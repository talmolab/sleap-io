{
  "data": {
    "labels": {
      "training_labels": "train.pkg.slp",
      "validation_labels": "val.pkg.slp",
      "validation_fraction": 0.1,
      "test_labels": null,
      "split_by_inds": false,
      "training_inds": null,
      "validation_inds": null,
      "test_inds": null,
      "search_path_hints": [
        ""
      ],
      "skeletons": [
        {
          "directed": true,
          "graph": {
            "name": "Skeleton-0",
            "num_edges_inserted": 46
          },
          "links": [
            {
              "edge_insert_idx": 44,
              "key": 0,
              "source": {
                "py/object": "sleap.skeleton.Node",
                "py/state": {
                  "py/tuple": [
                    "head",
                    1.0
                  ]
                }
              },
              "target": {
                "py/object": "sleap.skeleton.Node",
                "py/state": {
                  "py/tuple": [
                    "eyeL",
                    1.0
                  ]
                }
              },
              "type": {
                "py/reduce": [
                  {
                    "py/type": "sleap.skeleton.EdgeType"
                  },
                  {
                    "py/tuple": [
                      1
                    ]
                  }
                ]
              }
            },
            {
              "edge_insert_idx": 45,
              "key": 0,
              "source": {
                "py/id": 1
              },
              "target": {
                "py/object": "sleap.skeleton.Node",
                "py/state": {
                  "py/tuple": [
                    "eyeR",
                    1.0
                  ]
                }
              },
              "type": {
                "py/id": 3
              }
            },
            {
              "edge_insert_idx": 34,
              "key": 0,
              "source": {
                "py/object": "sleap.skeleton.Node",
                "py/state": {
                  "py/tuple": [
                    "thorax",
                    1.0
                  ]
                }
              },
              "target": {
                "py/id": 1
              },
              "type": {
                "py/id": 3
              }
            },
            {
              "edge_insert_idx": 35,
              "key": 0,
              "source": {
                "py/id": 5
              },
              "target": {
                "py/object": "sleap.skeleton.Node",
                "py/state": {
                  "py/tuple": [
                    "abdomen",
                    1.0
                  ]
                }
              },
              "type": {
                "py/id": 3
              }
            },
            {
              "edge_insert_idx": 36,
              "key": 0,
              "source": {
                "py/id": 5
              },
              "target": {
                "py/object": "sleap.skeleton.Node",
                "py/state": {
                  "py/tuple": [
                    "wingL",
                    1.0
                  ]
                }
              },
              "type": {
                "py/id": 3
              }
            },
            {
              "edge_insert_idx": 37,
              "key": 0,
              "source": {
                "py/id": 5
              },
              "target": {
                "py/object": "sleap.skeleton.Node",
                "py/state": {
                  "py/tuple": [
                    "wingR",
                    1.0
                  ]
                }
              },
              "type": {
                "py/id": 3
              }
            },
            {
              "edge_insert_idx": 38,
              "key": 0,
              "source": {
                "py/id": 5
              },
              "target": {
                "py/object": "sleap.skeleton.Node",
                "py/state": {
                  "py/tuple": [
                    "forelegL4",
                    1.0
                  ]
                }
              },
              "type": {
                "py/id": 3
              }
            },
            {
              "edge_insert_idx": 39,
              "key": 0,
              "source": {
                "py/id": 5
              },
              "target": {
                "py/object": "sleap.skeleton.Node",
                "py/state": {
                  "py/tuple": [
                    "forelegR4",
                    1.0
                  ]
                }
              },
              "type": {
                "py/id": 3
              }
            },
            {
              "edge_insert_idx": 40,
              "key": 0,
              "source": {
                "py/id": 5
              },
              "target": {
                "py/object": "sleap.skeleton.Node",
                "py/state": {
                  "py/tuple": [
                    "midlegL4",
                    1.0
                  ]
                }
              },
              "type": {
                "py/id": 3
              }
            },
            {
              "edge_insert_idx": 41,
              "key": 0,
              "source": {
                "py/id": 5
              },
              "target": {
                "py/object": "sleap.skeleton.Node",
                "py/state": {
                  "py/tuple": [
                    "midlegR4",
                    1.0
                  ]
                }
              },
              "type": {
                "py/id": 3
              }
            },
            {
              "edge_insert_idx": 42,
              "key": 0,
              "source": {
                "py/id": 5
              },
              "target": {
                "py/object": "sleap.skeleton.Node",
                "py/state": {
                  "py/tuple": [
                    "hindlegL4",
                    1.0
                  ]
                }
              },
              "type": {
                "py/id": 3
              }
            },
            {
              "edge_insert_idx": 43,
              "key": 0,
              "source": {
                "py/id": 5
              },
              "target": {
                "py/object": "sleap.skeleton.Node",
                "py/state": {
                  "py/tuple": [
                    "hindlegR4",
                    1.0
                  ]
                }
              },
              "type": {
                "py/id": 3
              }
            },
            {
              "key": 0,
              "source": {
                "py/id": 7
              },
              "target": {
                "py/id": 8
              },
              "type": {
                "py/reduce": [
                  {
                    "py/type": "sleap.skeleton.EdgeType"
                  },
                  {
                    "py/tuple": [
                      2
                    ]
                  }
                ]
              }
            },
            {
              "key": 0,
              "source": {
                "py/id": 8
              },
              "target": {
                "py/id": 7
              },
              "type": {
                "py/id": 15
              }
            },
            {
              "key": 0,
              "source": {
                "py/id": 9
              },
              "target": {
                "py/id": 10
              },
              "type": {
                "py/id": 15
              }
            },
            {
              "key": 0,
              "source": {
                "py/id": 10
              },
              "target": {
                "py/id": 9
              },
              "type": {
                "py/id": 15
              }
            },
            {
              "key": 0,
              "source": {
                "py/id": 11
              },
              "target": {
                "py/id": 12
              },
              "type": {
                "py/id": 15
              }
            },
            {
              "key": 0,
              "source": {
                "py/id": 12
              },
              "target": {
                "py/id": 11
              },
              "type": {
                "py/id": 15
              }
            },
            {
              "key": 0,
              "source": {
                "py/id": 13
              },
              "target": {
                "py/id": 14
              },
              "type": {
                "py/id": 15
              }
            },
            {
              "key": 0,
              "source": {
                "py/id": 14
              },
              "target": {
                "py/id": 13
              },
              "type": {
                "py/id": 15
              }
            },
            {
              "key": 0,
              "source": {
                "py/id": 2
              },
              "target": {
                "py/id": 4
              },
              "type": {
                "py/id": 15
              }
            },
            {
              "key": 0,
              "source": {
                "py/id": 4
              },
              "target": {
                "py/id": 2
              },
              "type": {
                "py/id": 15
              }
            }
          ],
          "multigraph": true,
          "nodes": [
            {
              "id": {
                "py/id": 1
              }
            },
            {
              "id": {
                "py/id": 5
              }
            },
            {
              "id": {
                "py/id": 6
              }
            },
            {
              "id": {
                "py/id": 7
              }
            },
            {
              "id": {
                "py/id": 8
              }
            },
            {
              "id": {
                "py/id": 9
              }
            },
            {
              "id": {
                "py/id": 10
              }
            },
            {
              "id": {
                "py/id": 11
              }
            },
            {
              "id": {
                "py/id": 12
              }
            },
            {
              "id": {
                "py/id": 13
              }
            },
            {
              "id": {
                "py/id": 14
              }
            },
            {
              "id": {
                "py/id": 2
              }
            },
            {
              "id": {
                "py/id": 4
              }
            }
          ]
        }
      ]
    },
    "preprocessing": {
      "ensure_rgb": false,
      "ensure_grayscale": false,
      "imagenet_mode": null,
      "input_scaling": 1.0,
      "pad_to_stride": 32,
      "resize_and_pad_to_target": true,
      "target_height": 1024,
      "target_width": 1024
    },
    "instance_cropping": {
      "center_on_part": null,
      "crop_size": null,
      "crop_size_detection_padding": 16
    }
  },
  "model": {
    "backbone": {
      "leap": null,
      "unet": {
        "stem_stride": null,
        "max_stride": 32,
        "output_stride": 4,
        "filters": 16,
        "filters_rate": 2.0,
        "middle_block": true,
        "up_interpolate": true,
        "stacks": 1
      },
      "hourglass": null,
      "resnet": null,
      "pretrained_encoder": null
    },
    "heads": {
      "single_instance": null,
      "centroid": null,
      "centered_instance": null,
      "multi_instance": {
        "confmaps": {
          "part_names": [
            "head",
            "thorax",
            "abdomen",
            "wingL",
            "wingR",
            "forelegL4",
            "forelegR4",
            "midlegL4",
            "midlegR4",
            "hindlegL4",
            "hindlegR4",
            "eyeL",
            "eyeR"
          ],
          "sigma": 2.5,
          "output_stride": 4,
          "loss_weight": 1.0,
          "offset_refinement": false
        },
        "pafs": {
          "edges": [
            [
              "thorax",
              "head"
            ],
            [
              "thorax",
              "abdomen"
            ],
            [
              "thorax",
              "wingL"
            ],
            [
              "thorax",
              "wingR"
            ],
            [
              "thorax",
              "forelegL4"
            ],
            [
              "thorax",
              "forelegR4"
            ],
            [
              "thorax",
              "midlegL4"
            ],
            [
              "thorax",
              "midlegR4"
            ],
            [
              "thorax",
              "hindlegL4"
            ],
            [
              "thorax",
              "hindlegR4"
            ],
            [
              "head",
              "eyeL"
            ],
            [
              "head",
              "eyeR"
            ]
          ],
          "sigma": 75.0,
          "output_stride": 8,
          "loss_weight": 1.0
        }
      },
      "multi_class_bottomup": null,
      "multi_class_topdown": null
    },
    "base_checkpoint": null
  },
  "optimization": {
    "preload_data": true,
    "augmentation_config": {
      "rotate": true,
      "rotation_min_angle": -15.0,
      "rotation_max_angle": 15.0,
      "translate": false,
      "translate_min": -5,
      "translate_max": 5,
      "scale": false,
      "scale_min": 0.9,
      "scale_max": 1.1,
      "uniform_noise": false,
      "uniform_noise_min_val": 0.0,
      "uniform_noise_max_val": 10.0,
      "gaussian_noise": false,
      "gaussian_noise_mean": 5.0,
      "gaussian_noise_stddev": 1.0,
      "contrast": false,
      "contrast_min_gamma": 0.5,
      "contrast_max_gamma": 2.0,
      "brightness": false,
      "brightness_min_val": 0.0,
      "brightness_max_val": 10.0,
      "random_crop": false,
      "random_crop_height": 256,
      "random_crop_width": 256,
      "random_flip": false,
      "flip_horizontal": false
    },
    "online_shuffling": true,
    "shuffle_buffer_size": 128,
    "prefetch": true,
    "batch_size": 4,
    "batches_per_epoch": 400,
    "min_batches_per_epoch": 200,
    "val_batches_per_epoch": 50,
    "min_val_batches_per_epoch": 10,
    "epochs": 10,
    "optimizer": "adam",
    "initial_learning_rate": 0.0001,
    "learning_rate_schedule": {
      "reduce_on_plateau": true,
      "reduction_factor": 0.5,
      "plateau_min_delta": 1e-06,
      "plateau_patience": 5,
      "plateau_cooldown": 3,
      "min_learning_rate": 1e-08
    },
    "hard_keypoint_mining": {
      "online_mining": false,
      "hard_to_easy_ratio": 2.0,
      "min_hard_keypoints": 2,
      "max_hard_keypoints": null,
      "loss_scale": 5.0
    },
    "early_stopping": {
      "stop_training_on_plateau": true,
      "plateau_min_delta": 1e-08,
      "plateau_patience": 10
    }
  },
  "outputs": {
    "save_outputs": true,
    "run_name": "sleap_bottomup",
    "run_name_prefix": "",
    "run_name_suffix": "",
    "runs_folder": "models",
    "tags": [
      ""
    ],
    "save_visualizations": true,
    "keep_viz_images": false,
    "zip_outputs": false,
    "log_to_csv": true,
    "checkpointing": {
      "initial_model": false,
      "best_model": true,
      "every_epoch": false,
      "latest_model": false,
      "final_model": false
    },
    "tensorboard": {
      "write_logs": false,
      "loss_frequency": "epoch",
      "architecture_graph": false,
      "profile_graph": false,
      "visualizations": true
    },
    "zmq": {
      "subscribe_to_controller": false,
      "controller_address": "tcp://127.0.0.1:9000",
      "controller_polling_timeout": 10,
      "publish_updates": false,
      "publish_address": "tcp://127.0.0.1:9001"
    }
  },
  "name": "",
  "description": "",
  "sleap_version": "1.4.1",
  "filename": "training_config.json"
}