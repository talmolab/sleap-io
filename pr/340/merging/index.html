
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://io.sleap.ai/merging/">
      
      
        <link rel="prev" href="../codecs/">
      
      
        <link rel="next" href="../rendering/">
      
      
        
      
      
      <link rel="icon" href="../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Merging - sleap-io documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#merging-annotations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="sleap-io documentation" class="md-header__button md-logo" aria-label="sleap-io documentation" data-md-component="logo">
      
  <img src="../assets/sleap-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            sleap-io documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Merging
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-orange" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/talmolab/sleap-io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="sleap-io documentation" class="md-nav__button md-logo" aria-label="sleap-io documentation" data-md-component="logo">
      
  <img src="../assets/sleap-logo.png" alt="logo">

    </a>
    sleap-io documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/talmolab/sleap-io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/talmolab/sleap-io/releases" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Releases
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../codecs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Codecs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Merging
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Merging
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick start
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-merging-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        How merging works
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matching-without-merging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Matching without merging
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleton-matching" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Skeleton matching
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#video-matching" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Video matching
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#track-matching" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: Track matching
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frame-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4: Frame strategies
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instance-matching" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 5: Instance matching
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Troubleshooting
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reference
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rendering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rendering
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transforms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transforms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../formats/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Formats
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Formats
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../formats/slp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SLP Format
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Full API
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Full API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/sleap_io/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    sleap_io
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_1" id="__nav_6_4_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    sleap_io
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_1_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/sleap_io/codecs/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    codecs
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_1_1" id="__nav_6_4_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_4_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_1_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    codecs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/codecs/dataframe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dataframe
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/codecs/dictionary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dictionary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/codecs/numpy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    numpy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_1_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/sleap_io/io/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    io
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_1_2" id="__nav_6_4_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_4_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    io
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/alphatracker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    alphatracker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/analysis_h5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    analysis_h5
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cli
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/coco/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    coco
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/csv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    csv
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/dlc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dlc
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/jabs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    jabs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/labelstudio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    labelstudio
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/leap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    leap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    main
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/nwb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    nwb
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/nwb_annotations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    nwb_annotations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/nwb_predictions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    nwb_predictions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/skeleton/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    skeleton
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/slp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    slp
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/slp_lazy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    slp_lazy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/ultralytics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ultralytics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/video_reading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    video_reading
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/video_writing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    video_writing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_1_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/sleap_io/model/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    model
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_1_3" id="__nav_6_4_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_4_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_1_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    model
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/model/camera/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    camera
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/model/instance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    instance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/model/labeled_frame/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    labeled_frame
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/model/labels/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    labels
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/model/labels_set/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    labels_set
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/model/matching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    matching
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/model/skeleton/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    skeleton
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/model/suggestions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    suggestions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/model/video/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    video
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_1_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/sleap_io/rendering/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    rendering
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_1_4" id="__nav_6_4_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_4_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_1_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    rendering
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/rendering/callbacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    callbacks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/rendering/colors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    colors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/rendering/core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    core
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/rendering/shapes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    shapes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_1_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/sleap_io/transform/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    transform
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_1_5" id="__nav_6_4_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_4_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_1_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    transform
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/transform/core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    core
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/transform/frame/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    frame
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/transform/points/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    points
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/transform/video/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    video
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/version/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    version
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick start
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-merging-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        How merging works
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matching-without-merging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Matching without merging
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleton-matching" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Skeleton matching
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#video-matching" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Video matching
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#track-matching" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: Track matching
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frame-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4: Frame strategies
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instance-matching" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 5: Instance matching
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Troubleshooting
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reference
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<div class="md-source-file"><a href="../merging.md" title="View markdown source" class="md-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6m4 18H6V4h7v5h5v11M13 9V3.5L18.5 9H13Z"/></svg></a></div>
<h1 id="merging-annotations">Merging annotations<a class="headerlink" href="#merging-annotations" title="Permanent link">&para;</a></h1>
<p>Merging combines annotations from multiple sources into a single dataset.</p>
<h2 id="quick-start">Quick start<a class="headerlink" href="#quick-start" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sleap_io</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sio</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">base</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;manual_annotations.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">predictions</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;predictions.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">base</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;merged.slp&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="how-merging-works">How merging works<a class="headerlink" href="#how-merging-works" title="Permanent link">&para;</a></h2>
<p>Merging proceeds in five steps:</p>
<ol>
<li><strong><a href="#skeleton-matching">Match skeletons</a></strong> — Find corresponding skeletons by node structure</li>
<li><strong><a href="#video-matching">Match videos</a></strong> — Identify same videos across datasets</li>
<li><strong><a href="#track-matching">Match tracks</a></strong> — Map track identities between datasets</li>
<li><strong><a href="#frame-strategies">Merge frames</a></strong> — Combine frames based on the <code>frame</code> strategy</li>
<li><strong><a href="#instance-matching">Match instances</a></strong> — Pair instances within overlapping frames</li>
</ol>
<h3 id="preset-options">Preset options<a class="headerlink" href="#preset-options" title="Permanent link">&para;</a></h3>
<p>These options are controlled via parameters to <a href="#sleap_io.model.labels.Labels.merge"><code>Labels.merge()</code></a>:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Controls</th>
<th>Options</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>skeleton</code></td>
<td>How skeletons are matched</td>
<td><a href="#skeleton-matching"><code>"structure"</code></a> (default), <a href="#skeleton-matching"><code>"subset"</code></a>, <a href="#skeleton-matching"><code>"overlap"</code></a>, <a href="#skeleton-matching"><code>"exact"</code></a></td>
</tr>
<tr>
<td><code>video</code></td>
<td>How videos are matched</td>
<td><a href="#how-auto-matching-works"><code>"auto"</code></a> (default), <a href="#other-video-matching-methods"><code>"path"</code></a>, <a href="#other-video-matching-methods"><code>"basename"</code></a>, <a href="#other-video-matching-methods"><code>"content"</code></a>, <a href="#other-video-matching-methods"><code>"shape"</code></a>, <a href="#other-video-matching-methods"><code>"image_dedup"</code></a></td>
</tr>
<tr>
<td><code>track</code></td>
<td>How tracks are matched</td>
<td><a href="#track-matching"><code>"name"</code></a> (default), <a href="#track-matching"><code>"identity"</code></a></td>
</tr>
<tr>
<td><code>frame</code></td>
<td>How overlapping frames are combined</td>
<td><a href="#auto-default"><code>"auto"</code></a> (default), <a href="#replace_predictions"><code>"replace_predictions"</code></a>, <a href="#other-frame-strategies"><code>"keep_original"</code></a>, <a href="#other-frame-strategies"><code>"keep_new"</code></a>, <a href="#other-frame-strategies"><code>"keep_both"</code></a>, <a href="#other-frame-strategies"><code>"update_tracks"</code></a></td>
</tr>
<tr>
<td><code>instance</code></td>
<td>How instances are paired within frames</td>
<td><a href="#instance-matching"><code>"spatial"</code></a> (default), <a href="#instance-matching"><code>"identity"</code></a>, <a href="#instance-matching"><code>"iou"</code></a></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>  <span class="c1"># All defaults</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">video</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>  <span class="c1"># Explicit defaults</span>
</code></pre></div>
<hr />
<h2 id="matching-without-merging">Matching without merging<a class="headerlink" href="#matching-without-merging" title="Permanent link">&para;</a></h2>
<p>Sometimes you need to inspect matching results without actually merging datasets. This is useful for:</p>
<ul>
<li><strong>Evaluation workflows</strong>: Aligning predictions with ground truth to compute metrics</li>
<li><strong>Debugging</strong>: Understanding why videos/skeletons aren't matching as expected</li>
<li><strong>Validation</strong>: Checking matches before committing to a merge</li>
</ul>
<p>Use <a href="#sleap_io.model.labels.Labels.match"><code>Labels.match()</code></a> to build correspondence maps without modifying either dataset:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sleap_io</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sio</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">gt_labels</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_slp</span><span class="p">(</span><span class="s2">&quot;ground_truth.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="n">pred_labels</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_slp</span><span class="p">(</span><span class="s2">&quot;predictions.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="c1"># Match predictions to ground truth (doesn&#39;t modify either)</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="n">result</span> <span class="o">=</span> <span class="n">gt_labels</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">pred_labels</span><span class="p">)</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="c1"># Inspect results</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="c1"># Videos: 2/2 matched</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="c1"># Skeletons: 1/1 matched</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="c1"># Tracks: 0/0 matched</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="c1"># Check if all videos matched</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="o">.</span><span class="n">all_videos_matched</span><span class="p">:</span>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unmatched videos:&quot;</span><span class="p">)</span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>    <span class="k">for</span> <span class="n">video</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">unmatched_videos</span><span class="p">:</span>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">video</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="c1"># Iterate through matched videos</span>
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="k">for</span> <span class="n">pred_video</span><span class="p">,</span> <span class="n">gt_video</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">video_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>    <span class="k">if</span> <span class="n">gt_video</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pred_video</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">gt_video</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="matchresult-properties">MatchResult properties<a class="headerlink" href="#matchresult-properties" title="Permanent link">&para;</a></h3>
<p>The <a href="#sleap_io.model.matching.MatchResult"><code>MatchResult</code></a> object contains:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>video_map</code></td>
<td><code>dict[Video, Video \| None]</code></td>
<td>Maps other's videos to self's videos</td>
</tr>
<tr>
<td><code>skeleton_map</code></td>
<td><code>dict[Skeleton, Skeleton \| None]</code></td>
<td>Maps other's skeletons to self's skeletons</td>
</tr>
<tr>
<td><code>track_map</code></td>
<td><code>dict[Track, Track \| None]</code></td>
<td>Maps other's tracks to self's tracks</td>
</tr>
<tr>
<td><code>unmatched_videos</code></td>
<td><code>list[Video]</code></td>
<td>Videos from other with no match</td>
</tr>
<tr>
<td><code>unmatched_skeletons</code></td>
<td><code>list[Skeleton]</code></td>
<td>Skeletons from other with no match</td>
</tr>
<tr>
<td><code>unmatched_tracks</code></td>
<td><code>list[Track]</code></td>
<td>Tracks from other with no match</td>
</tr>
<tr>
<td><code>all_videos_matched</code></td>
<td><code>bool</code></td>
<td>True if all videos matched</td>
</tr>
<tr>
<td><code>n_videos_matched</code></td>
<td><code>int</code></td>
<td>Count of matched videos</td>
</tr>
</tbody>
</table>
<h3 id="customizing-matching">Customizing matching<a class="headerlink" href="#customizing-matching" title="Permanent link">&para;</a></h3>
<p><code>Labels.match()</code> accepts the same matching parameters as <code>merge()</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># Use specific video matching method</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">result</span> <span class="o">=</span> <span class="n">gt_labels</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">pred_labels</span><span class="p">,</span> <span class="n">video</span><span class="o">=</span><span class="s2">&quot;basename&quot;</span><span class="p">)</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="c1"># Use custom matchers</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="n">VideoMatcher</span><span class="p">,</span> <span class="n">VideoMatchMethod</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="n">matcher</span> <span class="o">=</span> <span class="n">VideoMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">BASENAME</span><span class="p">)</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="n">result</span> <span class="o">=</span> <span class="n">gt_labels</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">pred_labels</span><span class="p">,</span> <span class="n">video</span><span class="o">=</span><span class="n">matcher</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="skeleton-matching">Step 1: Skeleton matching<a class="headerlink" href="#skeleton-matching" title="Permanent link">&para;</a></h2>
<p>Before merging can proceed, skeletons from both datasets must be matched. Each skeleton in the incoming dataset is compared against skeletons in the base dataset to find correspondence.</p>
<h3 id="matching-methods">Matching methods<a class="headerlink" href="#matching-methods" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Method</th>
<th>Behavior</th>
<th>Use case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>"structure"</code></td>
<td>Match if same node names, regardless of order</td>
<td><strong>Default.</strong> Most common case</td>
</tr>
<tr>
<td><code>"subset"</code></td>
<td>Match if incoming skeleton nodes are a subset of base</td>
<td>Merging partial annotations</td>
</tr>
<tr>
<td><code>"overlap"</code></td>
<td>Match if sufficient overlap between node sets</td>
<td>Flexible matching with threshold</td>
</tr>
<tr>
<td><code>"exact"</code></td>
<td>Match only if nodes and edges are identical</td>
<td>Strict validation</td>
</tr>
</tbody>
</table>
<p>If no match is found, the skeleton is added as new to the base dataset.</p>
<h3 id="string-configuration">String configuration<a class="headerlink" href="#string-configuration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Default: match by structure (same nodes, any order)</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">skeleton</span><span class="o">=</span><span class="s2">&quot;structure&quot;</span><span class="p">)</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c1"># Allow partial matches (incoming can have fewer nodes)</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">skeleton</span><span class="o">=</span><span class="s2">&quot;subset&quot;</span><span class="p">)</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="c1"># Exact match required (nodes and edges must be identical)</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">skeleton</span><span class="o">=</span><span class="s2">&quot;exact&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="object-configuration">Object configuration<a class="headerlink" href="#object-configuration" title="Permanent link">&para;</a></h3>
<p>For advanced control, use <a href="#sleap_io.model.matching.SkeletonMatcher"><code>SkeletonMatcher</code></a>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="n">SkeletonMatcher</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="c1"># Overlap matching with custom threshold (70% of nodes must match)</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="n">matcher</span> <span class="o">=</span> <span class="n">SkeletonMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;overlap&quot;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">skeleton</span><span class="o">=</span><span class="n">matcher</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="video-matching">Step 2: Video matching<a class="headerlink" href="#video-matching" title="Permanent link">&para;</a></h2>
<p>Videos must match for frames to merge. If video matching fails, the video is added as new—no frames merge because there's no overlap.</p>
<h3 id="design-philosophy">Design philosophy<a class="headerlink" href="#design-philosophy" title="Permanent link">&para;</a></h3>
<p>The default AUTO algorithm prioritizes <strong>avoiding false positives</strong> (matching wrong videos) over avoiding false negatives (failing to match correct videos):</p>
<table>
<thead>
<tr>
<th>Error type</th>
<th>Consequence</th>
<th>Severity</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>False positive</strong></td>
<td>Annotations merged to wrong video</td>
<td><strong>Data corruption</strong> (often unrecoverable)</td>
</tr>
<tr>
<td><strong>False negative</strong></td>
<td>Video added as new</td>
<td><strong>Safe</strong> (easily fixed, see below)</td>
</tr>
</tbody>
</table>
<p><strong>When uncertain, AUTO adds the video as new rather than risk a wrong match.</strong></p>
<h3 id="how-auto-matching-works">How AUTO matching works<a class="headerlink" href="#how-auto-matching-works" title="Permanent link">&para;</a></h3>
<p>For each incoming video, AUTO runs these checks in order:</p>
<table>
<thead>
<tr>
<th>Step</th>
<th>Check</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Shape incompatible (frames, H, W differ)</td>
<td>Reject</td>
</tr>
<tr>
<td>2</td>
<td>Provenance conflict (different <code>original_video</code>, verifiable)</td>
<td>Reject</td>
</tr>
<tr>
<td>3</td>
<td>Same physical file (<code>os.path.samefile</code>)</td>
<td><strong>Match</strong></td>
</tr>
<tr>
<td>4</td>
<td>Exact path string match</td>
<td><strong>Match</strong></td>
</tr>
<tr>
<td>5</td>
<td>Unique basename/parent suffix match</td>
<td><strong>Match</strong></td>
</tr>
<tr>
<td>6</td>
<td>Pose matching (identical annotations on common frames)</td>
<td><strong>Match</strong></td>
</tr>
<tr>
<td>7</td>
<td>Image matching (pixel similarity, if enabled)</td>
<td><strong>Match</strong></td>
</tr>
<tr>
<td>8</td>
<td>No match found</td>
<td>Add as new</td>
</tr>
</tbody>
</table>
<p><strong>Shape is for rejection only.</strong> Same resolution does NOT imply a match—it just means the videos aren't rejected. This prevents matching unrelated videos that happen to have the same dimensions.</p>
<p><strong>Provenance conflict checking</strong> only rejects when files can be verified on disk. If neither file exists (e.g., embedded videos in <code>.pkg.slp</code> files), the check is skipped to allow fall-through to content-based matching.</p>
<h3 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h3>
<p><strong>Cross-platform paths with unique basenames:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>Base:  C:/Users/alice/data/fly.mp4
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>Other: /home/bob/data/fly.mp4
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>Result: MATCH — &quot;fly.mp4&quot; is unique in both sets
</code></pre></div></p>
<p><strong>Ambiguous basenames, parent disambiguates:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>Base:  /data/exp1/fly.mp4, /data/exp2/fly.mp4
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>Other: /remote/exp2/fly.mp4
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>Result: MATCH to exp2/fly.mp4 — parent directory disambiguates
</code></pre></div></p>
<p><strong>Same basename, different content:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>Base:  fly.mp4 (1000 frames)
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>Other: fly.mp4 (500 frames)
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>Result: NOT MATCH — shape rejection (different frame counts)
</code></pre></div></p>
<p><strong>PKG.SLP predictions to external video:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>Base: project.slp with /data/fly.mp4
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>Other: predictions.pkg.slp (embedded, original_video=/data/fly.mp4)
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>Result: MATCH — provenance chain links to same file
</code></pre></div></p>
<p><strong>Cross-platform embedded videos (pose matching):</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>Base: valence.pkg.slp (Linux, original_video=/snlkt/.../CHR/fly.mp4)
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>Other: stress.pkg.slp (Windows, original_video=X:/.../CHR/fly.mp4)
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>Result: MATCH — poses on common frames are identical
</code></pre></div></p>
<h3 id="content-based-matching">Content-based matching<a class="headerlink" href="#content-based-matching" title="Permanent link">&para;</a></h3>
<p>AUTO mode includes pose-based matching as a default step. When videos have overlapping labeled frames, the matcher compares pose coordinates to identify identical videos even when file paths differ.</p>
<h4 id="how-pose-matching-works">How pose matching works<a class="headerlink" href="#how-pose-matching-works" title="Permanent link">&para;</a></h4>
<ol>
<li>Find common frame indices between videos</li>
<li>For each common frame, check if ANY instance pair has identical poses</li>
<li>If enough frames match (default: 3), consider it a match</li>
</ol>
<p>This is particularly useful for:
- Cross-platform merges (Linux ↔ Windows paths)
- Embedded videos in <code>.pkg.slp</code> files that can't be verified on disk
- Videos that have been moved or renamed</p>
<h4 id="videomatcher-parameters">VideoMatcher parameters<a class="headerlink" href="#videomatcher-parameters" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>content_frames</code></td>
<td>3</td>
<td>Minimum matching frames for confident match</td>
</tr>
<tr>
<td><code>compare_predictions</code></td>
<td><code>"auto"</code></td>
<td>Include predictions: <code>"auto"</code>, <code>True</code>, or <code>False</code></td>
</tr>
<tr>
<td><code>compare_images</code></td>
<td><code>False</code></td>
<td>Enable image comparison (expensive)</td>
</tr>
<tr>
<td><code>image_similarity_threshold</code></td>
<td>0.05</td>
<td>Max pixel difference (0-1 scale)</td>
</tr>
</tbody>
</table>
<h4 id="compare_predictions-modes">compare_predictions modes<a class="headerlink" href="#compare_predictions-modes" title="Permanent link">&para;</a></h4>
<ul>
<li><code>"auto"</code> (default): Include predictions only if the video has NO user instances</li>
<li><code>True</code>: Always include predictions in comparison</li>
<li><code>False</code>: Only compare user-labeled instances</li>
</ul>
<h4 id="image-similarity-threshold">Image similarity threshold<a class="headerlink" href="#image-similarity-threshold" title="Permanent link">&para;</a></h4>
<p>When <code>compare_images=True</code>, frames are compared by mean pixel difference:</p>
<ul>
<li><code>0.05</code> (default): ~13/255 pixel difference allowed</li>
<li><code>0.01</code>: Very strict (~3/255 pixels)</li>
<li><code>0.1</code>: Lenient (~26/255 pixels)</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># Enable image comparison with custom threshold</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="n">VideoMatcher</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">video</span><span class="o">=</span><span class="n">VideoMatcher</span><span class="p">(</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>    <span class="n">compare_images</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>    <span class="n">image_similarity_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>  <span class="c1"># More lenient</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="p">))</span>
</code></pre></div>
<h3 id="string-configuration_1">String configuration<a class="headerlink" href="#string-configuration_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># Default: safe AUTO cascade</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">video</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="c1"># Exact path match only</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">video</span><span class="o">=</span><span class="s2">&quot;path&quot;</span><span class="p">)</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="c1"># Match by filename only (ignores directory)</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">video</span><span class="o">=</span><span class="s2">&quot;basename&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="object-configuration_1">Object configuration<a class="headerlink" href="#object-configuration_1" title="Permanent link">&para;</a></h3>
<p>For advanced control, use <a href="#sleap_io.model.matching.VideoMatcher"><code>VideoMatcher</code></a>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="n">VideoMatcher</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c1"># Strict path matching (paths must be identical, no normalization)</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="n">matcher</span> <span class="o">=</span> <span class="n">VideoMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">video</span><span class="o">=</span><span class="n">matcher</span><span class="p">)</span>
</code></pre></div>
<h3 id="other-video-matching-methods">Other video matching methods<a class="headerlink" href="#other-video-matching-methods" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Method</th>
<th>Behavior</th>
<th>Use case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>"auto"</code></td>
<td>Safe cascade (default)</td>
<td>Most situations</td>
</tr>
<tr>
<td><code>"path"</code></td>
<td>Exact path match only</td>
<td>Strict control</td>
</tr>
<tr>
<td><code>"basename"</code></td>
<td>Filename only, ignores directory</td>
<td>Cross-platform (use with caution)</td>
</tr>
<tr>
<td><code>"content"</code></td>
<td>Shape + backend type</td>
<td><strong>Dangerous</strong> — matches any same-resolution video</td>
</tr>
<tr>
<td><code>"shape"</code></td>
<td>Match and merge by shape</td>
<td>Image list merging</td>
</tr>
<tr>
<td><code>"image_dedup"</code></td>
<td>Deduplicate image lists</td>
<td>Remove duplicate images</td>
</tr>
</tbody>
</table>
<h3 id="handling-false-negatives">Handling false negatives<a class="headerlink" href="#handling-false-negatives" title="Permanent link">&para;</a></h3>
<p>If AUTO doesn't match videos that ARE the same, you have a <strong>false negative</strong>. This is safe—the video was added as new rather than corrupting data. Here's how to detect and fix it:</p>
<p><strong>Step 1: Detect</strong> — Check video count after merge:
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">base</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;base.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="n">other</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;other.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Before: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">videos</span><span class="p">)</span><span class="si">}</span><span class="s2"> videos&quot;</span><span class="p">)</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="n">result</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;After: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">videos</span><span class="p">)</span><span class="si">}</span><span class="s2"> videos&quot;</span><span class="p">)</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="c1"># If count increased unexpectedly, videos weren&#39;t matched</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">base</span><span class="o">.</span><span class="n">videos</span><span class="p">:</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">v</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></p>
<p><strong>Step 2: Verify</strong> — Confirm the videos ARE the same:
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># Check shapes match</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">video_a</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">videos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="n">video_b</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">videos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># The one that should have matched</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Video A: </span><span class="si">{</span><span class="n">video_a</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># e.g., (1000, 480, 640, 3)</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Video B: </span><span class="si">{</span><span class="n">video_b</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="c1"># If files exist, check content</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="k">if</span> <span class="n">video_a</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="n">video_b</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>    <span class="c1"># Compare first frame visually or by hash</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>    <span class="n">frame_a</span> <span class="o">=</span> <span class="n">video_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a>    <span class="n">frame_b</span> <span class="o">=</span> <span class="n">video_b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></p>
<p><strong>Step 3: Fix</strong> — Use <a href="#sleap_io.model.labels.Labels.replace_filenames"><code>replace_filenames</code></a> before merging:
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># Reload and fix paths before merge</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="n">base</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;base.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="n">other</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;other.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="c1"># Option A: Map the specific file</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="n">other</span><span class="o">.</span><span class="n">replace_filenames</span><span class="p">(</span><span class="n">filename_map</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>    <span class="s2">&quot;/remote/path/fly.mp4&quot;</span><span class="p">:</span> <span class="s2">&quot;/local/path/fly.mp4&quot;</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="p">})</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="c1"># Option B: Map by prefix (for multiple videos)</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="n">other</span><span class="o">.</span><span class="n">replace_filenames</span><span class="p">(</span><span class="n">prefix_map</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>    <span class="s2">&quot;/remote/data&quot;</span><span class="p">:</span> <span class="s2">&quot;/local/data&quot;</span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="p">})</span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="c1"># Now merge</span>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="n">result</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Videos after fix: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">videos</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Should match original count</span>
</code></pre></div></p>
<p><strong>Alternative: Force match with explicit matcher:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1"># Only use this if you&#39;re CERTAIN the videos are the same</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">video</span><span class="o">=</span><span class="s2">&quot;basename&quot;</span><span class="p">)</span>  <span class="c1"># Match by filename only</span>
</code></pre></div></p>
<hr />
<h2 id="track-matching">Step 3: Track matching<a class="headerlink" href="#track-matching" title="Permanent link">&para;</a></h2>
<p>Tracks represent identities (e.g., individual animals) that persist across frames. During merge, tracks from the incoming dataset are matched to tracks in the base dataset.</p>
<h3 id="matching-methods_1">Matching methods<a class="headerlink" href="#matching-methods_1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Method</th>
<th>Behavior</th>
<th>Use case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>"name"</code></td>
<td>Match tracks with identical names</td>
<td><strong>Default.</strong> Named individuals</td>
</tr>
<tr>
<td><code>"identity"</code></td>
<td>Match by track object identity</td>
<td>Same <code>Track</code> object in memory</td>
</tr>
</tbody>
</table>
<p>If no match is found, the track is added as new to the base dataset.</p>
<h3 id="string-configuration_2">String configuration<a class="headerlink" href="#string-configuration_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># Default: match by track name</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">track</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="c1"># Match by object identity (same Track instance)</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">track</span><span class="o">=</span><span class="s2">&quot;identity&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="object-configuration_2">Object configuration<a class="headerlink" href="#object-configuration_2" title="Permanent link">&para;</a></h3>
<p>For advanced control, use <a href="#sleap_io.model.matching.TrackMatcher"><code>TrackMatcher</code></a>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrackMatcher</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="c1"># Explicit name matching</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="n">matcher</span> <span class="o">=</span> <span class="n">TrackMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">track</span><span class="o">=</span><span class="n">matcher</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="frame-strategies">Step 4: Frame strategies<a class="headerlink" href="#frame-strategies" title="Permanent link">&para;</a></h2>
<p>The <code>frame</code> parameter controls what happens when both datasets have the same frame (same video and frame index).</p>
<h3 id="auto-default"><code>auto</code> (default)<a class="headerlink" href="#auto-default" title="Permanent link">&para;</a></h3>
<p>The recommended strategy for human-in-the-loop workflows. Preserves user labels, updates predictions.</p>
<table>
<thead>
<tr>
<th>Base instance</th>
<th>Other instance</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr>
<td>User label</td>
<td>Prediction</td>
<td>Keep user label</td>
</tr>
<tr>
<td>User label</td>
<td>User label</td>
<td>Keep base (conflict)</td>
</tr>
<tr>
<td>Prediction</td>
<td>User label</td>
<td><strong>Replace</strong> with user label</td>
</tr>
<tr>
<td>Prediction</td>
<td>Prediction</td>
<td>Replace with newer</td>
</tr>
</tbody>
</table>
<p>Unmatched instances from <code>other</code> are added.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c1"># Typical HITL workflow: merge predictions into labeled project</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>  <span class="c1"># Uses auto by default</span>
</code></pre></div>
<h3 id="replace_predictions"><code>replace_predictions</code><a class="headerlink" href="#replace_predictions" title="Permanent link">&para;</a></h3>
<p>Replace all predictions in base with predictions from other. User labels are preserved.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1"># Re-ran inference, want to update predictions</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">new_predictions</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;replace_predictions&quot;</span><span class="p">)</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Instance type</th>
<th>From base</th>
<th>From other</th>
</tr>
</thead>
<tbody>
<tr>
<td>User label</td>
<td><strong>Keep</strong></td>
<td>Ignore</td>
</tr>
<tr>
<td>Prediction</td>
<td>Remove</td>
<td><strong>Add</strong></td>
</tr>
</tbody>
</table>
<h3 id="other-frame-strategies">Other frame strategies<a class="headerlink" href="#other-frame-strategies" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Strategy</th>
<th>Behavior</th>
<th>Use case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>"keep_original"</code></td>
<td>Ignore other entirely for overlapping frames</td>
<td>Preserve base annotations</td>
</tr>
<tr>
<td><code>"keep_new"</code></td>
<td>Replace base with other for overlapping frames</td>
<td>Overwrite with new annotations</td>
</tr>
<tr>
<td><code>"keep_both"</code></td>
<td>Concatenate all instances (creates duplicates)</td>
<td>Manual deduplication later</td>
</tr>
<tr>
<td><code>"update_tracks"</code></td>
<td>Copy track assignments only, don't modify poses</td>
<td>Update identity labels</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1"># Keep only the original annotations</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;keep_original&quot;</span><span class="p">)</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="c1"># Replace with new annotations</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;keep_new&quot;</span><span class="p">)</span>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="c1"># Keep everything (may create duplicates)</span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;keep_both&quot;</span><span class="p">)</span>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="c1"># Update track assignments without changing poses</span>
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;update_tracks&quot;</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="instance-matching">Step 5: Instance matching<a class="headerlink" href="#instance-matching" title="Permanent link">&para;</a></h2>
<p>For frame strategies that need to pair instances (<code>auto</code>, <code>update_tracks</code>), instance matching determines how instances in the base frame correspond to instances in the incoming frame.</p>
<h3 id="matching-methods_2">Matching methods<a class="headerlink" href="#matching-methods_2" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Method</th>
<th>Behavior</th>
<th>Use case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>"spatial"</code></td>
<td>Match by centroid distance</td>
<td><strong>Default.</strong> Position-based matching</td>
</tr>
<tr>
<td><code>"identity"</code></td>
<td>Match by track identity</td>
<td>Same track assignment</td>
</tr>
<tr>
<td><code>"iou"</code></td>
<td>Match by bounding box IoU</td>
<td>Overlap-based matching</td>
</tr>
</tbody>
</table>
<h3 id="string-configuration_3">String configuration<a class="headerlink" href="#string-configuration_3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c1"># Default: spatial matching with 5px threshold</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="s2">&quot;spatial&quot;</span><span class="p">)</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="c1"># Match by track identity</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="s2">&quot;identity&quot;</span><span class="p">)</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="c1"># Match by bounding box overlap</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="s2">&quot;iou&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="object-configuration_3">Object configuration<a class="headerlink" href="#object-configuration_3" title="Permanent link">&para;</a></h3>
<p>For advanced control, use <a href="#sleap_io.model.matching.InstanceMatcher"><code>InstanceMatcher</code></a>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="n">InstanceMatcher</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="c1"># Tighter spatial matching (2px threshold)</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="n">matcher</span> <span class="o">=</span> <span class="n">InstanceMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;spatial&quot;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="n">matcher</span><span class="p">)</span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="c1"># IoU matching with 50% overlap threshold</span>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="n">matcher</span> <span class="o">=</span> <span class="n">InstanceMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;iou&quot;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="n">matcher</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h2>
<h3 id="videos-werent-matched-false-negative">Videos weren't matched (false negative)<a class="headerlink" href="#videos-werent-matched-false-negative" title="Permanent link">&para;</a></h3>
<p>See <a href="#handling-false-negatives">Handling false negatives</a> above.</p>
<h3 id="videos-matched-incorrectly-false-positive">Videos matched incorrectly (false positive)<a class="headerlink" href="#videos-matched-incorrectly-false-positive" title="Permanent link">&para;</a></h3>
<p>This shouldn't happen with AUTO matching. If it does:</p>
<ol>
<li>Check if videos have identical shapes AND ambiguous paths</li>
<li>Use <code>video="path"</code> for strict matching</li>
<li>Report as a bug—AUTO should be conservative</li>
</ol>
<h3 id="duplicate-instances-after-merge">Duplicate instances after merge<a class="headerlink" href="#duplicate-instances-after-merge" title="Permanent link">&para;</a></h3>
<p>Use <code>auto</code> instead of <code>keep_both</code>, or tighten the instance match threshold:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="n">InstanceMatcher</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="n">base</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="n">InstanceMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;spatial&quot;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">2.0</span><span class="p">))</span>
</code></pre></div>
<hr />
<h2 id="reference">Reference<a class="headerlink" href="#reference" title="Permanent link">&para;</a></h2>
<h3 id="labelsmerge">Labels.merge<a class="headerlink" href="#labelsmerge" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">


<h4 id="sleap_io.model.labels.Labels.merge" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sleap_io</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">Labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">skeleton</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">video</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">track</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">error_mode</span><span class="o">=</span><span class="s1">&#39;continue&#39;</span><span class="p">)</span></code>

<a href="#sleap_io.model.labels.Labels.merge" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">

        <p>Merge another Labels object into this one.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;Labels&lt;/code&gt; (&lt;code&gt;sleap_io.model.labels.Labels&lt;/code&gt;)" href="../reference/sleap_io/model/labels/#sleap_io.model.labels.Labels">Labels</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Another Labels object to merge into this one.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>skeleton</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="SkeletonMatcher">SkeletonMatcher</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Skeleton matching method. Can be a string ("structure",
"subset", "overlap", "exact") or a SkeletonMatcher object for
advanced configuration. Default is "structure".</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>video</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="VideoMatcher">VideoMatcher</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Video matching method. Can be a string ("auto", "path",
"basename", "content", "shape", "image_dedup") or a VideoMatcher
object for advanced configuration. Default is "auto".</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>track</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="TrackMatcher">TrackMatcher</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Track matching method. Can be a string ("name", "identity") or
a TrackMatcher object. Default is "name".</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>frame</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frame merge strategy. One of "auto", "keep_original",
"keep_new", "keep_both", "update_tracks", "replace_predictions".
Default is "auto".</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>instance</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="InstanceMatcher">InstanceMatcher</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Instance matching method for spatial frame strategies. Can be
a string ("spatial", "identity", "iou") or an InstanceMatcher object.
Default is "spatial" with 5px tolerance.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>validate</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, validate for conflicts before merging.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>progress_callback</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional callback for progress updates.
Should accept (current, total, message) arguments.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>error_mode</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How to handle errors:
- "continue": Log errors but continue
- "strict": Raise exception on first error
- "warn": Print warnings but continue</p>
              </div>
            </td>
            <td>
                  <code>&#39;continue&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="MergeResult">MergeResult</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>MergeResult object with statistics and any errors/conflicts.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If Labels is lazy-loaded.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>This method modifies the Labels object in place. The merge is designed to
handle common workflows like merging predictions back into a project.</p>
<p>Provenance tracking: Each merge operation appends a record to
<code>self.provenance["merge_history"]</code> containing:</p>
<ul>
<li><code>timestamp</code>: ISO format timestamp of the merge</li>
<li><code>source_filename</code>: Path from source's provenance (<code>None</code> if in-memory)</li>
<li><code>target_filename</code>: Path from target's provenance (<code>None</code> if in-memory)</li>
<li><code>source_labels</code>: Statistics about the source Labels</li>
<li><code>strategy</code>: The frame strategy used</li>
<li><code>sleap_io_version</code>: Version of sleap-io that performed the merge</li>
<li><code>result</code>: Merge statistics (frames_merged, instances_added, conflicts)</li>
</ul>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/labels.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-2163" name="__codelineno-0-2163"></a><a href="#__codelineno-0-2163"><span class="linenos" data-linenos="2163 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span>
<a id="__codelineno-0-2164" name="__codelineno-0-2164"></a><a href="#__codelineno-0-2164"><span class="linenos" data-linenos="2164 "></span></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2165" name="__codelineno-0-2165"></a><a href="#__codelineno-0-2165"><span class="linenos" data-linenos="2165 "></span></a>    <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Labels&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2166" name="__codelineno-0-2166"></a><a href="#__codelineno-0-2166"><span class="linenos" data-linenos="2166 "></span></a>    <span class="n">skeleton</span><span class="p">:</span> <span class="s2">&quot;str | SkeletonMatcher | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2167" name="__codelineno-0-2167"></a><a href="#__codelineno-0-2167"><span class="linenos" data-linenos="2167 "></span></a>    <span class="n">video</span><span class="p">:</span> <span class="s2">&quot;str | VideoMatcher | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2168" name="__codelineno-0-2168"></a><a href="#__codelineno-0-2168"><span class="linenos" data-linenos="2168 "></span></a>    <span class="n">track</span><span class="p">:</span> <span class="s2">&quot;str | TrackMatcher | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2169" name="__codelineno-0-2169"></a><a href="#__codelineno-0-2169"><span class="linenos" data-linenos="2169 "></span></a>    <span class="n">frame</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2170" name="__codelineno-0-2170"></a><a href="#__codelineno-0-2170"><span class="linenos" data-linenos="2170 "></span></a>    <span class="n">instance</span><span class="p">:</span> <span class="s2">&quot;str | InstanceMatcher | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2171" name="__codelineno-0-2171"></a><a href="#__codelineno-0-2171"><span class="linenos" data-linenos="2171 "></span></a>    <span class="n">validate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2172" name="__codelineno-0-2172"></a><a href="#__codelineno-0-2172"><span class="linenos" data-linenos="2172 "></span></a>    <span class="n">progress_callback</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2173" name="__codelineno-0-2173"></a><a href="#__codelineno-0-2173"><span class="linenos" data-linenos="2173 "></span></a>    <span class="n">error_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;continue&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2174" name="__codelineno-0-2174"></a><a href="#__codelineno-0-2174"><span class="linenos" data-linenos="2174 "></span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MergeResult&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2175" name="__codelineno-0-2175"></a><a href="#__codelineno-0-2175"><span class="linenos" data-linenos="2175 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge another Labels object into this one.</span>
<a id="__codelineno-0-2176" name="__codelineno-0-2176"></a><a href="#__codelineno-0-2176"><span class="linenos" data-linenos="2176 "></span></a>
<a id="__codelineno-0-2177" name="__codelineno-0-2177"></a><a href="#__codelineno-0-2177"><span class="linenos" data-linenos="2177 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-2178" name="__codelineno-0-2178"></a><a href="#__codelineno-0-2178"><span class="linenos" data-linenos="2178 "></span></a><span class="sd">        other: Another Labels object to merge into this one.</span>
<a id="__codelineno-0-2179" name="__codelineno-0-2179"></a><a href="#__codelineno-0-2179"><span class="linenos" data-linenos="2179 "></span></a><span class="sd">        skeleton: Skeleton matching method. Can be a string (&quot;structure&quot;,</span>
<a id="__codelineno-0-2180" name="__codelineno-0-2180"></a><a href="#__codelineno-0-2180"><span class="linenos" data-linenos="2180 "></span></a><span class="sd">            &quot;subset&quot;, &quot;overlap&quot;, &quot;exact&quot;) or a SkeletonMatcher object for</span>
<a id="__codelineno-0-2181" name="__codelineno-0-2181"></a><a href="#__codelineno-0-2181"><span class="linenos" data-linenos="2181 "></span></a><span class="sd">            advanced configuration. Default is &quot;structure&quot;.</span>
<a id="__codelineno-0-2182" name="__codelineno-0-2182"></a><a href="#__codelineno-0-2182"><span class="linenos" data-linenos="2182 "></span></a><span class="sd">        video: Video matching method. Can be a string (&quot;auto&quot;, &quot;path&quot;,</span>
<a id="__codelineno-0-2183" name="__codelineno-0-2183"></a><a href="#__codelineno-0-2183"><span class="linenos" data-linenos="2183 "></span></a><span class="sd">            &quot;basename&quot;, &quot;content&quot;, &quot;shape&quot;, &quot;image_dedup&quot;) or a VideoMatcher</span>
<a id="__codelineno-0-2184" name="__codelineno-0-2184"></a><a href="#__codelineno-0-2184"><span class="linenos" data-linenos="2184 "></span></a><span class="sd">            object for advanced configuration. Default is &quot;auto&quot;.</span>
<a id="__codelineno-0-2185" name="__codelineno-0-2185"></a><a href="#__codelineno-0-2185"><span class="linenos" data-linenos="2185 "></span></a><span class="sd">        track: Track matching method. Can be a string (&quot;name&quot;, &quot;identity&quot;) or</span>
<a id="__codelineno-0-2186" name="__codelineno-0-2186"></a><a href="#__codelineno-0-2186"><span class="linenos" data-linenos="2186 "></span></a><span class="sd">            a TrackMatcher object. Default is &quot;name&quot;.</span>
<a id="__codelineno-0-2187" name="__codelineno-0-2187"></a><a href="#__codelineno-0-2187"><span class="linenos" data-linenos="2187 "></span></a><span class="sd">        frame: Frame merge strategy. One of &quot;auto&quot;, &quot;keep_original&quot;,</span>
<a id="__codelineno-0-2188" name="__codelineno-0-2188"></a><a href="#__codelineno-0-2188"><span class="linenos" data-linenos="2188 "></span></a><span class="sd">            &quot;keep_new&quot;, &quot;keep_both&quot;, &quot;update_tracks&quot;, &quot;replace_predictions&quot;.</span>
<a id="__codelineno-0-2189" name="__codelineno-0-2189"></a><a href="#__codelineno-0-2189"><span class="linenos" data-linenos="2189 "></span></a><span class="sd">            Default is &quot;auto&quot;.</span>
<a id="__codelineno-0-2190" name="__codelineno-0-2190"></a><a href="#__codelineno-0-2190"><span class="linenos" data-linenos="2190 "></span></a><span class="sd">        instance: Instance matching method for spatial frame strategies. Can be</span>
<a id="__codelineno-0-2191" name="__codelineno-0-2191"></a><a href="#__codelineno-0-2191"><span class="linenos" data-linenos="2191 "></span></a><span class="sd">            a string (&quot;spatial&quot;, &quot;identity&quot;, &quot;iou&quot;) or an InstanceMatcher object.</span>
<a id="__codelineno-0-2192" name="__codelineno-0-2192"></a><a href="#__codelineno-0-2192"><span class="linenos" data-linenos="2192 "></span></a><span class="sd">            Default is &quot;spatial&quot; with 5px tolerance.</span>
<a id="__codelineno-0-2193" name="__codelineno-0-2193"></a><a href="#__codelineno-0-2193"><span class="linenos" data-linenos="2193 "></span></a><span class="sd">        validate: If True, validate for conflicts before merging.</span>
<a id="__codelineno-0-2194" name="__codelineno-0-2194"></a><a href="#__codelineno-0-2194"><span class="linenos" data-linenos="2194 "></span></a><span class="sd">        progress_callback: Optional callback for progress updates.</span>
<a id="__codelineno-0-2195" name="__codelineno-0-2195"></a><a href="#__codelineno-0-2195"><span class="linenos" data-linenos="2195 "></span></a><span class="sd">            Should accept (current, total, message) arguments.</span>
<a id="__codelineno-0-2196" name="__codelineno-0-2196"></a><a href="#__codelineno-0-2196"><span class="linenos" data-linenos="2196 "></span></a><span class="sd">        error_mode: How to handle errors:</span>
<a id="__codelineno-0-2197" name="__codelineno-0-2197"></a><a href="#__codelineno-0-2197"><span class="linenos" data-linenos="2197 "></span></a><span class="sd">            - &quot;continue&quot;: Log errors but continue</span>
<a id="__codelineno-0-2198" name="__codelineno-0-2198"></a><a href="#__codelineno-0-2198"><span class="linenos" data-linenos="2198 "></span></a><span class="sd">            - &quot;strict&quot;: Raise exception on first error</span>
<a id="__codelineno-0-2199" name="__codelineno-0-2199"></a><a href="#__codelineno-0-2199"><span class="linenos" data-linenos="2199 "></span></a><span class="sd">            - &quot;warn&quot;: Print warnings but continue</span>
<a id="__codelineno-0-2200" name="__codelineno-0-2200"></a><a href="#__codelineno-0-2200"><span class="linenos" data-linenos="2200 "></span></a>
<a id="__codelineno-0-2201" name="__codelineno-0-2201"></a><a href="#__codelineno-0-2201"><span class="linenos" data-linenos="2201 "></span></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-2202" name="__codelineno-0-2202"></a><a href="#__codelineno-0-2202"><span class="linenos" data-linenos="2202 "></span></a><span class="sd">        MergeResult object with statistics and any errors/conflicts.</span>
<a id="__codelineno-0-2203" name="__codelineno-0-2203"></a><a href="#__codelineno-0-2203"><span class="linenos" data-linenos="2203 "></span></a>
<a id="__codelineno-0-2204" name="__codelineno-0-2204"></a><a href="#__codelineno-0-2204"><span class="linenos" data-linenos="2204 "></span></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-2205" name="__codelineno-0-2205"></a><a href="#__codelineno-0-2205"><span class="linenos" data-linenos="2205 "></span></a><span class="sd">        RuntimeError: If Labels is lazy-loaded.</span>
<a id="__codelineno-0-2206" name="__codelineno-0-2206"></a><a href="#__codelineno-0-2206"><span class="linenos" data-linenos="2206 "></span></a>
<a id="__codelineno-0-2207" name="__codelineno-0-2207"></a><a href="#__codelineno-0-2207"><span class="linenos" data-linenos="2207 "></span></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-2208" name="__codelineno-0-2208"></a><a href="#__codelineno-0-2208"><span class="linenos" data-linenos="2208 "></span></a><span class="sd">        This method modifies the Labels object in place. The merge is designed to</span>
<a id="__codelineno-0-2209" name="__codelineno-0-2209"></a><a href="#__codelineno-0-2209"><span class="linenos" data-linenos="2209 "></span></a><span class="sd">        handle common workflows like merging predictions back into a project.</span>
<a id="__codelineno-0-2210" name="__codelineno-0-2210"></a><a href="#__codelineno-0-2210"><span class="linenos" data-linenos="2210 "></span></a>
<a id="__codelineno-0-2211" name="__codelineno-0-2211"></a><a href="#__codelineno-0-2211"><span class="linenos" data-linenos="2211 "></span></a><span class="sd">        Provenance tracking: Each merge operation appends a record to</span>
<a id="__codelineno-0-2212" name="__codelineno-0-2212"></a><a href="#__codelineno-0-2212"><span class="linenos" data-linenos="2212 "></span></a><span class="sd">        ``self.provenance[&quot;merge_history&quot;]`` containing:</span>
<a id="__codelineno-0-2213" name="__codelineno-0-2213"></a><a href="#__codelineno-0-2213"><span class="linenos" data-linenos="2213 "></span></a>
<a id="__codelineno-0-2214" name="__codelineno-0-2214"></a><a href="#__codelineno-0-2214"><span class="linenos" data-linenos="2214 "></span></a><span class="sd">        - ``timestamp``: ISO format timestamp of the merge</span>
<a id="__codelineno-0-2215" name="__codelineno-0-2215"></a><a href="#__codelineno-0-2215"><span class="linenos" data-linenos="2215 "></span></a><span class="sd">        - ``source_filename``: Path from source&#39;s provenance (``None`` if in-memory)</span>
<a id="__codelineno-0-2216" name="__codelineno-0-2216"></a><a href="#__codelineno-0-2216"><span class="linenos" data-linenos="2216 "></span></a><span class="sd">        - ``target_filename``: Path from target&#39;s provenance (``None`` if in-memory)</span>
<a id="__codelineno-0-2217" name="__codelineno-0-2217"></a><a href="#__codelineno-0-2217"><span class="linenos" data-linenos="2217 "></span></a><span class="sd">        - ``source_labels``: Statistics about the source Labels</span>
<a id="__codelineno-0-2218" name="__codelineno-0-2218"></a><a href="#__codelineno-0-2218"><span class="linenos" data-linenos="2218 "></span></a><span class="sd">        - ``strategy``: The frame strategy used</span>
<a id="__codelineno-0-2219" name="__codelineno-0-2219"></a><a href="#__codelineno-0-2219"><span class="linenos" data-linenos="2219 "></span></a><span class="sd">        - ``sleap_io_version``: Version of sleap-io that performed the merge</span>
<a id="__codelineno-0-2220" name="__codelineno-0-2220"></a><a href="#__codelineno-0-2220"><span class="linenos" data-linenos="2220 "></span></a><span class="sd">        - ``result``: Merge statistics (frames_merged, instances_added, conflicts)</span>
<a id="__codelineno-0-2221" name="__codelineno-0-2221"></a><a href="#__codelineno-0-2221"><span class="linenos" data-linenos="2221 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2222" name="__codelineno-0-2222"></a><a href="#__codelineno-0-2222"><span class="linenos" data-linenos="2222 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_check_not_lazy</span><span class="p">(</span><span class="s2">&quot;merge&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2223" name="__codelineno-0-2223"></a><a href="#__codelineno-0-2223"><span class="linenos" data-linenos="2223 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<a id="__codelineno-0-2224" name="__codelineno-0-2224"></a><a href="#__codelineno-0-2224"><span class="linenos" data-linenos="2224 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-2225" name="__codelineno-0-2225"></a><a href="#__codelineno-0-2225"><span class="linenos" data-linenos="2225 "></span></a>
<a id="__codelineno-0-2226" name="__codelineno-0-2226"></a><a href="#__codelineno-0-2226"><span class="linenos" data-linenos="2226 "></span></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">sleap_io</span>
<a id="__codelineno-0-2227" name="__codelineno-0-2227"></a><a href="#__codelineno-0-2227"><span class="linenos" data-linenos="2227 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-0-2228" name="__codelineno-0-2228"></a><a href="#__codelineno-0-2228"><span class="linenos" data-linenos="2228 "></span></a>        <span class="n">ConflictResolution</span><span class="p">,</span>
<a id="__codelineno-0-2229" name="__codelineno-0-2229"></a><a href="#__codelineno-0-2229"><span class="linenos" data-linenos="2229 "></span></a>        <span class="n">ErrorMode</span><span class="p">,</span>
<a id="__codelineno-0-2230" name="__codelineno-0-2230"></a><a href="#__codelineno-0-2230"><span class="linenos" data-linenos="2230 "></span></a>        <span class="n">InstanceMatcher</span><span class="p">,</span>
<a id="__codelineno-0-2231" name="__codelineno-0-2231"></a><a href="#__codelineno-0-2231"><span class="linenos" data-linenos="2231 "></span></a>        <span class="n">InstanceMatchMethod</span><span class="p">,</span>
<a id="__codelineno-0-2232" name="__codelineno-0-2232"></a><a href="#__codelineno-0-2232"><span class="linenos" data-linenos="2232 "></span></a>        <span class="n">MergeError</span><span class="p">,</span>
<a id="__codelineno-0-2233" name="__codelineno-0-2233"></a><a href="#__codelineno-0-2233"><span class="linenos" data-linenos="2233 "></span></a>        <span class="n">MergeResult</span><span class="p">,</span>
<a id="__codelineno-0-2234" name="__codelineno-0-2234"></a><a href="#__codelineno-0-2234"><span class="linenos" data-linenos="2234 "></span></a>        <span class="n">SkeletonMatcher</span><span class="p">,</span>
<a id="__codelineno-0-2235" name="__codelineno-0-2235"></a><a href="#__codelineno-0-2235"><span class="linenos" data-linenos="2235 "></span></a>        <span class="n">SkeletonMatchMethod</span><span class="p">,</span>
<a id="__codelineno-0-2236" name="__codelineno-0-2236"></a><a href="#__codelineno-0-2236"><span class="linenos" data-linenos="2236 "></span></a>        <span class="n">SkeletonMismatchError</span><span class="p">,</span>
<a id="__codelineno-0-2237" name="__codelineno-0-2237"></a><a href="#__codelineno-0-2237"><span class="linenos" data-linenos="2237 "></span></a>        <span class="n">TrackMatcher</span><span class="p">,</span>
<a id="__codelineno-0-2238" name="__codelineno-0-2238"></a><a href="#__codelineno-0-2238"><span class="linenos" data-linenos="2238 "></span></a>        <span class="n">TrackMatchMethod</span><span class="p">,</span>
<a id="__codelineno-0-2239" name="__codelineno-0-2239"></a><a href="#__codelineno-0-2239"><span class="linenos" data-linenos="2239 "></span></a>        <span class="n">VideoMatcher</span><span class="p">,</span>
<a id="__codelineno-0-2240" name="__codelineno-0-2240"></a><a href="#__codelineno-0-2240"><span class="linenos" data-linenos="2240 "></span></a>        <span class="n">VideoMatchMethod</span><span class="p">,</span>
<a id="__codelineno-0-2241" name="__codelineno-0-2241"></a><a href="#__codelineno-0-2241"><span class="linenos" data-linenos="2241 "></span></a>    <span class="p">)</span>
<a id="__codelineno-0-2242" name="__codelineno-0-2242"></a><a href="#__codelineno-0-2242"><span class="linenos" data-linenos="2242 "></span></a>
<a id="__codelineno-0-2243" name="__codelineno-0-2243"></a><a href="#__codelineno-0-2243"><span class="linenos" data-linenos="2243 "></span></a>    <span class="c1"># Coerce string arguments to Matcher objects</span>
<a id="__codelineno-0-2244" name="__codelineno-0-2244"></a><a href="#__codelineno-0-2244"><span class="linenos" data-linenos="2244 "></span></a>    <span class="k">if</span> <span class="n">skeleton</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2245" name="__codelineno-0-2245"></a><a href="#__codelineno-0-2245"><span class="linenos" data-linenos="2245 "></span></a>        <span class="n">skeleton_matcher</span> <span class="o">=</span> <span class="n">SkeletonMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">STRUCTURE</span><span class="p">)</span>
<a id="__codelineno-0-2246" name="__codelineno-0-2246"></a><a href="#__codelineno-0-2246"><span class="linenos" data-linenos="2246 "></span></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">skeleton</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-2247" name="__codelineno-0-2247"></a><a href="#__codelineno-0-2247"><span class="linenos" data-linenos="2247 "></span></a>        <span class="n">skeleton_matcher</span> <span class="o">=</span> <span class="n">SkeletonMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">SkeletonMatchMethod</span><span class="p">(</span><span class="n">skeleton</span><span class="p">))</span>
<a id="__codelineno-0-2248" name="__codelineno-0-2248"></a><a href="#__codelineno-0-2248"><span class="linenos" data-linenos="2248 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2249" name="__codelineno-0-2249"></a><a href="#__codelineno-0-2249"><span class="linenos" data-linenos="2249 "></span></a>        <span class="n">skeleton_matcher</span> <span class="o">=</span> <span class="n">skeleton</span>
<a id="__codelineno-0-2250" name="__codelineno-0-2250"></a><a href="#__codelineno-0-2250"><span class="linenos" data-linenos="2250 "></span></a>
<a id="__codelineno-0-2251" name="__codelineno-0-2251"></a><a href="#__codelineno-0-2251"><span class="linenos" data-linenos="2251 "></span></a>    <span class="k">if</span> <span class="n">video</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2252" name="__codelineno-0-2252"></a><a href="#__codelineno-0-2252"><span class="linenos" data-linenos="2252 "></span></a>        <span class="n">video_matcher</span> <span class="o">=</span> <span class="n">VideoMatcher</span><span class="p">()</span>
<a id="__codelineno-0-2253" name="__codelineno-0-2253"></a><a href="#__codelineno-0-2253"><span class="linenos" data-linenos="2253 "></span></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">video</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-2254" name="__codelineno-0-2254"></a><a href="#__codelineno-0-2254"><span class="linenos" data-linenos="2254 "></span></a>        <span class="n">video_matcher</span> <span class="o">=</span> <span class="n">VideoMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">VideoMatchMethod</span><span class="p">(</span><span class="n">video</span><span class="p">))</span>
<a id="__codelineno-0-2255" name="__codelineno-0-2255"></a><a href="#__codelineno-0-2255"><span class="linenos" data-linenos="2255 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2256" name="__codelineno-0-2256"></a><a href="#__codelineno-0-2256"><span class="linenos" data-linenos="2256 "></span></a>        <span class="n">video_matcher</span> <span class="o">=</span> <span class="n">video</span>
<a id="__codelineno-0-2257" name="__codelineno-0-2257"></a><a href="#__codelineno-0-2257"><span class="linenos" data-linenos="2257 "></span></a>
<a id="__codelineno-0-2258" name="__codelineno-0-2258"></a><a href="#__codelineno-0-2258"><span class="linenos" data-linenos="2258 "></span></a>    <span class="k">if</span> <span class="n">track</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2259" name="__codelineno-0-2259"></a><a href="#__codelineno-0-2259"><span class="linenos" data-linenos="2259 "></span></a>        <span class="n">track_matcher</span> <span class="o">=</span> <span class="n">TrackMatcher</span><span class="p">()</span>
<a id="__codelineno-0-2260" name="__codelineno-0-2260"></a><a href="#__codelineno-0-2260"><span class="linenos" data-linenos="2260 "></span></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">track</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-2261" name="__codelineno-0-2261"></a><a href="#__codelineno-0-2261"><span class="linenos" data-linenos="2261 "></span></a>        <span class="n">track_matcher</span> <span class="o">=</span> <span class="n">TrackMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">TrackMatchMethod</span><span class="p">(</span><span class="n">track</span><span class="p">))</span>
<a id="__codelineno-0-2262" name="__codelineno-0-2262"></a><a href="#__codelineno-0-2262"><span class="linenos" data-linenos="2262 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2263" name="__codelineno-0-2263"></a><a href="#__codelineno-0-2263"><span class="linenos" data-linenos="2263 "></span></a>        <span class="n">track_matcher</span> <span class="o">=</span> <span class="n">track</span>
<a id="__codelineno-0-2264" name="__codelineno-0-2264"></a><a href="#__codelineno-0-2264"><span class="linenos" data-linenos="2264 "></span></a>
<a id="__codelineno-0-2265" name="__codelineno-0-2265"></a><a href="#__codelineno-0-2265"><span class="linenos" data-linenos="2265 "></span></a>    <span class="k">if</span> <span class="n">instance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2266" name="__codelineno-0-2266"></a><a href="#__codelineno-0-2266"><span class="linenos" data-linenos="2266 "></span></a>        <span class="n">instance_matcher</span> <span class="o">=</span> <span class="n">InstanceMatcher</span><span class="p">()</span>
<a id="__codelineno-0-2267" name="__codelineno-0-2267"></a><a href="#__codelineno-0-2267"><span class="linenos" data-linenos="2267 "></span></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-2268" name="__codelineno-0-2268"></a><a href="#__codelineno-0-2268"><span class="linenos" data-linenos="2268 "></span></a>        <span class="n">instance_matcher</span> <span class="o">=</span> <span class="n">InstanceMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">InstanceMatchMethod</span><span class="p">(</span><span class="n">instance</span><span class="p">))</span>
<a id="__codelineno-0-2269" name="__codelineno-0-2269"></a><a href="#__codelineno-0-2269"><span class="linenos" data-linenos="2269 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2270" name="__codelineno-0-2270"></a><a href="#__codelineno-0-2270"><span class="linenos" data-linenos="2270 "></span></a>        <span class="n">instance_matcher</span> <span class="o">=</span> <span class="n">instance</span>
<a id="__codelineno-0-2271" name="__codelineno-0-2271"></a><a href="#__codelineno-0-2271"><span class="linenos" data-linenos="2271 "></span></a>
<a id="__codelineno-0-2272" name="__codelineno-0-2272"></a><a href="#__codelineno-0-2272"><span class="linenos" data-linenos="2272 "></span></a>    <span class="c1"># Parse error mode</span>
<a id="__codelineno-0-2273" name="__codelineno-0-2273"></a><a href="#__codelineno-0-2273"><span class="linenos" data-linenos="2273 "></span></a>    <span class="n">error_mode_enum</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="p">(</span><span class="n">error_mode</span><span class="p">)</span>
<a id="__codelineno-0-2274" name="__codelineno-0-2274"></a><a href="#__codelineno-0-2274"><span class="linenos" data-linenos="2274 "></span></a>
<a id="__codelineno-0-2275" name="__codelineno-0-2275"></a><a href="#__codelineno-0-2275"><span class="linenos" data-linenos="2275 "></span></a>    <span class="c1"># Initialize result</span>
<a id="__codelineno-0-2276" name="__codelineno-0-2276"></a><a href="#__codelineno-0-2276"><span class="linenos" data-linenos="2276 "></span></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">MergeResult</span><span class="p">(</span><span class="n">successful</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-2277" name="__codelineno-0-2277"></a><a href="#__codelineno-0-2277"><span class="linenos" data-linenos="2277 "></span></a>
<a id="__codelineno-0-2278" name="__codelineno-0-2278"></a><a href="#__codelineno-0-2278"><span class="linenos" data-linenos="2278 "></span></a>    <span class="c1"># Track merge history in provenance</span>
<a id="__codelineno-0-2279" name="__codelineno-0-2279"></a><a href="#__codelineno-0-2279"><span class="linenos" data-linenos="2279 "></span></a>    <span class="k">if</span> <span class="s2">&quot;merge_history&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">provenance</span><span class="p">:</span>
<a id="__codelineno-0-2280" name="__codelineno-0-2280"></a><a href="#__codelineno-0-2280"><span class="linenos" data-linenos="2280 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">provenance</span><span class="p">[</span><span class="s2">&quot;merge_history&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2281" name="__codelineno-0-2281"></a><a href="#__codelineno-0-2281"><span class="linenos" data-linenos="2281 "></span></a>
<a id="__codelineno-0-2282" name="__codelineno-0-2282"></a><a href="#__codelineno-0-2282"><span class="linenos" data-linenos="2282 "></span></a>    <span class="n">merge_record</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-2283" name="__codelineno-0-2283"></a><a href="#__codelineno-0-2283"><span class="linenos" data-linenos="2283 "></span></a>        <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
<a id="__codelineno-0-2284" name="__codelineno-0-2284"></a><a href="#__codelineno-0-2284"><span class="linenos" data-linenos="2284 "></span></a>        <span class="s2">&quot;source_filename&quot;</span><span class="p">:</span> <span class="n">other</span><span class="o">.</span><span class="n">provenance</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;filename&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2285" name="__codelineno-0-2285"></a><a href="#__codelineno-0-2285"><span class="linenos" data-linenos="2285 "></span></a>        <span class="s2">&quot;target_filename&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">provenance</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;filename&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2286" name="__codelineno-0-2286"></a><a href="#__codelineno-0-2286"><span class="linenos" data-linenos="2286 "></span></a>        <span class="s2">&quot;source_labels&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-2287" name="__codelineno-0-2287"></a><a href="#__codelineno-0-2287"><span class="linenos" data-linenos="2287 "></span></a>            <span class="s2">&quot;n_frames&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">labeled_frames</span><span class="p">),</span>
<a id="__codelineno-0-2288" name="__codelineno-0-2288"></a><a href="#__codelineno-0-2288"><span class="linenos" data-linenos="2288 "></span></a>            <span class="s2">&quot;n_videos&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">videos</span><span class="p">),</span>
<a id="__codelineno-0-2289" name="__codelineno-0-2289"></a><a href="#__codelineno-0-2289"><span class="linenos" data-linenos="2289 "></span></a>            <span class="s2">&quot;n_skeletons&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">skeletons</span><span class="p">),</span>
<a id="__codelineno-0-2290" name="__codelineno-0-2290"></a><a href="#__codelineno-0-2290"><span class="linenos" data-linenos="2290 "></span></a>            <span class="s2">&quot;n_tracks&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">tracks</span><span class="p">),</span>
<a id="__codelineno-0-2291" name="__codelineno-0-2291"></a><a href="#__codelineno-0-2291"><span class="linenos" data-linenos="2291 "></span></a>        <span class="p">},</span>
<a id="__codelineno-0-2292" name="__codelineno-0-2292"></a><a href="#__codelineno-0-2292"><span class="linenos" data-linenos="2292 "></span></a>        <span class="s2">&quot;strategy&quot;</span><span class="p">:</span> <span class="n">frame</span><span class="p">,</span>
<a id="__codelineno-0-2293" name="__codelineno-0-2293"></a><a href="#__codelineno-0-2293"><span class="linenos" data-linenos="2293 "></span></a>        <span class="s2">&quot;sleap_io_version&quot;</span><span class="p">:</span> <span class="n">sleap_io</span><span class="o">.</span><span class="n">__version__</span><span class="p">,</span>
<a id="__codelineno-0-2294" name="__codelineno-0-2294"></a><a href="#__codelineno-0-2294"><span class="linenos" data-linenos="2294 "></span></a>    <span class="p">}</span>
<a id="__codelineno-0-2295" name="__codelineno-0-2295"></a><a href="#__codelineno-0-2295"><span class="linenos" data-linenos="2295 "></span></a>
<a id="__codelineno-0-2296" name="__codelineno-0-2296"></a><a href="#__codelineno-0-2296"><span class="linenos" data-linenos="2296 "></span></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2297" name="__codelineno-0-2297"></a><a href="#__codelineno-0-2297"><span class="linenos" data-linenos="2297 "></span></a>        <span class="c1"># Step 1: Match and merge skeletons</span>
<a id="__codelineno-0-2298" name="__codelineno-0-2298"></a><a href="#__codelineno-0-2298"><span class="linenos" data-linenos="2298 "></span></a>        <span class="n">skeleton_map</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-2299" name="__codelineno-0-2299"></a><a href="#__codelineno-0-2299"><span class="linenos" data-linenos="2299 "></span></a>        <span class="k">for</span> <span class="n">other_skel</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">skeletons</span><span class="p">:</span>
<a id="__codelineno-0-2300" name="__codelineno-0-2300"></a><a href="#__codelineno-0-2300"><span class="linenos" data-linenos="2300 "></span></a>            <span class="n">matched</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-2301" name="__codelineno-0-2301"></a><a href="#__codelineno-0-2301"><span class="linenos" data-linenos="2301 "></span></a>            <span class="k">for</span> <span class="n">self_skel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeletons</span><span class="p">:</span>
<a id="__codelineno-0-2302" name="__codelineno-0-2302"></a><a href="#__codelineno-0-2302"><span class="linenos" data-linenos="2302 "></span></a>                <span class="k">if</span> <span class="n">skeleton_matcher</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">self_skel</span><span class="p">,</span> <span class="n">other_skel</span><span class="p">):</span>
<a id="__codelineno-0-2303" name="__codelineno-0-2303"></a><a href="#__codelineno-0-2303"><span class="linenos" data-linenos="2303 "></span></a>                    <span class="n">skeleton_map</span><span class="p">[</span><span class="n">other_skel</span><span class="p">]</span> <span class="o">=</span> <span class="n">self_skel</span>
<a id="__codelineno-0-2304" name="__codelineno-0-2304"></a><a href="#__codelineno-0-2304"><span class="linenos" data-linenos="2304 "></span></a>                    <span class="n">matched</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-2305" name="__codelineno-0-2305"></a><a href="#__codelineno-0-2305"><span class="linenos" data-linenos="2305 "></span></a>                    <span class="k">break</span>
<a id="__codelineno-0-2306" name="__codelineno-0-2306"></a><a href="#__codelineno-0-2306"><span class="linenos" data-linenos="2306 "></span></a>
<a id="__codelineno-0-2307" name="__codelineno-0-2307"></a><a href="#__codelineno-0-2307"><span class="linenos" data-linenos="2307 "></span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">matched</span><span class="p">:</span>
<a id="__codelineno-0-2308" name="__codelineno-0-2308"></a><a href="#__codelineno-0-2308"><span class="linenos" data-linenos="2308 "></span></a>                <span class="k">if</span> <span class="n">validate</span> <span class="ow">and</span> <span class="n">error_mode_enum</span> <span class="o">==</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">STRICT</span><span class="p">:</span>
<a id="__codelineno-0-2309" name="__codelineno-0-2309"></a><a href="#__codelineno-0-2309"><span class="linenos" data-linenos="2309 "></span></a>                    <span class="k">raise</span> <span class="n">SkeletonMismatchError</span><span class="p">(</span>
<a id="__codelineno-0-2310" name="__codelineno-0-2310"></a><a href="#__codelineno-0-2310"><span class="linenos" data-linenos="2310 "></span></a>                        <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;No matching skeleton found for </span><span class="si">{</span><span class="n">other_skel</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2311" name="__codelineno-0-2311"></a><a href="#__codelineno-0-2311"><span class="linenos" data-linenos="2311 "></span></a>                        <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;skeleton&quot;</span><span class="p">:</span> <span class="n">other_skel</span><span class="p">},</span>
<a id="__codelineno-0-2312" name="__codelineno-0-2312"></a><a href="#__codelineno-0-2312"><span class="linenos" data-linenos="2312 "></span></a>                    <span class="p">)</span>
<a id="__codelineno-0-2313" name="__codelineno-0-2313"></a><a href="#__codelineno-0-2313"><span class="linenos" data-linenos="2313 "></span></a>                <span class="k">elif</span> <span class="n">error_mode_enum</span> <span class="o">==</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">WARN</span><span class="p">:</span>
<a id="__codelineno-0-2314" name="__codelineno-0-2314"></a><a href="#__codelineno-0-2314"><span class="linenos" data-linenos="2314 "></span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: No matching skeleton for </span><span class="si">{</span><span class="n">other_skel</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2315" name="__codelineno-0-2315"></a><a href="#__codelineno-0-2315"><span class="linenos" data-linenos="2315 "></span></a>
<a id="__codelineno-0-2316" name="__codelineno-0-2316"></a><a href="#__codelineno-0-2316"><span class="linenos" data-linenos="2316 "></span></a>                <span class="c1"># Add new skeleton if no match</span>
<a id="__codelineno-0-2317" name="__codelineno-0-2317"></a><a href="#__codelineno-0-2317"><span class="linenos" data-linenos="2317 "></span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">skeletons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">other_skel</span><span class="p">)</span>
<a id="__codelineno-0-2318" name="__codelineno-0-2318"></a><a href="#__codelineno-0-2318"><span class="linenos" data-linenos="2318 "></span></a>                <span class="n">skeleton_map</span><span class="p">[</span><span class="n">other_skel</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_skel</span>
<a id="__codelineno-0-2319" name="__codelineno-0-2319"></a><a href="#__codelineno-0-2319"><span class="linenos" data-linenos="2319 "></span></a>
<a id="__codelineno-0-2320" name="__codelineno-0-2320"></a><a href="#__codelineno-0-2320"><span class="linenos" data-linenos="2320 "></span></a>        <span class="c1"># Step 2: Match and merge videos</span>
<a id="__codelineno-0-2321" name="__codelineno-0-2321"></a><a href="#__codelineno-0-2321"><span class="linenos" data-linenos="2321 "></span></a>        <span class="n">video_map</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-2322" name="__codelineno-0-2322"></a><a href="#__codelineno-0-2322"><span class="linenos" data-linenos="2322 "></span></a>        <span class="n">frame_idx_map</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Maps (old_video, old_idx) -&gt; (new_video, new_idx)</span>
<a id="__codelineno-0-2323" name="__codelineno-0-2323"></a><a href="#__codelineno-0-2323"><span class="linenos" data-linenos="2323 "></span></a>
<a id="__codelineno-0-2324" name="__codelineno-0-2324"></a><a href="#__codelineno-0-2324"><span class="linenos" data-linenos="2324 "></span></a>        <span class="k">for</span> <span class="n">other_video</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">videos</span><span class="p">:</span>
<a id="__codelineno-0-2325" name="__codelineno-0-2325"></a><a href="#__codelineno-0-2325"><span class="linenos" data-linenos="2325 "></span></a>            <span class="n">matched</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-2326" name="__codelineno-0-2326"></a><a href="#__codelineno-0-2326"><span class="linenos" data-linenos="2326 "></span></a>            <span class="n">matched_video</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2327" name="__codelineno-0-2327"></a><a href="#__codelineno-0-2327"><span class="linenos" data-linenos="2327 "></span></a>
<a id="__codelineno-0-2328" name="__codelineno-0-2328"></a><a href="#__codelineno-0-2328"><span class="linenos" data-linenos="2328 "></span></a>            <span class="c1"># IMAGE_DEDUP and SHAPE need special post-match processing</span>
<a id="__codelineno-0-2329" name="__codelineno-0-2329"></a><a href="#__codelineno-0-2329"><span class="linenos" data-linenos="2329 "></span></a>            <span class="k">if</span> <span class="n">video_matcher</span><span class="o">.</span><span class="n">method</span> <span class="ow">in</span> <span class="p">(</span>
<a id="__codelineno-0-2330" name="__codelineno-0-2330"></a><a href="#__codelineno-0-2330"><span class="linenos" data-linenos="2330 "></span></a>                <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">IMAGE_DEDUP</span><span class="p">,</span>
<a id="__codelineno-0-2331" name="__codelineno-0-2331"></a><a href="#__codelineno-0-2331"><span class="linenos" data-linenos="2331 "></span></a>                <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">SHAPE</span><span class="p">,</span>
<a id="__codelineno-0-2332" name="__codelineno-0-2332"></a><a href="#__codelineno-0-2332"><span class="linenos" data-linenos="2332 "></span></a>            <span class="p">):</span>
<a id="__codelineno-0-2333" name="__codelineno-0-2333"></a><a href="#__codelineno-0-2333"><span class="linenos" data-linenos="2333 "></span></a>                <span class="k">for</span> <span class="n">self_video</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="p">:</span>
<a id="__codelineno-0-2334" name="__codelineno-0-2334"></a><a href="#__codelineno-0-2334"><span class="linenos" data-linenos="2334 "></span></a>                    <span class="k">if</span> <span class="n">video_matcher</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">self_video</span><span class="p">,</span> <span class="n">other_video</span><span class="p">):</span>
<a id="__codelineno-0-2335" name="__codelineno-0-2335"></a><a href="#__codelineno-0-2335"><span class="linenos" data-linenos="2335 "></span></a>                        <span class="n">matched_video</span> <span class="o">=</span> <span class="n">self_video</span>
<a id="__codelineno-0-2336" name="__codelineno-0-2336"></a><a href="#__codelineno-0-2336"><span class="linenos" data-linenos="2336 "></span></a>                        <span class="k">if</span> <span class="n">video_matcher</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">IMAGE_DEDUP</span><span class="p">:</span>
<a id="__codelineno-0-2337" name="__codelineno-0-2337"></a><a href="#__codelineno-0-2337"><span class="linenos" data-linenos="2337 "></span></a>                            <span class="c1"># Deduplicate images from other_video</span>
<a id="__codelineno-0-2338" name="__codelineno-0-2338"></a><a href="#__codelineno-0-2338"><span class="linenos" data-linenos="2338 "></span></a>                            <span class="n">deduped_video</span> <span class="o">=</span> <span class="n">other_video</span><span class="o">.</span><span class="n">deduplicate_with</span><span class="p">(</span><span class="n">self_video</span><span class="p">)</span>
<a id="__codelineno-0-2339" name="__codelineno-0-2339"></a><a href="#__codelineno-0-2339"><span class="linenos" data-linenos="2339 "></span></a>                            <span class="k">if</span> <span class="n">deduped_video</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2340" name="__codelineno-0-2340"></a><a href="#__codelineno-0-2340"><span class="linenos" data-linenos="2340 "></span></a>                                <span class="c1"># All images were duplicates, map to existing video</span>
<a id="__codelineno-0-2341" name="__codelineno-0-2341"></a><a href="#__codelineno-0-2341"><span class="linenos" data-linenos="2341 "></span></a>                                <span class="n">video_map</span><span class="p">[</span><span class="n">other_video</span><span class="p">]</span> <span class="o">=</span> <span class="n">self_video</span>
<a id="__codelineno-0-2342" name="__codelineno-0-2342"></a><a href="#__codelineno-0-2342"><span class="linenos" data-linenos="2342 "></span></a>                                <span class="c1"># Build frame index mapping for deduplicated frames</span>
<a id="__codelineno-0-2343" name="__codelineno-0-2343"></a><a href="#__codelineno-0-2343"><span class="linenos" data-linenos="2343 "></span></a>                                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-2344" name="__codelineno-0-2344"></a><a href="#__codelineno-0-2344"><span class="linenos" data-linenos="2344 "></span></a>                                    <span class="n">other_video</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="nb">list</span>
<a id="__codelineno-0-2345" name="__codelineno-0-2345"></a><a href="#__codelineno-0-2345"><span class="linenos" data-linenos="2345 "></span></a>                                <span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">self_video</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-2346" name="__codelineno-0-2346"></a><a href="#__codelineno-0-2346"><span class="linenos" data-linenos="2346 "></span></a>                                    <span class="n">other_basenames</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-2347" name="__codelineno-0-2347"></a><a href="#__codelineno-0-2347"><span class="linenos" data-linenos="2347 "></span></a>                                        <span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">other_video</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-2348" name="__codelineno-0-2348"></a><a href="#__codelineno-0-2348"><span class="linenos" data-linenos="2348 "></span></a>                                    <span class="p">]</span>
<a id="__codelineno-0-2349" name="__codelineno-0-2349"></a><a href="#__codelineno-0-2349"><span class="linenos" data-linenos="2349 "></span></a>                                    <span class="n">self_basenames</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-2350" name="__codelineno-0-2350"></a><a href="#__codelineno-0-2350"><span class="linenos" data-linenos="2350 "></span></a>                                        <span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">self_video</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-2351" name="__codelineno-0-2351"></a><a href="#__codelineno-0-2351"><span class="linenos" data-linenos="2351 "></span></a>                                    <span class="p">]</span>
<a id="__codelineno-0-2352" name="__codelineno-0-2352"></a><a href="#__codelineno-0-2352"><span class="linenos" data-linenos="2352 "></span></a>                                    <span class="k">for</span> <span class="n">old_idx</span><span class="p">,</span> <span class="n">basename</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
<a id="__codelineno-0-2353" name="__codelineno-0-2353"></a><a href="#__codelineno-0-2353"><span class="linenos" data-linenos="2353 "></span></a>                                        <span class="n">other_basenames</span>
<a id="__codelineno-0-2354" name="__codelineno-0-2354"></a><a href="#__codelineno-0-2354"><span class="linenos" data-linenos="2354 "></span></a>                                    <span class="p">):</span>
<a id="__codelineno-0-2355" name="__codelineno-0-2355"></a><a href="#__codelineno-0-2355"><span class="linenos" data-linenos="2355 "></span></a>                                        <span class="k">if</span> <span class="n">basename</span> <span class="ow">in</span> <span class="n">self_basenames</span><span class="p">:</span>
<a id="__codelineno-0-2356" name="__codelineno-0-2356"></a><a href="#__codelineno-0-2356"><span class="linenos" data-linenos="2356 "></span></a>                                            <span class="n">new_idx</span> <span class="o">=</span> <span class="n">self_basenames</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">basename</span><span class="p">)</span>
<a id="__codelineno-0-2357" name="__codelineno-0-2357"></a><a href="#__codelineno-0-2357"><span class="linenos" data-linenos="2357 "></span></a>                                            <span class="n">frame_idx_map</span><span class="p">[</span>
<a id="__codelineno-0-2358" name="__codelineno-0-2358"></a><a href="#__codelineno-0-2358"><span class="linenos" data-linenos="2358 "></span></a>                                                <span class="p">(</span><span class="n">other_video</span><span class="p">,</span> <span class="n">old_idx</span><span class="p">)</span>
<a id="__codelineno-0-2359" name="__codelineno-0-2359"></a><a href="#__codelineno-0-2359"><span class="linenos" data-linenos="2359 "></span></a>                                            <span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2360" name="__codelineno-0-2360"></a><a href="#__codelineno-0-2360"><span class="linenos" data-linenos="2360 "></span></a>                                                <span class="n">self_video</span><span class="p">,</span>
<a id="__codelineno-0-2361" name="__codelineno-0-2361"></a><a href="#__codelineno-0-2361"><span class="linenos" data-linenos="2361 "></span></a>                                                <span class="n">new_idx</span><span class="p">,</span>
<a id="__codelineno-0-2362" name="__codelineno-0-2362"></a><a href="#__codelineno-0-2362"><span class="linenos" data-linenos="2362 "></span></a>                                            <span class="p">)</span>
<a id="__codelineno-0-2363" name="__codelineno-0-2363"></a><a href="#__codelineno-0-2363"><span class="linenos" data-linenos="2363 "></span></a>                            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2364" name="__codelineno-0-2364"></a><a href="#__codelineno-0-2364"><span class="linenos" data-linenos="2364 "></span></a>                                <span class="c1"># Add deduplicated video as new</span>
<a id="__codelineno-0-2365" name="__codelineno-0-2365"></a><a href="#__codelineno-0-2365"><span class="linenos" data-linenos="2365 "></span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deduped_video</span><span class="p">)</span>
<a id="__codelineno-0-2366" name="__codelineno-0-2366"></a><a href="#__codelineno-0-2366"><span class="linenos" data-linenos="2366 "></span></a>                                <span class="n">video_map</span><span class="p">[</span><span class="n">other_video</span><span class="p">]</span> <span class="o">=</span> <span class="n">deduped_video</span>
<a id="__codelineno-0-2367" name="__codelineno-0-2367"></a><a href="#__codelineno-0-2367"><span class="linenos" data-linenos="2367 "></span></a>                                <span class="c1"># Build frame index mapping for remaining frames</span>
<a id="__codelineno-0-2368" name="__codelineno-0-2368"></a><a href="#__codelineno-0-2368"><span class="linenos" data-linenos="2368 "></span></a>                                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-2369" name="__codelineno-0-2369"></a><a href="#__codelineno-0-2369"><span class="linenos" data-linenos="2369 "></span></a>                                    <span class="n">other_video</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="nb">list</span>
<a id="__codelineno-0-2370" name="__codelineno-0-2370"></a><a href="#__codelineno-0-2370"><span class="linenos" data-linenos="2370 "></span></a>                                <span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">deduped_video</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-2371" name="__codelineno-0-2371"></a><a href="#__codelineno-0-2371"><span class="linenos" data-linenos="2371 "></span></a>                                    <span class="n">other_basenames</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-2372" name="__codelineno-0-2372"></a><a href="#__codelineno-0-2372"><span class="linenos" data-linenos="2372 "></span></a>                                        <span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">other_video</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-2373" name="__codelineno-0-2373"></a><a href="#__codelineno-0-2373"><span class="linenos" data-linenos="2373 "></span></a>                                    <span class="p">]</span>
<a id="__codelineno-0-2374" name="__codelineno-0-2374"></a><a href="#__codelineno-0-2374"><span class="linenos" data-linenos="2374 "></span></a>                                    <span class="n">deduped_basenames</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-2375" name="__codelineno-0-2375"></a><a href="#__codelineno-0-2375"><span class="linenos" data-linenos="2375 "></span></a>                                        <span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">deduped_video</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-2376" name="__codelineno-0-2376"></a><a href="#__codelineno-0-2376"><span class="linenos" data-linenos="2376 "></span></a>                                    <span class="p">]</span>
<a id="__codelineno-0-2377" name="__codelineno-0-2377"></a><a href="#__codelineno-0-2377"><span class="linenos" data-linenos="2377 "></span></a>                                    <span class="n">self_basenames</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-2378" name="__codelineno-0-2378"></a><a href="#__codelineno-0-2378"><span class="linenos" data-linenos="2378 "></span></a>                                        <span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">self_video</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-2379" name="__codelineno-0-2379"></a><a href="#__codelineno-0-2379"><span class="linenos" data-linenos="2379 "></span></a>                                    <span class="p">]</span>
<a id="__codelineno-0-2380" name="__codelineno-0-2380"></a><a href="#__codelineno-0-2380"><span class="linenos" data-linenos="2380 "></span></a>                                    <span class="k">for</span> <span class="n">old_idx</span><span class="p">,</span> <span class="n">basename</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
<a id="__codelineno-0-2381" name="__codelineno-0-2381"></a><a href="#__codelineno-0-2381"><span class="linenos" data-linenos="2381 "></span></a>                                        <span class="n">other_basenames</span>
<a id="__codelineno-0-2382" name="__codelineno-0-2382"></a><a href="#__codelineno-0-2382"><span class="linenos" data-linenos="2382 "></span></a>                                    <span class="p">):</span>
<a id="__codelineno-0-2383" name="__codelineno-0-2383"></a><a href="#__codelineno-0-2383"><span class="linenos" data-linenos="2383 "></span></a>                                        <span class="k">if</span> <span class="n">basename</span> <span class="ow">in</span> <span class="n">deduped_basenames</span><span class="p">:</span>
<a id="__codelineno-0-2384" name="__codelineno-0-2384"></a><a href="#__codelineno-0-2384"><span class="linenos" data-linenos="2384 "></span></a>                                            <span class="n">new_idx</span> <span class="o">=</span> <span class="n">deduped_basenames</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
<a id="__codelineno-0-2385" name="__codelineno-0-2385"></a><a href="#__codelineno-0-2385"><span class="linenos" data-linenos="2385 "></span></a>                                                <span class="n">basename</span>
<a id="__codelineno-0-2386" name="__codelineno-0-2386"></a><a href="#__codelineno-0-2386"><span class="linenos" data-linenos="2386 "></span></a>                                            <span class="p">)</span>
<a id="__codelineno-0-2387" name="__codelineno-0-2387"></a><a href="#__codelineno-0-2387"><span class="linenos" data-linenos="2387 "></span></a>                                            <span class="n">frame_idx_map</span><span class="p">[</span>
<a id="__codelineno-0-2388" name="__codelineno-0-2388"></a><a href="#__codelineno-0-2388"><span class="linenos" data-linenos="2388 "></span></a>                                                <span class="p">(</span><span class="n">other_video</span><span class="p">,</span> <span class="n">old_idx</span><span class="p">)</span>
<a id="__codelineno-0-2389" name="__codelineno-0-2389"></a><a href="#__codelineno-0-2389"><span class="linenos" data-linenos="2389 "></span></a>                                            <span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2390" name="__codelineno-0-2390"></a><a href="#__codelineno-0-2390"><span class="linenos" data-linenos="2390 "></span></a>                                                <span class="n">deduped_video</span><span class="p">,</span>
<a id="__codelineno-0-2391" name="__codelineno-0-2391"></a><a href="#__codelineno-0-2391"><span class="linenos" data-linenos="2391 "></span></a>                                                <span class="n">new_idx</span><span class="p">,</span>
<a id="__codelineno-0-2392" name="__codelineno-0-2392"></a><a href="#__codelineno-0-2392"><span class="linenos" data-linenos="2392 "></span></a>                                            <span class="p">)</span>
<a id="__codelineno-0-2393" name="__codelineno-0-2393"></a><a href="#__codelineno-0-2393"><span class="linenos" data-linenos="2393 "></span></a>                                        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2394" name="__codelineno-0-2394"></a><a href="#__codelineno-0-2394"><span class="linenos" data-linenos="2394 "></span></a>                                            <span class="c1"># Cases where the image was a duplicate,</span>
<a id="__codelineno-0-2395" name="__codelineno-0-2395"></a><a href="#__codelineno-0-2395"><span class="linenos" data-linenos="2395 "></span></a>                                            <span class="c1"># present in both self and other labels</span>
<a id="__codelineno-0-2396" name="__codelineno-0-2396"></a><a href="#__codelineno-0-2396"><span class="linenos" data-linenos="2396 "></span></a>                                            <span class="c1"># See Issue #239.</span>
<a id="__codelineno-0-2397" name="__codelineno-0-2397"></a><a href="#__codelineno-0-2397"><span class="linenos" data-linenos="2397 "></span></a>                                            <span class="k">assert</span> <span class="n">basename</span> <span class="ow">in</span> <span class="n">self_basenames</span><span class="p">,</span> <span class="p">(</span>
<a id="__codelineno-0-2398" name="__codelineno-0-2398"></a><a href="#__codelineno-0-2398"><span class="linenos" data-linenos="2398 "></span></a>                                                <span class="s2">&quot;Unexpected basename mismatch, </span><span class="se">\</span>
<a id="__codelineno-0-2399" name="__codelineno-0-2399"></a><a href="#__codelineno-0-2399"><span class="linenos" data-linenos="2399 "></span></a><span class="s2">                                                    possible file corruption.&quot;</span>
<a id="__codelineno-0-2400" name="__codelineno-0-2400"></a><a href="#__codelineno-0-2400"><span class="linenos" data-linenos="2400 "></span></a>                                            <span class="p">)</span>
<a id="__codelineno-0-2401" name="__codelineno-0-2401"></a><a href="#__codelineno-0-2401"><span class="linenos" data-linenos="2401 "></span></a>                                            <span class="n">new_idx</span> <span class="o">=</span> <span class="n">self_basenames</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">basename</span><span class="p">)</span>
<a id="__codelineno-0-2402" name="__codelineno-0-2402"></a><a href="#__codelineno-0-2402"><span class="linenos" data-linenos="2402 "></span></a>                                            <span class="n">frame_idx_map</span><span class="p">[</span>
<a id="__codelineno-0-2403" name="__codelineno-0-2403"></a><a href="#__codelineno-0-2403"><span class="linenos" data-linenos="2403 "></span></a>                                                <span class="p">(</span><span class="n">other_video</span><span class="p">,</span> <span class="n">old_idx</span><span class="p">)</span>
<a id="__codelineno-0-2404" name="__codelineno-0-2404"></a><a href="#__codelineno-0-2404"><span class="linenos" data-linenos="2404 "></span></a>                                            <span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2405" name="__codelineno-0-2405"></a><a href="#__codelineno-0-2405"><span class="linenos" data-linenos="2405 "></span></a>                                                <span class="n">self_video</span><span class="p">,</span>
<a id="__codelineno-0-2406" name="__codelineno-0-2406"></a><a href="#__codelineno-0-2406"><span class="linenos" data-linenos="2406 "></span></a>                                                <span class="n">new_idx</span><span class="p">,</span>
<a id="__codelineno-0-2407" name="__codelineno-0-2407"></a><a href="#__codelineno-0-2407"><span class="linenos" data-linenos="2407 "></span></a>                                            <span class="p">)</span>
<a id="__codelineno-0-2408" name="__codelineno-0-2408"></a><a href="#__codelineno-0-2408"><span class="linenos" data-linenos="2408 "></span></a>                        <span class="k">elif</span> <span class="n">video_matcher</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">SHAPE</span><span class="p">:</span>
<a id="__codelineno-0-2409" name="__codelineno-0-2409"></a><a href="#__codelineno-0-2409"><span class="linenos" data-linenos="2409 "></span></a>                            <span class="c1"># Merge videos with same shape</span>
<a id="__codelineno-0-2410" name="__codelineno-0-2410"></a><a href="#__codelineno-0-2410"><span class="linenos" data-linenos="2410 "></span></a>                            <span class="n">merged_video</span> <span class="o">=</span> <span class="n">self_video</span><span class="o">.</span><span class="n">merge_with</span><span class="p">(</span><span class="n">other_video</span><span class="p">)</span>
<a id="__codelineno-0-2411" name="__codelineno-0-2411"></a><a href="#__codelineno-0-2411"><span class="linenos" data-linenos="2411 "></span></a>                            <span class="c1"># Replace self_video with merged version</span>
<a id="__codelineno-0-2412" name="__codelineno-0-2412"></a><a href="#__codelineno-0-2412"><span class="linenos" data-linenos="2412 "></span></a>                            <span class="n">self_video_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">self_video</span><span class="p">)</span>
<a id="__codelineno-0-2413" name="__codelineno-0-2413"></a><a href="#__codelineno-0-2413"><span class="linenos" data-linenos="2413 "></span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="p">[</span><span class="n">self_video_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_video</span>
<a id="__codelineno-0-2414" name="__codelineno-0-2414"></a><a href="#__codelineno-0-2414"><span class="linenos" data-linenos="2414 "></span></a>                            <span class="n">video_map</span><span class="p">[</span><span class="n">other_video</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_video</span>
<a id="__codelineno-0-2415" name="__codelineno-0-2415"></a><a href="#__codelineno-0-2415"><span class="linenos" data-linenos="2415 "></span></a>                            <span class="n">video_map</span><span class="p">[</span><span class="n">self_video</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2416" name="__codelineno-0-2416"></a><a href="#__codelineno-0-2416"><span class="linenos" data-linenos="2416 "></span></a>                                <span class="n">merged_video</span>  <span class="c1"># Update mapping for self too</span>
<a id="__codelineno-0-2417" name="__codelineno-0-2417"></a><a href="#__codelineno-0-2417"><span class="linenos" data-linenos="2417 "></span></a>                            <span class="p">)</span>
<a id="__codelineno-0-2418" name="__codelineno-0-2418"></a><a href="#__codelineno-0-2418"><span class="linenos" data-linenos="2418 "></span></a>                            <span class="c1"># Build frame index mapping</span>
<a id="__codelineno-0-2419" name="__codelineno-0-2419"></a><a href="#__codelineno-0-2419"><span class="linenos" data-linenos="2419 "></span></a>                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-2420" name="__codelineno-0-2420"></a><a href="#__codelineno-0-2420"><span class="linenos" data-linenos="2420 "></span></a>                                <span class="n">other_video</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="nb">list</span>
<a id="__codelineno-0-2421" name="__codelineno-0-2421"></a><a href="#__codelineno-0-2421"><span class="linenos" data-linenos="2421 "></span></a>                            <span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">merged_video</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-2422" name="__codelineno-0-2422"></a><a href="#__codelineno-0-2422"><span class="linenos" data-linenos="2422 "></span></a>                                <span class="n">other_basenames</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-2423" name="__codelineno-0-2423"></a><a href="#__codelineno-0-2423"><span class="linenos" data-linenos="2423 "></span></a>                                    <span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">other_video</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-2424" name="__codelineno-0-2424"></a><a href="#__codelineno-0-2424"><span class="linenos" data-linenos="2424 "></span></a>                                <span class="p">]</span>
<a id="__codelineno-0-2425" name="__codelineno-0-2425"></a><a href="#__codelineno-0-2425"><span class="linenos" data-linenos="2425 "></span></a>                                <span class="n">merged_basenames</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-2426" name="__codelineno-0-2426"></a><a href="#__codelineno-0-2426"><span class="linenos" data-linenos="2426 "></span></a>                                    <span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">merged_video</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-2427" name="__codelineno-0-2427"></a><a href="#__codelineno-0-2427"><span class="linenos" data-linenos="2427 "></span></a>                                <span class="p">]</span>
<a id="__codelineno-0-2428" name="__codelineno-0-2428"></a><a href="#__codelineno-0-2428"><span class="linenos" data-linenos="2428 "></span></a>                                <span class="k">for</span> <span class="n">old_idx</span><span class="p">,</span> <span class="n">basename</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">other_basenames</span><span class="p">):</span>
<a id="__codelineno-0-2429" name="__codelineno-0-2429"></a><a href="#__codelineno-0-2429"><span class="linenos" data-linenos="2429 "></span></a>                                    <span class="k">if</span> <span class="n">basename</span> <span class="ow">in</span> <span class="n">merged_basenames</span><span class="p">:</span>
<a id="__codelineno-0-2430" name="__codelineno-0-2430"></a><a href="#__codelineno-0-2430"><span class="linenos" data-linenos="2430 "></span></a>                                        <span class="n">new_idx</span> <span class="o">=</span> <span class="n">merged_basenames</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">basename</span><span class="p">)</span>
<a id="__codelineno-0-2431" name="__codelineno-0-2431"></a><a href="#__codelineno-0-2431"><span class="linenos" data-linenos="2431 "></span></a>                                        <span class="n">frame_idx_map</span><span class="p">[(</span><span class="n">other_video</span><span class="p">,</span> <span class="n">old_idx</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2432" name="__codelineno-0-2432"></a><a href="#__codelineno-0-2432"><span class="linenos" data-linenos="2432 "></span></a>                                            <span class="n">merged_video</span><span class="p">,</span>
<a id="__codelineno-0-2433" name="__codelineno-0-2433"></a><a href="#__codelineno-0-2433"><span class="linenos" data-linenos="2433 "></span></a>                                            <span class="n">new_idx</span><span class="p">,</span>
<a id="__codelineno-0-2434" name="__codelineno-0-2434"></a><a href="#__codelineno-0-2434"><span class="linenos" data-linenos="2434 "></span></a>                                        <span class="p">)</span>
<a id="__codelineno-0-2435" name="__codelineno-0-2435"></a><a href="#__codelineno-0-2435"><span class="linenos" data-linenos="2435 "></span></a>                        <span class="n">matched</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-2436" name="__codelineno-0-2436"></a><a href="#__codelineno-0-2436"><span class="linenos" data-linenos="2436 "></span></a>                        <span class="k">break</span>
<a id="__codelineno-0-2437" name="__codelineno-0-2437"></a><a href="#__codelineno-0-2437"><span class="linenos" data-linenos="2437 "></span></a>
<a id="__codelineno-0-2438" name="__codelineno-0-2438"></a><a href="#__codelineno-0-2438"><span class="linenos" data-linenos="2438 "></span></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2439" name="__codelineno-0-2439"></a><a href="#__codelineno-0-2439"><span class="linenos" data-linenos="2439 "></span></a>                <span class="c1"># All other methods: use find_match() for the full matching cascade</span>
<a id="__codelineno-0-2440" name="__codelineno-0-2440"></a><a href="#__codelineno-0-2440"><span class="linenos" data-linenos="2440 "></span></a>                <span class="n">matched_video</span> <span class="o">=</span> <span class="n">video_matcher</span><span class="o">.</span><span class="n">find_match</span><span class="p">(</span>
<a id="__codelineno-0-2441" name="__codelineno-0-2441"></a><a href="#__codelineno-0-2441"><span class="linenos" data-linenos="2441 "></span></a>                    <span class="n">other_video</span><span class="p">,</span>
<a id="__codelineno-0-2442" name="__codelineno-0-2442"></a><a href="#__codelineno-0-2442"><span class="linenos" data-linenos="2442 "></span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="p">,</span>
<a id="__codelineno-0-2443" name="__codelineno-0-2443"></a><a href="#__codelineno-0-2443"><span class="linenos" data-linenos="2443 "></span></a>                    <span class="n">labels_incoming</span><span class="o">=</span><span class="n">other</span><span class="p">,</span>
<a id="__codelineno-0-2444" name="__codelineno-0-2444"></a><a href="#__codelineno-0-2444"><span class="linenos" data-linenos="2444 "></span></a>                    <span class="n">labels_base</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2445" name="__codelineno-0-2445"></a><a href="#__codelineno-0-2445"><span class="linenos" data-linenos="2445 "></span></a>                <span class="p">)</span>
<a id="__codelineno-0-2446" name="__codelineno-0-2446"></a><a href="#__codelineno-0-2446"><span class="linenos" data-linenos="2446 "></span></a>                <span class="k">if</span> <span class="n">matched_video</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2447" name="__codelineno-0-2447"></a><a href="#__codelineno-0-2447"><span class="linenos" data-linenos="2447 "></span></a>                    <span class="n">video_map</span><span class="p">[</span><span class="n">other_video</span><span class="p">]</span> <span class="o">=</span> <span class="n">matched_video</span>
<a id="__codelineno-0-2448" name="__codelineno-0-2448"></a><a href="#__codelineno-0-2448"><span class="linenos" data-linenos="2448 "></span></a>                    <span class="n">matched</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-2449" name="__codelineno-0-2449"></a><a href="#__codelineno-0-2449"><span class="linenos" data-linenos="2449 "></span></a>
<a id="__codelineno-0-2450" name="__codelineno-0-2450"></a><a href="#__codelineno-0-2450"><span class="linenos" data-linenos="2450 "></span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">matched</span><span class="p">:</span>
<a id="__codelineno-0-2451" name="__codelineno-0-2451"></a><a href="#__codelineno-0-2451"><span class="linenos" data-linenos="2451 "></span></a>                <span class="c1"># Add new video if no match</span>
<a id="__codelineno-0-2452" name="__codelineno-0-2452"></a><a href="#__codelineno-0-2452"><span class="linenos" data-linenos="2452 "></span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">other_video</span><span class="p">)</span>
<a id="__codelineno-0-2453" name="__codelineno-0-2453"></a><a href="#__codelineno-0-2453"><span class="linenos" data-linenos="2453 "></span></a>                <span class="n">video_map</span><span class="p">[</span><span class="n">other_video</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_video</span>
<a id="__codelineno-0-2454" name="__codelineno-0-2454"></a><a href="#__codelineno-0-2454"><span class="linenos" data-linenos="2454 "></span></a>
<a id="__codelineno-0-2455" name="__codelineno-0-2455"></a><a href="#__codelineno-0-2455"><span class="linenos" data-linenos="2455 "></span></a>        <span class="c1"># Step 3: Match and merge tracks</span>
<a id="__codelineno-0-2456" name="__codelineno-0-2456"></a><a href="#__codelineno-0-2456"><span class="linenos" data-linenos="2456 "></span></a>        <span class="n">track_map</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-2457" name="__codelineno-0-2457"></a><a href="#__codelineno-0-2457"><span class="linenos" data-linenos="2457 "></span></a>        <span class="k">for</span> <span class="n">other_track</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">tracks</span><span class="p">:</span>
<a id="__codelineno-0-2458" name="__codelineno-0-2458"></a><a href="#__codelineno-0-2458"><span class="linenos" data-linenos="2458 "></span></a>            <span class="n">matched</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-2459" name="__codelineno-0-2459"></a><a href="#__codelineno-0-2459"><span class="linenos" data-linenos="2459 "></span></a>            <span class="k">for</span> <span class="n">self_track</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tracks</span><span class="p">:</span>
<a id="__codelineno-0-2460" name="__codelineno-0-2460"></a><a href="#__codelineno-0-2460"><span class="linenos" data-linenos="2460 "></span></a>                <span class="k">if</span> <span class="n">track_matcher</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">self_track</span><span class="p">,</span> <span class="n">other_track</span><span class="p">):</span>
<a id="__codelineno-0-2461" name="__codelineno-0-2461"></a><a href="#__codelineno-0-2461"><span class="linenos" data-linenos="2461 "></span></a>                    <span class="n">track_map</span><span class="p">[</span><span class="n">other_track</span><span class="p">]</span> <span class="o">=</span> <span class="n">self_track</span>
<a id="__codelineno-0-2462" name="__codelineno-0-2462"></a><a href="#__codelineno-0-2462"><span class="linenos" data-linenos="2462 "></span></a>                    <span class="n">matched</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-2463" name="__codelineno-0-2463"></a><a href="#__codelineno-0-2463"><span class="linenos" data-linenos="2463 "></span></a>                    <span class="k">break</span>
<a id="__codelineno-0-2464" name="__codelineno-0-2464"></a><a href="#__codelineno-0-2464"><span class="linenos" data-linenos="2464 "></span></a>
<a id="__codelineno-0-2465" name="__codelineno-0-2465"></a><a href="#__codelineno-0-2465"><span class="linenos" data-linenos="2465 "></span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">matched</span><span class="p">:</span>
<a id="__codelineno-0-2466" name="__codelineno-0-2466"></a><a href="#__codelineno-0-2466"><span class="linenos" data-linenos="2466 "></span></a>                <span class="c1"># Add new track if no match</span>
<a id="__codelineno-0-2467" name="__codelineno-0-2467"></a><a href="#__codelineno-0-2467"><span class="linenos" data-linenos="2467 "></span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">tracks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">other_track</span><span class="p">)</span>
<a id="__codelineno-0-2468" name="__codelineno-0-2468"></a><a href="#__codelineno-0-2468"><span class="linenos" data-linenos="2468 "></span></a>                <span class="n">track_map</span><span class="p">[</span><span class="n">other_track</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_track</span>
<a id="__codelineno-0-2469" name="__codelineno-0-2469"></a><a href="#__codelineno-0-2469"><span class="linenos" data-linenos="2469 "></span></a>
<a id="__codelineno-0-2470" name="__codelineno-0-2470"></a><a href="#__codelineno-0-2470"><span class="linenos" data-linenos="2470 "></span></a>        <span class="c1"># Step 4: Merge frames</span>
<a id="__codelineno-0-2471" name="__codelineno-0-2471"></a><a href="#__codelineno-0-2471"><span class="linenos" data-linenos="2471 "></span></a>        <span class="n">total_frames</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">labeled_frames</span><span class="p">)</span>
<a id="__codelineno-0-2472" name="__codelineno-0-2472"></a><a href="#__codelineno-0-2472"><span class="linenos" data-linenos="2472 "></span></a>
<a id="__codelineno-0-2473" name="__codelineno-0-2473"></a><a href="#__codelineno-0-2473"><span class="linenos" data-linenos="2473 "></span></a>        <span class="k">for</span> <span class="n">frame_idx</span><span class="p">,</span> <span class="n">other_frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">labeled_frames</span><span class="p">):</span>
<a id="__codelineno-0-2474" name="__codelineno-0-2474"></a><a href="#__codelineno-0-2474"><span class="linenos" data-linenos="2474 "></span></a>            <span class="k">if</span> <span class="n">progress_callback</span><span class="p">:</span>
<a id="__codelineno-0-2475" name="__codelineno-0-2475"></a><a href="#__codelineno-0-2475"><span class="linenos" data-linenos="2475 "></span></a>                <span class="n">progress_callback</span><span class="p">(</span>
<a id="__codelineno-0-2476" name="__codelineno-0-2476"></a><a href="#__codelineno-0-2476"><span class="linenos" data-linenos="2476 "></span></a>                    <span class="n">frame_idx</span><span class="p">,</span>
<a id="__codelineno-0-2477" name="__codelineno-0-2477"></a><a href="#__codelineno-0-2477"><span class="linenos" data-linenos="2477 "></span></a>                    <span class="n">total_frames</span><span class="p">,</span>
<a id="__codelineno-0-2478" name="__codelineno-0-2478"></a><a href="#__codelineno-0-2478"><span class="linenos" data-linenos="2478 "></span></a>                    <span class="sa">f</span><span class="s2">&quot;Merging frame </span><span class="si">{</span><span class="n">frame_idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">total_frames</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2479" name="__codelineno-0-2479"></a><a href="#__codelineno-0-2479"><span class="linenos" data-linenos="2479 "></span></a>                <span class="p">)</span>
<a id="__codelineno-0-2480" name="__codelineno-0-2480"></a><a href="#__codelineno-0-2480"><span class="linenos" data-linenos="2480 "></span></a>
<a id="__codelineno-0-2481" name="__codelineno-0-2481"></a><a href="#__codelineno-0-2481"><span class="linenos" data-linenos="2481 "></span></a>            <span class="c1"># Check if frame index needs remapping (for deduplicated/merged videos)</span>
<a id="__codelineno-0-2482" name="__codelineno-0-2482"></a><a href="#__codelineno-0-2482"><span class="linenos" data-linenos="2482 "></span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">other_frame</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">other_frame</span><span class="o">.</span><span class="n">frame_idx</span><span class="p">)</span> <span class="ow">in</span> <span class="n">frame_idx_map</span><span class="p">:</span>
<a id="__codelineno-0-2483" name="__codelineno-0-2483"></a><a href="#__codelineno-0-2483"><span class="linenos" data-linenos="2483 "></span></a>                <span class="n">mapped_video</span><span class="p">,</span> <span class="n">mapped_frame_idx</span> <span class="o">=</span> <span class="n">frame_idx_map</span><span class="p">[</span>
<a id="__codelineno-0-2484" name="__codelineno-0-2484"></a><a href="#__codelineno-0-2484"><span class="linenos" data-linenos="2484 "></span></a>                    <span class="p">(</span><span class="n">other_frame</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">other_frame</span><span class="o">.</span><span class="n">frame_idx</span><span class="p">)</span>
<a id="__codelineno-0-2485" name="__codelineno-0-2485"></a><a href="#__codelineno-0-2485"><span class="linenos" data-linenos="2485 "></span></a>                <span class="p">]</span>
<a id="__codelineno-0-2486" name="__codelineno-0-2486"></a><a href="#__codelineno-0-2486"><span class="linenos" data-linenos="2486 "></span></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2487" name="__codelineno-0-2487"></a><a href="#__codelineno-0-2487"><span class="linenos" data-linenos="2487 "></span></a>                <span class="c1"># Map video to self</span>
<a id="__codelineno-0-2488" name="__codelineno-0-2488"></a><a href="#__codelineno-0-2488"><span class="linenos" data-linenos="2488 "></span></a>                <span class="n">mapped_video</span> <span class="o">=</span> <span class="n">video_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">other_frame</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">other_frame</span><span class="o">.</span><span class="n">video</span><span class="p">)</span>
<a id="__codelineno-0-2489" name="__codelineno-0-2489"></a><a href="#__codelineno-0-2489"><span class="linenos" data-linenos="2489 "></span></a>                <span class="n">mapped_frame_idx</span> <span class="o">=</span> <span class="n">other_frame</span><span class="o">.</span><span class="n">frame_idx</span>
<a id="__codelineno-0-2490" name="__codelineno-0-2490"></a><a href="#__codelineno-0-2490"><span class="linenos" data-linenos="2490 "></span></a>
<a id="__codelineno-0-2491" name="__codelineno-0-2491"></a><a href="#__codelineno-0-2491"><span class="linenos" data-linenos="2491 "></span></a>            <span class="c1"># Find matching frame in self</span>
<a id="__codelineno-0-2492" name="__codelineno-0-2492"></a><a href="#__codelineno-0-2492"><span class="linenos" data-linenos="2492 "></span></a>            <span class="n">matching_frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">mapped_video</span><span class="p">,</span> <span class="n">mapped_frame_idx</span><span class="p">)</span>
<a id="__codelineno-0-2493" name="__codelineno-0-2493"></a><a href="#__codelineno-0-2493"><span class="linenos" data-linenos="2493 "></span></a>
<a id="__codelineno-0-2494" name="__codelineno-0-2494"></a><a href="#__codelineno-0-2494"><span class="linenos" data-linenos="2494 "></span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matching_frames</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-2495" name="__codelineno-0-2495"></a><a href="#__codelineno-0-2495"><span class="linenos" data-linenos="2495 "></span></a>                <span class="c1"># No matching frame, create new one</span>
<a id="__codelineno-0-2496" name="__codelineno-0-2496"></a><a href="#__codelineno-0-2496"><span class="linenos" data-linenos="2496 "></span></a>                <span class="n">new_frame</span> <span class="o">=</span> <span class="n">LabeledFrame</span><span class="p">(</span>
<a id="__codelineno-0-2497" name="__codelineno-0-2497"></a><a href="#__codelineno-0-2497"><span class="linenos" data-linenos="2497 "></span></a>                    <span class="n">video</span><span class="o">=</span><span class="n">mapped_video</span><span class="p">,</span>
<a id="__codelineno-0-2498" name="__codelineno-0-2498"></a><a href="#__codelineno-0-2498"><span class="linenos" data-linenos="2498 "></span></a>                    <span class="n">frame_idx</span><span class="o">=</span><span class="n">mapped_frame_idx</span><span class="p">,</span>
<a id="__codelineno-0-2499" name="__codelineno-0-2499"></a><a href="#__codelineno-0-2499"><span class="linenos" data-linenos="2499 "></span></a>                    <span class="n">instances</span><span class="o">=</span><span class="p">[],</span>
<a id="__codelineno-0-2500" name="__codelineno-0-2500"></a><a href="#__codelineno-0-2500"><span class="linenos" data-linenos="2500 "></span></a>                <span class="p">)</span>
<a id="__codelineno-0-2501" name="__codelineno-0-2501"></a><a href="#__codelineno-0-2501"><span class="linenos" data-linenos="2501 "></span></a>
<a id="__codelineno-0-2502" name="__codelineno-0-2502"></a><a href="#__codelineno-0-2502"><span class="linenos" data-linenos="2502 "></span></a>                <span class="c1"># Map instances to new skeleton/track</span>
<a id="__codelineno-0-2503" name="__codelineno-0-2503"></a><a href="#__codelineno-0-2503"><span class="linenos" data-linenos="2503 "></span></a>                <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">other_frame</span><span class="o">.</span><span class="n">instances</span><span class="p">:</span>
<a id="__codelineno-0-2504" name="__codelineno-0-2504"></a><a href="#__codelineno-0-2504"><span class="linenos" data-linenos="2504 "></span></a>                    <span class="n">new_inst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map_instance</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">skeleton_map</span><span class="p">,</span> <span class="n">track_map</span><span class="p">)</span>
<a id="__codelineno-0-2505" name="__codelineno-0-2505"></a><a href="#__codelineno-0-2505"><span class="linenos" data-linenos="2505 "></span></a>                    <span class="n">new_frame</span><span class="o">.</span><span class="n">instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_inst</span><span class="p">)</span>
<a id="__codelineno-0-2506" name="__codelineno-0-2506"></a><a href="#__codelineno-0-2506"><span class="linenos" data-linenos="2506 "></span></a>                    <span class="n">result</span><span class="o">.</span><span class="n">instances_added</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-2507" name="__codelineno-0-2507"></a><a href="#__codelineno-0-2507"><span class="linenos" data-linenos="2507 "></span></a>
<a id="__codelineno-0-2508" name="__codelineno-0-2508"></a><a href="#__codelineno-0-2508"><span class="linenos" data-linenos="2508 "></span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_frame</span><span class="p">)</span>
<a id="__codelineno-0-2509" name="__codelineno-0-2509"></a><a href="#__codelineno-0-2509"><span class="linenos" data-linenos="2509 "></span></a>                <span class="n">result</span><span class="o">.</span><span class="n">frames_merged</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-2510" name="__codelineno-0-2510"></a><a href="#__codelineno-0-2510"><span class="linenos" data-linenos="2510 "></span></a>
<a id="__codelineno-0-2511" name="__codelineno-0-2511"></a><a href="#__codelineno-0-2511"><span class="linenos" data-linenos="2511 "></span></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2512" name="__codelineno-0-2512"></a><a href="#__codelineno-0-2512"><span class="linenos" data-linenos="2512 "></span></a>                <span class="c1"># Merge into existing frame</span>
<a id="__codelineno-0-2513" name="__codelineno-0-2513"></a><a href="#__codelineno-0-2513"><span class="linenos" data-linenos="2513 "></span></a>                <span class="n">self_frame</span> <span class="o">=</span> <span class="n">matching_frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2514" name="__codelineno-0-2514"></a><a href="#__codelineno-0-2514"><span class="linenos" data-linenos="2514 "></span></a>
<a id="__codelineno-0-2515" name="__codelineno-0-2515"></a><a href="#__codelineno-0-2515"><span class="linenos" data-linenos="2515 "></span></a>                <span class="c1"># Merge instances using frame-level merge</span>
<a id="__codelineno-0-2516" name="__codelineno-0-2516"></a><a href="#__codelineno-0-2516"><span class="linenos" data-linenos="2516 "></span></a>                <span class="n">merged_instances</span><span class="p">,</span> <span class="n">conflicts</span> <span class="o">=</span> <span class="n">self_frame</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
<a id="__codelineno-0-2517" name="__codelineno-0-2517"></a><a href="#__codelineno-0-2517"><span class="linenos" data-linenos="2517 "></span></a>                    <span class="n">other_frame</span><span class="p">,</span>
<a id="__codelineno-0-2518" name="__codelineno-0-2518"></a><a href="#__codelineno-0-2518"><span class="linenos" data-linenos="2518 "></span></a>                    <span class="n">instance</span><span class="o">=</span><span class="n">instance_matcher</span><span class="p">,</span>
<a id="__codelineno-0-2519" name="__codelineno-0-2519"></a><a href="#__codelineno-0-2519"><span class="linenos" data-linenos="2519 "></span></a>                    <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">,</span>
<a id="__codelineno-0-2520" name="__codelineno-0-2520"></a><a href="#__codelineno-0-2520"><span class="linenos" data-linenos="2520 "></span></a>                <span class="p">)</span>
<a id="__codelineno-0-2521" name="__codelineno-0-2521"></a><a href="#__codelineno-0-2521"><span class="linenos" data-linenos="2521 "></span></a>
<a id="__codelineno-0-2522" name="__codelineno-0-2522"></a><a href="#__codelineno-0-2522"><span class="linenos" data-linenos="2522 "></span></a>                <span class="c1"># Remap skeleton and track references for instances from other frame</span>
<a id="__codelineno-0-2523" name="__codelineno-0-2523"></a><a href="#__codelineno-0-2523"><span class="linenos" data-linenos="2523 "></span></a>                <span class="n">remapped_instances</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2524" name="__codelineno-0-2524"></a><a href="#__codelineno-0-2524"><span class="linenos" data-linenos="2524 "></span></a>                <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">merged_instances</span><span class="p">:</span>
<a id="__codelineno-0-2525" name="__codelineno-0-2525"></a><a href="#__codelineno-0-2525"><span class="linenos" data-linenos="2525 "></span></a>                    <span class="c1"># Check if instance needs remapping (from other_frame)</span>
<a id="__codelineno-0-2526" name="__codelineno-0-2526"></a><a href="#__codelineno-0-2526"><span class="linenos" data-linenos="2526 "></span></a>                    <span class="k">if</span> <span class="n">inst</span><span class="o">.</span><span class="n">skeleton</span> <span class="ow">in</span> <span class="n">skeleton_map</span><span class="p">:</span>
<a id="__codelineno-0-2527" name="__codelineno-0-2527"></a><a href="#__codelineno-0-2527"><span class="linenos" data-linenos="2527 "></span></a>                        <span class="c1"># Instance needs remapping</span>
<a id="__codelineno-0-2528" name="__codelineno-0-2528"></a><a href="#__codelineno-0-2528"><span class="linenos" data-linenos="2528 "></span></a>                        <span class="n">remapped_inst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map_instance</span><span class="p">(</span>
<a id="__codelineno-0-2529" name="__codelineno-0-2529"></a><a href="#__codelineno-0-2529"><span class="linenos" data-linenos="2529 "></span></a>                            <span class="n">inst</span><span class="p">,</span> <span class="n">skeleton_map</span><span class="p">,</span> <span class="n">track_map</span>
<a id="__codelineno-0-2530" name="__codelineno-0-2530"></a><a href="#__codelineno-0-2530"><span class="linenos" data-linenos="2530 "></span></a>                        <span class="p">)</span>
<a id="__codelineno-0-2531" name="__codelineno-0-2531"></a><a href="#__codelineno-0-2531"><span class="linenos" data-linenos="2531 "></span></a>                        <span class="n">remapped_instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">remapped_inst</span><span class="p">)</span>
<a id="__codelineno-0-2532" name="__codelineno-0-2532"></a><a href="#__codelineno-0-2532"><span class="linenos" data-linenos="2532 "></span></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2533" name="__codelineno-0-2533"></a><a href="#__codelineno-0-2533"><span class="linenos" data-linenos="2533 "></span></a>                        <span class="c1"># Instance already has correct skeleton (from self_frame)</span>
<a id="__codelineno-0-2534" name="__codelineno-0-2534"></a><a href="#__codelineno-0-2534"><span class="linenos" data-linenos="2534 "></span></a>                        <span class="n">remapped_instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>
<a id="__codelineno-0-2535" name="__codelineno-0-2535"></a><a href="#__codelineno-0-2535"><span class="linenos" data-linenos="2535 "></span></a>                <span class="n">merged_instances</span> <span class="o">=</span> <span class="n">remapped_instances</span>
<a id="__codelineno-0-2536" name="__codelineno-0-2536"></a><a href="#__codelineno-0-2536"><span class="linenos" data-linenos="2536 "></span></a>
<a id="__codelineno-0-2537" name="__codelineno-0-2537"></a><a href="#__codelineno-0-2537"><span class="linenos" data-linenos="2537 "></span></a>                <span class="c1"># Count changes</span>
<a id="__codelineno-0-2538" name="__codelineno-0-2538"></a><a href="#__codelineno-0-2538"><span class="linenos" data-linenos="2538 "></span></a>                <span class="n">n_before</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">self_frame</span><span class="o">.</span><span class="n">instances</span><span class="p">)</span>
<a id="__codelineno-0-2539" name="__codelineno-0-2539"></a><a href="#__codelineno-0-2539"><span class="linenos" data-linenos="2539 "></span></a>                <span class="n">n_after</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">merged_instances</span><span class="p">)</span>
<a id="__codelineno-0-2540" name="__codelineno-0-2540"></a><a href="#__codelineno-0-2540"><span class="linenos" data-linenos="2540 "></span></a>                <span class="n">result</span><span class="o">.</span><span class="n">instances_added</span> <span class="o">+=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_after</span> <span class="o">-</span> <span class="n">n_before</span><span class="p">)</span>
<a id="__codelineno-0-2541" name="__codelineno-0-2541"></a><a href="#__codelineno-0-2541"><span class="linenos" data-linenos="2541 "></span></a>
<a id="__codelineno-0-2542" name="__codelineno-0-2542"></a><a href="#__codelineno-0-2542"><span class="linenos" data-linenos="2542 "></span></a>                <span class="c1"># Record conflicts</span>
<a id="__codelineno-0-2543" name="__codelineno-0-2543"></a><a href="#__codelineno-0-2543"><span class="linenos" data-linenos="2543 "></span></a>                <span class="k">for</span> <span class="n">orig</span><span class="p">,</span> <span class="n">new</span><span class="p">,</span> <span class="n">resolution</span> <span class="ow">in</span> <span class="n">conflicts</span><span class="p">:</span>
<a id="__codelineno-0-2544" name="__codelineno-0-2544"></a><a href="#__codelineno-0-2544"><span class="linenos" data-linenos="2544 "></span></a>                    <span class="n">result</span><span class="o">.</span><span class="n">conflicts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-2545" name="__codelineno-0-2545"></a><a href="#__codelineno-0-2545"><span class="linenos" data-linenos="2545 "></span></a>                        <span class="n">ConflictResolution</span><span class="p">(</span>
<a id="__codelineno-0-2546" name="__codelineno-0-2546"></a><a href="#__codelineno-0-2546"><span class="linenos" data-linenos="2546 "></span></a>                            <span class="n">frame</span><span class="o">=</span><span class="n">self_frame</span><span class="p">,</span>
<a id="__codelineno-0-2547" name="__codelineno-0-2547"></a><a href="#__codelineno-0-2547"><span class="linenos" data-linenos="2547 "></span></a>                            <span class="n">conflict_type</span><span class="o">=</span><span class="s2">&quot;instance_conflict&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2548" name="__codelineno-0-2548"></a><a href="#__codelineno-0-2548"><span class="linenos" data-linenos="2548 "></span></a>                            <span class="n">original_data</span><span class="o">=</span><span class="n">orig</span><span class="p">,</span>
<a id="__codelineno-0-2549" name="__codelineno-0-2549"></a><a href="#__codelineno-0-2549"><span class="linenos" data-linenos="2549 "></span></a>                            <span class="n">new_data</span><span class="o">=</span><span class="n">new</span><span class="p">,</span>
<a id="__codelineno-0-2550" name="__codelineno-0-2550"></a><a href="#__codelineno-0-2550"><span class="linenos" data-linenos="2550 "></span></a>                            <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">,</span>
<a id="__codelineno-0-2551" name="__codelineno-0-2551"></a><a href="#__codelineno-0-2551"><span class="linenos" data-linenos="2551 "></span></a>                        <span class="p">)</span>
<a id="__codelineno-0-2552" name="__codelineno-0-2552"></a><a href="#__codelineno-0-2552"><span class="linenos" data-linenos="2552 "></span></a>                    <span class="p">)</span>
<a id="__codelineno-0-2553" name="__codelineno-0-2553"></a><a href="#__codelineno-0-2553"><span class="linenos" data-linenos="2553 "></span></a>
<a id="__codelineno-0-2554" name="__codelineno-0-2554"></a><a href="#__codelineno-0-2554"><span class="linenos" data-linenos="2554 "></span></a>                <span class="c1"># Update frame instances</span>
<a id="__codelineno-0-2555" name="__codelineno-0-2555"></a><a href="#__codelineno-0-2555"><span class="linenos" data-linenos="2555 "></span></a>                <span class="n">self_frame</span><span class="o">.</span><span class="n">instances</span> <span class="o">=</span> <span class="n">merged_instances</span>
<a id="__codelineno-0-2556" name="__codelineno-0-2556"></a><a href="#__codelineno-0-2556"><span class="linenos" data-linenos="2556 "></span></a>                <span class="n">result</span><span class="o">.</span><span class="n">frames_merged</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-2557" name="__codelineno-0-2557"></a><a href="#__codelineno-0-2557"><span class="linenos" data-linenos="2557 "></span></a>
<a id="__codelineno-0-2558" name="__codelineno-0-2558"></a><a href="#__codelineno-0-2558"><span class="linenos" data-linenos="2558 "></span></a>        <span class="c1"># Step 5: Merge suggestions</span>
<a id="__codelineno-0-2559" name="__codelineno-0-2559"></a><a href="#__codelineno-0-2559"><span class="linenos" data-linenos="2559 "></span></a>        <span class="k">for</span> <span class="n">other_suggestion</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">suggestions</span><span class="p">:</span>
<a id="__codelineno-0-2560" name="__codelineno-0-2560"></a><a href="#__codelineno-0-2560"><span class="linenos" data-linenos="2560 "></span></a>            <span class="n">mapped_video</span> <span class="o">=</span> <span class="n">video_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<a id="__codelineno-0-2561" name="__codelineno-0-2561"></a><a href="#__codelineno-0-2561"><span class="linenos" data-linenos="2561 "></span></a>                <span class="n">other_suggestion</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">other_suggestion</span><span class="o">.</span><span class="n">video</span>
<a id="__codelineno-0-2562" name="__codelineno-0-2562"></a><a href="#__codelineno-0-2562"><span class="linenos" data-linenos="2562 "></span></a>            <span class="p">)</span>
<a id="__codelineno-0-2563" name="__codelineno-0-2563"></a><a href="#__codelineno-0-2563"><span class="linenos" data-linenos="2563 "></span></a>            <span class="c1"># Check if suggestion already exists</span>
<a id="__codelineno-0-2564" name="__codelineno-0-2564"></a><a href="#__codelineno-0-2564"><span class="linenos" data-linenos="2564 "></span></a>            <span class="n">exists</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-2565" name="__codelineno-0-2565"></a><a href="#__codelineno-0-2565"><span class="linenos" data-linenos="2565 "></span></a>            <span class="k">for</span> <span class="n">self_suggestion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">suggestions</span><span class="p">:</span>
<a id="__codelineno-0-2566" name="__codelineno-0-2566"></a><a href="#__codelineno-0-2566"><span class="linenos" data-linenos="2566 "></span></a>                <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-2567" name="__codelineno-0-2567"></a><a href="#__codelineno-0-2567"><span class="linenos" data-linenos="2567 "></span></a>                    <span class="n">self_suggestion</span><span class="o">.</span><span class="n">video</span> <span class="o">==</span> <span class="n">mapped_video</span>
<a id="__codelineno-0-2568" name="__codelineno-0-2568"></a><a href="#__codelineno-0-2568"><span class="linenos" data-linenos="2568 "></span></a>                    <span class="ow">and</span> <span class="n">self_suggestion</span><span class="o">.</span><span class="n">frame_idx</span> <span class="o">==</span> <span class="n">other_suggestion</span><span class="o">.</span><span class="n">frame_idx</span>
<a id="__codelineno-0-2569" name="__codelineno-0-2569"></a><a href="#__codelineno-0-2569"><span class="linenos" data-linenos="2569 "></span></a>                <span class="p">):</span>
<a id="__codelineno-0-2570" name="__codelineno-0-2570"></a><a href="#__codelineno-0-2570"><span class="linenos" data-linenos="2570 "></span></a>                    <span class="n">exists</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-2571" name="__codelineno-0-2571"></a><a href="#__codelineno-0-2571"><span class="linenos" data-linenos="2571 "></span></a>                    <span class="k">break</span>
<a id="__codelineno-0-2572" name="__codelineno-0-2572"></a><a href="#__codelineno-0-2572"><span class="linenos" data-linenos="2572 "></span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">:</span>
<a id="__codelineno-0-2573" name="__codelineno-0-2573"></a><a href="#__codelineno-0-2573"><span class="linenos" data-linenos="2573 "></span></a>                <span class="c1"># Create new suggestion with mapped video</span>
<a id="__codelineno-0-2574" name="__codelineno-0-2574"></a><a href="#__codelineno-0-2574"><span class="linenos" data-linenos="2574 "></span></a>                <span class="n">new_suggestion</span> <span class="o">=</span> <span class="n">SuggestionFrame</span><span class="p">(</span>
<a id="__codelineno-0-2575" name="__codelineno-0-2575"></a><a href="#__codelineno-0-2575"><span class="linenos" data-linenos="2575 "></span></a>                    <span class="n">video</span><span class="o">=</span><span class="n">mapped_video</span><span class="p">,</span> <span class="n">frame_idx</span><span class="o">=</span><span class="n">other_suggestion</span><span class="o">.</span><span class="n">frame_idx</span>
<a id="__codelineno-0-2576" name="__codelineno-0-2576"></a><a href="#__codelineno-0-2576"><span class="linenos" data-linenos="2576 "></span></a>                <span class="p">)</span>
<a id="__codelineno-0-2577" name="__codelineno-0-2577"></a><a href="#__codelineno-0-2577"><span class="linenos" data-linenos="2577 "></span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">suggestions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_suggestion</span><span class="p">)</span>
<a id="__codelineno-0-2578" name="__codelineno-0-2578"></a><a href="#__codelineno-0-2578"><span class="linenos" data-linenos="2578 "></span></a>
<a id="__codelineno-0-2579" name="__codelineno-0-2579"></a><a href="#__codelineno-0-2579"><span class="linenos" data-linenos="2579 "></span></a>        <span class="c1"># Update merge record</span>
<a id="__codelineno-0-2580" name="__codelineno-0-2580"></a><a href="#__codelineno-0-2580"><span class="linenos" data-linenos="2580 "></span></a>        <span class="n">merge_record</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-2581" name="__codelineno-0-2581"></a><a href="#__codelineno-0-2581"><span class="linenos" data-linenos="2581 "></span></a>            <span class="s2">&quot;frames_merged&quot;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">frames_merged</span><span class="p">,</span>
<a id="__codelineno-0-2582" name="__codelineno-0-2582"></a><a href="#__codelineno-0-2582"><span class="linenos" data-linenos="2582 "></span></a>            <span class="s2">&quot;instances_added&quot;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">instances_added</span><span class="p">,</span>
<a id="__codelineno-0-2583" name="__codelineno-0-2583"></a><a href="#__codelineno-0-2583"><span class="linenos" data-linenos="2583 "></span></a>            <span class="s2">&quot;conflicts&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">conflicts</span><span class="p">),</span>
<a id="__codelineno-0-2584" name="__codelineno-0-2584"></a><a href="#__codelineno-0-2584"><span class="linenos" data-linenos="2584 "></span></a>        <span class="p">}</span>
<a id="__codelineno-0-2585" name="__codelineno-0-2585"></a><a href="#__codelineno-0-2585"><span class="linenos" data-linenos="2585 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">provenance</span><span class="p">[</span><span class="s2">&quot;merge_history&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">merge_record</span><span class="p">)</span>
<a id="__codelineno-0-2586" name="__codelineno-0-2586"></a><a href="#__codelineno-0-2586"><span class="linenos" data-linenos="2586 "></span></a>
<a id="__codelineno-0-2587" name="__codelineno-0-2587"></a><a href="#__codelineno-0-2587"><span class="linenos" data-linenos="2587 "></span></a>    <span class="k">except</span> <span class="n">MergeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-2588" name="__codelineno-0-2588"></a><a href="#__codelineno-0-2588"><span class="linenos" data-linenos="2588 "></span></a>        <span class="n">result</span><span class="o">.</span><span class="n">successful</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-2589" name="__codelineno-0-2589"></a><a href="#__codelineno-0-2589"><span class="linenos" data-linenos="2589 "></span></a>        <span class="n">result</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-2590" name="__codelineno-0-2590"></a><a href="#__codelineno-0-2590"><span class="linenos" data-linenos="2590 "></span></a>        <span class="k">if</span> <span class="n">error_mode_enum</span> <span class="o">==</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">STRICT</span><span class="p">:</span>
<a id="__codelineno-0-2591" name="__codelineno-0-2591"></a><a href="#__codelineno-0-2591"><span class="linenos" data-linenos="2591 "></span></a>            <span class="k">raise</span>
<a id="__codelineno-0-2592" name="__codelineno-0-2592"></a><a href="#__codelineno-0-2592"><span class="linenos" data-linenos="2592 "></span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-2593" name="__codelineno-0-2593"></a><a href="#__codelineno-0-2593"><span class="linenos" data-linenos="2593 "></span></a>        <span class="n">result</span><span class="o">.</span><span class="n">successful</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-2594" name="__codelineno-0-2594"></a><a href="#__codelineno-0-2594"><span class="linenos" data-linenos="2594 "></span></a>        <span class="n">result</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-2595" name="__codelineno-0-2595"></a><a href="#__codelineno-0-2595"><span class="linenos" data-linenos="2595 "></span></a>            <span class="n">MergeError</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;exception&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">})</span>
<a id="__codelineno-0-2596" name="__codelineno-0-2596"></a><a href="#__codelineno-0-2596"><span class="linenos" data-linenos="2596 "></span></a>        <span class="p">)</span>
<a id="__codelineno-0-2597" name="__codelineno-0-2597"></a><a href="#__codelineno-0-2597"><span class="linenos" data-linenos="2597 "></span></a>        <span class="k">if</span> <span class="n">error_mode_enum</span> <span class="o">==</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">STRICT</span><span class="p">:</span>
<a id="__codelineno-0-2598" name="__codelineno-0-2598"></a><a href="#__codelineno-0-2598"><span class="linenos" data-linenos="2598 "></span></a>            <span class="k">raise</span>
<a id="__codelineno-0-2599" name="__codelineno-0-2599"></a><a href="#__codelineno-0-2599"><span class="linenos" data-linenos="2599 "></span></a>
<a id="__codelineno-0-2600" name="__codelineno-0-2600"></a><a href="#__codelineno-0-2600"><span class="linenos" data-linenos="2600 "></span></a>    <span class="k">if</span> <span class="n">progress_callback</span><span class="p">:</span>
<a id="__codelineno-0-2601" name="__codelineno-0-2601"></a><a href="#__codelineno-0-2601"><span class="linenos" data-linenos="2601 "></span></a>        <span class="n">progress_callback</span><span class="p">(</span><span class="n">total_frames</span><span class="p">,</span> <span class="n">total_frames</span><span class="p">,</span> <span class="s2">&quot;Merge complete&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2602" name="__codelineno-0-2602"></a><a href="#__codelineno-0-2602"><span class="linenos" data-linenos="2602 "></span></a>
<a id="__codelineno-0-2603" name="__codelineno-0-2603"></a><a href="#__codelineno-0-2603"><span class="linenos" data-linenos="2603 "></span></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
            </details>
    </div>

</div><h3 id="labelsadd_video">Labels.add_video<a class="headerlink" href="#labelsadd_video" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">


<h4 id="sleap_io.model.labels.Labels.add_video" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sleap_io</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">Labels</span><span class="o">.</span><span class="n">add_video</span><span class="p">(</span><span class="n">video</span><span class="p">)</span></code>

<a href="#sleap_io.model.labels.Labels.add_video" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">

        <p>Add a video to the labels, preventing duplicates.</p>
<p>This method provides safe video addition by checking if a video with
the same file identity already exists. Unlike direct list append, this
prevents duplicate videos even when different Video objects point to
the same underlying file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>video</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;Video&lt;/code&gt; (&lt;code&gt;sleap_io.model.video.Video&lt;/code&gt;)" href="../reference/sleap_io/model/video/#sleap_io.model.video.Video">Video</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video to add.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;Video&lt;/code&gt; (&lt;code&gt;sleap_io.model.video.Video&lt;/code&gt;)" href="../reference/sleap_io/model/video/#sleap_io.model.video.Video">Video</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video that should be used. If a duplicate was detected, returns
the existing video; otherwise returns the input video.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>This method uses is_same_file() for duplicate detection, which:
- Considers source_video for embedded videos (PKG.SLP)
- Uses strict path comparison (same basename in different dirs != same)
- Handles ImageVideo lists correctly</p>
<p>Use this instead of <code>labels.videos.append(video)</code> to prevent duplicates.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/labels.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1301" name="__codelineno-0-1301"></a><a href="#__codelineno-0-1301"><span class="linenos" data-linenos="1301 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">add_video</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">video</span><span class="p">:</span> <span class="n">Video</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Video</span><span class="p">:</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a><a href="#__codelineno-0-1302"><span class="linenos" data-linenos="1302 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a video to the labels, preventing duplicates.</span>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a><a href="#__codelineno-0-1303"><span class="linenos" data-linenos="1303 "></span></a>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a><a href="#__codelineno-0-1304"><span class="linenos" data-linenos="1304 "></span></a><span class="sd">    This method provides safe video addition by checking if a video with</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a><a href="#__codelineno-0-1305"><span class="linenos" data-linenos="1305 "></span></a><span class="sd">    the same file identity already exists. Unlike direct list append, this</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a><a href="#__codelineno-0-1306"><span class="linenos" data-linenos="1306 "></span></a><span class="sd">    prevents duplicate videos even when different Video objects point to</span>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a><a href="#__codelineno-0-1307"><span class="linenos" data-linenos="1307 "></span></a><span class="sd">    the same underlying file.</span>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a><a href="#__codelineno-0-1308"><span class="linenos" data-linenos="1308 "></span></a>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a><a href="#__codelineno-0-1309"><span class="linenos" data-linenos="1309 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a><a href="#__codelineno-0-1310"><span class="linenos" data-linenos="1310 "></span></a><span class="sd">        video: The video to add.</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a><a href="#__codelineno-0-1311"><span class="linenos" data-linenos="1311 "></span></a>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a><a href="#__codelineno-0-1312"><span class="linenos" data-linenos="1312 "></span></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a><a href="#__codelineno-0-1313"><span class="linenos" data-linenos="1313 "></span></a><span class="sd">        The video that should be used. If a duplicate was detected, returns</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a><a href="#__codelineno-0-1314"><span class="linenos" data-linenos="1314 "></span></a><span class="sd">        the existing video; otherwise returns the input video.</span>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a><a href="#__codelineno-0-1315"><span class="linenos" data-linenos="1315 "></span></a>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a><a href="#__codelineno-0-1316"><span class="linenos" data-linenos="1316 "></span></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a><a href="#__codelineno-0-1317"><span class="linenos" data-linenos="1317 "></span></a><span class="sd">        This method uses is_same_file() for duplicate detection, which:</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a><a href="#__codelineno-0-1318"><span class="linenos" data-linenos="1318 "></span></a><span class="sd">        - Considers source_video for embedded videos (PKG.SLP)</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a><a href="#__codelineno-0-1319"><span class="linenos" data-linenos="1319 "></span></a><span class="sd">        - Uses strict path comparison (same basename in different dirs != same)</span>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a><a href="#__codelineno-0-1320"><span class="linenos" data-linenos="1320 "></span></a><span class="sd">        - Handles ImageVideo lists correctly</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a><a href="#__codelineno-0-1321"><span class="linenos" data-linenos="1321 "></span></a>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a><a href="#__codelineno-0-1322"><span class="linenos" data-linenos="1322 "></span></a><span class="sd">        Use this instead of `labels.videos.append(video)` to prevent duplicates.</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a><a href="#__codelineno-0-1323"><span class="linenos" data-linenos="1323 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a><a href="#__codelineno-0-1324"><span class="linenos" data-linenos="1324 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="n">is_same_file</span>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a><a href="#__codelineno-0-1325"><span class="linenos" data-linenos="1325 "></span></a>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a><a href="#__codelineno-0-1326"><span class="linenos" data-linenos="1326 "></span></a>    <span class="k">for</span> <span class="n">existing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="p">:</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a><a href="#__codelineno-0-1327"><span class="linenos" data-linenos="1327 "></span></a>        <span class="k">if</span> <span class="n">is_same_file</span><span class="p">(</span><span class="n">existing</span><span class="p">,</span> <span class="n">video</span><span class="p">):</span>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><a href="#__codelineno-0-1328"><span class="linenos" data-linenos="1328 "></span></a>            <span class="k">return</span> <span class="n">existing</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a><a href="#__codelineno-0-1329"><span class="linenos" data-linenos="1329 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">video</span><span class="p">)</span>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a><a href="#__codelineno-0-1330"><span class="linenos" data-linenos="1330 "></span></a>    <span class="k">return</span> <span class="n">video</span>
</code></pre></div>
            </details>
    </div>

</div><h3 id="labelsreplace_filenames">Labels.replace_filenames<a class="headerlink" href="#labelsreplace_filenames" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">


<h4 id="sleap_io.model.labels.Labels.replace_filenames" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sleap_io</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">Labels</span><span class="o">.</span><span class="n">replace_filenames</span><span class="p">(</span><span class="n">new_filenames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">open_videos</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#sleap_io.model.labels.Labels.replace_filenames" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">

        <p>Replace video filenames.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>new_filenames</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span> | <span title="pathlib._local.Path">Path</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of new filenames. Must have the same length as the
number of videos in the labels.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filename_map</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span> | <span title="pathlib._local.Path">Path</span>, <span title="str">str</span> | <span title="pathlib._local.Path">Path</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping old filenames (keys) to new filenames
(values).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix_map</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span> | <span title="pathlib._local.Path">Path</span>, <span title="str">str</span> | <span title="pathlib._local.Path">Path</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping old prefixes (keys) to new prefixes (values).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>open_videos</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code> (the default), attempt to open the video backend for
I/O after replacing the filename. If <code>False</code>, the backend will not be
opened (useful for operations with costly file existence checks).</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>Only one of the argument types can be provided.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/labels.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1369" name="__codelineno-0-1369"></a><a href="#__codelineno-0-1369"><span class="linenos" data-linenos="1369 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">replace_filenames</span><span class="p">(</span>
<a id="__codelineno-0-1370" name="__codelineno-0-1370"></a><a href="#__codelineno-0-1370"><span class="linenos" data-linenos="1370 "></span></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371"></a><a href="#__codelineno-0-1371"><span class="linenos" data-linenos="1371 "></span></a>    <span class="n">new_filenames</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1372" name="__codelineno-0-1372"></a><a href="#__codelineno-0-1372"><span class="linenos" data-linenos="1372 "></span></a>    <span class="n">filename_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1373" name="__codelineno-0-1373"></a><a href="#__codelineno-0-1373"><span class="linenos" data-linenos="1373 "></span></a>    <span class="n">prefix_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1374" name="__codelineno-0-1374"></a><a href="#__codelineno-0-1374"><span class="linenos" data-linenos="1374 "></span></a>    <span class="n">open_videos</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1375" name="__codelineno-0-1375"></a><a href="#__codelineno-0-1375"><span class="linenos" data-linenos="1375 "></span></a><span class="p">):</span>
<a id="__codelineno-0-1376" name="__codelineno-0-1376"></a><a href="#__codelineno-0-1376"><span class="linenos" data-linenos="1376 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Replace video filenames.</span>
<a id="__codelineno-0-1377" name="__codelineno-0-1377"></a><a href="#__codelineno-0-1377"><span class="linenos" data-linenos="1377 "></span></a>
<a id="__codelineno-0-1378" name="__codelineno-0-1378"></a><a href="#__codelineno-0-1378"><span class="linenos" data-linenos="1378 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1379" name="__codelineno-0-1379"></a><a href="#__codelineno-0-1379"><span class="linenos" data-linenos="1379 "></span></a><span class="sd">        new_filenames: List of new filenames. Must have the same length as the</span>
<a id="__codelineno-0-1380" name="__codelineno-0-1380"></a><a href="#__codelineno-0-1380"><span class="linenos" data-linenos="1380 "></span></a><span class="sd">            number of videos in the labels.</span>
<a id="__codelineno-0-1381" name="__codelineno-0-1381"></a><a href="#__codelineno-0-1381"><span class="linenos" data-linenos="1381 "></span></a><span class="sd">        filename_map: Dictionary mapping old filenames (keys) to new filenames</span>
<a id="__codelineno-0-1382" name="__codelineno-0-1382"></a><a href="#__codelineno-0-1382"><span class="linenos" data-linenos="1382 "></span></a><span class="sd">            (values).</span>
<a id="__codelineno-0-1383" name="__codelineno-0-1383"></a><a href="#__codelineno-0-1383"><span class="linenos" data-linenos="1383 "></span></a><span class="sd">        prefix_map: Dictionary mapping old prefixes (keys) to new prefixes (values).</span>
<a id="__codelineno-0-1384" name="__codelineno-0-1384"></a><a href="#__codelineno-0-1384"><span class="linenos" data-linenos="1384 "></span></a><span class="sd">        open_videos: If `True` (the default), attempt to open the video backend for</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385"></a><a href="#__codelineno-0-1385"><span class="linenos" data-linenos="1385 "></span></a><span class="sd">            I/O after replacing the filename. If `False`, the backend will not be</span>
<a id="__codelineno-0-1386" name="__codelineno-0-1386"></a><a href="#__codelineno-0-1386"><span class="linenos" data-linenos="1386 "></span></a><span class="sd">            opened (useful for operations with costly file existence checks).</span>
<a id="__codelineno-0-1387" name="__codelineno-0-1387"></a><a href="#__codelineno-0-1387"><span class="linenos" data-linenos="1387 "></span></a>
<a id="__codelineno-0-1388" name="__codelineno-0-1388"></a><a href="#__codelineno-0-1388"><span class="linenos" data-linenos="1388 "></span></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-1389" name="__codelineno-0-1389"></a><a href="#__codelineno-0-1389"><span class="linenos" data-linenos="1389 "></span></a><span class="sd">        Only one of the argument types can be provided.</span>
<a id="__codelineno-0-1390" name="__codelineno-0-1390"></a><a href="#__codelineno-0-1390"><span class="linenos" data-linenos="1390 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1391" name="__codelineno-0-1391"></a><a href="#__codelineno-0-1391"><span class="linenos" data-linenos="1391 "></span></a>    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1392" name="__codelineno-0-1392"></a><a href="#__codelineno-0-1392"><span class="linenos" data-linenos="1392 "></span></a>    <span class="k">if</span> <span class="n">new_filenames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1393" name="__codelineno-0-1393"></a><a href="#__codelineno-0-1393"><span class="linenos" data-linenos="1393 "></span></a>        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-1394" name="__codelineno-0-1394"></a><a href="#__codelineno-0-1394"><span class="linenos" data-linenos="1394 "></span></a>    <span class="k">if</span> <span class="n">filename_map</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1395" name="__codelineno-0-1395"></a><a href="#__codelineno-0-1395"><span class="linenos" data-linenos="1395 "></span></a>        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-1396" name="__codelineno-0-1396"></a><a href="#__codelineno-0-1396"><span class="linenos" data-linenos="1396 "></span></a>    <span class="k">if</span> <span class="n">prefix_map</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1397" name="__codelineno-0-1397"></a><a href="#__codelineno-0-1397"><span class="linenos" data-linenos="1397 "></span></a>        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-1398" name="__codelineno-0-1398"></a><a href="#__codelineno-0-1398"><span class="linenos" data-linenos="1398 "></span></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1399" name="__codelineno-0-1399"></a><a href="#__codelineno-0-1399"><span class="linenos" data-linenos="1399 "></span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1400" name="__codelineno-0-1400"></a><a href="#__codelineno-0-1400"><span class="linenos" data-linenos="1400 "></span></a>            <span class="s2">&quot;Exactly one input method must be provided to replace filenames.&quot;</span>
<a id="__codelineno-0-1401" name="__codelineno-0-1401"></a><a href="#__codelineno-0-1401"><span class="linenos" data-linenos="1401 "></span></a>        <span class="p">)</span>
<a id="__codelineno-0-1402" name="__codelineno-0-1402"></a><a href="#__codelineno-0-1402"><span class="linenos" data-linenos="1402 "></span></a>
<a id="__codelineno-0-1403" name="__codelineno-0-1403"></a><a href="#__codelineno-0-1403"><span class="linenos" data-linenos="1403 "></span></a>    <span class="k">if</span> <span class="n">new_filenames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1404" name="__codelineno-0-1404"></a><a href="#__codelineno-0-1404"><span class="linenos" data-linenos="1404 "></span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_filenames</span><span class="p">):</span>
<a id="__codelineno-0-1405" name="__codelineno-0-1405"></a><a href="#__codelineno-0-1405"><span class="linenos" data-linenos="1405 "></span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1406" name="__codelineno-0-1406"></a><a href="#__codelineno-0-1406"><span class="linenos" data-linenos="1406 "></span></a>                <span class="sa">f</span><span class="s2">&quot;Number of new filenames (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">new_filenames</span><span class="p">)</span><span class="si">}</span><span class="s2">) does not match &quot;</span>
<a id="__codelineno-0-1407" name="__codelineno-0-1407"></a><a href="#__codelineno-0-1407"><span class="linenos" data-linenos="1407 "></span></a>                <span class="sa">f</span><span class="s2">&quot;the number of videos (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-1408" name="__codelineno-0-1408"></a><a href="#__codelineno-0-1408"><span class="linenos" data-linenos="1408 "></span></a>            <span class="p">)</span>
<a id="__codelineno-0-1409" name="__codelineno-0-1409"></a><a href="#__codelineno-0-1409"><span class="linenos" data-linenos="1409 "></span></a>
<a id="__codelineno-0-1410" name="__codelineno-0-1410"></a><a href="#__codelineno-0-1410"><span class="linenos" data-linenos="1410 "></span></a>        <span class="k">for</span> <span class="n">video</span><span class="p">,</span> <span class="n">new_filename</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="p">,</span> <span class="n">new_filenames</span><span class="p">):</span>
<a id="__codelineno-0-1411" name="__codelineno-0-1411"></a><a href="#__codelineno-0-1411"><span class="linenos" data-linenos="1411 "></span></a>            <span class="n">video</span><span class="o">.</span><span class="n">replace_filename</span><span class="p">(</span><span class="n">new_filename</span><span class="p">,</span> <span class="nb">open</span><span class="o">=</span><span class="n">open_videos</span><span class="p">)</span>
<a id="__codelineno-0-1412" name="__codelineno-0-1412"></a><a href="#__codelineno-0-1412"><span class="linenos" data-linenos="1412 "></span></a>
<a id="__codelineno-0-1413" name="__codelineno-0-1413"></a><a href="#__codelineno-0-1413"><span class="linenos" data-linenos="1413 "></span></a>    <span class="k">elif</span> <span class="n">filename_map</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1414" name="__codelineno-0-1414"></a><a href="#__codelineno-0-1414"><span class="linenos" data-linenos="1414 "></span></a>        <span class="k">for</span> <span class="n">video</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="p">:</span>
<a id="__codelineno-0-1415" name="__codelineno-0-1415"></a><a href="#__codelineno-0-1415"><span class="linenos" data-linenos="1415 "></span></a>            <span class="k">for</span> <span class="n">old_fn</span><span class="p">,</span> <span class="n">new_fn</span> <span class="ow">in</span> <span class="n">filename_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1416" name="__codelineno-0-1416"></a><a href="#__codelineno-0-1416"><span class="linenos" data-linenos="1416 "></span></a>                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-0-1417" name="__codelineno-0-1417"></a><a href="#__codelineno-0-1417"><span class="linenos" data-linenos="1417 "></span></a>                    <span class="n">new_fns</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1418" name="__codelineno-0-1418"></a><a href="#__codelineno-0-1418"><span class="linenos" data-linenos="1418 "></span></a>                    <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">video</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
<a id="__codelineno-0-1419" name="__codelineno-0-1419"></a><a href="#__codelineno-0-1419"><span class="linenos" data-linenos="1419 "></span></a>                        <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> <span class="o">==</span> <span class="n">Path</span><span class="p">(</span><span class="n">old_fn</span><span class="p">):</span>
<a id="__codelineno-0-1420" name="__codelineno-0-1420"></a><a href="#__codelineno-0-1420"><span class="linenos" data-linenos="1420 "></span></a>                            <span class="n">new_fns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_fn</span><span class="p">)</span>
<a id="__codelineno-0-1421" name="__codelineno-0-1421"></a><a href="#__codelineno-0-1421"><span class="linenos" data-linenos="1421 "></span></a>                        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1422" name="__codelineno-0-1422"></a><a href="#__codelineno-0-1422"><span class="linenos" data-linenos="1422 "></span></a>                            <span class="n">new_fns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<a id="__codelineno-0-1423" name="__codelineno-0-1423"></a><a href="#__codelineno-0-1423"><span class="linenos" data-linenos="1423 "></span></a>                    <span class="n">video</span><span class="o">.</span><span class="n">replace_filename</span><span class="p">(</span><span class="n">new_fns</span><span class="p">,</span> <span class="nb">open</span><span class="o">=</span><span class="n">open_videos</span><span class="p">)</span>
<a id="__codelineno-0-1424" name="__codelineno-0-1424"></a><a href="#__codelineno-0-1424"><span class="linenos" data-linenos="1424 "></span></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1425" name="__codelineno-0-1425"></a><a href="#__codelineno-0-1425"><span class="linenos" data-linenos="1425 "></span></a>                    <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="n">Path</span><span class="p">(</span><span class="n">old_fn</span><span class="p">):</span>
<a id="__codelineno-0-1426" name="__codelineno-0-1426"></a><a href="#__codelineno-0-1426"><span class="linenos" data-linenos="1426 "></span></a>                        <span class="n">video</span><span class="o">.</span><span class="n">replace_filename</span><span class="p">(</span><span class="n">new_fn</span><span class="p">,</span> <span class="nb">open</span><span class="o">=</span><span class="n">open_videos</span><span class="p">)</span>
<a id="__codelineno-0-1427" name="__codelineno-0-1427"></a><a href="#__codelineno-0-1427"><span class="linenos" data-linenos="1427 "></span></a>
<a id="__codelineno-0-1428" name="__codelineno-0-1428"></a><a href="#__codelineno-0-1428"><span class="linenos" data-linenos="1428 "></span></a>    <span class="k">elif</span> <span class="n">prefix_map</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1429" name="__codelineno-0-1429"></a><a href="#__codelineno-0-1429"><span class="linenos" data-linenos="1429 "></span></a>        <span class="k">for</span> <span class="n">video</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="p">:</span>
<a id="__codelineno-0-1430" name="__codelineno-0-1430"></a><a href="#__codelineno-0-1430"><span class="linenos" data-linenos="1430 "></span></a>            <span class="k">for</span> <span class="n">old_prefix</span><span class="p">,</span> <span class="n">new_prefix</span> <span class="ow">in</span> <span class="n">prefix_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1431" name="__codelineno-0-1431"></a><a href="#__codelineno-0-1431"><span class="linenos" data-linenos="1431 "></span></a>                <span class="c1"># Sanitize old_prefix for cross-platform matching</span>
<a id="__codelineno-0-1432" name="__codelineno-0-1432"></a><a href="#__codelineno-0-1432"><span class="linenos" data-linenos="1432 "></span></a>                <span class="n">old_prefix_sanitized</span> <span class="o">=</span> <span class="n">sanitize_filename</span><span class="p">(</span><span class="n">old_prefix</span><span class="p">)</span>
<a id="__codelineno-0-1433" name="__codelineno-0-1433"></a><a href="#__codelineno-0-1433"><span class="linenos" data-linenos="1433 "></span></a>
<a id="__codelineno-0-1434" name="__codelineno-0-1434"></a><a href="#__codelineno-0-1434"><span class="linenos" data-linenos="1434 "></span></a>                <span class="c1"># Check if old prefix ends with a separator</span>
<a id="__codelineno-0-1435" name="__codelineno-0-1435"></a><a href="#__codelineno-0-1435"><span class="linenos" data-linenos="1435 "></span></a>                <span class="n">old_ends_with_sep</span> <span class="o">=</span> <span class="n">old_prefix_sanitized</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1436" name="__codelineno-0-1436"></a><a href="#__codelineno-0-1436"><span class="linenos" data-linenos="1436 "></span></a>
<a id="__codelineno-0-1437" name="__codelineno-0-1437"></a><a href="#__codelineno-0-1437"><span class="linenos" data-linenos="1437 "></span></a>                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-0-1438" name="__codelineno-0-1438"></a><a href="#__codelineno-0-1438"><span class="linenos" data-linenos="1438 "></span></a>                    <span class="n">new_fns</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1439" name="__codelineno-0-1439"></a><a href="#__codelineno-0-1439"><span class="linenos" data-linenos="1439 "></span></a>                    <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">video</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
<a id="__codelineno-0-1440" name="__codelineno-0-1440"></a><a href="#__codelineno-0-1440"><span class="linenos" data-linenos="1440 "></span></a>                        <span class="c1"># Sanitize filename for matching</span>
<a id="__codelineno-0-1441" name="__codelineno-0-1441"></a><a href="#__codelineno-0-1441"><span class="linenos" data-linenos="1441 "></span></a>                        <span class="n">fn_sanitized</span> <span class="o">=</span> <span class="n">sanitize_filename</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<a id="__codelineno-0-1442" name="__codelineno-0-1442"></a><a href="#__codelineno-0-1442"><span class="linenos" data-linenos="1442 "></span></a>
<a id="__codelineno-0-1443" name="__codelineno-0-1443"></a><a href="#__codelineno-0-1443"><span class="linenos" data-linenos="1443 "></span></a>                        <span class="k">if</span> <span class="n">fn_sanitized</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">old_prefix_sanitized</span><span class="p">):</span>
<a id="__codelineno-0-1444" name="__codelineno-0-1444"></a><a href="#__codelineno-0-1444"><span class="linenos" data-linenos="1444 "></span></a>                            <span class="c1"># Calculate the remainder after removing the prefix</span>
<a id="__codelineno-0-1445" name="__codelineno-0-1445"></a><a href="#__codelineno-0-1445"><span class="linenos" data-linenos="1445 "></span></a>                            <span class="n">remainder</span> <span class="o">=</span> <span class="n">fn_sanitized</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">old_prefix_sanitized</span><span class="p">)</span> <span class="p">:]</span>
<a id="__codelineno-0-1446" name="__codelineno-0-1446"></a><a href="#__codelineno-0-1446"><span class="linenos" data-linenos="1446 "></span></a>
<a id="__codelineno-0-1447" name="__codelineno-0-1447"></a><a href="#__codelineno-0-1447"><span class="linenos" data-linenos="1447 "></span></a>                            <span class="c1"># Build the new filename</span>
<a id="__codelineno-0-1448" name="__codelineno-0-1448"></a><a href="#__codelineno-0-1448"><span class="linenos" data-linenos="1448 "></span></a>                            <span class="k">if</span> <span class="n">remainder</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1449" name="__codelineno-0-1449"></a><a href="#__codelineno-0-1449"><span class="linenos" data-linenos="1449 "></span></a>                                <span class="c1"># Remainder has separator, remove it to avoid double</span>
<a id="__codelineno-0-1450" name="__codelineno-0-1450"></a><a href="#__codelineno-0-1450"><span class="linenos" data-linenos="1450 "></span></a>                                <span class="c1"># slash</span>
<a id="__codelineno-0-1451" name="__codelineno-0-1451"></a><a href="#__codelineno-0-1451"><span class="linenos" data-linenos="1451 "></span></a>                                <span class="n">remainder</span> <span class="o">=</span> <span class="n">remainder</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-1452" name="__codelineno-0-1452"></a><a href="#__codelineno-0-1452"><span class="linenos" data-linenos="1452 "></span></a>                                <span class="c1"># Always add separator between prefix and remainder</span>
<a id="__codelineno-0-1453" name="__codelineno-0-1453"></a><a href="#__codelineno-0-1453"><span class="linenos" data-linenos="1453 "></span></a>                                <span class="k">if</span> <span class="n">new_prefix</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">new_prefix</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span>
<a id="__codelineno-0-1454" name="__codelineno-0-1454"></a><a href="#__codelineno-0-1454"><span class="linenos" data-linenos="1454 "></span></a>                                    <span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1455" name="__codelineno-0-1455"></a><a href="#__codelineno-0-1455"><span class="linenos" data-linenos="1455 "></span></a>                                <span class="p">):</span>
<a id="__codelineno-0-1456" name="__codelineno-0-1456"></a><a href="#__codelineno-0-1456"><span class="linenos" data-linenos="1456 "></span></a>                                    <span class="n">new_fn</span> <span class="o">=</span> <span class="n">new_prefix</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">remainder</span>
<a id="__codelineno-0-1457" name="__codelineno-0-1457"></a><a href="#__codelineno-0-1457"><span class="linenos" data-linenos="1457 "></span></a>                                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1458" name="__codelineno-0-1458"></a><a href="#__codelineno-0-1458"><span class="linenos" data-linenos="1458 "></span></a>                                    <span class="n">new_fn</span> <span class="o">=</span> <span class="n">new_prefix</span> <span class="o">+</span> <span class="n">remainder</span>
<a id="__codelineno-0-1459" name="__codelineno-0-1459"></a><a href="#__codelineno-0-1459"><span class="linenos" data-linenos="1459 "></span></a>                            <span class="k">elif</span> <span class="n">old_ends_with_sep</span><span class="p">:</span>
<a id="__codelineno-0-1460" name="__codelineno-0-1460"></a><a href="#__codelineno-0-1460"><span class="linenos" data-linenos="1460 "></span></a>                                <span class="c1"># Old prefix had separator, preserve it in the new</span>
<a id="__codelineno-0-1461" name="__codelineno-0-1461"></a><a href="#__codelineno-0-1461"><span class="linenos" data-linenos="1461 "></span></a>                                <span class="c1"># one</span>
<a id="__codelineno-0-1462" name="__codelineno-0-1462"></a><a href="#__codelineno-0-1462"><span class="linenos" data-linenos="1462 "></span></a>                                <span class="k">if</span> <span class="n">new_prefix</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">new_prefix</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span>
<a id="__codelineno-0-1463" name="__codelineno-0-1463"></a><a href="#__codelineno-0-1463"><span class="linenos" data-linenos="1463 "></span></a>                                    <span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1464" name="__codelineno-0-1464"></a><a href="#__codelineno-0-1464"><span class="linenos" data-linenos="1464 "></span></a>                                <span class="p">):</span>
<a id="__codelineno-0-1465" name="__codelineno-0-1465"></a><a href="#__codelineno-0-1465"><span class="linenos" data-linenos="1465 "></span></a>                                    <span class="n">new_fn</span> <span class="o">=</span> <span class="n">new_prefix</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">remainder</span>
<a id="__codelineno-0-1466" name="__codelineno-0-1466"></a><a href="#__codelineno-0-1466"><span class="linenos" data-linenos="1466 "></span></a>                                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1467" name="__codelineno-0-1467"></a><a href="#__codelineno-0-1467"><span class="linenos" data-linenos="1467 "></span></a>                                    <span class="n">new_fn</span> <span class="o">=</span> <span class="n">new_prefix</span> <span class="o">+</span> <span class="n">remainder</span>
<a id="__codelineno-0-1468" name="__codelineno-0-1468"></a><a href="#__codelineno-0-1468"><span class="linenos" data-linenos="1468 "></span></a>                            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1469" name="__codelineno-0-1469"></a><a href="#__codelineno-0-1469"><span class="linenos" data-linenos="1469 "></span></a>                                <span class="c1"># No separator in old prefix, don&#39;t add one</span>
<a id="__codelineno-0-1470" name="__codelineno-0-1470"></a><a href="#__codelineno-0-1470"><span class="linenos" data-linenos="1470 "></span></a>                                <span class="n">new_fn</span> <span class="o">=</span> <span class="n">new_prefix</span> <span class="o">+</span> <span class="n">remainder</span>
<a id="__codelineno-0-1471" name="__codelineno-0-1471"></a><a href="#__codelineno-0-1471"><span class="linenos" data-linenos="1471 "></span></a>
<a id="__codelineno-0-1472" name="__codelineno-0-1472"></a><a href="#__codelineno-0-1472"><span class="linenos" data-linenos="1472 "></span></a>                            <span class="n">new_fns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_fn</span><span class="p">)</span>
<a id="__codelineno-0-1473" name="__codelineno-0-1473"></a><a href="#__codelineno-0-1473"><span class="linenos" data-linenos="1473 "></span></a>                        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1474" name="__codelineno-0-1474"></a><a href="#__codelineno-0-1474"><span class="linenos" data-linenos="1474 "></span></a>                            <span class="n">new_fns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<a id="__codelineno-0-1475" name="__codelineno-0-1475"></a><a href="#__codelineno-0-1475"><span class="linenos" data-linenos="1475 "></span></a>                    <span class="n">video</span><span class="o">.</span><span class="n">replace_filename</span><span class="p">(</span><span class="n">new_fns</span><span class="p">,</span> <span class="nb">open</span><span class="o">=</span><span class="n">open_videos</span><span class="p">)</span>
<a id="__codelineno-0-1476" name="__codelineno-0-1476"></a><a href="#__codelineno-0-1476"><span class="linenos" data-linenos="1476 "></span></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1477" name="__codelineno-0-1477"></a><a href="#__codelineno-0-1477"><span class="linenos" data-linenos="1477 "></span></a>                    <span class="c1"># Sanitize filename for matching</span>
<a id="__codelineno-0-1478" name="__codelineno-0-1478"></a><a href="#__codelineno-0-1478"><span class="linenos" data-linenos="1478 "></span></a>                    <span class="n">fn_sanitized</span> <span class="o">=</span> <span class="n">sanitize_filename</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-1479" name="__codelineno-0-1479"></a><a href="#__codelineno-0-1479"><span class="linenos" data-linenos="1479 "></span></a>
<a id="__codelineno-0-1480" name="__codelineno-0-1480"></a><a href="#__codelineno-0-1480"><span class="linenos" data-linenos="1480 "></span></a>                    <span class="k">if</span> <span class="n">fn_sanitized</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">old_prefix_sanitized</span><span class="p">):</span>
<a id="__codelineno-0-1481" name="__codelineno-0-1481"></a><a href="#__codelineno-0-1481"><span class="linenos" data-linenos="1481 "></span></a>                        <span class="c1"># Calculate the remainder after removing the prefix</span>
<a id="__codelineno-0-1482" name="__codelineno-0-1482"></a><a href="#__codelineno-0-1482"><span class="linenos" data-linenos="1482 "></span></a>                        <span class="n">remainder</span> <span class="o">=</span> <span class="n">fn_sanitized</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">old_prefix_sanitized</span><span class="p">)</span> <span class="p">:]</span>
<a id="__codelineno-0-1483" name="__codelineno-0-1483"></a><a href="#__codelineno-0-1483"><span class="linenos" data-linenos="1483 "></span></a>
<a id="__codelineno-0-1484" name="__codelineno-0-1484"></a><a href="#__codelineno-0-1484"><span class="linenos" data-linenos="1484 "></span></a>                        <span class="c1"># Build the new filename</span>
<a id="__codelineno-0-1485" name="__codelineno-0-1485"></a><a href="#__codelineno-0-1485"><span class="linenos" data-linenos="1485 "></span></a>                        <span class="k">if</span> <span class="n">remainder</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1486" name="__codelineno-0-1486"></a><a href="#__codelineno-0-1486"><span class="linenos" data-linenos="1486 "></span></a>                            <span class="c1"># Remainder has separator, remove it to avoid double</span>
<a id="__codelineno-0-1487" name="__codelineno-0-1487"></a><a href="#__codelineno-0-1487"><span class="linenos" data-linenos="1487 "></span></a>                            <span class="c1"># slash</span>
<a id="__codelineno-0-1488" name="__codelineno-0-1488"></a><a href="#__codelineno-0-1488"><span class="linenos" data-linenos="1488 "></span></a>                            <span class="n">remainder</span> <span class="o">=</span> <span class="n">remainder</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-1489" name="__codelineno-0-1489"></a><a href="#__codelineno-0-1489"><span class="linenos" data-linenos="1489 "></span></a>                            <span class="c1"># Always add separator between prefix and remainder</span>
<a id="__codelineno-0-1490" name="__codelineno-0-1490"></a><a href="#__codelineno-0-1490"><span class="linenos" data-linenos="1490 "></span></a>                            <span class="k">if</span> <span class="n">new_prefix</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">new_prefix</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)):</span>
<a id="__codelineno-0-1491" name="__codelineno-0-1491"></a><a href="#__codelineno-0-1491"><span class="linenos" data-linenos="1491 "></span></a>                                <span class="n">new_fn</span> <span class="o">=</span> <span class="n">new_prefix</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">remainder</span>
<a id="__codelineno-0-1492" name="__codelineno-0-1492"></a><a href="#__codelineno-0-1492"><span class="linenos" data-linenos="1492 "></span></a>                            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1493" name="__codelineno-0-1493"></a><a href="#__codelineno-0-1493"><span class="linenos" data-linenos="1493 "></span></a>                                <span class="n">new_fn</span> <span class="o">=</span> <span class="n">new_prefix</span> <span class="o">+</span> <span class="n">remainder</span>
<a id="__codelineno-0-1494" name="__codelineno-0-1494"></a><a href="#__codelineno-0-1494"><span class="linenos" data-linenos="1494 "></span></a>                        <span class="k">elif</span> <span class="n">old_ends_with_sep</span><span class="p">:</span>
<a id="__codelineno-0-1495" name="__codelineno-0-1495"></a><a href="#__codelineno-0-1495"><span class="linenos" data-linenos="1495 "></span></a>                            <span class="c1"># Old prefix had separator, preserve it in the new one</span>
<a id="__codelineno-0-1496" name="__codelineno-0-1496"></a><a href="#__codelineno-0-1496"><span class="linenos" data-linenos="1496 "></span></a>                            <span class="k">if</span> <span class="n">new_prefix</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">new_prefix</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)):</span>
<a id="__codelineno-0-1497" name="__codelineno-0-1497"></a><a href="#__codelineno-0-1497"><span class="linenos" data-linenos="1497 "></span></a>                                <span class="n">new_fn</span> <span class="o">=</span> <span class="n">new_prefix</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">remainder</span>
<a id="__codelineno-0-1498" name="__codelineno-0-1498"></a><a href="#__codelineno-0-1498"><span class="linenos" data-linenos="1498 "></span></a>                            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1499" name="__codelineno-0-1499"></a><a href="#__codelineno-0-1499"><span class="linenos" data-linenos="1499 "></span></a>                                <span class="n">new_fn</span> <span class="o">=</span> <span class="n">new_prefix</span> <span class="o">+</span> <span class="n">remainder</span>
<a id="__codelineno-0-1500" name="__codelineno-0-1500"></a><a href="#__codelineno-0-1500"><span class="linenos" data-linenos="1500 "></span></a>                        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1501" name="__codelineno-0-1501"></a><a href="#__codelineno-0-1501"><span class="linenos" data-linenos="1501 "></span></a>                            <span class="c1"># No separator in old prefix, don&#39;t add one</span>
<a id="__codelineno-0-1502" name="__codelineno-0-1502"></a><a href="#__codelineno-0-1502"><span class="linenos" data-linenos="1502 "></span></a>                            <span class="n">new_fn</span> <span class="o">=</span> <span class="n">new_prefix</span> <span class="o">+</span> <span class="n">remainder</span>
<a id="__codelineno-0-1503" name="__codelineno-0-1503"></a><a href="#__codelineno-0-1503"><span class="linenos" data-linenos="1503 "></span></a>
<a id="__codelineno-0-1504" name="__codelineno-0-1504"></a><a href="#__codelineno-0-1504"><span class="linenos" data-linenos="1504 "></span></a>                        <span class="n">video</span><span class="o">.</span><span class="n">replace_filename</span><span class="p">(</span><span class="n">new_fn</span><span class="p">,</span> <span class="nb">open</span><span class="o">=</span><span class="n">open_videos</span><span class="p">)</span>
</code></pre></div>
            </details>
    </div>

</div><h3 id="framestrategy">FrameStrategy<a class="headerlink" href="#framestrategy" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.FrameStrategy" class="doc doc-heading">
            <code>sleap_io.model.matching.FrameStrategy</code>


<a href="#sleap_io.model.matching.FrameStrategy" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code>builtins.str</code>, <code>enum.Enum</code></p>



        <p>Strategies for handling frame merging.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;AUTO&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FrameStrategy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AUTO&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;auto&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;

  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;sleap_io.model.matching.FrameStrategy.AUTO&lt;/code&gt;)" href="#sleap_io.model.matching.FrameStrategy.AUTO">AUTO</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Automatic merging that preserves user labels over predictions when
they overlap.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;KEEP_ORIGINAL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FrameStrategy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KEEP_ORIGINAL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;keep_original&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;

  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;sleap_io.model.matching.FrameStrategy.KEEP_ORIGINAL&lt;/code&gt;)" href="#sleap_io.model.matching.FrameStrategy.KEEP_ORIGINAL">KEEP_ORIGINAL</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always keep instances from the original (base) frame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;KEEP_NEW&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FrameStrategy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KEEP_NEW&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;keep_new&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;

  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;sleap_io.model.matching.FrameStrategy.KEEP_NEW&lt;/code&gt;)" href="#sleap_io.model.matching.FrameStrategy.KEEP_NEW">KEEP_NEW</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always keep instances from the new (incoming) frame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;KEEP_BOTH&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FrameStrategy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KEEP_BOTH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;keep_both&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;

  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;sleap_io.model.matching.FrameStrategy.KEEP_BOTH&lt;/code&gt;)" href="#sleap_io.model.matching.FrameStrategy.KEEP_BOTH">KEEP_BOTH</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keep all instances from both frames without filtering.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;UPDATE_TRACKS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FrameStrategy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UPDATE_TRACKS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;update_tracks&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;

  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;sleap_io.model.matching.FrameStrategy.UPDATE_TRACKS&lt;/code&gt;)" href="#sleap_io.model.matching.FrameStrategy.UPDATE_TRACKS">UPDATE_TRACKS</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Update track assignments only without modifying poses.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;REPLACE_PREDICTIONS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FrameStrategy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;REPLACE_PREDICTIONS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;replace_predictions&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;

  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-class-attribute&quot;&gt;&lt;code&gt;class-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;sleap_io.model.matching.FrameStrategy.REPLACE_PREDICTIONS&lt;/code&gt;)" href="#sleap_io.model.matching.FrameStrategy.REPLACE_PREDICTIONS">REPLACE_PREDICTIONS</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keep user instances from base, remove base predictions,
add only predictions from incoming frame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>













              <details class="mkdocstrings-source">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-102" name="__codelineno-0-102"></a><a href="#__codelineno-0-102"><span class="linenos" data-linenos="102 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">FrameStrategy</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><a href="#__codelineno-0-103"><span class="linenos" data-linenos="103 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Strategies for handling frame merging.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><a href="#__codelineno-0-104"><span class="linenos" data-linenos="104 "></span></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><a href="#__codelineno-0-105"><span class="linenos" data-linenos="105 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><a href="#__codelineno-0-106"><span class="linenos" data-linenos="106 "></span></a><span class="sd">        AUTO: Automatic merging that preserves user labels over predictions when</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><a href="#__codelineno-0-107"><span class="linenos" data-linenos="107 "></span></a><span class="sd">            they overlap.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><a href="#__codelineno-0-108"><span class="linenos" data-linenos="108 "></span></a><span class="sd">        KEEP_ORIGINAL: Always keep instances from the original (base) frame.</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><a href="#__codelineno-0-109"><span class="linenos" data-linenos="109 "></span></a><span class="sd">        KEEP_NEW: Always keep instances from the new (incoming) frame.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><a href="#__codelineno-0-110"><span class="linenos" data-linenos="110 "></span></a><span class="sd">        KEEP_BOTH: Keep all instances from both frames without filtering.</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><a href="#__codelineno-0-111"><span class="linenos" data-linenos="111 "></span></a><span class="sd">        UPDATE_TRACKS: Update track assignments only without modifying poses.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><a href="#__codelineno-0-112"><span class="linenos" data-linenos="112 "></span></a><span class="sd">        REPLACE_PREDICTIONS: Keep user instances from base, remove base predictions,</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><a href="#__codelineno-0-113"><span class="linenos" data-linenos="113 "></span></a><span class="sd">            add only predictions from incoming frame.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><a href="#__codelineno-0-114"><span class="linenos" data-linenos="114 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><a href="#__codelineno-0-115"><span class="linenos" data-linenos="115 "></span></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><a href="#__codelineno-0-116"><span class="linenos" data-linenos="116 "></span></a>    <span class="n">AUTO</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><a href="#__codelineno-0-117"><span class="linenos" data-linenos="117 "></span></a>    <span class="n">KEEP_ORIGINAL</span> <span class="o">=</span> <span class="s2">&quot;keep_original&quot;</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><a href="#__codelineno-0-118"><span class="linenos" data-linenos="118 "></span></a>    <span class="n">KEEP_NEW</span> <span class="o">=</span> <span class="s2">&quot;keep_new&quot;</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><a href="#__codelineno-0-119"><span class="linenos" data-linenos="119 "></span></a>    <span class="n">KEEP_BOTH</span> <span class="o">=</span> <span class="s2">&quot;keep_both&quot;</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><a href="#__codelineno-0-120"><span class="linenos" data-linenos="120 "></span></a>    <span class="n">UPDATE_TRACKS</span> <span class="o">=</span> <span class="s2">&quot;update_tracks&quot;</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><a href="#__codelineno-0-121"><span class="linenos" data-linenos="121 "></span></a>    <span class="n">REPLACE_PREDICTIONS</span> <span class="o">=</span> <span class="s2">&quot;replace_predictions&quot;</span>
</code></pre></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.FrameStrategy.AUTO" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">AUTO</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FrameStrategy</span><span class="o">.</span><span class="n">AUTO</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="o">&gt;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.FrameStrategy.AUTO" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Strategies for handling frame merging.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.AUTO.AUTO">AUTO</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Automatic merging that preserves user labels over predictions when
they overlap.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.AUTO.KEEP_ORIGINAL">KEEP_ORIGINAL</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always keep instances from the original (base) frame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.AUTO.KEEP_NEW">KEEP_NEW</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always keep instances from the new (incoming) frame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.AUTO.KEEP_BOTH">KEEP_BOTH</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keep all instances from both frames without filtering.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.AUTO.UPDATE_TRACKS">UPDATE_TRACKS</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Update track assignments only without modifying poses.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.AUTO.REPLACE_PREDICTIONS">REPLACE_PREDICTIONS</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keep user instances from base, remove base predictions,
add only predictions from incoming frame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.FrameStrategy.KEEP_BOTH" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">KEEP_BOTH</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FrameStrategy</span><span class="o">.</span><span class="n">KEEP_BOTH</span><span class="p">:</span> <span class="s1">&#39;keep_both&#39;</span><span class="o">&gt;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.FrameStrategy.KEEP_BOTH" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Strategies for handling frame merging.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_BOTH.AUTO">AUTO</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Automatic merging that preserves user labels over predictions when
they overlap.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_BOTH.KEEP_ORIGINAL">KEEP_ORIGINAL</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always keep instances from the original (base) frame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_BOTH.KEEP_NEW">KEEP_NEW</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always keep instances from the new (incoming) frame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_BOTH.KEEP_BOTH">KEEP_BOTH</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keep all instances from both frames without filtering.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_BOTH.UPDATE_TRACKS">UPDATE_TRACKS</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Update track assignments only without modifying poses.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_BOTH.REPLACE_PREDICTIONS">REPLACE_PREDICTIONS</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keep user instances from base, remove base predictions,
add only predictions from incoming frame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.FrameStrategy.KEEP_NEW" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">KEEP_NEW</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FrameStrategy</span><span class="o">.</span><span class="n">KEEP_NEW</span><span class="p">:</span> <span class="s1">&#39;keep_new&#39;</span><span class="o">&gt;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.FrameStrategy.KEEP_NEW" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Strategies for handling frame merging.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_NEW.AUTO">AUTO</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Automatic merging that preserves user labels over predictions when
they overlap.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_NEW.KEEP_ORIGINAL">KEEP_ORIGINAL</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always keep instances from the original (base) frame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_NEW.KEEP_NEW">KEEP_NEW</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always keep instances from the new (incoming) frame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_NEW.KEEP_BOTH">KEEP_BOTH</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keep all instances from both frames without filtering.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_NEW.UPDATE_TRACKS">UPDATE_TRACKS</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Update track assignments only without modifying poses.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_NEW.REPLACE_PREDICTIONS">REPLACE_PREDICTIONS</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keep user instances from base, remove base predictions,
add only predictions from incoming frame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.FrameStrategy.KEEP_ORIGINAL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">KEEP_ORIGINAL</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FrameStrategy</span><span class="o">.</span><span class="n">KEEP_ORIGINAL</span><span class="p">:</span> <span class="s1">&#39;keep_original&#39;</span><span class="o">&gt;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.FrameStrategy.KEEP_ORIGINAL" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Strategies for handling frame merging.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_ORIGINAL.AUTO">AUTO</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Automatic merging that preserves user labels over predictions when
they overlap.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_ORIGINAL.KEEP_ORIGINAL">KEEP_ORIGINAL</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always keep instances from the original (base) frame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_ORIGINAL.KEEP_NEW">KEEP_NEW</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always keep instances from the new (incoming) frame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_ORIGINAL.KEEP_BOTH">KEEP_BOTH</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keep all instances from both frames without filtering.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_ORIGINAL.UPDATE_TRACKS">UPDATE_TRACKS</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Update track assignments only without modifying poses.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_ORIGINAL.REPLACE_PREDICTIONS">REPLACE_PREDICTIONS</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keep user instances from base, remove base predictions,
add only predictions from incoming frame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.FrameStrategy.REPLACE_PREDICTIONS" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">REPLACE_PREDICTIONS</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FrameStrategy</span><span class="o">.</span><span class="n">REPLACE_PREDICTIONS</span><span class="p">:</span> <span class="s1">&#39;replace_predictions&#39;</span><span class="o">&gt;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.FrameStrategy.REPLACE_PREDICTIONS" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Strategies for handling frame merging.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.REPLACE_PREDICTIONS.AUTO">AUTO</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Automatic merging that preserves user labels over predictions when
they overlap.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.REPLACE_PREDICTIONS.KEEP_ORIGINAL">KEEP_ORIGINAL</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always keep instances from the original (base) frame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.REPLACE_PREDICTIONS.KEEP_NEW">KEEP_NEW</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always keep instances from the new (incoming) frame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.REPLACE_PREDICTIONS.KEEP_BOTH">KEEP_BOTH</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keep all instances from both frames without filtering.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.REPLACE_PREDICTIONS.UPDATE_TRACKS">UPDATE_TRACKS</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Update track assignments only without modifying poses.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.REPLACE_PREDICTIONS.REPLACE_PREDICTIONS">REPLACE_PREDICTIONS</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keep user instances from base, remove base predictions,
add only predictions from incoming frame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.FrameStrategy.UPDATE_TRACKS" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">UPDATE_TRACKS</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FrameStrategy</span><span class="o">.</span><span class="n">UPDATE_TRACKS</span><span class="p">:</span> <span class="s1">&#39;update_tracks&#39;</span><span class="o">&gt;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.FrameStrategy.UPDATE_TRACKS" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Strategies for handling frame merging.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.UPDATE_TRACKS.AUTO">AUTO</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Automatic merging that preserves user labels over predictions when
they overlap.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.UPDATE_TRACKS.KEEP_ORIGINAL">KEEP_ORIGINAL</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always keep instances from the original (base) frame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.UPDATE_TRACKS.KEEP_NEW">KEEP_NEW</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always keep instances from the new (incoming) frame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.UPDATE_TRACKS.KEEP_BOTH">KEEP_BOTH</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keep all instances from both frames without filtering.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.UPDATE_TRACKS.UPDATE_TRACKS">UPDATE_TRACKS</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Update track assignments only without modifying poses.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.UPDATE_TRACKS.REPLACE_PREDICTIONS">REPLACE_PREDICTIONS</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keep user instances from base, remove base predictions,
add only predictions from incoming frame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.FrameStrategy.__doc__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__doc__</span> <span class="o">=</span> <span class="s1">&#39;Strategies for handling frame merging.</span><span class="se">\n\n</span><span class="s1">Attributes:</span><span class="se">\n</span><span class="s1">    AUTO: Automatic merging that preserves user labels over predictions when</span><span class="se">\n</span><span class="s1">        they overlap.</span><span class="se">\n</span><span class="s1">    KEEP_ORIGINAL: Always keep instances from the original (base) frame.</span><span class="se">\n</span><span class="s1">    KEEP_NEW: Always keep instances from the new (incoming) frame.</span><span class="se">\n</span><span class="s1">    KEEP_BOTH: Keep all instances from both frames without filtering.</span><span class="se">\n</span><span class="s1">    UPDATE_TRACKS: Update track assignments only without modifying poses.</span><span class="se">\n</span><span class="s1">    REPLACE_PREDICTIONS: Keep user instances from base, remove base predictions,</span><span class="se">\n</span><span class="s1">        add only predictions from incoming frame.</span><span class="se">\n</span><span class="s1">&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.FrameStrategy.__doc__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to 'utf-8'.
errors defaults to 'strict'.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.FrameStrategy.__module__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__module__</span> <span class="o">=</span> <span class="s1">&#39;sleap_io.model.matching&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.FrameStrategy.__module__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to 'utf-8'.
errors defaults to 'strict'.</p>

    </div>

</div>






  </div>

    </div>

</div><h3 id="videomatcher">VideoMatcher<a class="headerlink" href="#videomatcher" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.VideoMatcher" class="doc doc-heading">
            <code>sleap_io.model.matching.VideoMatcher</code>


<a href="#sleap_io.model.matching.VideoMatcher" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">



        <p>Matcher for comparing and matching videos.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.method">method</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matching method to use. Can be a VideoMatchMethod enum value
or a string that will be converted to the enum. Default is AUTO.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.strict">strict</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use strict path matching for the PATH method.
When True, paths must be exactly identical. When False, paths
are normalized before comparison. Only used when method is PATH.
Default is False.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.content_frames">content_frames</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum number of matching frames required for pose/image
matching to confirm a match. If fewer common frames exist, requires
all of them to match. Default 3.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.compare_predictions">compare_predictions</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to include predicted instances in pose matching.
"auto" (default): Include only if video has 100% predictions (no user
instances). True: Always include predictions. False: Never include
predictions (user instances only).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.compare_images">compare_images</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to compare frame images via pixel similarity.
Expensive operation requiring frame decoding. Default False.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.image_similarity_threshold">image_similarity_threshold</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum mean pixel difference (0-1 scale,
normalized by 255) for images to be considered matching.
Only used when compare_images=True. Default 0.05 (~13/255 pixels).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>For AUTO method, use find_match() when matching against a list of
candidates. The match() method for AUTO uses a simplified pairwise
check that doesn't include the full leaf-uniqueness algorithm.</p>
</details>











<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__eq__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.VideoMatcher.__eq__&lt;/code&gt;)" href="#sleap_io.model.matching.VideoMatcher.__eq__">__eq__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class VideoMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;VideoMatchMethod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AUTO&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;auto&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content_frames&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compare_predictions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;auto&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compare_images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image_similarity_threshold&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.VideoMatcher.__init__&lt;/code&gt;)" href="#sleap_io.model.matching.VideoMatcher.__init__">__init__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class VideoMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;__replace__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;changes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.VideoMatcher.__replace__&lt;/code&gt;)" href="#sleap_io.model.matching.VideoMatcher.__replace__">__replace__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class VideoMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__repr__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.VideoMatcher.__repr__&lt;/code&gt;)" href="#sleap_io.model.matching.VideoMatcher.__repr__">__repr__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class VideoMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__setattr__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.VideoMatcher.__setattr__&lt;/code&gt;)" href="#sleap_io.model.matching.VideoMatcher.__setattr__">__setattr__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class VideoMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;find_match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;incoming&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;candidates&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels_incoming&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels_base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.VideoMatcher.find_match&lt;/code&gt;)" href="#sleap_io.model.matching.VideoMatcher.find_match">find_match</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Find a matching video from candidates using the configured method.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;k&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;video1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;video2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.VideoMatcher.match&lt;/code&gt;)" href="#sleap_io.model.matching.VideoMatcher.match">match</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Check if two videos match according to the configured method.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



              <details class="mkdocstrings-source">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-793" name="__codelineno-0-793"></a><a href="#__codelineno-0-793"><span class="linenos" data-linenos=" 793 "></span></a><span class="nd">@attrs</span><span class="o">.</span><span class="n">define</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><a href="#__codelineno-0-794"><span class="linenos" data-linenos=" 794 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">VideoMatcher</span><span class="p">:</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><a href="#__codelineno-0-795"><span class="linenos" data-linenos=" 795 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Matcher for comparing and matching videos.</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a><a href="#__codelineno-0-796"><span class="linenos" data-linenos=" 796 "></span></a>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a><a href="#__codelineno-0-797"><span class="linenos" data-linenos=" 797 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a><a href="#__codelineno-0-798"><span class="linenos" data-linenos=" 798 "></span></a><span class="sd">        method: The matching method to use. Can be a VideoMatchMethod enum value</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a><a href="#__codelineno-0-799"><span class="linenos" data-linenos=" 799 "></span></a><span class="sd">            or a string that will be converted to the enum. Default is AUTO.</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a><a href="#__codelineno-0-800"><span class="linenos" data-linenos=" 800 "></span></a><span class="sd">        strict: Whether to use strict path matching for the PATH method.</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a><a href="#__codelineno-0-801"><span class="linenos" data-linenos=" 801 "></span></a><span class="sd">            When True, paths must be exactly identical. When False, paths</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a><a href="#__codelineno-0-802"><span class="linenos" data-linenos=" 802 "></span></a><span class="sd">            are normalized before comparison. Only used when method is PATH.</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a><a href="#__codelineno-0-803"><span class="linenos" data-linenos=" 803 "></span></a><span class="sd">            Default is False.</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a><a href="#__codelineno-0-804"><span class="linenos" data-linenos=" 804 "></span></a><span class="sd">        content_frames: Minimum number of matching frames required for pose/image</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a><a href="#__codelineno-0-805"><span class="linenos" data-linenos=" 805 "></span></a><span class="sd">            matching to confirm a match. If fewer common frames exist, requires</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a><a href="#__codelineno-0-806"><span class="linenos" data-linenos=" 806 "></span></a><span class="sd">            all of them to match. Default 3.</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a><a href="#__codelineno-0-807"><span class="linenos" data-linenos=" 807 "></span></a><span class="sd">        compare_predictions: Whether to include predicted instances in pose matching.</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a><a href="#__codelineno-0-808"><span class="linenos" data-linenos=" 808 "></span></a><span class="sd">            &quot;auto&quot; (default): Include only if video has 100% predictions (no user</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a><a href="#__codelineno-0-809"><span class="linenos" data-linenos=" 809 "></span></a><span class="sd">            instances). True: Always include predictions. False: Never include</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a><a href="#__codelineno-0-810"><span class="linenos" data-linenos=" 810 "></span></a><span class="sd">            predictions (user instances only).</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a><a href="#__codelineno-0-811"><span class="linenos" data-linenos=" 811 "></span></a><span class="sd">        compare_images: Whether to compare frame images via pixel similarity.</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a><a href="#__codelineno-0-812"><span class="linenos" data-linenos=" 812 "></span></a><span class="sd">            Expensive operation requiring frame decoding. Default False.</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><a href="#__codelineno-0-813"><span class="linenos" data-linenos=" 813 "></span></a><span class="sd">        image_similarity_threshold: Maximum mean pixel difference (0-1 scale,</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><a href="#__codelineno-0-814"><span class="linenos" data-linenos=" 814 "></span></a><span class="sd">            normalized by 255) for images to be considered matching.</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><a href="#__codelineno-0-815"><span class="linenos" data-linenos=" 815 "></span></a><span class="sd">            Only used when compare_images=True. Default 0.05 (~13/255 pixels).</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><a href="#__codelineno-0-816"><span class="linenos" data-linenos=" 816 "></span></a>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a><a href="#__codelineno-0-817"><span class="linenos" data-linenos=" 817 "></span></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><a href="#__codelineno-0-818"><span class="linenos" data-linenos=" 818 "></span></a><span class="sd">        For AUTO method, use find_match() when matching against a list of</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><a href="#__codelineno-0-819"><span class="linenos" data-linenos=" 819 "></span></a><span class="sd">        candidates. The match() method for AUTO uses a simplified pairwise</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a><a href="#__codelineno-0-820"><span class="linenos" data-linenos=" 820 "></span></a><span class="sd">        check that doesn&#39;t include the full leaf-uniqueness algorithm.</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><a href="#__codelineno-0-821"><span class="linenos" data-linenos=" 821 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><a href="#__codelineno-0-822"><span class="linenos" data-linenos=" 822 "></span></a>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><a href="#__codelineno-0-823"><span class="linenos" data-linenos=" 823 "></span></a>    <span class="n">method</span><span class="p">:</span> <span class="n">VideoMatchMethod</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">field</span><span class="p">(</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a><a href="#__codelineno-0-824"><span class="linenos" data-linenos=" 824 "></span></a>        <span class="n">default</span><span class="o">=</span><span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">AUTO</span><span class="p">,</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><a href="#__codelineno-0-825"><span class="linenos" data-linenos=" 825 "></span></a>        <span class="n">converter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">VideoMatchMethod</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a><a href="#__codelineno-0-826"><span class="linenos" data-linenos=" 826 "></span></a>    <span class="p">)</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><a href="#__codelineno-0-827"><span class="linenos" data-linenos=" 827 "></span></a>    <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><a href="#__codelineno-0-828"><span class="linenos" data-linenos=" 828 "></span></a>    <span class="n">content_frames</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><a href="#__codelineno-0-829"><span class="linenos" data-linenos=" 829 "></span></a>    <span class="n">compare_predictions</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><a href="#__codelineno-0-830"><span class="linenos" data-linenos=" 830 "></span></a>    <span class="n">compare_images</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><a href="#__codelineno-0-831"><span class="linenos" data-linenos=" 831 "></span></a>    <span class="n">image_similarity_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a><a href="#__codelineno-0-832"><span class="linenos" data-linenos=" 832 "></span></a>    <span class="n">_frame_cache</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><a href="#__codelineno-0-833"><span class="linenos" data-linenos=" 833 "></span></a>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><a href="#__codelineno-0-834"><span class="linenos" data-linenos=" 834 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_cached_frame_instances</span><span class="p">(</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a><a href="#__codelineno-0-835"><span class="linenos" data-linenos=" 835 "></span></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><a href="#__codelineno-0-836"><span class="linenos" data-linenos=" 836 "></span></a>        <span class="n">labels</span><span class="p">:</span> <span class="s2">&quot;Labels&quot;</span><span class="p">,</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><a href="#__codelineno-0-837"><span class="linenos" data-linenos=" 837 "></span></a>        <span class="n">video</span><span class="p">:</span> <span class="s2">&quot;Video&quot;</span><span class="p">,</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><a href="#__codelineno-0-838"><span class="linenos" data-linenos=" 838 "></span></a>        <span class="n">include_predictions</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><a href="#__codelineno-0-839"><span class="linenos" data-linenos=" 839 "></span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Instance&quot;</span><span class="p">]]:</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><a href="#__codelineno-0-840"><span class="linenos" data-linenos=" 840 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get frame instances with caching for performance.</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><a href="#__codelineno-0-841"><span class="linenos" data-linenos=" 841 "></span></a>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><a href="#__codelineno-0-842"><span class="linenos" data-linenos=" 842 "></span></a><span class="sd">        Caches the result to avoid recomputing for the same video multiple times</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><a href="#__codelineno-0-843"><span class="linenos" data-linenos=" 843 "></span></a><span class="sd">        during merge operations.</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><a href="#__codelineno-0-844"><span class="linenos" data-linenos=" 844 "></span></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a><a href="#__codelineno-0-845"><span class="linenos" data-linenos=" 845 "></span></a>        <span class="n">cache_key</span> <span class="o">=</span> <span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">video</span><span class="p">),</span> <span class="n">include_predictions</span><span class="p">)</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><a href="#__codelineno-0-846"><span class="linenos" data-linenos=" 846 "></span></a>        <span class="k">if</span> <span class="n">cache_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frame_cache</span><span class="p">:</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a><a href="#__codelineno-0-847"><span class="linenos" data-linenos=" 847 "></span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_frame_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">_get_frame_instances</span><span class="p">(</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a><a href="#__codelineno-0-848"><span class="linenos" data-linenos=" 848 "></span></a>                <span class="n">labels</span><span class="p">,</span> <span class="n">video</span><span class="p">,</span> <span class="n">include_predictions</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a><a href="#__codelineno-0-849"><span class="linenos" data-linenos=" 849 "></span></a>            <span class="p">)</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a><a href="#__codelineno-0-850"><span class="linenos" data-linenos=" 850 "></span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frame_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a><a href="#__codelineno-0-851"><span class="linenos" data-linenos=" 851 "></span></a>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a><a href="#__codelineno-0-852"><span class="linenos" data-linenos=" 852 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">video1</span><span class="p">:</span> <span class="n">Video</span><span class="p">,</span> <span class="n">video2</span><span class="p">:</span> <span class="n">Video</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a><a href="#__codelineno-0-853"><span class="linenos" data-linenos=" 853 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two videos match according to the configured method.</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a><a href="#__codelineno-0-854"><span class="linenos" data-linenos=" 854 "></span></a>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a><a href="#__codelineno-0-855"><span class="linenos" data-linenos=" 855 "></span></a><span class="sd">        For AUTO method, this performs pairwise checks (file identity, path match).</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><a href="#__codelineno-0-856"><span class="linenos" data-linenos=" 856 "></span></a><span class="sd">        For full AUTO matching with leaf-uniqueness, use find_match() instead.</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a><a href="#__codelineno-0-857"><span class="linenos" data-linenos=" 857 "></span></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><a href="#__codelineno-0-858"><span class="linenos" data-linenos=" 858 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">AUTO</span><span class="p">:</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><a href="#__codelineno-0-859"><span class="linenos" data-linenos=" 859 "></span></a>            <span class="c1"># Pairwise AUTO: rejection checks + definitive identity + path match</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a><a href="#__codelineno-0-860"><span class="linenos" data-linenos=" 860 "></span></a>            <span class="c1"># (Leaf-uniqueness requires full candidate list - use find_match())</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><a href="#__codelineno-0-861"><span class="linenos" data-linenos=" 861 "></span></a>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><a href="#__codelineno-0-862"><span class="linenos" data-linenos=" 862 "></span></a>            <span class="c1"># Rejection: incompatible shapes</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a><a href="#__codelineno-0-863"><span class="linenos" data-linenos=" 863 "></span></a>            <span class="k">if</span> <span class="n">shapes_compatible</span><span class="p">(</span><span class="n">video1</span><span class="p">,</span> <span class="n">video2</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><a href="#__codelineno-0-864"><span class="linenos" data-linenos=" 864 "></span></a>                <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a><a href="#__codelineno-0-865"><span class="linenos" data-linenos=" 865 "></span></a>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a><a href="#__codelineno-0-866"><span class="linenos" data-linenos=" 866 "></span></a>            <span class="c1"># Rejection: conflicting provenance</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a><a href="#__codelineno-0-867"><span class="linenos" data-linenos=" 867 "></span></a>            <span class="k">if</span> <span class="n">original_videos_conflict</span><span class="p">(</span><span class="n">video1</span><span class="p">,</span> <span class="n">video2</span><span class="p">):</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a><a href="#__codelineno-0-868"><span class="linenos" data-linenos=" 868 "></span></a>                <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><a href="#__codelineno-0-869"><span class="linenos" data-linenos=" 869 "></span></a>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><a href="#__codelineno-0-870"><span class="linenos" data-linenos=" 870 "></span></a>            <span class="c1"># Definitive: same file identity</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a><a href="#__codelineno-0-871"><span class="linenos" data-linenos=" 871 "></span></a>            <span class="k">if</span> <span class="n">is_same_file</span><span class="p">(</span><span class="n">video1</span><span class="p">,</span> <span class="n">video2</span><span class="p">):</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><a href="#__codelineno-0-872"><span class="linenos" data-linenos=" 872 "></span></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><a href="#__codelineno-0-873"><span class="linenos" data-linenos=" 873 "></span></a>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a><a href="#__codelineno-0-874"><span class="linenos" data-linenos=" 874 "></span></a>            <span class="c1"># String: strict path match</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><a href="#__codelineno-0-875"><span class="linenos" data-linenos=" 875 "></span></a>            <span class="k">if</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">video2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><a href="#__codelineno-0-876"><span class="linenos" data-linenos=" 876 "></span></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><a href="#__codelineno-0-877"><span class="linenos" data-linenos=" 877 "></span></a>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a><a href="#__codelineno-0-878"><span class="linenos" data-linenos=" 878 "></span></a>            <span class="c1"># String: basename match (for pairwise, this is the fallback)</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a><a href="#__codelineno-0-879"><span class="linenos" data-linenos=" 879 "></span></a>            <span class="k">if</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">video2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a><a href="#__codelineno-0-880"><span class="linenos" data-linenos=" 880 "></span></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><a href="#__codelineno-0-881"><span class="linenos" data-linenos=" 881 "></span></a>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a><a href="#__codelineno-0-882"><span class="linenos" data-linenos=" 882 "></span></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a><a href="#__codelineno-0-883"><span class="linenos" data-linenos=" 883 "></span></a>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a><a href="#__codelineno-0-884"><span class="linenos" data-linenos=" 884 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">PATH</span><span class="p">:</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a><a href="#__codelineno-0-885"><span class="linenos" data-linenos=" 885 "></span></a>            <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">video2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">)</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><a href="#__codelineno-0-886"><span class="linenos" data-linenos=" 886 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">BASENAME</span><span class="p">:</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a><a href="#__codelineno-0-887"><span class="linenos" data-linenos=" 887 "></span></a>            <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">video2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a><a href="#__codelineno-0-888"><span class="linenos" data-linenos=" 888 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">CONTENT</span><span class="p">:</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a><a href="#__codelineno-0-889"><span class="linenos" data-linenos=" 889 "></span></a>            <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_content</span><span class="p">(</span><span class="n">video2</span><span class="p">)</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a><a href="#__codelineno-0-890"><span class="linenos" data-linenos=" 890 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">IMAGE_DEDUP</span><span class="p">:</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a><a href="#__codelineno-0-891"><span class="linenos" data-linenos=" 891 "></span></a>            <span class="c1"># Match ImageVideo instances with overlapping images (ImageVideo only)</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a><a href="#__codelineno-0-892"><span class="linenos" data-linenos=" 892 "></span></a>            <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">has_overlapping_images</span><span class="p">(</span><span class="n">video2</span><span class="p">)</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a><a href="#__codelineno-0-893"><span class="linenos" data-linenos=" 893 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">SHAPE</span><span class="p">:</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a><a href="#__codelineno-0-894"><span class="linenos" data-linenos=" 894 "></span></a>            <span class="c1"># Match videos by shape only (height, width, channels)</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a><a href="#__codelineno-0-895"><span class="linenos" data-linenos=" 895 "></span></a>            <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_shape</span><span class="p">(</span><span class="n">video2</span><span class="p">)</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a><a href="#__codelineno-0-896"><span class="linenos" data-linenos=" 896 "></span></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a><a href="#__codelineno-0-897"><span class="linenos" data-linenos=" 897 "></span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown video match method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a><a href="#__codelineno-0-898"><span class="linenos" data-linenos=" 898 "></span></a>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a><a href="#__codelineno-0-899"><span class="linenos" data-linenos=" 899 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">find_match</span><span class="p">(</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a><a href="#__codelineno-0-900"><span class="linenos" data-linenos=" 900 "></span></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a><a href="#__codelineno-0-901"><span class="linenos" data-linenos=" 901 "></span></a>        <span class="n">incoming</span><span class="p">:</span> <span class="n">Video</span><span class="p">,</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><a href="#__codelineno-0-902"><span class="linenos" data-linenos=" 902 "></span></a>        <span class="n">candidates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Video</span><span class="p">],</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><a href="#__codelineno-0-903"><span class="linenos" data-linenos=" 903 "></span></a>        <span class="n">labels_incoming</span><span class="p">:</span> <span class="s2">&quot;Labels | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a><a href="#__codelineno-0-904"><span class="linenos" data-linenos=" 904 "></span></a>        <span class="n">labels_base</span><span class="p">:</span> <span class="s2">&quot;Labels | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a><a href="#__codelineno-0-905"><span class="linenos" data-linenos=" 905 "></span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Video</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><a href="#__codelineno-0-906"><span class="linenos" data-linenos=" 906 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Find a matching video from candidates using the configured method.</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a><a href="#__codelineno-0-907"><span class="linenos" data-linenos=" 907 "></span></a>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a><a href="#__codelineno-0-908"><span class="linenos" data-linenos=" 908 "></span></a><span class="sd">        This is the preferred method for AUTO matching as it implements the</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a><a href="#__codelineno-0-909"><span class="linenos" data-linenos=" 909 "></span></a><span class="sd">        full safe matching cascade including leaf-uniqueness disambiguation.</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a><a href="#__codelineno-0-910"><span class="linenos" data-linenos=" 910 "></span></a>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a><a href="#__codelineno-0-911"><span class="linenos" data-linenos=" 911 "></span></a><span class="sd">        Args:</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a><a href="#__codelineno-0-912"><span class="linenos" data-linenos=" 912 "></span></a><span class="sd">            incoming: The video to find a match for.</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><a href="#__codelineno-0-913"><span class="linenos" data-linenos=" 913 "></span></a><span class="sd">            candidates: List of existing videos to search for matches.</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a><a href="#__codelineno-0-914"><span class="linenos" data-linenos=" 914 "></span></a><span class="sd">            labels_incoming: Labels object containing the incoming video&#39;s</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><a href="#__codelineno-0-915"><span class="linenos" data-linenos=" 915 "></span></a><span class="sd">                annotations. Used for pose-based matching in AUTO mode.</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><a href="#__codelineno-0-916"><span class="linenos" data-linenos=" 916 "></span></a><span class="sd">            labels_base: Labels object containing the candidates&#39; annotations.</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><a href="#__codelineno-0-917"><span class="linenos" data-linenos=" 917 "></span></a><span class="sd">                Used for pose-based matching in AUTO mode.</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a><a href="#__codelineno-0-918"><span class="linenos" data-linenos=" 918 "></span></a>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><a href="#__codelineno-0-919"><span class="linenos" data-linenos=" 919 "></span></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><a href="#__codelineno-0-920"><span class="linenos" data-linenos=" 920 "></span></a><span class="sd">            The matched video, or None if no match found.</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><a href="#__codelineno-0-921"><span class="linenos" data-linenos=" 921 "></span></a>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><a href="#__codelineno-0-922"><span class="linenos" data-linenos=" 922 "></span></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><a href="#__codelineno-0-923"><span class="linenos" data-linenos=" 923 "></span></a><span class="sd">            For AUTO method, implements the safe matching cascade:</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><a href="#__codelineno-0-924"><span class="linenos" data-linenos=" 924 "></span></a><span class="sd">            1. Shape rejection (filter candidates)</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><a href="#__codelineno-0-925"><span class="linenos" data-linenos=" 925 "></span></a><span class="sd">            2. original_video conflict rejection (filter candidates)</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><a href="#__codelineno-0-926"><span class="linenos" data-linenos=" 926 "></span></a><span class="sd">            3. Definitive file identity (is_same_file)</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><a href="#__codelineno-0-927"><span class="linenos" data-linenos=" 927 "></span></a><span class="sd">            4. Strict path match</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><a href="#__codelineno-0-928"><span class="linenos" data-linenos=" 928 "></span></a><span class="sd">            5. Leaf uniqueness matching at increasing depths</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><a href="#__codelineno-0-929"><span class="linenos" data-linenos=" 929 "></span></a><span class="sd">            6. Pose-based matching (if labels provided)</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><a href="#__codelineno-0-930"><span class="linenos" data-linenos=" 930 "></span></a><span class="sd">            7. Image-based matching (if compare_images=True)</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><a href="#__codelineno-0-931"><span class="linenos" data-linenos=" 931 "></span></a>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><a href="#__codelineno-0-932"><span class="linenos" data-linenos=" 932 "></span></a><span class="sd">            Shape is for REJECTION only - compatible shapes don&#39;t imply a match.</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><a href="#__codelineno-0-933"><span class="linenos" data-linenos=" 933 "></span></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><a href="#__codelineno-0-934"><span class="linenos" data-linenos=" 934 "></span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><a href="#__codelineno-0-935"><span class="linenos" data-linenos=" 935 "></span></a>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><a href="#__codelineno-0-936"><span class="linenos" data-linenos=" 936 "></span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.io.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">sanitize_filename</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><a href="#__codelineno-0-937"><span class="linenos" data-linenos=" 937 "></span></a>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><a href="#__codelineno-0-938"><span class="linenos" data-linenos=" 938 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">AUTO</span><span class="p">:</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><a href="#__codelineno-0-939"><span class="linenos" data-linenos=" 939 "></span></a>            <span class="c1"># Build list of viable candidates (not rejected by shape/provenance)</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><a href="#__codelineno-0-940"><span class="linenos" data-linenos=" 940 "></span></a>            <span class="n">viable</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><a href="#__codelineno-0-941"><span class="linenos" data-linenos=" 941 "></span></a>            <span class="k">for</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><a href="#__codelineno-0-942"><span class="linenos" data-linenos=" 942 "></span></a>                <span class="c1"># REJECTION CHECK 1: Shape compatibility</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><a href="#__codelineno-0-943"><span class="linenos" data-linenos=" 943 "></span></a>                <span class="n">shape_compat</span> <span class="o">=</span> <span class="n">shapes_compatible</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">incoming</span><span class="p">)</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><a href="#__codelineno-0-944"><span class="linenos" data-linenos=" 944 "></span></a>                <span class="k">if</span> <span class="n">shape_compat</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><a href="#__codelineno-0-945"><span class="linenos" data-linenos=" 945 "></span></a>                    <span class="c1"># Definitely incompatible shapes - skip</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a><a href="#__codelineno-0-946"><span class="linenos" data-linenos=" 946 "></span></a>                    <span class="k">continue</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><a href="#__codelineno-0-947"><span class="linenos" data-linenos=" 947 "></span></a>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a><a href="#__codelineno-0-948"><span class="linenos" data-linenos=" 948 "></span></a>                <span class="c1"># REJECTION CHECK 2: original_video conflict</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><a href="#__codelineno-0-949"><span class="linenos" data-linenos=" 949 "></span></a>                <span class="k">if</span> <span class="n">original_videos_conflict</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">incoming</span><span class="p">):</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a><a href="#__codelineno-0-950"><span class="linenos" data-linenos=" 950 "></span></a>                    <span class="c1"># Both have provenance pointing to different files - skip</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a><a href="#__codelineno-0-951"><span class="linenos" data-linenos=" 951 "></span></a>                    <span class="k">continue</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a><a href="#__codelineno-0-952"><span class="linenos" data-linenos=" 952 "></span></a>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a><a href="#__codelineno-0-953"><span class="linenos" data-linenos=" 953 "></span></a>                <span class="n">viable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate</span><span class="p">)</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a><a href="#__codelineno-0-954"><span class="linenos" data-linenos=" 954 "></span></a>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a><a href="#__codelineno-0-955"><span class="linenos" data-linenos=" 955 "></span></a>            <span class="c1"># DEFINITIVE CHECK: File identity (handles source_video chains)</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a><a href="#__codelineno-0-956"><span class="linenos" data-linenos=" 956 "></span></a>            <span class="k">for</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="n">viable</span><span class="p">:</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a><a href="#__codelineno-0-957"><span class="linenos" data-linenos=" 957 "></span></a>                <span class="k">if</span> <span class="n">is_same_file</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">incoming</span><span class="p">):</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a><a href="#__codelineno-0-958"><span class="linenos" data-linenos=" 958 "></span></a>                    <span class="k">return</span> <span class="n">candidate</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><a href="#__codelineno-0-959"><span class="linenos" data-linenos=" 959 "></span></a>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a><a href="#__codelineno-0-960"><span class="linenos" data-linenos=" 960 "></span></a>            <span class="c1"># STRING CHECK: Full path match</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a><a href="#__codelineno-0-961"><span class="linenos" data-linenos=" 961 "></span></a>            <span class="k">for</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="n">viable</span><span class="p">:</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><a href="#__codelineno-0-962"><span class="linenos" data-linenos=" 962 "></span></a>                <span class="k">if</span> <span class="n">candidate</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">incoming</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a><a href="#__codelineno-0-963"><span class="linenos" data-linenos=" 963 "></span></a>                    <span class="k">return</span> <span class="n">candidate</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a><a href="#__codelineno-0-964"><span class="linenos" data-linenos=" 964 "></span></a>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a><a href="#__codelineno-0-965"><span class="linenos" data-linenos=" 965 "></span></a>            <span class="c1"># STRING CHECK: Leaf path uniqueness</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a><a href="#__codelineno-0-966"><span class="linenos" data-linenos=" 966 "></span></a>            <span class="c1"># Match paths by comparing suffixes at increasing depths</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a><a href="#__codelineno-0-967"><span class="linenos" data-linenos=" 967 "></span></a>            <span class="k">if</span> <span class="n">viable</span><span class="p">:</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a><a href="#__codelineno-0-968"><span class="linenos" data-linenos=" 968 "></span></a>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a><a href="#__codelineno-0-969"><span class="linenos" data-linenos=" 969 "></span></a>                <span class="k">def</span><span class="w"> </span><span class="nf">get_path_parts</span><span class="p">(</span><span class="n">video</span><span class="p">:</span> <span class="n">Video</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a><a href="#__codelineno-0-970"><span class="linenos" data-linenos=" 970 "></span></a><span class="w">                    </span><span class="sd">&quot;&quot;&quot;Get path parts for comparison, using root video for embedded.&quot;&quot;&quot;</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a><a href="#__codelineno-0-971"><span class="linenos" data-linenos=" 971 "></span></a>                    <span class="n">root</span> <span class="o">=</span> <span class="n">_get_root_video</span><span class="p">(</span><span class="n">video</span><span class="p">)</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a><a href="#__codelineno-0-972"><span class="linenos" data-linenos=" 972 "></span></a>                    <span class="n">fn</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a><a href="#__codelineno-0-973"><span class="linenos" data-linenos=" 973 "></span></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a><a href="#__codelineno-0-974"><span class="linenos" data-linenos=" 974 "></span></a>                        <span class="n">fn</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Use first for ImageVideo</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a><a href="#__codelineno-0-975"><span class="linenos" data-linenos=" 975 "></span></a>                    <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">sanitize_filename</span><span class="p">(</span><span class="n">fn</span><span class="p">))</span><span class="o">.</span><span class="n">parts</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><a href="#__codelineno-0-976"><span class="linenos" data-linenos=" 976 "></span></a>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a><a href="#__codelineno-0-977"><span class="linenos" data-linenos=" 977 "></span></a>                <span class="n">incoming_parts</span> <span class="o">=</span> <span class="n">get_path_parts</span><span class="p">(</span><span class="n">incoming</span><span class="p">)</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><a href="#__codelineno-0-978"><span class="linenos" data-linenos=" 978 "></span></a>                <span class="n">candidate_parts</span> <span class="o">=</span> <span class="p">[(</span><span class="n">v</span><span class="p">,</span> <span class="n">get_path_parts</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">viable</span><span class="p">]</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a><a href="#__codelineno-0-979"><span class="linenos" data-linenos=" 979 "></span></a>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a><a href="#__codelineno-0-980"><span class="linenos" data-linenos=" 980 "></span></a>                <span class="c1"># Also need all existing videos for uniqueness check</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a><a href="#__codelineno-0-981"><span class="linenos" data-linenos=" 981 "></span></a>                <span class="n">all_existing_parts</span> <span class="o">=</span> <span class="p">[(</span><span class="n">v</span><span class="p">,</span> <span class="n">get_path_parts</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">]</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><a href="#__codelineno-0-982"><span class="linenos" data-linenos=" 982 "></span></a>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a><a href="#__codelineno-0-983"><span class="linenos" data-linenos=" 983 "></span></a>                <span class="c1"># Compare at increasing depths until we find a unique match</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a><a href="#__codelineno-0-984"><span class="linenos" data-linenos=" 984 "></span></a>                <span class="n">max_depth</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><a href="#__codelineno-0-985"><span class="linenos" data-linenos=" 985 "></span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">incoming_parts</span><span class="p">),</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><a href="#__codelineno-0-986"><span class="linenos" data-linenos=" 986 "></span></a>                    <span class="nb">max</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">all_existing_parts</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a><a href="#__codelineno-0-987"><span class="linenos" data-linenos=" 987 "></span></a>                <span class="p">)</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a><a href="#__codelineno-0-988"><span class="linenos" data-linenos=" 988 "></span></a>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><a href="#__codelineno-0-989"><span class="linenos" data-linenos=" 989 "></span></a>                <span class="k">for</span> <span class="n">depth</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a><a href="#__codelineno-0-990"><span class="linenos" data-linenos=" 990 "></span></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">incoming_parts</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">depth</span><span class="p">:</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a><a href="#__codelineno-0-991"><span class="linenos" data-linenos=" 991 "></span></a>                        <span class="k">continue</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><a href="#__codelineno-0-992"><span class="linenos" data-linenos=" 992 "></span></a>                    <span class="n">incoming_leaf</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">incoming_parts</span><span class="p">[</span><span class="o">-</span><span class="n">depth</span><span class="p">:])</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a><a href="#__codelineno-0-993"><span class="linenos" data-linenos=" 993 "></span></a>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a><a href="#__codelineno-0-994"><span class="linenos" data-linenos=" 994 "></span></a>                    <span class="c1"># Find all viable candidates that match at this depth</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a><a href="#__codelineno-0-995"><span class="linenos" data-linenos=" 995 "></span></a>                    <span class="n">matches_at_depth</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><a href="#__codelineno-0-996"><span class="linenos" data-linenos=" 996 "></span></a>                    <span class="k">for</span> <span class="n">candidate</span><span class="p">,</span> <span class="n">parts</span> <span class="ow">in</span> <span class="n">candidate_parts</span><span class="p">:</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a><a href="#__codelineno-0-997"><span class="linenos" data-linenos=" 997 "></span></a>                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">depth</span><span class="p">:</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a><a href="#__codelineno-0-998"><span class="linenos" data-linenos=" 998 "></span></a>                            <span class="k">continue</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a><a href="#__codelineno-0-999"><span class="linenos" data-linenos=" 999 "></span></a>                        <span class="n">candidate_leaf</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="n">depth</span><span class="p">:])</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><a href="#__codelineno-0-1000"><span class="linenos" data-linenos="1000 "></span></a>                        <span class="k">if</span> <span class="n">candidate_leaf</span> <span class="o">==</span> <span class="n">incoming_leaf</span><span class="p">:</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a><a href="#__codelineno-0-1001"><span class="linenos" data-linenos="1001 "></span></a>                            <span class="n">matches_at_depth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate</span><span class="p">)</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a><a href="#__codelineno-0-1002"><span class="linenos" data-linenos="1002 "></span></a>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a><a href="#__codelineno-0-1003"><span class="linenos" data-linenos="1003 "></span></a>                    <span class="c1"># If exactly one match at this depth, use it</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a><a href="#__codelineno-0-1004"><span class="linenos" data-linenos="1004 "></span></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches_at_depth</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a><a href="#__codelineno-0-1005"><span class="linenos" data-linenos="1005 "></span></a>                        <span class="k">return</span> <span class="n">matches_at_depth</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a><a href="#__codelineno-0-1006"><span class="linenos" data-linenos="1006 "></span></a>                    <span class="c1"># If no matches, try deeper</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a><a href="#__codelineno-0-1007"><span class="linenos" data-linenos="1007 "></span></a>                    <span class="c1"># If multiple matches, continue deeper to disambiguate</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a><a href="#__codelineno-0-1008"><span class="linenos" data-linenos="1008 "></span></a>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a><a href="#__codelineno-0-1009"><span class="linenos" data-linenos="1009 "></span></a>            <span class="c1"># POSE MATCHING: Compare pose annotations (default in AUTO)</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a><a href="#__codelineno-0-1010"><span class="linenos" data-linenos="1010 "></span></a>            <span class="k">if</span> <span class="n">labels_incoming</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">labels_base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><a href="#__codelineno-0-1011"><span class="linenos" data-linenos="1011 "></span></a>                <span class="n">match</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_match_by_poses</span><span class="p">(</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a><a href="#__codelineno-0-1012"><span class="linenos" data-linenos="1012 "></span></a>                    <span class="n">incoming</span><span class="p">,</span> <span class="n">viable</span><span class="p">,</span> <span class="n">labels_incoming</span><span class="p">,</span> <span class="n">labels_base</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a><a href="#__codelineno-0-1013"><span class="linenos" data-linenos="1013 "></span></a>                <span class="p">)</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><a href="#__codelineno-0-1014"><span class="linenos" data-linenos="1014 "></span></a>                <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a><a href="#__codelineno-0-1015"><span class="linenos" data-linenos="1015 "></span></a>                    <span class="k">return</span> <span class="n">match</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a><a href="#__codelineno-0-1016"><span class="linenos" data-linenos="1016 "></span></a>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a><a href="#__codelineno-0-1017"><span class="linenos" data-linenos="1017 "></span></a>            <span class="c1"># IMAGE MATCHING: Compare frame images (opt-in)</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><a href="#__codelineno-0-1018"><span class="linenos" data-linenos="1018 "></span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_images</span><span class="p">:</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a><a href="#__codelineno-0-1019"><span class="linenos" data-linenos="1019 "></span></a>                <span class="n">match</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_match_by_images</span><span class="p">(</span><span class="n">incoming</span><span class="p">,</span> <span class="n">viable</span><span class="p">)</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><a href="#__codelineno-0-1020"><span class="linenos" data-linenos="1020 "></span></a>                <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><a href="#__codelineno-0-1021"><span class="linenos" data-linenos="1021 "></span></a>                    <span class="k">return</span> <span class="n">match</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><a href="#__codelineno-0-1022"><span class="linenos" data-linenos="1022 "></span></a>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><a href="#__codelineno-0-1023"><span class="linenos" data-linenos="1023 "></span></a>            <span class="c1"># No match found</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><a href="#__codelineno-0-1024"><span class="linenos" data-linenos="1024 "></span></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><a href="#__codelineno-0-1025"><span class="linenos" data-linenos="1025 "></span></a>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><a href="#__codelineno-0-1026"><span class="linenos" data-linenos="1026 "></span></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><a href="#__codelineno-0-1027"><span class="linenos" data-linenos="1027 "></span></a>            <span class="c1"># Non-AUTO methods: use pairwise match()</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><a href="#__codelineno-0-1028"><span class="linenos" data-linenos="1028 "></span></a>            <span class="k">for</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><a href="#__codelineno-0-1029"><span class="linenos" data-linenos="1029 "></span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">incoming</span><span class="p">):</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><a href="#__codelineno-0-1030"><span class="linenos" data-linenos="1030 "></span></a>                    <span class="k">return</span> <span class="n">candidate</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><a href="#__codelineno-0-1031"><span class="linenos" data-linenos="1031 "></span></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a><a href="#__codelineno-0-1032"><span class="linenos" data-linenos="1032 "></span></a>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a><a href="#__codelineno-0-1033"><span class="linenos" data-linenos="1033 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_match_by_poses</span><span class="p">(</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><a href="#__codelineno-0-1034"><span class="linenos" data-linenos="1034 "></span></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><a href="#__codelineno-0-1035"><span class="linenos" data-linenos="1035 "></span></a>        <span class="n">incoming</span><span class="p">:</span> <span class="s2">&quot;Video&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><a href="#__codelineno-0-1036"><span class="linenos" data-linenos="1036 "></span></a>        <span class="n">candidates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Video&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><a href="#__codelineno-0-1037"><span class="linenos" data-linenos="1037 "></span></a>        <span class="n">labels_incoming</span><span class="p">:</span> <span class="s2">&quot;Labels&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><a href="#__codelineno-0-1038"><span class="linenos" data-linenos="1038 "></span></a>        <span class="n">labels_base</span><span class="p">:</span> <span class="s2">&quot;Labels&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a><a href="#__codelineno-0-1039"><span class="linenos" data-linenos="1039 "></span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Video | None&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a><a href="#__codelineno-0-1040"><span class="linenos" data-linenos="1040 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Try to match video by comparing pose annotations.</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><a href="#__codelineno-0-1041"><span class="linenos" data-linenos="1041 "></span></a>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><a href="#__codelineno-0-1042"><span class="linenos" data-linenos="1042 "></span></a><span class="sd">        Returns matched video if poses match on enough common frames.</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a><a href="#__codelineno-0-1043"><span class="linenos" data-linenos="1043 "></span></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><a href="#__codelineno-0-1044"><span class="linenos" data-linenos="1044 "></span></a>        <span class="c1"># Resolve whether to include predictions for incoming video</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><a href="#__codelineno-0-1045"><span class="linenos" data-linenos="1045 "></span></a>        <span class="n">include_preds</span> <span class="o">=</span> <span class="n">_resolve_compare_predictions</span><span class="p">(</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><a href="#__codelineno-0-1046"><span class="linenos" data-linenos="1046 "></span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">compare_predictions</span><span class="p">,</span> <span class="n">labels_incoming</span><span class="p">,</span> <span class="n">incoming</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><a href="#__codelineno-0-1047"><span class="linenos" data-linenos="1047 "></span></a>        <span class="p">)</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><a href="#__codelineno-0-1048"><span class="linenos" data-linenos="1048 "></span></a>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><a href="#__codelineno-0-1049"><span class="linenos" data-linenos="1049 "></span></a>        <span class="c1"># Get incoming video&#39;s frame -&gt; instances map (cached)</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><a href="#__codelineno-0-1050"><span class="linenos" data-linenos="1050 "></span></a>        <span class="n">incoming_frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cached_frame_instances</span><span class="p">(</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><a href="#__codelineno-0-1051"><span class="linenos" data-linenos="1051 "></span></a>            <span class="n">labels_incoming</span><span class="p">,</span> <span class="n">incoming</span><span class="p">,</span> <span class="n">include_preds</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><a href="#__codelineno-0-1052"><span class="linenos" data-linenos="1052 "></span></a>        <span class="p">)</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><a href="#__codelineno-0-1053"><span class="linenos" data-linenos="1053 "></span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">incoming_frames</span><span class="p">:</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><a href="#__codelineno-0-1054"><span class="linenos" data-linenos="1054 "></span></a>            <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># No annotations to compare</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><a href="#__codelineno-0-1055"><span class="linenos" data-linenos="1055 "></span></a>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><a href="#__codelineno-0-1056"><span class="linenos" data-linenos="1056 "></span></a>        <span class="k">for</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><a href="#__codelineno-0-1057"><span class="linenos" data-linenos="1057 "></span></a>            <span class="c1"># Get candidate&#39;s frame -&gt; instances map (cached for performance)</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><a href="#__codelineno-0-1058"><span class="linenos" data-linenos="1058 "></span></a>            <span class="c1"># Use same prediction setting resolved for candidate</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><a href="#__codelineno-0-1059"><span class="linenos" data-linenos="1059 "></span></a>            <span class="n">include_preds_cand</span> <span class="o">=</span> <span class="n">_resolve_compare_predictions</span><span class="p">(</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><a href="#__codelineno-0-1060"><span class="linenos" data-linenos="1060 "></span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">compare_predictions</span><span class="p">,</span> <span class="n">labels_base</span><span class="p">,</span> <span class="n">candidate</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a><a href="#__codelineno-0-1061"><span class="linenos" data-linenos="1061 "></span></a>            <span class="p">)</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a><a href="#__codelineno-0-1062"><span class="linenos" data-linenos="1062 "></span></a>            <span class="n">candidate_frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cached_frame_instances</span><span class="p">(</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a><a href="#__codelineno-0-1063"><span class="linenos" data-linenos="1063 "></span></a>                <span class="n">labels_base</span><span class="p">,</span> <span class="n">candidate</span><span class="p">,</span> <span class="n">include_preds_cand</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a><a href="#__codelineno-0-1064"><span class="linenos" data-linenos="1064 "></span></a>            <span class="p">)</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a><a href="#__codelineno-0-1065"><span class="linenos" data-linenos="1065 "></span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">candidate_frames</span><span class="p">:</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><a href="#__codelineno-0-1066"><span class="linenos" data-linenos="1066 "></span></a>                <span class="k">continue</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><a href="#__codelineno-0-1067"><span class="linenos" data-linenos="1067 "></span></a>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><a href="#__codelineno-0-1068"><span class="linenos" data-linenos="1068 "></span></a>            <span class="c1"># Find common frame indices</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><a href="#__codelineno-0-1069"><span class="linenos" data-linenos="1069 "></span></a>            <span class="n">common_indices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">incoming_frames</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">candidate_frames</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><a href="#__codelineno-0-1070"><span class="linenos" data-linenos="1070 "></span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">common_indices</span><span class="p">:</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><a href="#__codelineno-0-1071"><span class="linenos" data-linenos="1071 "></span></a>                <span class="k">continue</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a><a href="#__codelineno-0-1072"><span class="linenos" data-linenos="1072 "></span></a>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><a href="#__codelineno-0-1073"><span class="linenos" data-linenos="1073 "></span></a>            <span class="c1"># Determine required matches</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><a href="#__codelineno-0-1074"><span class="linenos" data-linenos="1074 "></span></a>            <span class="n">required_matches</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_frames</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">common_indices</span><span class="p">))</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><a href="#__codelineno-0-1075"><span class="linenos" data-linenos="1075 "></span></a>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><a href="#__codelineno-0-1076"><span class="linenos" data-linenos="1076 "></span></a>            <span class="c1"># Sample frames if too many (performance)</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><a href="#__codelineno-0-1077"><span class="linenos" data-linenos="1077 "></span></a>            <span class="n">sample_indices</span> <span class="o">=</span> <span class="n">_sample_frame_indices</span><span class="p">(</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a><a href="#__codelineno-0-1078"><span class="linenos" data-linenos="1078 "></span></a>                <span class="n">common_indices</span><span class="p">,</span> <span class="n">max_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">content_frames</span> <span class="o">*</span> <span class="mi">2</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><a href="#__codelineno-0-1079"><span class="linenos" data-linenos="1079 "></span></a>            <span class="p">)</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a><a href="#__codelineno-0-1080"><span class="linenos" data-linenos="1080 "></span></a>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a><a href="#__codelineno-0-1081"><span class="linenos" data-linenos="1081 "></span></a>            <span class="c1"># Count matching frames</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><a href="#__codelineno-0-1082"><span class="linenos" data-linenos="1082 "></span></a>            <span class="n">matching_frames</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><a href="#__codelineno-0-1083"><span class="linenos" data-linenos="1083 "></span></a>            <span class="k">for</span> <span class="n">frame_idx</span> <span class="ow">in</span> <span class="n">sample_indices</span><span class="p">:</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a><a href="#__codelineno-0-1084"><span class="linenos" data-linenos="1084 "></span></a>                <span class="k">if</span> <span class="n">_frame_has_matching_pose</span><span class="p">(</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><a href="#__codelineno-0-1085"><span class="linenos" data-linenos="1085 "></span></a>                    <span class="n">incoming_frames</span><span class="p">[</span><span class="n">frame_idx</span><span class="p">],</span> <span class="n">candidate_frames</span><span class="p">[</span><span class="n">frame_idx</span><span class="p">]</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><a href="#__codelineno-0-1086"><span class="linenos" data-linenos="1086 "></span></a>                <span class="p">):</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><a href="#__codelineno-0-1087"><span class="linenos" data-linenos="1087 "></span></a>                    <span class="n">matching_frames</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a><a href="#__codelineno-0-1088"><span class="linenos" data-linenos="1088 "></span></a>                    <span class="k">if</span> <span class="n">matching_frames</span> <span class="o">&gt;=</span> <span class="n">required_matches</span><span class="p">:</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><a href="#__codelineno-0-1089"><span class="linenos" data-linenos="1089 "></span></a>                        <span class="k">return</span> <span class="n">candidate</span>  <span class="c1"># Found match!</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a><a href="#__codelineno-0-1090"><span class="linenos" data-linenos="1090 "></span></a>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a><a href="#__codelineno-0-1091"><span class="linenos" data-linenos="1091 "></span></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a><a href="#__codelineno-0-1092"><span class="linenos" data-linenos="1092 "></span></a>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a><a href="#__codelineno-0-1093"><span class="linenos" data-linenos="1093 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_match_by_images</span><span class="p">(</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a><a href="#__codelineno-0-1094"><span class="linenos" data-linenos="1094 "></span></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a><a href="#__codelineno-0-1095"><span class="linenos" data-linenos="1095 "></span></a>        <span class="n">incoming</span><span class="p">:</span> <span class="s2">&quot;Video&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a><a href="#__codelineno-0-1096"><span class="linenos" data-linenos="1096 "></span></a>        <span class="n">candidates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Video&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a><a href="#__codelineno-0-1097"><span class="linenos" data-linenos="1097 "></span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Video | None&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a><a href="#__codelineno-0-1098"><span class="linenos" data-linenos="1098 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Try to match video by comparing image content.</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a><a href="#__codelineno-0-1099"><span class="linenos" data-linenos="1099 "></span></a>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><a href="#__codelineno-0-1100"><span class="linenos" data-linenos="1100 "></span></a><span class="sd">        Only used when compare_images=True. Expensive operation.</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><a href="#__codelineno-0-1101"><span class="linenos" data-linenos="1101 "></span></a><span class="sd">        Returns matched video if images match on enough common frames.</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a><a href="#__codelineno-0-1102"><span class="linenos" data-linenos="1102 "></span></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><a href="#__codelineno-0-1103"><span class="linenos" data-linenos="1103 "></span></a>        <span class="k">for</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><a href="#__codelineno-0-1104"><span class="linenos" data-linenos="1104 "></span></a>            <span class="c1"># Get common embedded frame indices</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><a href="#__codelineno-0-1105"><span class="linenos" data-linenos="1105 "></span></a>            <span class="n">common_indices</span> <span class="o">=</span> <span class="n">_get_common_embedded_indices</span><span class="p">(</span><span class="n">incoming</span><span class="p">,</span> <span class="n">candidate</span><span class="p">)</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a><a href="#__codelineno-0-1106"><span class="linenos" data-linenos="1106 "></span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">common_indices</span><span class="p">:</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a><a href="#__codelineno-0-1107"><span class="linenos" data-linenos="1107 "></span></a>                <span class="k">continue</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a><a href="#__codelineno-0-1108"><span class="linenos" data-linenos="1108 "></span></a>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><a href="#__codelineno-0-1109"><span class="linenos" data-linenos="1109 "></span></a>            <span class="n">required_matches</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_frames</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">common_indices</span><span class="p">))</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><a href="#__codelineno-0-1110"><span class="linenos" data-linenos="1110 "></span></a>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a><a href="#__codelineno-0-1111"><span class="linenos" data-linenos="1111 "></span></a>            <span class="c1"># Sample frames</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><a href="#__codelineno-0-1112"><span class="linenos" data-linenos="1112 "></span></a>            <span class="n">sample_indices</span> <span class="o">=</span> <span class="n">_sample_frame_indices</span><span class="p">(</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a><a href="#__codelineno-0-1113"><span class="linenos" data-linenos="1113 "></span></a>                <span class="n">common_indices</span><span class="p">,</span> <span class="n">max_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">content_frames</span> <span class="o">*</span> <span class="mi">2</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><a href="#__codelineno-0-1114"><span class="linenos" data-linenos="1114 "></span></a>            <span class="p">)</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><a href="#__codelineno-0-1115"><span class="linenos" data-linenos="1115 "></span></a>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><a href="#__codelineno-0-1116"><span class="linenos" data-linenos="1116 "></span></a>            <span class="c1"># Count matching frames</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><a href="#__codelineno-0-1117"><span class="linenos" data-linenos="1117 "></span></a>            <span class="n">matching_frames</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><a href="#__codelineno-0-1118"><span class="linenos" data-linenos="1118 "></span></a>            <span class="k">for</span> <span class="n">frame_idx</span> <span class="ow">in</span> <span class="n">sample_indices</span><span class="p">:</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a><a href="#__codelineno-0-1119"><span class="linenos" data-linenos="1119 "></span></a>                <span class="k">if</span> <span class="n">_frames_similar_by_image</span><span class="p">(</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><a href="#__codelineno-0-1120"><span class="linenos" data-linenos="1120 "></span></a>                    <span class="n">incoming</span><span class="p">,</span> <span class="n">candidate</span><span class="p">,</span> <span class="n">frame_idx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_similarity_threshold</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a><a href="#__codelineno-0-1121"><span class="linenos" data-linenos="1121 "></span></a>                <span class="p">):</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><a href="#__codelineno-0-1122"><span class="linenos" data-linenos="1122 "></span></a>                    <span class="n">matching_frames</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><a href="#__codelineno-0-1123"><span class="linenos" data-linenos="1123 "></span></a>                    <span class="k">if</span> <span class="n">matching_frames</span> <span class="o">&gt;=</span> <span class="n">required_matches</span><span class="p">:</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><a href="#__codelineno-0-1124"><span class="linenos" data-linenos="1124 "></span></a>                        <span class="k">return</span> <span class="n">candidate</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><a href="#__codelineno-0-1125"><span class="linenos" data-linenos="1125 "></span></a>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a><a href="#__codelineno-0-1126"><span class="linenos" data-linenos="1126 "></span></a>        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.VideoMatcher.__annotations__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__annotations__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;VideoMatchMethod | str&#39;</span><span class="p">,</span> <span class="s1">&#39;strict&#39;</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span><span class="p">,</span> <span class="s1">&#39;content_frames&#39;</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;compare_predictions&#39;</span><span class="p">:</span> <span class="s1">&#39;str | bool&#39;</span><span class="p">,</span> <span class="s1">&#39;compare_images&#39;</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span><span class="p">,</span> <span class="s1">&#39;image_similarity_threshold&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;_frame_cache&#39;</span><span class="p">:</span> <span class="s1">&#39;dict&#39;</span><span class="p">}</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.VideoMatcher.__annotations__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>dict() -&gt; new empty dictionary
dict(mapping) -&gt; new dictionary initialized from a mapping object's
    (key, value) pairs
dict(iterable) -&gt; new dictionary initialized as if via:
    d = {}
    for k, v in iterable:
        d[k] = v
dict(**kwargs) -&gt; new dictionary initialized with the name=value pairs
    in the keyword argument list.  For example:  dict(one=1, two=2)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.VideoMatcher.__attrs_own_setattr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__attrs_own_setattr__</span> <span class="o">=</span> <span class="kc">True</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.VideoMatcher.__attrs_own_setattr__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Returns True when the argument is true, False otherwise.
The builtins True and False are the only two instances of the class bool.
The class bool is a subclass of the class int, and cannot be subclassed.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.VideoMatcher.__attrs_props__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__attrs_props__</span> <span class="o">=</span> <span class="n">ClassProps</span><span class="p">(</span><span class="n">is_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_slotted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_weakref_slot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_frozen</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=&lt;</span><span class="n">KeywordOnly</span><span class="o">.</span><span class="n">NO</span><span class="p">:</span> <span class="s1">&#39;no&#39;</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">collected_fields_by_mro</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_init</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_repr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_eq</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_ordering</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hashability</span><span class="o">=&lt;</span><span class="n">Hashability</span><span class="o">.</span><span class="n">UNHASHABLE</span><span class="p">:</span> <span class="s1">&#39;unhashable&#39;</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">added_match_args</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_str</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">added_pickling</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">on_setattr_hook</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">pipe</span><span class="o">.&lt;</span><span class="nb">locals</span><span class="o">&gt;.</span><span class="n">wrapped_pipe</span> <span class="n">at</span> <span class="mh">0x7f45c0a9aca0</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">field_transformer</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.VideoMatcher.__attrs_props__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Effective class properties as derived from parameters to <code>attr.s()</code> or
<code>define()</code> decorators.</p>
<p>This is the same data structure that <em>attrs</em> uses internally to decide how
to construct the final class.</p>
<p>Warning:</p>
<div class="highlight"><pre><span></span><code>This feature is currently **experimental** and is not covered by our
strict backwards-compatibility guarantees.
</code></pre></div>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.__attrs_props__.is_exception">is_exception</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class is treated as an exception class.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.__attrs_props__.is_slotted">is_slotted</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class is <code>slotted &lt;slotted classes&gt;</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.__attrs_props__.has_weakref_slot">has_weakref_slot</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has a slot for weak references.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.__attrs_props__.is_frozen">is_frozen</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class is frozen.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.__attrs_props__.kw_only">kw_only</span></code></td>
            <td>
                  <code><span title="KeywordOnly">KeywordOnly</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether / how the class enforces keyword-only arguments on the
<code>__init__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.__attrs_props__.collected_fields_by_mro">collected_fields_by_mro</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class fields were collected by method resolution order.
That is, correctly but unlike <code>dataclasses</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.__attrs_props__.added_init">added_init</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has an <em>attrs</em>-generated <code>__init__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.__attrs_props__.added_repr">added_repr</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has an <em>attrs</em>-generated <code>__repr__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.__attrs_props__.added_eq">added_eq</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has <em>attrs</em>-generated equality methods.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.__attrs_props__.added_ordering">added_ordering</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has <em>attrs</em>-generated ordering methods.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.__attrs_props__.hashability">hashability</span></code></td>
            <td>
                  <code><span title="Hashability">Hashability</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How <code>hashable &lt;hashing&gt;</code> the class is.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.__attrs_props__.added_match_args">added_match_args</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class supports positional <code>match &lt;match&gt;</code> over its
fields.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.__attrs_props__.added_str">added_str</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has an <em>attrs</em>-generated <code>__str__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.__attrs_props__.added_pickling">added_pickling</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has <em>attrs</em>-generated <code>__getstate__</code> and
<code>__setstate__</code> methods for <code>pickle</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.__attrs_props__.on_setattr_hook">on_setattr_hook</span></code></td>
            <td>
                  <code><span title="Callable">Callable</span>[[<span title="typing.Any">Any</span>, <span title="Attribute">Attribute</span>[<span title="typing.Any">Any</span>], <span title="typing.Any">Any</span>], <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The class's <code>__setattr__</code> hook.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.__attrs_props__.field_transformer">field_transformer</span></code></td>
            <td>
                  <code><span title="Callable">Callable</span>[[<span title="Attribute">Attribute</span>[<span title="typing.Any">Any</span>]], <span title="Attribute">Attribute</span>[<span title="typing.Any">Any</span>]] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The class's <code>field transformers &lt;transform-fields&gt;</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>.. versionadded:: 25.4.0</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.VideoMatcher.__doc__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__doc__</span> <span class="o">=</span> <span class="s1">&#39;Matcher for comparing and matching videos.</span><span class="se">\n\n</span><span class="s1">Attributes:</span><span class="se">\n</span><span class="s1">    method: The matching method to use. Can be a VideoMatchMethod enum value</span><span class="se">\n</span><span class="s1">        or a string that will be converted to the enum. Default is AUTO.</span><span class="se">\n</span><span class="s1">    strict: Whether to use strict path matching for the PATH method.</span><span class="se">\n</span><span class="s1">        When True, paths must be exactly identical. When False, paths</span><span class="se">\n</span><span class="s1">        are normalized before comparison. Only used when method is PATH.</span><span class="se">\n</span><span class="s1">        Default is False.</span><span class="se">\n</span><span class="s1">    content_frames: Minimum number of matching frames required for pose/image</span><span class="se">\n</span><span class="s1">        matching to confirm a match. If fewer common frames exist, requires</span><span class="se">\n</span><span class="s1">        all of them to match. Default 3.</span><span class="se">\n</span><span class="s1">    compare_predictions: Whether to include predicted instances in pose matching.</span><span class="se">\n</span><span class="s1">        &quot;auto&quot; (default): Include only if video has 100% predictions (no user</span><span class="se">\n</span><span class="s1">        instances). True: Always include predictions. False: Never include</span><span class="se">\n</span><span class="s1">        predictions (user instances only).</span><span class="se">\n</span><span class="s1">    compare_images: Whether to compare frame images via pixel similarity.</span><span class="se">\n</span><span class="s1">        Expensive operation requiring frame decoding. Default False.</span><span class="se">\n</span><span class="s1">    image_similarity_threshold: Maximum mean pixel difference (0-1 scale,</span><span class="se">\n</span><span class="s1">        normalized by 255) for images to be considered matching.</span><span class="se">\n</span><span class="s1">        Only used when compare_images=True. Default 0.05 (~13/255 pixels).</span><span class="se">\n\n</span><span class="s1">Notes:</span><span class="se">\n</span><span class="s1">    For AUTO method, use find_match() when matching against a list of</span><span class="se">\n</span><span class="s1">    candidates. The match() method for AUTO uses a simplified pairwise</span><span class="se">\n</span><span class="s1">    check that doesn</span><span class="se">\&#39;</span><span class="s1">t include the full leaf-uniqueness algorithm.</span><span class="se">\n</span><span class="s1">&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.VideoMatcher.__doc__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to 'utf-8'.
errors defaults to 'strict'.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.VideoMatcher.__firstlineno__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__firstlineno__</span> <span class="o">=</span> <span class="mi">793</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.VideoMatcher.__firstlineno__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>int([x]) -&gt; integer
int(x, base=10) -&gt; integer</p>
<p>Convert a number or string to an integer, or return 0 if no arguments
are given.  If x is a number, return x.<strong>int</strong>().  For floating-point
numbers, this truncates towards zero.</p>
<p>If x is not a number or if base is given, then x must be a string,
bytes, or bytearray instance representing an integer literal in the
given base.  The literal can be preceded by '+' or '-' and be surrounded
by whitespace.  The base defaults to 10.  Valid bases are 0 and 2-36.
Base 0 means to interpret the base from the string as an integer literal.</p>
<blockquote>
<blockquote>
<blockquote>
<p>int('0b100', base=0)
4</p>
</blockquote>
</blockquote>
</blockquote>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.VideoMatcher.__match_args__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__match_args__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="s1">&#39;strict&#39;</span><span class="p">,</span> <span class="s1">&#39;content_frames&#39;</span><span class="p">,</span> <span class="s1">&#39;compare_predictions&#39;</span><span class="p">,</span> <span class="s1">&#39;compare_images&#39;</span><span class="p">,</span> <span class="s1">&#39;image_similarity_threshold&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.VideoMatcher.__match_args__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Built-in immutable sequence.</p>
<p>If no argument is given, the constructor returns an empty tuple.
If iterable is specified the tuple is initialized from iterable's items.</p>
<p>If the argument is a tuple, the return value is the same object.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.VideoMatcher.__module__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__module__</span> <span class="o">=</span> <span class="s1">&#39;sleap_io.model.matching&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.VideoMatcher.__module__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to 'utf-8'.
errors defaults to 'strict'.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.VideoMatcher.__slots__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="s1">&#39;strict&#39;</span><span class="p">,</span> <span class="s1">&#39;content_frames&#39;</span><span class="p">,</span> <span class="s1">&#39;compare_predictions&#39;</span><span class="p">,</span> <span class="s1">&#39;compare_images&#39;</span><span class="p">,</span> <span class="s1">&#39;image_similarity_threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;_frame_cache&#39;</span><span class="p">,</span> <span class="s1">&#39;__weakref__&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.VideoMatcher.__slots__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Built-in immutable sequence.</p>
<p>If no argument is given, the constructor returns an empty tuple.
If iterable is specified the tuple is initialized from iterable's items.</p>
<p>If the argument is a tuple, the return value is the same object.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.VideoMatcher.__static_attributes__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__static_attributes__</span> <span class="o">=</span> <span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.VideoMatcher.__static_attributes__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Built-in immutable sequence.</p>
<p>If no argument is given, the constructor returns an empty tuple.
If iterable is specified the tuple is initialized from iterable's items.</p>
<p>If the argument is a tuple, the return value is the same object.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.VideoMatcher.__weakref__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__weakref__</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#sleap_io.model.matching.VideoMatcher.__weakref__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>list of weak references to the object</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.VideoMatcher.__eq__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.VideoMatcher.__eq__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class VideoMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-16" name="__codelineno-0-16"></a><a href="#__codelineno-0-16"><span class="linenos" data-linenos="16 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><a href="#__codelineno-0-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><a href="#__codelineno-0-18"><span class="linenos" data-linenos="18 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><a href="#__codelineno-0-19"><span class="linenos" data-linenos="19 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">Any</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><a href="#__codelineno-0-20"><span class="linenos" data-linenos="20 "></span></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><a href="#__codelineno-0-21"><span class="linenos" data-linenos="21 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">attrs</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><a href="#__codelineno-0-22"><span class="linenos" data-linenos="22 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><a href="#__codelineno-0-23"><span class="linenos" data-linenos="23 "></span></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><a href="#__codelineno-0-24"><span class="linenos" data-linenos="24 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.instance</span><span class="w"> </span><span class="kn">import</span> <span class="n">Instance</span><span class="p">,</span> <span class="n">Track</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><a href="#__codelineno-0-25"><span class="linenos" data-linenos="25 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.labeled_frame</span><span class="w"> </span><span class="kn">import</span> <span class="n">LabeledFrame</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><a href="#__codelineno-0-26"><span class="linenos" data-linenos="26 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.skeleton</span><span class="w"> </span><span class="kn">import</span> <span class="n">Skeleton</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.VideoMatcher.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">method</span><span class="o">=&lt;</span><span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">AUTO</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">content_frames</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">compare_predictions</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">compare_images</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">image_similarity_threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.VideoMatcher.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class VideoMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-28" name="__codelineno-0-28"></a><a href="#__codelineno-0-28"><span class="linenos" data-linenos="28 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.video</span><span class="w"> </span><span class="kn">import</span> <span class="n">Video</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><a href="#__codelineno-0-29"><span class="linenos" data-linenos="29 "></span></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><a href="#__codelineno-0-30"><span class="linenos" data-linenos="30 "></span></a><span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><a href="#__codelineno-0-31"><span class="linenos" data-linenos="31 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.labels</span><span class="w"> </span><span class="kn">import</span> <span class="n">Labels</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><a href="#__codelineno-0-32"><span class="linenos" data-linenos="32 "></span></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><a href="#__codelineno-0-33"><span class="linenos" data-linenos="33 "></span></a>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><a href="#__codelineno-0-34"><span class="linenos" data-linenos="34 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">SkeletonMatchMethod</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><a href="#__codelineno-0-35"><span class="linenos" data-linenos="35 "></span></a>    <span class="s2">&quot;&quot;&quot;Methods for matching skeletons.</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.VideoMatcher.__replace__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__replace__</span><span class="p">(</span><span class="o">**</span><span class="n">changes</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.VideoMatcher.__replace__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class VideoMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><a href="#__codelineno-0-1100"><span class="linenos" data-linenos="1100 "></span></a><span class="n">Only</span> <span class="n">used</span> <span class="n">when</span> <span class="n">compare_images</span><span class="o">=</span><span class="kc">True</span><span class="o">.</span> <span class="n">Expensive</span> <span class="n">operation</span><span class="o">.</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.VideoMatcher.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#sleap_io.model.matching.VideoMatcher.__repr__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class VideoMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="sd">&quot;&quot;&quot;Unified matcher system for comparing and matching data structures during merging.</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="sd">This module provides configurable matchers for comparing skeletons, instances, tracks,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="sd">and videos during merge operations. The matchers use various strategies to determine</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="sd">when data structures should be considered equivalent during merging.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="sd">Key features:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="sd">- Skeleton matching: exact, structure-based, overlap, and subset matching</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="sd">- Instance matching: spatial proximity, track identity, and bounding box IoU</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><a href="#__codelineno-0-10"><span class="linenos" data-linenos="10 "></span></a><span class="sd">- Track matching: by name or object identity</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><a href="#__codelineno-0-11"><span class="linenos" data-linenos="11 "></span></a><span class="sd">- Video matching: path, basename, content, and auto matching</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><a href="#__codelineno-0-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><a href="#__codelineno-0-13"><span class="linenos" data-linenos="13 "></span></a><span class="sd">Video matching supports path-based, filename-based, content-based, and</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><a href="#__codelineno-0-14"><span class="linenos" data-linenos="14 "></span></a><span class="sd">automatic strategies.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><a href="#__codelineno-0-15"><span class="linenos" data-linenos="15 "></span></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.VideoMatcher.__setattr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.VideoMatcher.__setattr__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class VideoMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1176" name="__codelineno-0-1176"></a><a href="#__codelineno-0-1176"><span class="linenos" data-linenos="1176 "></span></a>        <span class="n">details</span><span class="p">:</span> <span class="n">Dictionary</span> <span class="n">containing</span> <span class="n">additional</span> <span class="n">error</span> <span class="n">details</span> <span class="ow">and</span> <span class="n">context</span><span class="o">.</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a><a href="#__codelineno-0-1177"><span class="linenos" data-linenos="1177 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a><a href="#__codelineno-0-1178"><span class="linenos" data-linenos="1178 "></span></a>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a><a href="#__codelineno-0-1179"><span class="linenos" data-linenos="1179 "></span></a><span class="sd">    message: str</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a><a href="#__codelineno-0-1180"><span class="linenos" data-linenos="1180 "></span></a><span class="sd">    details: dict = attrs.field(factory=dict)</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a><a href="#__codelineno-0-1181"><span class="linenos" data-linenos="1181 "></span></a>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a><a href="#__codelineno-0-1182"><span class="linenos" data-linenos="1182 "></span></a>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a><a href="#__codelineno-0-1183"><span class="linenos" data-linenos="1183 "></span></a><span class="sd">class SkeletonMismatchError(MergeError):</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a><a href="#__codelineno-0-1184"><span class="linenos" data-linenos="1184 "></span></a><span class="sd">    &quot;&quot;&quot;</span><span class="n">Raised</span> <span class="n">when</span> <span class="n">skeletons</span> <span class="n">don</span><span class="s1">&#39;t match during merge.&quot;&quot;&quot;</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.VideoMatcher.find_match" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_match</span><span class="p">(</span><span class="n">incoming</span><span class="p">,</span> <span class="n">candidates</span><span class="p">,</span> <span class="n">labels_incoming</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels_base</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.VideoMatcher.find_match" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Find a matching video from candidates using the configured method.</p>
<p>This is the preferred method for AUTO matching as it implements the
full safe matching cascade including leaf-uniqueness disambiguation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>incoming</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;Video&lt;/code&gt; (&lt;code&gt;sleap_io.model.video.Video&lt;/code&gt;)" href="../reference/sleap_io/model/video/#sleap_io.model.video.Video">Video</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video to find a match for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>candidates</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;Video&lt;/code&gt; (&lt;code&gt;sleap_io.model.video.Video&lt;/code&gt;)" href="../reference/sleap_io/model/video/#sleap_io.model.video.Video">Video</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of existing videos to search for matches.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>labels_incoming</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;Labels&lt;/code&gt; (&lt;code&gt;sleap_io.model.labels.Labels&lt;/code&gt;)" href="../reference/sleap_io/model/labels/#sleap_io.model.labels.Labels">Labels</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels object containing the incoming video's
annotations. Used for pose-based matching in AUTO mode.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>labels_base</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;Labels&lt;/code&gt; (&lt;code&gt;sleap_io.model.labels.Labels&lt;/code&gt;)" href="../reference/sleap_io/model/labels/#sleap_io.model.labels.Labels">Labels</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels object containing the candidates' annotations.
Used for pose-based matching in AUTO mode.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;Video&lt;/code&gt; (&lt;code&gt;sleap_io.model.video.Video&lt;/code&gt;)" href="../reference/sleap_io/model/video/#sleap_io.model.video.Video">Video</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matched video, or None if no match found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>For AUTO method, implements the safe matching cascade:
1. Shape rejection (filter candidates)
2. original_video conflict rejection (filter candidates)
3. Definitive file identity (is_same_file)
4. Strict path match
5. Leaf uniqueness matching at increasing depths
6. Pose-based matching (if labels provided)
7. Image-based matching (if compare_images=True)</p>
<p>Shape is for REJECTION only - compatible shapes don't imply a match.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-899" name="__codelineno-0-899"></a><a href="#__codelineno-0-899"><span class="linenos" data-linenos=" 899 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">find_match</span><span class="p">(</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a><a href="#__codelineno-0-900"><span class="linenos" data-linenos=" 900 "></span></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a><a href="#__codelineno-0-901"><span class="linenos" data-linenos=" 901 "></span></a>    <span class="n">incoming</span><span class="p">:</span> <span class="n">Video</span><span class="p">,</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><a href="#__codelineno-0-902"><span class="linenos" data-linenos=" 902 "></span></a>    <span class="n">candidates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Video</span><span class="p">],</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><a href="#__codelineno-0-903"><span class="linenos" data-linenos=" 903 "></span></a>    <span class="n">labels_incoming</span><span class="p">:</span> <span class="s2">&quot;Labels | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a><a href="#__codelineno-0-904"><span class="linenos" data-linenos=" 904 "></span></a>    <span class="n">labels_base</span><span class="p">:</span> <span class="s2">&quot;Labels | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a><a href="#__codelineno-0-905"><span class="linenos" data-linenos=" 905 "></span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Video</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><a href="#__codelineno-0-906"><span class="linenos" data-linenos=" 906 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Find a matching video from candidates using the configured method.</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a><a href="#__codelineno-0-907"><span class="linenos" data-linenos=" 907 "></span></a>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a><a href="#__codelineno-0-908"><span class="linenos" data-linenos=" 908 "></span></a><span class="sd">    This is the preferred method for AUTO matching as it implements the</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a><a href="#__codelineno-0-909"><span class="linenos" data-linenos=" 909 "></span></a><span class="sd">    full safe matching cascade including leaf-uniqueness disambiguation.</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a><a href="#__codelineno-0-910"><span class="linenos" data-linenos=" 910 "></span></a>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a><a href="#__codelineno-0-911"><span class="linenos" data-linenos=" 911 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a><a href="#__codelineno-0-912"><span class="linenos" data-linenos=" 912 "></span></a><span class="sd">        incoming: The video to find a match for.</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><a href="#__codelineno-0-913"><span class="linenos" data-linenos=" 913 "></span></a><span class="sd">        candidates: List of existing videos to search for matches.</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a><a href="#__codelineno-0-914"><span class="linenos" data-linenos=" 914 "></span></a><span class="sd">        labels_incoming: Labels object containing the incoming video&#39;s</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><a href="#__codelineno-0-915"><span class="linenos" data-linenos=" 915 "></span></a><span class="sd">            annotations. Used for pose-based matching in AUTO mode.</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><a href="#__codelineno-0-916"><span class="linenos" data-linenos=" 916 "></span></a><span class="sd">        labels_base: Labels object containing the candidates&#39; annotations.</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><a href="#__codelineno-0-917"><span class="linenos" data-linenos=" 917 "></span></a><span class="sd">            Used for pose-based matching in AUTO mode.</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a><a href="#__codelineno-0-918"><span class="linenos" data-linenos=" 918 "></span></a>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><a href="#__codelineno-0-919"><span class="linenos" data-linenos=" 919 "></span></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><a href="#__codelineno-0-920"><span class="linenos" data-linenos=" 920 "></span></a><span class="sd">        The matched video, or None if no match found.</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><a href="#__codelineno-0-921"><span class="linenos" data-linenos=" 921 "></span></a>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><a href="#__codelineno-0-922"><span class="linenos" data-linenos=" 922 "></span></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><a href="#__codelineno-0-923"><span class="linenos" data-linenos=" 923 "></span></a><span class="sd">        For AUTO method, implements the safe matching cascade:</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><a href="#__codelineno-0-924"><span class="linenos" data-linenos=" 924 "></span></a><span class="sd">        1. Shape rejection (filter candidates)</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><a href="#__codelineno-0-925"><span class="linenos" data-linenos=" 925 "></span></a><span class="sd">        2. original_video conflict rejection (filter candidates)</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><a href="#__codelineno-0-926"><span class="linenos" data-linenos=" 926 "></span></a><span class="sd">        3. Definitive file identity (is_same_file)</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><a href="#__codelineno-0-927"><span class="linenos" data-linenos=" 927 "></span></a><span class="sd">        4. Strict path match</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><a href="#__codelineno-0-928"><span class="linenos" data-linenos=" 928 "></span></a><span class="sd">        5. Leaf uniqueness matching at increasing depths</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><a href="#__codelineno-0-929"><span class="linenos" data-linenos=" 929 "></span></a><span class="sd">        6. Pose-based matching (if labels provided)</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><a href="#__codelineno-0-930"><span class="linenos" data-linenos=" 930 "></span></a><span class="sd">        7. Image-based matching (if compare_images=True)</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><a href="#__codelineno-0-931"><span class="linenos" data-linenos=" 931 "></span></a>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><a href="#__codelineno-0-932"><span class="linenos" data-linenos=" 932 "></span></a><span class="sd">        Shape is for REJECTION only - compatible shapes don&#39;t imply a match.</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><a href="#__codelineno-0-933"><span class="linenos" data-linenos=" 933 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><a href="#__codelineno-0-934"><span class="linenos" data-linenos=" 934 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><a href="#__codelineno-0-935"><span class="linenos" data-linenos=" 935 "></span></a>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><a href="#__codelineno-0-936"><span class="linenos" data-linenos=" 936 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.io.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">sanitize_filename</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><a href="#__codelineno-0-937"><span class="linenos" data-linenos=" 937 "></span></a>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><a href="#__codelineno-0-938"><span class="linenos" data-linenos=" 938 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">AUTO</span><span class="p">:</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><a href="#__codelineno-0-939"><span class="linenos" data-linenos=" 939 "></span></a>        <span class="c1"># Build list of viable candidates (not rejected by shape/provenance)</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><a href="#__codelineno-0-940"><span class="linenos" data-linenos=" 940 "></span></a>        <span class="n">viable</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><a href="#__codelineno-0-941"><span class="linenos" data-linenos=" 941 "></span></a>        <span class="k">for</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><a href="#__codelineno-0-942"><span class="linenos" data-linenos=" 942 "></span></a>            <span class="c1"># REJECTION CHECK 1: Shape compatibility</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><a href="#__codelineno-0-943"><span class="linenos" data-linenos=" 943 "></span></a>            <span class="n">shape_compat</span> <span class="o">=</span> <span class="n">shapes_compatible</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">incoming</span><span class="p">)</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><a href="#__codelineno-0-944"><span class="linenos" data-linenos=" 944 "></span></a>            <span class="k">if</span> <span class="n">shape_compat</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><a href="#__codelineno-0-945"><span class="linenos" data-linenos=" 945 "></span></a>                <span class="c1"># Definitely incompatible shapes - skip</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a><a href="#__codelineno-0-946"><span class="linenos" data-linenos=" 946 "></span></a>                <span class="k">continue</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><a href="#__codelineno-0-947"><span class="linenos" data-linenos=" 947 "></span></a>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a><a href="#__codelineno-0-948"><span class="linenos" data-linenos=" 948 "></span></a>            <span class="c1"># REJECTION CHECK 2: original_video conflict</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><a href="#__codelineno-0-949"><span class="linenos" data-linenos=" 949 "></span></a>            <span class="k">if</span> <span class="n">original_videos_conflict</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">incoming</span><span class="p">):</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a><a href="#__codelineno-0-950"><span class="linenos" data-linenos=" 950 "></span></a>                <span class="c1"># Both have provenance pointing to different files - skip</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a><a href="#__codelineno-0-951"><span class="linenos" data-linenos=" 951 "></span></a>                <span class="k">continue</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a><a href="#__codelineno-0-952"><span class="linenos" data-linenos=" 952 "></span></a>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a><a href="#__codelineno-0-953"><span class="linenos" data-linenos=" 953 "></span></a>            <span class="n">viable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate</span><span class="p">)</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a><a href="#__codelineno-0-954"><span class="linenos" data-linenos=" 954 "></span></a>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a><a href="#__codelineno-0-955"><span class="linenos" data-linenos=" 955 "></span></a>        <span class="c1"># DEFINITIVE CHECK: File identity (handles source_video chains)</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a><a href="#__codelineno-0-956"><span class="linenos" data-linenos=" 956 "></span></a>        <span class="k">for</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="n">viable</span><span class="p">:</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a><a href="#__codelineno-0-957"><span class="linenos" data-linenos=" 957 "></span></a>            <span class="k">if</span> <span class="n">is_same_file</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">incoming</span><span class="p">):</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a><a href="#__codelineno-0-958"><span class="linenos" data-linenos=" 958 "></span></a>                <span class="k">return</span> <span class="n">candidate</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><a href="#__codelineno-0-959"><span class="linenos" data-linenos=" 959 "></span></a>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a><a href="#__codelineno-0-960"><span class="linenos" data-linenos=" 960 "></span></a>        <span class="c1"># STRING CHECK: Full path match</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a><a href="#__codelineno-0-961"><span class="linenos" data-linenos=" 961 "></span></a>        <span class="k">for</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="n">viable</span><span class="p">:</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><a href="#__codelineno-0-962"><span class="linenos" data-linenos=" 962 "></span></a>            <span class="k">if</span> <span class="n">candidate</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">incoming</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a><a href="#__codelineno-0-963"><span class="linenos" data-linenos=" 963 "></span></a>                <span class="k">return</span> <span class="n">candidate</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a><a href="#__codelineno-0-964"><span class="linenos" data-linenos=" 964 "></span></a>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a><a href="#__codelineno-0-965"><span class="linenos" data-linenos=" 965 "></span></a>        <span class="c1"># STRING CHECK: Leaf path uniqueness</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a><a href="#__codelineno-0-966"><span class="linenos" data-linenos=" 966 "></span></a>        <span class="c1"># Match paths by comparing suffixes at increasing depths</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a><a href="#__codelineno-0-967"><span class="linenos" data-linenos=" 967 "></span></a>        <span class="k">if</span> <span class="n">viable</span><span class="p">:</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a><a href="#__codelineno-0-968"><span class="linenos" data-linenos=" 968 "></span></a>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a><a href="#__codelineno-0-969"><span class="linenos" data-linenos=" 969 "></span></a>            <span class="k">def</span><span class="w"> </span><span class="nf">get_path_parts</span><span class="p">(</span><span class="n">video</span><span class="p">:</span> <span class="n">Video</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a><a href="#__codelineno-0-970"><span class="linenos" data-linenos=" 970 "></span></a><span class="w">                </span><span class="sd">&quot;&quot;&quot;Get path parts for comparison, using root video for embedded.&quot;&quot;&quot;</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a><a href="#__codelineno-0-971"><span class="linenos" data-linenos=" 971 "></span></a>                <span class="n">root</span> <span class="o">=</span> <span class="n">_get_root_video</span><span class="p">(</span><span class="n">video</span><span class="p">)</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a><a href="#__codelineno-0-972"><span class="linenos" data-linenos=" 972 "></span></a>                <span class="n">fn</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a><a href="#__codelineno-0-973"><span class="linenos" data-linenos=" 973 "></span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a><a href="#__codelineno-0-974"><span class="linenos" data-linenos=" 974 "></span></a>                    <span class="n">fn</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Use first for ImageVideo</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a><a href="#__codelineno-0-975"><span class="linenos" data-linenos=" 975 "></span></a>                <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">sanitize_filename</span><span class="p">(</span><span class="n">fn</span><span class="p">))</span><span class="o">.</span><span class="n">parts</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><a href="#__codelineno-0-976"><span class="linenos" data-linenos=" 976 "></span></a>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a><a href="#__codelineno-0-977"><span class="linenos" data-linenos=" 977 "></span></a>            <span class="n">incoming_parts</span> <span class="o">=</span> <span class="n">get_path_parts</span><span class="p">(</span><span class="n">incoming</span><span class="p">)</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><a href="#__codelineno-0-978"><span class="linenos" data-linenos=" 978 "></span></a>            <span class="n">candidate_parts</span> <span class="o">=</span> <span class="p">[(</span><span class="n">v</span><span class="p">,</span> <span class="n">get_path_parts</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">viable</span><span class="p">]</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a><a href="#__codelineno-0-979"><span class="linenos" data-linenos=" 979 "></span></a>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a><a href="#__codelineno-0-980"><span class="linenos" data-linenos=" 980 "></span></a>            <span class="c1"># Also need all existing videos for uniqueness check</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a><a href="#__codelineno-0-981"><span class="linenos" data-linenos=" 981 "></span></a>            <span class="n">all_existing_parts</span> <span class="o">=</span> <span class="p">[(</span><span class="n">v</span><span class="p">,</span> <span class="n">get_path_parts</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">]</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><a href="#__codelineno-0-982"><span class="linenos" data-linenos=" 982 "></span></a>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a><a href="#__codelineno-0-983"><span class="linenos" data-linenos=" 983 "></span></a>            <span class="c1"># Compare at increasing depths until we find a unique match</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a><a href="#__codelineno-0-984"><span class="linenos" data-linenos=" 984 "></span></a>            <span class="n">max_depth</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><a href="#__codelineno-0-985"><span class="linenos" data-linenos=" 985 "></span></a>                <span class="nb">len</span><span class="p">(</span><span class="n">incoming_parts</span><span class="p">),</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><a href="#__codelineno-0-986"><span class="linenos" data-linenos=" 986 "></span></a>                <span class="nb">max</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">all_existing_parts</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a><a href="#__codelineno-0-987"><span class="linenos" data-linenos=" 987 "></span></a>            <span class="p">)</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a><a href="#__codelineno-0-988"><span class="linenos" data-linenos=" 988 "></span></a>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><a href="#__codelineno-0-989"><span class="linenos" data-linenos=" 989 "></span></a>            <span class="k">for</span> <span class="n">depth</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a><a href="#__codelineno-0-990"><span class="linenos" data-linenos=" 990 "></span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">incoming_parts</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">depth</span><span class="p">:</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a><a href="#__codelineno-0-991"><span class="linenos" data-linenos=" 991 "></span></a>                    <span class="k">continue</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><a href="#__codelineno-0-992"><span class="linenos" data-linenos=" 992 "></span></a>                <span class="n">incoming_leaf</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">incoming_parts</span><span class="p">[</span><span class="o">-</span><span class="n">depth</span><span class="p">:])</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a><a href="#__codelineno-0-993"><span class="linenos" data-linenos=" 993 "></span></a>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a><a href="#__codelineno-0-994"><span class="linenos" data-linenos=" 994 "></span></a>                <span class="c1"># Find all viable candidates that match at this depth</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a><a href="#__codelineno-0-995"><span class="linenos" data-linenos=" 995 "></span></a>                <span class="n">matches_at_depth</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><a href="#__codelineno-0-996"><span class="linenos" data-linenos=" 996 "></span></a>                <span class="k">for</span> <span class="n">candidate</span><span class="p">,</span> <span class="n">parts</span> <span class="ow">in</span> <span class="n">candidate_parts</span><span class="p">:</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a><a href="#__codelineno-0-997"><span class="linenos" data-linenos=" 997 "></span></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">depth</span><span class="p">:</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a><a href="#__codelineno-0-998"><span class="linenos" data-linenos=" 998 "></span></a>                        <span class="k">continue</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a><a href="#__codelineno-0-999"><span class="linenos" data-linenos=" 999 "></span></a>                    <span class="n">candidate_leaf</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="n">depth</span><span class="p">:])</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><a href="#__codelineno-0-1000"><span class="linenos" data-linenos="1000 "></span></a>                    <span class="k">if</span> <span class="n">candidate_leaf</span> <span class="o">==</span> <span class="n">incoming_leaf</span><span class="p">:</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a><a href="#__codelineno-0-1001"><span class="linenos" data-linenos="1001 "></span></a>                        <span class="n">matches_at_depth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate</span><span class="p">)</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a><a href="#__codelineno-0-1002"><span class="linenos" data-linenos="1002 "></span></a>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a><a href="#__codelineno-0-1003"><span class="linenos" data-linenos="1003 "></span></a>                <span class="c1"># If exactly one match at this depth, use it</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a><a href="#__codelineno-0-1004"><span class="linenos" data-linenos="1004 "></span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches_at_depth</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a><a href="#__codelineno-0-1005"><span class="linenos" data-linenos="1005 "></span></a>                    <span class="k">return</span> <span class="n">matches_at_depth</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a><a href="#__codelineno-0-1006"><span class="linenos" data-linenos="1006 "></span></a>                <span class="c1"># If no matches, try deeper</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a><a href="#__codelineno-0-1007"><span class="linenos" data-linenos="1007 "></span></a>                <span class="c1"># If multiple matches, continue deeper to disambiguate</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a><a href="#__codelineno-0-1008"><span class="linenos" data-linenos="1008 "></span></a>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a><a href="#__codelineno-0-1009"><span class="linenos" data-linenos="1009 "></span></a>        <span class="c1"># POSE MATCHING: Compare pose annotations (default in AUTO)</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a><a href="#__codelineno-0-1010"><span class="linenos" data-linenos="1010 "></span></a>        <span class="k">if</span> <span class="n">labels_incoming</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">labels_base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><a href="#__codelineno-0-1011"><span class="linenos" data-linenos="1011 "></span></a>            <span class="n">match</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_match_by_poses</span><span class="p">(</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a><a href="#__codelineno-0-1012"><span class="linenos" data-linenos="1012 "></span></a>                <span class="n">incoming</span><span class="p">,</span> <span class="n">viable</span><span class="p">,</span> <span class="n">labels_incoming</span><span class="p">,</span> <span class="n">labels_base</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a><a href="#__codelineno-0-1013"><span class="linenos" data-linenos="1013 "></span></a>            <span class="p">)</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><a href="#__codelineno-0-1014"><span class="linenos" data-linenos="1014 "></span></a>            <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a><a href="#__codelineno-0-1015"><span class="linenos" data-linenos="1015 "></span></a>                <span class="k">return</span> <span class="n">match</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a><a href="#__codelineno-0-1016"><span class="linenos" data-linenos="1016 "></span></a>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a><a href="#__codelineno-0-1017"><span class="linenos" data-linenos="1017 "></span></a>        <span class="c1"># IMAGE MATCHING: Compare frame images (opt-in)</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><a href="#__codelineno-0-1018"><span class="linenos" data-linenos="1018 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_images</span><span class="p">:</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a><a href="#__codelineno-0-1019"><span class="linenos" data-linenos="1019 "></span></a>            <span class="n">match</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_match_by_images</span><span class="p">(</span><span class="n">incoming</span><span class="p">,</span> <span class="n">viable</span><span class="p">)</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><a href="#__codelineno-0-1020"><span class="linenos" data-linenos="1020 "></span></a>            <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><a href="#__codelineno-0-1021"><span class="linenos" data-linenos="1021 "></span></a>                <span class="k">return</span> <span class="n">match</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><a href="#__codelineno-0-1022"><span class="linenos" data-linenos="1022 "></span></a>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><a href="#__codelineno-0-1023"><span class="linenos" data-linenos="1023 "></span></a>        <span class="c1"># No match found</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><a href="#__codelineno-0-1024"><span class="linenos" data-linenos="1024 "></span></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><a href="#__codelineno-0-1025"><span class="linenos" data-linenos="1025 "></span></a>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><a href="#__codelineno-0-1026"><span class="linenos" data-linenos="1026 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><a href="#__codelineno-0-1027"><span class="linenos" data-linenos="1027 "></span></a>        <span class="c1"># Non-AUTO methods: use pairwise match()</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><a href="#__codelineno-0-1028"><span class="linenos" data-linenos="1028 "></span></a>        <span class="k">for</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><a href="#__codelineno-0-1029"><span class="linenos" data-linenos="1029 "></span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">incoming</span><span class="p">):</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><a href="#__codelineno-0-1030"><span class="linenos" data-linenos="1030 "></span></a>                <span class="k">return</span> <span class="n">candidate</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><a href="#__codelineno-0-1031"><span class="linenos" data-linenos="1031 "></span></a>        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.VideoMatcher.match" class="doc doc-heading">
            <code class="highlight language-python"><span class="k">match</span><span class="p">(</span><span class="n">video1</span><span class="p">,</span> <span class="n">video2</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.VideoMatcher.match" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Check if two videos match according to the configured method.</p>
<p>For AUTO method, this performs pairwise checks (file identity, path match).
For full AUTO matching with leaf-uniqueness, use find_match() instead.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-852" name="__codelineno-0-852"></a><a href="#__codelineno-0-852"><span class="linenos" data-linenos="852 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">video1</span><span class="p">:</span> <span class="n">Video</span><span class="p">,</span> <span class="n">video2</span><span class="p">:</span> <span class="n">Video</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a><a href="#__codelineno-0-853"><span class="linenos" data-linenos="853 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if two videos match according to the configured method.</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a><a href="#__codelineno-0-854"><span class="linenos" data-linenos="854 "></span></a>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a><a href="#__codelineno-0-855"><span class="linenos" data-linenos="855 "></span></a><span class="sd">    For AUTO method, this performs pairwise checks (file identity, path match).</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><a href="#__codelineno-0-856"><span class="linenos" data-linenos="856 "></span></a><span class="sd">    For full AUTO matching with leaf-uniqueness, use find_match() instead.</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a><a href="#__codelineno-0-857"><span class="linenos" data-linenos="857 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><a href="#__codelineno-0-858"><span class="linenos" data-linenos="858 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">AUTO</span><span class="p">:</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><a href="#__codelineno-0-859"><span class="linenos" data-linenos="859 "></span></a>        <span class="c1"># Pairwise AUTO: rejection checks + definitive identity + path match</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a><a href="#__codelineno-0-860"><span class="linenos" data-linenos="860 "></span></a>        <span class="c1"># (Leaf-uniqueness requires full candidate list - use find_match())</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><a href="#__codelineno-0-861"><span class="linenos" data-linenos="861 "></span></a>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><a href="#__codelineno-0-862"><span class="linenos" data-linenos="862 "></span></a>        <span class="c1"># Rejection: incompatible shapes</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a><a href="#__codelineno-0-863"><span class="linenos" data-linenos="863 "></span></a>        <span class="k">if</span> <span class="n">shapes_compatible</span><span class="p">(</span><span class="n">video1</span><span class="p">,</span> <span class="n">video2</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><a href="#__codelineno-0-864"><span class="linenos" data-linenos="864 "></span></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a><a href="#__codelineno-0-865"><span class="linenos" data-linenos="865 "></span></a>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a><a href="#__codelineno-0-866"><span class="linenos" data-linenos="866 "></span></a>        <span class="c1"># Rejection: conflicting provenance</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a><a href="#__codelineno-0-867"><span class="linenos" data-linenos="867 "></span></a>        <span class="k">if</span> <span class="n">original_videos_conflict</span><span class="p">(</span><span class="n">video1</span><span class="p">,</span> <span class="n">video2</span><span class="p">):</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a><a href="#__codelineno-0-868"><span class="linenos" data-linenos="868 "></span></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><a href="#__codelineno-0-869"><span class="linenos" data-linenos="869 "></span></a>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><a href="#__codelineno-0-870"><span class="linenos" data-linenos="870 "></span></a>        <span class="c1"># Definitive: same file identity</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a><a href="#__codelineno-0-871"><span class="linenos" data-linenos="871 "></span></a>        <span class="k">if</span> <span class="n">is_same_file</span><span class="p">(</span><span class="n">video1</span><span class="p">,</span> <span class="n">video2</span><span class="p">):</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><a href="#__codelineno-0-872"><span class="linenos" data-linenos="872 "></span></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><a href="#__codelineno-0-873"><span class="linenos" data-linenos="873 "></span></a>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a><a href="#__codelineno-0-874"><span class="linenos" data-linenos="874 "></span></a>        <span class="c1"># String: strict path match</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><a href="#__codelineno-0-875"><span class="linenos" data-linenos="875 "></span></a>        <span class="k">if</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">video2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><a href="#__codelineno-0-876"><span class="linenos" data-linenos="876 "></span></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><a href="#__codelineno-0-877"><span class="linenos" data-linenos="877 "></span></a>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a><a href="#__codelineno-0-878"><span class="linenos" data-linenos="878 "></span></a>        <span class="c1"># String: basename match (for pairwise, this is the fallback)</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a><a href="#__codelineno-0-879"><span class="linenos" data-linenos="879 "></span></a>        <span class="k">if</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">video2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a><a href="#__codelineno-0-880"><span class="linenos" data-linenos="880 "></span></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><a href="#__codelineno-0-881"><span class="linenos" data-linenos="881 "></span></a>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a><a href="#__codelineno-0-882"><span class="linenos" data-linenos="882 "></span></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a><a href="#__codelineno-0-883"><span class="linenos" data-linenos="883 "></span></a>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a><a href="#__codelineno-0-884"><span class="linenos" data-linenos="884 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">PATH</span><span class="p">:</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a><a href="#__codelineno-0-885"><span class="linenos" data-linenos="885 "></span></a>        <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">video2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">)</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><a href="#__codelineno-0-886"><span class="linenos" data-linenos="886 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">BASENAME</span><span class="p">:</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a><a href="#__codelineno-0-887"><span class="linenos" data-linenos="887 "></span></a>        <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">video2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a><a href="#__codelineno-0-888"><span class="linenos" data-linenos="888 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">CONTENT</span><span class="p">:</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a><a href="#__codelineno-0-889"><span class="linenos" data-linenos="889 "></span></a>        <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_content</span><span class="p">(</span><span class="n">video2</span><span class="p">)</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a><a href="#__codelineno-0-890"><span class="linenos" data-linenos="890 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">IMAGE_DEDUP</span><span class="p">:</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a><a href="#__codelineno-0-891"><span class="linenos" data-linenos="891 "></span></a>        <span class="c1"># Match ImageVideo instances with overlapping images (ImageVideo only)</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a><a href="#__codelineno-0-892"><span class="linenos" data-linenos="892 "></span></a>        <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">has_overlapping_images</span><span class="p">(</span><span class="n">video2</span><span class="p">)</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a><a href="#__codelineno-0-893"><span class="linenos" data-linenos="893 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">SHAPE</span><span class="p">:</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a><a href="#__codelineno-0-894"><span class="linenos" data-linenos="894 "></span></a>        <span class="c1"># Match videos by shape only (height, width, channels)</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a><a href="#__codelineno-0-895"><span class="linenos" data-linenos="895 "></span></a>        <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_shape</span><span class="p">(</span><span class="n">video2</span><span class="p">)</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a><a href="#__codelineno-0-896"><span class="linenos" data-linenos="896 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a><a href="#__codelineno-0-897"><span class="linenos" data-linenos="897 "></span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown video match method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="skeletonmatcher">SkeletonMatcher<a class="headerlink" href="#skeletonmatcher" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.SkeletonMatcher" class="doc doc-heading">
            <code>sleap_io.model.matching.SkeletonMatcher</code>


<a href="#sleap_io.model.matching.SkeletonMatcher" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">



        <p>Matcher for comparing and matching skeletons.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.method">method</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matching method to use. Can be a SkeletonMatchMethod enum value
or a string that will be converted to the enum. Default is STRUCTURE.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.require_same_order">require_same_order</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to require nodes in the same order for STRUCTURE
matching. Only used when method is STRUCTURE. Default is False.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.min_overlap">min_overlap</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum Jaccard similarity required for OVERLAP matching.
Only used when method is OVERLAP. Default is 0.5.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>












<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__eq__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.SkeletonMatcher.__eq__&lt;/code&gt;)" href="#sleap_io.model.matching.SkeletonMatcher.__eq__">__eq__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class SkeletonMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SkeletonMatchMethod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;STRUCTURE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;structure&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;require_same_order&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;min_overlap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.SkeletonMatcher.__init__&lt;/code&gt;)" href="#sleap_io.model.matching.SkeletonMatcher.__init__">__init__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class SkeletonMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;__replace__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;changes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.SkeletonMatcher.__replace__&lt;/code&gt;)" href="#sleap_io.model.matching.SkeletonMatcher.__replace__">__replace__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class SkeletonMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__repr__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.SkeletonMatcher.__repr__&lt;/code&gt;)" href="#sleap_io.model.matching.SkeletonMatcher.__repr__">__repr__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class SkeletonMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__setattr__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.SkeletonMatcher.__setattr__&lt;/code&gt;)" href="#sleap_io.model.matching.SkeletonMatcher.__setattr__">__setattr__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class SkeletonMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;k&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skeleton1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;skeleton2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.SkeletonMatcher.match&lt;/code&gt;)" href="#sleap_io.model.matching.SkeletonMatcher.match">match</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Check if two skeletons match according to the configured method.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



              <details class="mkdocstrings-source">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-647" name="__codelineno-0-647"></a><a href="#__codelineno-0-647"><span class="linenos" data-linenos="647 "></span></a><span class="nd">@attrs</span><span class="o">.</span><span class="n">define</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><a href="#__codelineno-0-648"><span class="linenos" data-linenos="648 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">SkeletonMatcher</span><span class="p">:</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><a href="#__codelineno-0-649"><span class="linenos" data-linenos="649 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Matcher for comparing and matching skeletons.</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><a href="#__codelineno-0-650"><span class="linenos" data-linenos="650 "></span></a>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><a href="#__codelineno-0-651"><span class="linenos" data-linenos="651 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><a href="#__codelineno-0-652"><span class="linenos" data-linenos="652 "></span></a><span class="sd">        method: The matching method to use. Can be a SkeletonMatchMethod enum value</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><a href="#__codelineno-0-653"><span class="linenos" data-linenos="653 "></span></a><span class="sd">            or a string that will be converted to the enum. Default is STRUCTURE.</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><a href="#__codelineno-0-654"><span class="linenos" data-linenos="654 "></span></a><span class="sd">        require_same_order: Whether to require nodes in the same order for STRUCTURE</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><a href="#__codelineno-0-655"><span class="linenos" data-linenos="655 "></span></a><span class="sd">            matching. Only used when method is STRUCTURE. Default is False.</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a><a href="#__codelineno-0-656"><span class="linenos" data-linenos="656 "></span></a><span class="sd">        min_overlap: Minimum Jaccard similarity required for OVERLAP matching.</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><a href="#__codelineno-0-657"><span class="linenos" data-linenos="657 "></span></a><span class="sd">            Only used when method is OVERLAP. Default is 0.5.</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a><a href="#__codelineno-0-658"><span class="linenos" data-linenos="658 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><a href="#__codelineno-0-659"><span class="linenos" data-linenos="659 "></span></a>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><a href="#__codelineno-0-660"><span class="linenos" data-linenos="660 "></span></a>    <span class="n">method</span><span class="p">:</span> <span class="n">SkeletonMatchMethod</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">field</span><span class="p">(</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><a href="#__codelineno-0-661"><span class="linenos" data-linenos="661 "></span></a>        <span class="n">default</span><span class="o">=</span><span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">STRUCTURE</span><span class="p">,</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><a href="#__codelineno-0-662"><span class="linenos" data-linenos="662 "></span></a>        <span class="n">converter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">SkeletonMatchMethod</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a><a href="#__codelineno-0-663"><span class="linenos" data-linenos="663 "></span></a>    <span class="p">)</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><a href="#__codelineno-0-664"><span class="linenos" data-linenos="664 "></span></a>    <span class="n">require_same_order</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><a href="#__codelineno-0-665"><span class="linenos" data-linenos="665 "></span></a>    <span class="n">min_overlap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><a href="#__codelineno-0-666"><span class="linenos" data-linenos="666 "></span></a>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a><a href="#__codelineno-0-667"><span class="linenos" data-linenos="667 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skeleton1</span><span class="p">:</span> <span class="n">Skeleton</span><span class="p">,</span> <span class="n">skeleton2</span><span class="p">:</span> <span class="n">Skeleton</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><a href="#__codelineno-0-668"><span class="linenos" data-linenos="668 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two skeletons match according to the configured method.&quot;&quot;&quot;</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a><a href="#__codelineno-0-669"><span class="linenos" data-linenos="669 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">EXACT</span><span class="p">:</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><a href="#__codelineno-0-670"><span class="linenos" data-linenos="670 "></span></a>            <span class="k">return</span> <span class="n">skeleton1</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">skeleton2</span><span class="p">,</span> <span class="n">require_same_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><a href="#__codelineno-0-671"><span class="linenos" data-linenos="671 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">STRUCTURE</span><span class="p">:</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a><a href="#__codelineno-0-672"><span class="linenos" data-linenos="672 "></span></a>            <span class="k">return</span> <span class="n">skeleton1</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a><a href="#__codelineno-0-673"><span class="linenos" data-linenos="673 "></span></a>                <span class="n">skeleton2</span><span class="p">,</span> <span class="n">require_same_order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">require_same_order</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a><a href="#__codelineno-0-674"><span class="linenos" data-linenos="674 "></span></a>            <span class="p">)</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><a href="#__codelineno-0-675"><span class="linenos" data-linenos="675 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">OVERLAP</span><span class="p">:</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a><a href="#__codelineno-0-676"><span class="linenos" data-linenos="676 "></span></a>            <span class="n">metrics</span> <span class="o">=</span> <span class="n">skeleton1</span><span class="o">.</span><span class="n">node_similarities</span><span class="p">(</span><span class="n">skeleton2</span><span class="p">)</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a><a href="#__codelineno-0-677"><span class="linenos" data-linenos="677 "></span></a>            <span class="k">return</span> <span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;jaccard&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_overlap</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><a href="#__codelineno-0-678"><span class="linenos" data-linenos="678 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">SUBSET</span><span class="p">:</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><a href="#__codelineno-0-679"><span class="linenos" data-linenos="679 "></span></a>            <span class="c1"># Check if skeleton1 nodes are subset of skeleton2</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a><a href="#__codelineno-0-680"><span class="linenos" data-linenos="680 "></span></a>            <span class="n">nodes1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">skeleton1</span><span class="o">.</span><span class="n">node_names</span><span class="p">)</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a><a href="#__codelineno-0-681"><span class="linenos" data-linenos="681 "></span></a>            <span class="n">nodes2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">skeleton2</span><span class="o">.</span><span class="n">node_names</span><span class="p">)</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a><a href="#__codelineno-0-682"><span class="linenos" data-linenos="682 "></span></a>            <span class="k">return</span> <span class="n">nodes1</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">nodes2</span><span class="p">)</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a><a href="#__codelineno-0-683"><span class="linenos" data-linenos="683 "></span></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a><a href="#__codelineno-0-684"><span class="linenos" data-linenos="684 "></span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown skeleton match method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.SkeletonMatcher.__annotations__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__annotations__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;SkeletonMatchMethod | str&#39;</span><span class="p">,</span> <span class="s1">&#39;require_same_order&#39;</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span><span class="p">,</span> <span class="s1">&#39;min_overlap&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">}</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.SkeletonMatcher.__annotations__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>dict() -&gt; new empty dictionary
dict(mapping) -&gt; new dictionary initialized from a mapping object's
    (key, value) pairs
dict(iterable) -&gt; new dictionary initialized as if via:
    d = {}
    for k, v in iterable:
        d[k] = v
dict(**kwargs) -&gt; new dictionary initialized with the name=value pairs
    in the keyword argument list.  For example:  dict(one=1, two=2)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.SkeletonMatcher.__attrs_own_setattr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__attrs_own_setattr__</span> <span class="o">=</span> <span class="kc">True</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.SkeletonMatcher.__attrs_own_setattr__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Returns True when the argument is true, False otherwise.
The builtins True and False are the only two instances of the class bool.
The class bool is a subclass of the class int, and cannot be subclassed.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.SkeletonMatcher.__attrs_props__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__attrs_props__</span> <span class="o">=</span> <span class="n">ClassProps</span><span class="p">(</span><span class="n">is_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_slotted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_weakref_slot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_frozen</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=&lt;</span><span class="n">KeywordOnly</span><span class="o">.</span><span class="n">NO</span><span class="p">:</span> <span class="s1">&#39;no&#39;</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">collected_fields_by_mro</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_init</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_repr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_eq</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_ordering</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hashability</span><span class="o">=&lt;</span><span class="n">Hashability</span><span class="o">.</span><span class="n">UNHASHABLE</span><span class="p">:</span> <span class="s1">&#39;unhashable&#39;</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">added_match_args</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_str</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">added_pickling</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">on_setattr_hook</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">pipe</span><span class="o">.&lt;</span><span class="nb">locals</span><span class="o">&gt;.</span><span class="n">wrapped_pipe</span> <span class="n">at</span> <span class="mh">0x7f45c0a9aca0</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">field_transformer</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.SkeletonMatcher.__attrs_props__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Effective class properties as derived from parameters to <code>attr.s()</code> or
<code>define()</code> decorators.</p>
<p>This is the same data structure that <em>attrs</em> uses internally to decide how
to construct the final class.</p>
<p>Warning:</p>
<div class="highlight"><pre><span></span><code>This feature is currently **experimental** and is not covered by our
strict backwards-compatibility guarantees.
</code></pre></div>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.__attrs_props__.is_exception">is_exception</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class is treated as an exception class.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.__attrs_props__.is_slotted">is_slotted</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class is <code>slotted &lt;slotted classes&gt;</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.__attrs_props__.has_weakref_slot">has_weakref_slot</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has a slot for weak references.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.__attrs_props__.is_frozen">is_frozen</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class is frozen.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.__attrs_props__.kw_only">kw_only</span></code></td>
            <td>
                  <code><span title="KeywordOnly">KeywordOnly</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether / how the class enforces keyword-only arguments on the
<code>__init__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.__attrs_props__.collected_fields_by_mro">collected_fields_by_mro</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class fields were collected by method resolution order.
That is, correctly but unlike <code>dataclasses</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.__attrs_props__.added_init">added_init</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has an <em>attrs</em>-generated <code>__init__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.__attrs_props__.added_repr">added_repr</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has an <em>attrs</em>-generated <code>__repr__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.__attrs_props__.added_eq">added_eq</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has <em>attrs</em>-generated equality methods.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.__attrs_props__.added_ordering">added_ordering</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has <em>attrs</em>-generated ordering methods.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.__attrs_props__.hashability">hashability</span></code></td>
            <td>
                  <code><span title="Hashability">Hashability</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How <code>hashable &lt;hashing&gt;</code> the class is.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.__attrs_props__.added_match_args">added_match_args</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class supports positional <code>match &lt;match&gt;</code> over its
fields.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.__attrs_props__.added_str">added_str</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has an <em>attrs</em>-generated <code>__str__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.__attrs_props__.added_pickling">added_pickling</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has <em>attrs</em>-generated <code>__getstate__</code> and
<code>__setstate__</code> methods for <code>pickle</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.__attrs_props__.on_setattr_hook">on_setattr_hook</span></code></td>
            <td>
                  <code><span title="Callable">Callable</span>[[<span title="typing.Any">Any</span>, <span title="Attribute">Attribute</span>[<span title="typing.Any">Any</span>], <span title="typing.Any">Any</span>], <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The class's <code>__setattr__</code> hook.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.__attrs_props__.field_transformer">field_transformer</span></code></td>
            <td>
                  <code><span title="Callable">Callable</span>[[<span title="Attribute">Attribute</span>[<span title="typing.Any">Any</span>]], <span title="Attribute">Attribute</span>[<span title="typing.Any">Any</span>]] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The class's <code>field transformers &lt;transform-fields&gt;</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>.. versionadded:: 25.4.0</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.SkeletonMatcher.__doc__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__doc__</span> <span class="o">=</span> <span class="s1">&#39;Matcher for comparing and matching skeletons.</span><span class="se">\n\n</span><span class="s1">Attributes:</span><span class="se">\n</span><span class="s1">    method: The matching method to use. Can be a SkeletonMatchMethod enum value</span><span class="se">\n</span><span class="s1">        or a string that will be converted to the enum. Default is STRUCTURE.</span><span class="se">\n</span><span class="s1">    require_same_order: Whether to require nodes in the same order for STRUCTURE</span><span class="se">\n</span><span class="s1">        matching. Only used when method is STRUCTURE. Default is False.</span><span class="se">\n</span><span class="s1">    min_overlap: Minimum Jaccard similarity required for OVERLAP matching.</span><span class="se">\n</span><span class="s1">        Only used when method is OVERLAP. Default is 0.5.</span><span class="se">\n</span><span class="s1">&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.SkeletonMatcher.__doc__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to 'utf-8'.
errors defaults to 'strict'.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.SkeletonMatcher.__firstlineno__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__firstlineno__</span> <span class="o">=</span> <span class="mi">647</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.SkeletonMatcher.__firstlineno__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>int([x]) -&gt; integer
int(x, base=10) -&gt; integer</p>
<p>Convert a number or string to an integer, or return 0 if no arguments
are given.  If x is a number, return x.<strong>int</strong>().  For floating-point
numbers, this truncates towards zero.</p>
<p>If x is not a number or if base is given, then x must be a string,
bytes, or bytearray instance representing an integer literal in the
given base.  The literal can be preceded by '+' or '-' and be surrounded
by whitespace.  The base defaults to 10.  Valid bases are 0 and 2-36.
Base 0 means to interpret the base from the string as an integer literal.</p>
<blockquote>
<blockquote>
<blockquote>
<p>int('0b100', base=0)
4</p>
</blockquote>
</blockquote>
</blockquote>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.SkeletonMatcher.__match_args__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__match_args__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="s1">&#39;require_same_order&#39;</span><span class="p">,</span> <span class="s1">&#39;min_overlap&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.SkeletonMatcher.__match_args__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Built-in immutable sequence.</p>
<p>If no argument is given, the constructor returns an empty tuple.
If iterable is specified the tuple is initialized from iterable's items.</p>
<p>If the argument is a tuple, the return value is the same object.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.SkeletonMatcher.__module__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__module__</span> <span class="o">=</span> <span class="s1">&#39;sleap_io.model.matching&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.SkeletonMatcher.__module__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to 'utf-8'.
errors defaults to 'strict'.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.SkeletonMatcher.__slots__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="s1">&#39;require_same_order&#39;</span><span class="p">,</span> <span class="s1">&#39;min_overlap&#39;</span><span class="p">,</span> <span class="s1">&#39;__weakref__&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.SkeletonMatcher.__slots__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Built-in immutable sequence.</p>
<p>If no argument is given, the constructor returns an empty tuple.
If iterable is specified the tuple is initialized from iterable's items.</p>
<p>If the argument is a tuple, the return value is the same object.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.SkeletonMatcher.__static_attributes__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__static_attributes__</span> <span class="o">=</span> <span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.SkeletonMatcher.__static_attributes__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Built-in immutable sequence.</p>
<p>If no argument is given, the constructor returns an empty tuple.
If iterable is specified the tuple is initialized from iterable's items.</p>
<p>If the argument is a tuple, the return value is the same object.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.SkeletonMatcher.__weakref__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__weakref__</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#sleap_io.model.matching.SkeletonMatcher.__weakref__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>list of weak references to the object</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.SkeletonMatcher.__eq__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.SkeletonMatcher.__eq__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class SkeletonMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-16" name="__codelineno-0-16"></a><a href="#__codelineno-0-16"><span class="linenos" data-linenos="16 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><a href="#__codelineno-0-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><a href="#__codelineno-0-18"><span class="linenos" data-linenos="18 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><a href="#__codelineno-0-19"><span class="linenos" data-linenos="19 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">Any</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><a href="#__codelineno-0-20"><span class="linenos" data-linenos="20 "></span></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><a href="#__codelineno-0-21"><span class="linenos" data-linenos="21 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">attrs</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><a href="#__codelineno-0-22"><span class="linenos" data-linenos="22 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.SkeletonMatcher.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">method</span><span class="o">=&lt;</span><span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">STRUCTURE</span><span class="p">:</span> <span class="s1">&#39;structure&#39;</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">require_same_order</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">min_overlap</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.SkeletonMatcher.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class SkeletonMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-24" name="__codelineno-0-24"></a><a href="#__codelineno-0-24"><span class="linenos" data-linenos="24 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.instance</span><span class="w"> </span><span class="kn">import</span> <span class="n">Instance</span><span class="p">,</span> <span class="n">Track</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><a href="#__codelineno-0-25"><span class="linenos" data-linenos="25 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.labeled_frame</span><span class="w"> </span><span class="kn">import</span> <span class="n">LabeledFrame</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><a href="#__codelineno-0-26"><span class="linenos" data-linenos="26 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.skeleton</span><span class="w"> </span><span class="kn">import</span> <span class="n">Skeleton</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><a href="#__codelineno-0-27"><span class="linenos" data-linenos="27 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.video</span><span class="w"> </span><span class="kn">import</span> <span class="n">Video</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.SkeletonMatcher.__replace__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__replace__</span><span class="p">(</span><span class="o">**</span><span class="n">changes</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.SkeletonMatcher.__replace__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class SkeletonMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><a href="#__codelineno-0-1100"><span class="linenos" data-linenos="1100 "></span></a><span class="n">Only</span> <span class="n">used</span> <span class="n">when</span> <span class="n">compare_images</span><span class="o">=</span><span class="kc">True</span><span class="o">.</span> <span class="n">Expensive</span> <span class="n">operation</span><span class="o">.</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.SkeletonMatcher.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#sleap_io.model.matching.SkeletonMatcher.__repr__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class SkeletonMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="sd">&quot;&quot;&quot;Unified matcher system for comparing and matching data structures during merging.</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="sd">This module provides configurable matchers for comparing skeletons, instances, tracks,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="sd">and videos during merge operations. The matchers use various strategies to determine</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="sd">when data structures should be considered equivalent during merging.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="sd">Key features:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="sd">- Skeleton matching: exact, structure-based, overlap, and subset matching</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="sd">- Instance matching: spatial proximity, track identity, and bounding box IoU</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><a href="#__codelineno-0-10"><span class="linenos" data-linenos="10 "></span></a><span class="sd">- Track matching: by name or object identity</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><a href="#__codelineno-0-11"><span class="linenos" data-linenos="11 "></span></a><span class="sd">- Video matching: path, basename, content, and auto matching</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><a href="#__codelineno-0-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><a href="#__codelineno-0-13"><span class="linenos" data-linenos="13 "></span></a><span class="sd">Video matching supports path-based, filename-based, content-based, and</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><a href="#__codelineno-0-14"><span class="linenos" data-linenos="14 "></span></a><span class="sd">automatic strategies.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><a href="#__codelineno-0-15"><span class="linenos" data-linenos="15 "></span></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.SkeletonMatcher.__setattr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.SkeletonMatcher.__setattr__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class SkeletonMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1176" name="__codelineno-0-1176"></a><a href="#__codelineno-0-1176"><span class="linenos" data-linenos="1176 "></span></a>        <span class="n">details</span><span class="p">:</span> <span class="n">Dictionary</span> <span class="n">containing</span> <span class="n">additional</span> <span class="n">error</span> <span class="n">details</span> <span class="ow">and</span> <span class="n">context</span><span class="o">.</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a><a href="#__codelineno-0-1177"><span class="linenos" data-linenos="1177 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a><a href="#__codelineno-0-1178"><span class="linenos" data-linenos="1178 "></span></a>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a><a href="#__codelineno-0-1179"><span class="linenos" data-linenos="1179 "></span></a><span class="sd">    message: str</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a><a href="#__codelineno-0-1180"><span class="linenos" data-linenos="1180 "></span></a><span class="sd">    details: dict = attrs.field(factory=dict)</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a><a href="#__codelineno-0-1181"><span class="linenos" data-linenos="1181 "></span></a>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a><a href="#__codelineno-0-1182"><span class="linenos" data-linenos="1182 "></span></a>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a><a href="#__codelineno-0-1183"><span class="linenos" data-linenos="1183 "></span></a><span class="sd">class SkeletonMismatchError(MergeError):</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a><a href="#__codelineno-0-1184"><span class="linenos" data-linenos="1184 "></span></a><span class="sd">    &quot;&quot;&quot;</span><span class="n">Raised</span> <span class="n">when</span> <span class="n">skeletons</span> <span class="n">don</span><span class="s1">&#39;t match during merge.&quot;&quot;&quot;</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.SkeletonMatcher.match" class="doc doc-heading">
            <code class="highlight language-python"><span class="k">match</span><span class="p">(</span><span class="n">skeleton1</span><span class="p">,</span> <span class="n">skeleton2</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.SkeletonMatcher.match" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Check if two skeletons match according to the configured method.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-667" name="__codelineno-0-667"></a><a href="#__codelineno-0-667"><span class="linenos" data-linenos="667 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skeleton1</span><span class="p">:</span> <span class="n">Skeleton</span><span class="p">,</span> <span class="n">skeleton2</span><span class="p">:</span> <span class="n">Skeleton</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><a href="#__codelineno-0-668"><span class="linenos" data-linenos="668 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if two skeletons match according to the configured method.&quot;&quot;&quot;</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a><a href="#__codelineno-0-669"><span class="linenos" data-linenos="669 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">EXACT</span><span class="p">:</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><a href="#__codelineno-0-670"><span class="linenos" data-linenos="670 "></span></a>        <span class="k">return</span> <span class="n">skeleton1</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">skeleton2</span><span class="p">,</span> <span class="n">require_same_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><a href="#__codelineno-0-671"><span class="linenos" data-linenos="671 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">STRUCTURE</span><span class="p">:</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a><a href="#__codelineno-0-672"><span class="linenos" data-linenos="672 "></span></a>        <span class="k">return</span> <span class="n">skeleton1</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a><a href="#__codelineno-0-673"><span class="linenos" data-linenos="673 "></span></a>            <span class="n">skeleton2</span><span class="p">,</span> <span class="n">require_same_order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">require_same_order</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a><a href="#__codelineno-0-674"><span class="linenos" data-linenos="674 "></span></a>        <span class="p">)</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><a href="#__codelineno-0-675"><span class="linenos" data-linenos="675 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">OVERLAP</span><span class="p">:</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a><a href="#__codelineno-0-676"><span class="linenos" data-linenos="676 "></span></a>        <span class="n">metrics</span> <span class="o">=</span> <span class="n">skeleton1</span><span class="o">.</span><span class="n">node_similarities</span><span class="p">(</span><span class="n">skeleton2</span><span class="p">)</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a><a href="#__codelineno-0-677"><span class="linenos" data-linenos="677 "></span></a>        <span class="k">return</span> <span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;jaccard&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_overlap</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><a href="#__codelineno-0-678"><span class="linenos" data-linenos="678 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">SUBSET</span><span class="p">:</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><a href="#__codelineno-0-679"><span class="linenos" data-linenos="679 "></span></a>        <span class="c1"># Check if skeleton1 nodes are subset of skeleton2</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a><a href="#__codelineno-0-680"><span class="linenos" data-linenos="680 "></span></a>        <span class="n">nodes1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">skeleton1</span><span class="o">.</span><span class="n">node_names</span><span class="p">)</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a><a href="#__codelineno-0-681"><span class="linenos" data-linenos="681 "></span></a>        <span class="n">nodes2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">skeleton2</span><span class="o">.</span><span class="n">node_names</span><span class="p">)</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a><a href="#__codelineno-0-682"><span class="linenos" data-linenos="682 "></span></a>        <span class="k">return</span> <span class="n">nodes1</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">nodes2</span><span class="p">)</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a><a href="#__codelineno-0-683"><span class="linenos" data-linenos="683 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a><a href="#__codelineno-0-684"><span class="linenos" data-linenos="684 "></span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown skeleton match method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="trackmatcher">TrackMatcher<a class="headerlink" href="#trackmatcher" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.TrackMatcher" class="doc doc-heading">
            <code>sleap_io.model.matching.TrackMatcher</code>


<a href="#sleap_io.model.matching.TrackMatcher" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">



        <p>Matcher for comparing and matching tracks.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatcher.method">method</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matching method to use. Can be a TrackMatchMethod enum value
or a string that will be converted to the enum. Default is NAME.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>












<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__eq__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.TrackMatcher.__eq__&lt;/code&gt;)" href="#sleap_io.model.matching.TrackMatcher.__eq__">__eq__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class TrackMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TrackMatchMethod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NAME&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.TrackMatcher.__init__&lt;/code&gt;)" href="#sleap_io.model.matching.TrackMatcher.__init__">__init__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class TrackMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;__replace__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;changes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.TrackMatcher.__replace__&lt;/code&gt;)" href="#sleap_io.model.matching.TrackMatcher.__replace__">__replace__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class TrackMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__repr__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.TrackMatcher.__repr__&lt;/code&gt;)" href="#sleap_io.model.matching.TrackMatcher.__repr__">__repr__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class TrackMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__setattr__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.TrackMatcher.__setattr__&lt;/code&gt;)" href="#sleap_io.model.matching.TrackMatcher.__setattr__">__setattr__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class TrackMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;k&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;track1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;track2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.TrackMatcher.match&lt;/code&gt;)" href="#sleap_io.model.matching.TrackMatcher.match">match</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Check if two tracks match according to the configured method.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



              <details class="mkdocstrings-source">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-774" name="__codelineno-0-774"></a><a href="#__codelineno-0-774"><span class="linenos" data-linenos="774 "></span></a><span class="nd">@attrs</span><span class="o">.</span><span class="n">define</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a><a href="#__codelineno-0-775"><span class="linenos" data-linenos="775 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">TrackMatcher</span><span class="p">:</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a><a href="#__codelineno-0-776"><span class="linenos" data-linenos="776 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Matcher for comparing and matching tracks.</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a><a href="#__codelineno-0-777"><span class="linenos" data-linenos="777 "></span></a>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><a href="#__codelineno-0-778"><span class="linenos" data-linenos="778 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a><a href="#__codelineno-0-779"><span class="linenos" data-linenos="779 "></span></a><span class="sd">        method: The matching method to use. Can be a TrackMatchMethod enum value</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a><a href="#__codelineno-0-780"><span class="linenos" data-linenos="780 "></span></a><span class="sd">            or a string that will be converted to the enum. Default is NAME.</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a><a href="#__codelineno-0-781"><span class="linenos" data-linenos="781 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a><a href="#__codelineno-0-782"><span class="linenos" data-linenos="782 "></span></a>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a><a href="#__codelineno-0-783"><span class="linenos" data-linenos="783 "></span></a>    <span class="n">method</span><span class="p">:</span> <span class="n">TrackMatchMethod</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">field</span><span class="p">(</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a><a href="#__codelineno-0-784"><span class="linenos" data-linenos="784 "></span></a>        <span class="n">default</span><span class="o">=</span><span class="n">TrackMatchMethod</span><span class="o">.</span><span class="n">NAME</span><span class="p">,</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a><a href="#__codelineno-0-785"><span class="linenos" data-linenos="785 "></span></a>        <span class="n">converter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">TrackMatchMethod</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a><a href="#__codelineno-0-786"><span class="linenos" data-linenos="786 "></span></a>    <span class="p">)</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a><a href="#__codelineno-0-787"><span class="linenos" data-linenos="787 "></span></a>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a><a href="#__codelineno-0-788"><span class="linenos" data-linenos="788 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track1</span><span class="p">:</span> <span class="n">Track</span><span class="p">,</span> <span class="n">track2</span><span class="p">:</span> <span class="n">Track</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a><a href="#__codelineno-0-789"><span class="linenos" data-linenos="789 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two tracks match according to the configured method.&quot;&quot;&quot;</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a><a href="#__codelineno-0-790"><span class="linenos" data-linenos="790 "></span></a>        <span class="k">return</span> <span class="n">track1</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">track2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</code></pre></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.TrackMatcher.__annotations__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__annotations__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;TrackMatchMethod | str&#39;</span><span class="p">}</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.TrackMatcher.__annotations__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>dict() -&gt; new empty dictionary
dict(mapping) -&gt; new dictionary initialized from a mapping object's
    (key, value) pairs
dict(iterable) -&gt; new dictionary initialized as if via:
    d = {}
    for k, v in iterable:
        d[k] = v
dict(**kwargs) -&gt; new dictionary initialized with the name=value pairs
    in the keyword argument list.  For example:  dict(one=1, two=2)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.TrackMatcher.__attrs_own_setattr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__attrs_own_setattr__</span> <span class="o">=</span> <span class="kc">True</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.TrackMatcher.__attrs_own_setattr__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Returns True when the argument is true, False otherwise.
The builtins True and False are the only two instances of the class bool.
The class bool is a subclass of the class int, and cannot be subclassed.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.TrackMatcher.__attrs_props__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__attrs_props__</span> <span class="o">=</span> <span class="n">ClassProps</span><span class="p">(</span><span class="n">is_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_slotted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_weakref_slot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_frozen</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=&lt;</span><span class="n">KeywordOnly</span><span class="o">.</span><span class="n">NO</span><span class="p">:</span> <span class="s1">&#39;no&#39;</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">collected_fields_by_mro</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_init</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_repr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_eq</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_ordering</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hashability</span><span class="o">=&lt;</span><span class="n">Hashability</span><span class="o">.</span><span class="n">UNHASHABLE</span><span class="p">:</span> <span class="s1">&#39;unhashable&#39;</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">added_match_args</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_str</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">added_pickling</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">on_setattr_hook</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">pipe</span><span class="o">.&lt;</span><span class="nb">locals</span><span class="o">&gt;.</span><span class="n">wrapped_pipe</span> <span class="n">at</span> <span class="mh">0x7f45c0a9aca0</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">field_transformer</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.TrackMatcher.__attrs_props__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Effective class properties as derived from parameters to <code>attr.s()</code> or
<code>define()</code> decorators.</p>
<p>This is the same data structure that <em>attrs</em> uses internally to decide how
to construct the final class.</p>
<p>Warning:</p>
<div class="highlight"><pre><span></span><code>This feature is currently **experimental** and is not covered by our
strict backwards-compatibility guarantees.
</code></pre></div>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatcher.__attrs_props__.is_exception">is_exception</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class is treated as an exception class.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatcher.__attrs_props__.is_slotted">is_slotted</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class is <code>slotted &lt;slotted classes&gt;</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatcher.__attrs_props__.has_weakref_slot">has_weakref_slot</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has a slot for weak references.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatcher.__attrs_props__.is_frozen">is_frozen</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class is frozen.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatcher.__attrs_props__.kw_only">kw_only</span></code></td>
            <td>
                  <code><span title="KeywordOnly">KeywordOnly</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether / how the class enforces keyword-only arguments on the
<code>__init__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatcher.__attrs_props__.collected_fields_by_mro">collected_fields_by_mro</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class fields were collected by method resolution order.
That is, correctly but unlike <code>dataclasses</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatcher.__attrs_props__.added_init">added_init</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has an <em>attrs</em>-generated <code>__init__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatcher.__attrs_props__.added_repr">added_repr</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has an <em>attrs</em>-generated <code>__repr__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatcher.__attrs_props__.added_eq">added_eq</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has <em>attrs</em>-generated equality methods.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatcher.__attrs_props__.added_ordering">added_ordering</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has <em>attrs</em>-generated ordering methods.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatcher.__attrs_props__.hashability">hashability</span></code></td>
            <td>
                  <code><span title="Hashability">Hashability</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How <code>hashable &lt;hashing&gt;</code> the class is.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatcher.__attrs_props__.added_match_args">added_match_args</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class supports positional <code>match &lt;match&gt;</code> over its
fields.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatcher.__attrs_props__.added_str">added_str</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has an <em>attrs</em>-generated <code>__str__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatcher.__attrs_props__.added_pickling">added_pickling</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has <em>attrs</em>-generated <code>__getstate__</code> and
<code>__setstate__</code> methods for <code>pickle</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatcher.__attrs_props__.on_setattr_hook">on_setattr_hook</span></code></td>
            <td>
                  <code><span title="Callable">Callable</span>[[<span title="typing.Any">Any</span>, <span title="Attribute">Attribute</span>[<span title="typing.Any">Any</span>], <span title="typing.Any">Any</span>], <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The class's <code>__setattr__</code> hook.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatcher.__attrs_props__.field_transformer">field_transformer</span></code></td>
            <td>
                  <code><span title="Callable">Callable</span>[[<span title="Attribute">Attribute</span>[<span title="typing.Any">Any</span>]], <span title="Attribute">Attribute</span>[<span title="typing.Any">Any</span>]] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The class's <code>field transformers &lt;transform-fields&gt;</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>.. versionadded:: 25.4.0</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.TrackMatcher.__doc__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__doc__</span> <span class="o">=</span> <span class="s1">&#39;Matcher for comparing and matching tracks.</span><span class="se">\n\n</span><span class="s1">Attributes:</span><span class="se">\n</span><span class="s1">    method: The matching method to use. Can be a TrackMatchMethod enum value</span><span class="se">\n</span><span class="s1">        or a string that will be converted to the enum. Default is NAME.</span><span class="se">\n</span><span class="s1">&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.TrackMatcher.__doc__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to 'utf-8'.
errors defaults to 'strict'.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.TrackMatcher.__firstlineno__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__firstlineno__</span> <span class="o">=</span> <span class="mi">774</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.TrackMatcher.__firstlineno__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>int([x]) -&gt; integer
int(x, base=10) -&gt; integer</p>
<p>Convert a number or string to an integer, or return 0 if no arguments
are given.  If x is a number, return x.<strong>int</strong>().  For floating-point
numbers, this truncates towards zero.</p>
<p>If x is not a number or if base is given, then x must be a string,
bytes, or bytearray instance representing an integer literal in the
given base.  The literal can be preceded by '+' or '-' and be surrounded
by whitespace.  The base defaults to 10.  Valid bases are 0 and 2-36.
Base 0 means to interpret the base from the string as an integer literal.</p>
<blockquote>
<blockquote>
<blockquote>
<p>int('0b100', base=0)
4</p>
</blockquote>
</blockquote>
</blockquote>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.TrackMatcher.__match_args__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__match_args__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">,)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.TrackMatcher.__match_args__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Built-in immutable sequence.</p>
<p>If no argument is given, the constructor returns an empty tuple.
If iterable is specified the tuple is initialized from iterable's items.</p>
<p>If the argument is a tuple, the return value is the same object.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.TrackMatcher.__module__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__module__</span> <span class="o">=</span> <span class="s1">&#39;sleap_io.model.matching&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.TrackMatcher.__module__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to 'utf-8'.
errors defaults to 'strict'.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.TrackMatcher.__slots__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="s1">&#39;__weakref__&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.TrackMatcher.__slots__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Built-in immutable sequence.</p>
<p>If no argument is given, the constructor returns an empty tuple.
If iterable is specified the tuple is initialized from iterable's items.</p>
<p>If the argument is a tuple, the return value is the same object.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.TrackMatcher.__static_attributes__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__static_attributes__</span> <span class="o">=</span> <span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.TrackMatcher.__static_attributes__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Built-in immutable sequence.</p>
<p>If no argument is given, the constructor returns an empty tuple.
If iterable is specified the tuple is initialized from iterable's items.</p>
<p>If the argument is a tuple, the return value is the same object.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.TrackMatcher.__weakref__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__weakref__</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#sleap_io.model.matching.TrackMatcher.__weakref__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>list of weak references to the object</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.TrackMatcher.__eq__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.TrackMatcher.__eq__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class TrackMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-16" name="__codelineno-0-16"></a><a href="#__codelineno-0-16"><span class="linenos" data-linenos="16 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><a href="#__codelineno-0-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><a href="#__codelineno-0-18"><span class="linenos" data-linenos="18 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><a href="#__codelineno-0-19"><span class="linenos" data-linenos="19 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">Any</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.TrackMatcher.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">method</span><span class="o">=&lt;</span><span class="n">TrackMatchMethod</span><span class="o">.</span><span class="n">NAME</span><span class="p">:</span> <span class="s1">&#39;name&#39;</span><span class="o">&gt;</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.TrackMatcher.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class TrackMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-22" name="__codelineno-0-22"></a><a href="#__codelineno-0-22"><span class="linenos" data-linenos="22 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">attrs</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><a href="#__codelineno-0-23"><span class="linenos" data-linenos="23 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.TrackMatcher.__replace__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__replace__</span><span class="p">(</span><span class="o">**</span><span class="n">changes</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.TrackMatcher.__replace__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class TrackMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><a href="#__codelineno-0-1100"><span class="linenos" data-linenos="1100 "></span></a><span class="n">Only</span> <span class="n">used</span> <span class="n">when</span> <span class="n">compare_images</span><span class="o">=</span><span class="kc">True</span><span class="o">.</span> <span class="n">Expensive</span> <span class="n">operation</span><span class="o">.</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.TrackMatcher.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#sleap_io.model.matching.TrackMatcher.__repr__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class TrackMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="sd">&quot;&quot;&quot;Unified matcher system for comparing and matching data structures during merging.</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="sd">This module provides configurable matchers for comparing skeletons, instances, tracks,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="sd">and videos during merge operations. The matchers use various strategies to determine</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="sd">when data structures should be considered equivalent during merging.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="sd">Key features:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="sd">- Skeleton matching: exact, structure-based, overlap, and subset matching</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="sd">- Instance matching: spatial proximity, track identity, and bounding box IoU</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><a href="#__codelineno-0-10"><span class="linenos" data-linenos="10 "></span></a><span class="sd">- Track matching: by name or object identity</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><a href="#__codelineno-0-11"><span class="linenos" data-linenos="11 "></span></a><span class="sd">- Video matching: path, basename, content, and auto matching</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><a href="#__codelineno-0-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><a href="#__codelineno-0-13"><span class="linenos" data-linenos="13 "></span></a><span class="sd">Video matching supports path-based, filename-based, content-based, and</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><a href="#__codelineno-0-14"><span class="linenos" data-linenos="14 "></span></a><span class="sd">automatic strategies.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><a href="#__codelineno-0-15"><span class="linenos" data-linenos="15 "></span></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.TrackMatcher.__setattr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.TrackMatcher.__setattr__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class TrackMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1176" name="__codelineno-0-1176"></a><a href="#__codelineno-0-1176"><span class="linenos" data-linenos="1176 "></span></a>        <span class="n">details</span><span class="p">:</span> <span class="n">Dictionary</span> <span class="n">containing</span> <span class="n">additional</span> <span class="n">error</span> <span class="n">details</span> <span class="ow">and</span> <span class="n">context</span><span class="o">.</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a><a href="#__codelineno-0-1177"><span class="linenos" data-linenos="1177 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a><a href="#__codelineno-0-1178"><span class="linenos" data-linenos="1178 "></span></a>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a><a href="#__codelineno-0-1179"><span class="linenos" data-linenos="1179 "></span></a><span class="sd">    message: str</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a><a href="#__codelineno-0-1180"><span class="linenos" data-linenos="1180 "></span></a><span class="sd">    details: dict = attrs.field(factory=dict)</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a><a href="#__codelineno-0-1181"><span class="linenos" data-linenos="1181 "></span></a>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a><a href="#__codelineno-0-1182"><span class="linenos" data-linenos="1182 "></span></a>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a><a href="#__codelineno-0-1183"><span class="linenos" data-linenos="1183 "></span></a><span class="sd">class SkeletonMismatchError(MergeError):</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a><a href="#__codelineno-0-1184"><span class="linenos" data-linenos="1184 "></span></a><span class="sd">    &quot;&quot;&quot;</span><span class="n">Raised</span> <span class="n">when</span> <span class="n">skeletons</span> <span class="n">don</span><span class="s1">&#39;t match during merge.&quot;&quot;&quot;</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.TrackMatcher.match" class="doc doc-heading">
            <code class="highlight language-python"><span class="k">match</span><span class="p">(</span><span class="n">track1</span><span class="p">,</span> <span class="n">track2</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.TrackMatcher.match" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Check if two tracks match according to the configured method.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-788" name="__codelineno-0-788"></a><a href="#__codelineno-0-788"><span class="linenos" data-linenos="788 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track1</span><span class="p">:</span> <span class="n">Track</span><span class="p">,</span> <span class="n">track2</span><span class="p">:</span> <span class="n">Track</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a><a href="#__codelineno-0-789"><span class="linenos" data-linenos="789 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if two tracks match according to the configured method.&quot;&quot;&quot;</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a><a href="#__codelineno-0-790"><span class="linenos" data-linenos="790 "></span></a>    <span class="k">return</span> <span class="n">track1</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">track2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</code></pre></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="instancematcher">InstanceMatcher<a class="headerlink" href="#instancematcher" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.InstanceMatcher" class="doc doc-heading">
            <code>sleap_io.model.matching.InstanceMatcher</code>


<a href="#sleap_io.model.matching.InstanceMatcher" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">



        <p>Matcher for comparing and matching instances.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.method">method</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matching method to use. Can be an InstanceMatchMethod enum value
or a string that will be converted to the enum. Default is SPATIAL.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.threshold">threshold</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The threshold value used for matching. For SPATIAL method, this is
the maximum pixel distance. For IOU method, this is the minimum IoU value.
Not used for IDENTITY method. Default is 5.0.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>












<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__eq__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.InstanceMatcher.__eq__&lt;/code&gt;)" href="#sleap_io.model.matching.InstanceMatcher.__eq__">__eq__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class InstanceMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InstanceMatchMethod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SPATIAL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;spatial&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;threshold&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.InstanceMatcher.__init__&lt;/code&gt;)" href="#sleap_io.model.matching.InstanceMatcher.__init__">__init__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class InstanceMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;__replace__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;changes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.InstanceMatcher.__replace__&lt;/code&gt;)" href="#sleap_io.model.matching.InstanceMatcher.__replace__">__replace__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class InstanceMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__repr__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.InstanceMatcher.__repr__&lt;/code&gt;)" href="#sleap_io.model.matching.InstanceMatcher.__repr__">__repr__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class InstanceMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__setattr__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.InstanceMatcher.__setattr__&lt;/code&gt;)" href="#sleap_io.model.matching.InstanceMatcher.__setattr__">__setattr__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class InstanceMatcher.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;find_matches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instances1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instances2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.InstanceMatcher.find_matches&lt;/code&gt;)" href="#sleap_io.model.matching.InstanceMatcher.find_matches">find_matches</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Find all matching instances between two lists.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;k&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instance1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instance2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.InstanceMatcher.match&lt;/code&gt;)" href="#sleap_io.model.matching.InstanceMatcher.match">match</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Check if two instances match according to the configured method.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



              <details class="mkdocstrings-source">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-687" name="__codelineno-0-687"></a><a href="#__codelineno-0-687"><span class="linenos" data-linenos="687 "></span></a><span class="nd">@attrs</span><span class="o">.</span><span class="n">define</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a><a href="#__codelineno-0-688"><span class="linenos" data-linenos="688 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">InstanceMatcher</span><span class="p">:</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a><a href="#__codelineno-0-689"><span class="linenos" data-linenos="689 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Matcher for comparing and matching instances.</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a><a href="#__codelineno-0-690"><span class="linenos" data-linenos="690 "></span></a>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a><a href="#__codelineno-0-691"><span class="linenos" data-linenos="691 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a><a href="#__codelineno-0-692"><span class="linenos" data-linenos="692 "></span></a><span class="sd">        method: The matching method to use. Can be an InstanceMatchMethod enum value</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a><a href="#__codelineno-0-693"><span class="linenos" data-linenos="693 "></span></a><span class="sd">            or a string that will be converted to the enum. Default is SPATIAL.</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a><a href="#__codelineno-0-694"><span class="linenos" data-linenos="694 "></span></a><span class="sd">        threshold: The threshold value used for matching. For SPATIAL method, this is</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><a href="#__codelineno-0-695"><span class="linenos" data-linenos="695 "></span></a><span class="sd">            the maximum pixel distance. For IOU method, this is the minimum IoU value.</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a><a href="#__codelineno-0-696"><span class="linenos" data-linenos="696 "></span></a><span class="sd">            Not used for IDENTITY method. Default is 5.0.</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><a href="#__codelineno-0-697"><span class="linenos" data-linenos="697 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><a href="#__codelineno-0-698"><span class="linenos" data-linenos="698 "></span></a>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a><a href="#__codelineno-0-699"><span class="linenos" data-linenos="699 "></span></a>    <span class="n">method</span><span class="p">:</span> <span class="n">InstanceMatchMethod</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">field</span><span class="p">(</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a><a href="#__codelineno-0-700"><span class="linenos" data-linenos="700 "></span></a>        <span class="n">default</span><span class="o">=</span><span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">SPATIAL</span><span class="p">,</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a><a href="#__codelineno-0-701"><span class="linenos" data-linenos="701 "></span></a>        <span class="n">converter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">InstanceMatchMethod</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><a href="#__codelineno-0-702"><span class="linenos" data-linenos="702 "></span></a>    <span class="p">)</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a><a href="#__codelineno-0-703"><span class="linenos" data-linenos="703 "></span></a>    <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a><a href="#__codelineno-0-704"><span class="linenos" data-linenos="704 "></span></a>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><a href="#__codelineno-0-705"><span class="linenos" data-linenos="705 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance1</span><span class="p">:</span> <span class="n">Instance</span><span class="p">,</span> <span class="n">instance2</span><span class="p">:</span> <span class="n">Instance</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><a href="#__codelineno-0-706"><span class="linenos" data-linenos="706 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two instances match according to the configured method.&quot;&quot;&quot;</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a><a href="#__codelineno-0-707"><span class="linenos" data-linenos="707 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">SPATIAL</span><span class="p">:</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a><a href="#__codelineno-0-708"><span class="linenos" data-linenos="708 "></span></a>            <span class="k">return</span> <span class="n">instance1</span><span class="o">.</span><span class="n">same_pose_as</span><span class="p">(</span><span class="n">instance2</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a><a href="#__codelineno-0-709"><span class="linenos" data-linenos="709 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">IDENTITY</span><span class="p">:</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a><a href="#__codelineno-0-710"><span class="linenos" data-linenos="710 "></span></a>            <span class="k">return</span> <span class="n">instance1</span><span class="o">.</span><span class="n">same_identity_as</span><span class="p">(</span><span class="n">instance2</span><span class="p">)</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><a href="#__codelineno-0-711"><span class="linenos" data-linenos="711 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">IOU</span><span class="p">:</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a><a href="#__codelineno-0-712"><span class="linenos" data-linenos="712 "></span></a>            <span class="k">return</span> <span class="n">instance1</span><span class="o">.</span><span class="n">overlaps_with</span><span class="p">(</span><span class="n">instance2</span><span class="p">,</span> <span class="n">iou_threshold</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a><a href="#__codelineno-0-713"><span class="linenos" data-linenos="713 "></span></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a><a href="#__codelineno-0-714"><span class="linenos" data-linenos="714 "></span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown instance match method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a><a href="#__codelineno-0-715"><span class="linenos" data-linenos="715 "></span></a>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a><a href="#__codelineno-0-716"><span class="linenos" data-linenos="716 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">find_matches</span><span class="p">(</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a><a href="#__codelineno-0-717"><span class="linenos" data-linenos="717 "></span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">instances1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Instance</span><span class="p">],</span> <span class="n">instances2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Instance</span><span class="p">]</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a><a href="#__codelineno-0-718"><span class="linenos" data-linenos="718 "></span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a><a href="#__codelineno-0-719"><span class="linenos" data-linenos="719 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Find all matching instances between two lists.</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a><a href="#__codelineno-0-720"><span class="linenos" data-linenos="720 "></span></a>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a><a href="#__codelineno-0-721"><span class="linenos" data-linenos="721 "></span></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a><a href="#__codelineno-0-722"><span class="linenos" data-linenos="722 "></span></a><span class="sd">            List of (idx1, idx2, score) tuples for matching instances.</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a><a href="#__codelineno-0-723"><span class="linenos" data-linenos="723 "></span></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a><a href="#__codelineno-0-724"><span class="linenos" data-linenos="724 "></span></a>        <span class="n">matches</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a><a href="#__codelineno-0-725"><span class="linenos" data-linenos="725 "></span></a>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a><a href="#__codelineno-0-726"><span class="linenos" data-linenos="726 "></span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">inst1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">instances1</span><span class="p">):</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><a href="#__codelineno-0-727"><span class="linenos" data-linenos="727 "></span></a>            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">inst2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">instances2</span><span class="p">):</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><a href="#__codelineno-0-728"><span class="linenos" data-linenos="728 "></span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">inst1</span><span class="p">,</span> <span class="n">inst2</span><span class="p">):</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><a href="#__codelineno-0-729"><span class="linenos" data-linenos="729 "></span></a>                    <span class="c1"># Calculate match score based on method</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><a href="#__codelineno-0-730"><span class="linenos" data-linenos="730 "></span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">SPATIAL</span><span class="p">:</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a><a href="#__codelineno-0-731"><span class="linenos" data-linenos="731 "></span></a>                        <span class="c1"># Use inverse distance as score</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a><a href="#__codelineno-0-732"><span class="linenos" data-linenos="732 "></span></a>                        <span class="n">pts1</span> <span class="o">=</span> <span class="n">inst1</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a><a href="#__codelineno-0-733"><span class="linenos" data-linenos="733 "></span></a>                        <span class="n">pts2</span> <span class="o">=</span> <span class="n">inst2</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a><a href="#__codelineno-0-734"><span class="linenos" data-linenos="734 "></span></a>                        <span class="n">valid</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pts1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pts2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a><a href="#__codelineno-0-735"><span class="linenos" data-linenos="735 "></span></a>                        <span class="k">if</span> <span class="n">valid</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a><a href="#__codelineno-0-736"><span class="linenos" data-linenos="736 "></span></a>                            <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a><a href="#__codelineno-0-737"><span class="linenos" data-linenos="737 "></span></a>                                <span class="n">pts1</span><span class="p">[</span><span class="n">valid</span><span class="p">]</span> <span class="o">-</span> <span class="n">pts2</span><span class="p">[</span><span class="n">valid</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a><a href="#__codelineno-0-738"><span class="linenos" data-linenos="738 "></span></a>                            <span class="p">)</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><a href="#__codelineno-0-739"><span class="linenos" data-linenos="739 "></span></a>                            <span class="n">score</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">distances</span><span class="p">))</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><a href="#__codelineno-0-740"><span class="linenos" data-linenos="740 "></span></a>                        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a><a href="#__codelineno-0-741"><span class="linenos" data-linenos="741 "></span></a>                            <span class="n">score</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a><a href="#__codelineno-0-742"><span class="linenos" data-linenos="742 "></span></a>                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">IOU</span><span class="p">:</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a><a href="#__codelineno-0-743"><span class="linenos" data-linenos="743 "></span></a>                        <span class="c1"># Calculate actual IoU as score</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a><a href="#__codelineno-0-744"><span class="linenos" data-linenos="744 "></span></a>                        <span class="n">bbox1</span> <span class="o">=</span> <span class="n">inst1</span><span class="o">.</span><span class="n">bounding_box</span><span class="p">()</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a><a href="#__codelineno-0-745"><span class="linenos" data-linenos="745 "></span></a>                        <span class="n">bbox2</span> <span class="o">=</span> <span class="n">inst2</span><span class="o">.</span><span class="n">bounding_box</span><span class="p">()</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a><a href="#__codelineno-0-746"><span class="linenos" data-linenos="746 "></span></a>                        <span class="k">if</span> <span class="n">bbox1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">bbox2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a><a href="#__codelineno-0-747"><span class="linenos" data-linenos="747 "></span></a>                            <span class="c1"># Calculate IoU</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><a href="#__codelineno-0-748"><span class="linenos" data-linenos="748 "></span></a>                            <span class="n">intersection_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">bbox1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a><a href="#__codelineno-0-749"><span class="linenos" data-linenos="749 "></span></a>                            <span class="n">intersection_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">bbox1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bbox2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a><a href="#__codelineno-0-750"><span class="linenos" data-linenos="750 "></span></a>                            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">intersection_min</span> <span class="o">&lt;</span> <span class="n">intersection_max</span><span class="p">):</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a><a href="#__codelineno-0-751"><span class="linenos" data-linenos="751 "></span></a>                                <span class="n">intersection_area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a><a href="#__codelineno-0-752"><span class="linenos" data-linenos="752 "></span></a>                                    <span class="n">intersection_max</span> <span class="o">-</span> <span class="n">intersection_min</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a><a href="#__codelineno-0-753"><span class="linenos" data-linenos="753 "></span></a>                                <span class="p">)</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a><a href="#__codelineno-0-754"><span class="linenos" data-linenos="754 "></span></a>                                <span class="n">area1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">bbox1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a><a href="#__codelineno-0-755"><span class="linenos" data-linenos="755 "></span></a>                                <span class="n">area2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">bbox2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a><a href="#__codelineno-0-756"><span class="linenos" data-linenos="756 "></span></a>                                <span class="n">union_area</span> <span class="o">=</span> <span class="n">area1</span> <span class="o">+</span> <span class="n">area2</span> <span class="o">-</span> <span class="n">intersection_area</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a><a href="#__codelineno-0-757"><span class="linenos" data-linenos="757 "></span></a>                                <span class="n">score</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a><a href="#__codelineno-0-758"><span class="linenos" data-linenos="758 "></span></a>                                    <span class="n">intersection_area</span> <span class="o">/</span> <span class="n">union_area</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a><a href="#__codelineno-0-759"><span class="linenos" data-linenos="759 "></span></a>                                    <span class="k">if</span> <span class="n">union_area</span> <span class="o">&gt;</span> <span class="mi">0</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a><a href="#__codelineno-0-760"><span class="linenos" data-linenos="760 "></span></a>                                    <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a><a href="#__codelineno-0-761"><span class="linenos" data-linenos="761 "></span></a>                                <span class="p">)</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a><a href="#__codelineno-0-762"><span class="linenos" data-linenos="762 "></span></a>                            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a><a href="#__codelineno-0-763"><span class="linenos" data-linenos="763 "></span></a>                                <span class="n">score</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a><a href="#__codelineno-0-764"><span class="linenos" data-linenos="764 "></span></a>                        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a><a href="#__codelineno-0-765"><span class="linenos" data-linenos="765 "></span></a>                            <span class="n">score</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a><a href="#__codelineno-0-766"><span class="linenos" data-linenos="766 "></span></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><a href="#__codelineno-0-767"><span class="linenos" data-linenos="767 "></span></a>                        <span class="n">score</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Binary match for identity</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a><a href="#__codelineno-0-768"><span class="linenos" data-linenos="768 "></span></a>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a><a href="#__codelineno-0-769"><span class="linenos" data-linenos="769 "></span></a>                    <span class="n">matches</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">score</span><span class="p">))</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a><a href="#__codelineno-0-770"><span class="linenos" data-linenos="770 "></span></a>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a><a href="#__codelineno-0-771"><span class="linenos" data-linenos="771 "></span></a>        <span class="k">return</span> <span class="n">matches</span>
</code></pre></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.InstanceMatcher.__annotations__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__annotations__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;InstanceMatchMethod | str&#39;</span><span class="p">,</span> <span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">}</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.InstanceMatcher.__annotations__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>dict() -&gt; new empty dictionary
dict(mapping) -&gt; new dictionary initialized from a mapping object's
    (key, value) pairs
dict(iterable) -&gt; new dictionary initialized as if via:
    d = {}
    for k, v in iterable:
        d[k] = v
dict(**kwargs) -&gt; new dictionary initialized with the name=value pairs
    in the keyword argument list.  For example:  dict(one=1, two=2)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.InstanceMatcher.__attrs_own_setattr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__attrs_own_setattr__</span> <span class="o">=</span> <span class="kc">True</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.InstanceMatcher.__attrs_own_setattr__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Returns True when the argument is true, False otherwise.
The builtins True and False are the only two instances of the class bool.
The class bool is a subclass of the class int, and cannot be subclassed.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.InstanceMatcher.__attrs_props__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__attrs_props__</span> <span class="o">=</span> <span class="n">ClassProps</span><span class="p">(</span><span class="n">is_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_slotted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_weakref_slot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_frozen</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=&lt;</span><span class="n">KeywordOnly</span><span class="o">.</span><span class="n">NO</span><span class="p">:</span> <span class="s1">&#39;no&#39;</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">collected_fields_by_mro</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_init</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_repr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_eq</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_ordering</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hashability</span><span class="o">=&lt;</span><span class="n">Hashability</span><span class="o">.</span><span class="n">UNHASHABLE</span><span class="p">:</span> <span class="s1">&#39;unhashable&#39;</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">added_match_args</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_str</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">added_pickling</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">on_setattr_hook</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">pipe</span><span class="o">.&lt;</span><span class="nb">locals</span><span class="o">&gt;.</span><span class="n">wrapped_pipe</span> <span class="n">at</span> <span class="mh">0x7f45c0a9aca0</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">field_transformer</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.InstanceMatcher.__attrs_props__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Effective class properties as derived from parameters to <code>attr.s()</code> or
<code>define()</code> decorators.</p>
<p>This is the same data structure that <em>attrs</em> uses internally to decide how
to construct the final class.</p>
<p>Warning:</p>
<div class="highlight"><pre><span></span><code>This feature is currently **experimental** and is not covered by our
strict backwards-compatibility guarantees.
</code></pre></div>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.__attrs_props__.is_exception">is_exception</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class is treated as an exception class.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.__attrs_props__.is_slotted">is_slotted</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class is <code>slotted &lt;slotted classes&gt;</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.__attrs_props__.has_weakref_slot">has_weakref_slot</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has a slot for weak references.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.__attrs_props__.is_frozen">is_frozen</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class is frozen.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.__attrs_props__.kw_only">kw_only</span></code></td>
            <td>
                  <code><span title="KeywordOnly">KeywordOnly</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether / how the class enforces keyword-only arguments on the
<code>__init__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.__attrs_props__.collected_fields_by_mro">collected_fields_by_mro</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class fields were collected by method resolution order.
That is, correctly but unlike <code>dataclasses</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.__attrs_props__.added_init">added_init</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has an <em>attrs</em>-generated <code>__init__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.__attrs_props__.added_repr">added_repr</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has an <em>attrs</em>-generated <code>__repr__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.__attrs_props__.added_eq">added_eq</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has <em>attrs</em>-generated equality methods.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.__attrs_props__.added_ordering">added_ordering</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has <em>attrs</em>-generated ordering methods.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.__attrs_props__.hashability">hashability</span></code></td>
            <td>
                  <code><span title="Hashability">Hashability</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How <code>hashable &lt;hashing&gt;</code> the class is.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.__attrs_props__.added_match_args">added_match_args</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class supports positional <code>match &lt;match&gt;</code> over its
fields.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.__attrs_props__.added_str">added_str</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has an <em>attrs</em>-generated <code>__str__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.__attrs_props__.added_pickling">added_pickling</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has <em>attrs</em>-generated <code>__getstate__</code> and
<code>__setstate__</code> methods for <code>pickle</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.__attrs_props__.on_setattr_hook">on_setattr_hook</span></code></td>
            <td>
                  <code><span title="Callable">Callable</span>[[<span title="typing.Any">Any</span>, <span title="Attribute">Attribute</span>[<span title="typing.Any">Any</span>], <span title="typing.Any">Any</span>], <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The class's <code>__setattr__</code> hook.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.__attrs_props__.field_transformer">field_transformer</span></code></td>
            <td>
                  <code><span title="Callable">Callable</span>[[<span title="Attribute">Attribute</span>[<span title="typing.Any">Any</span>]], <span title="Attribute">Attribute</span>[<span title="typing.Any">Any</span>]] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The class's <code>field transformers &lt;transform-fields&gt;</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>.. versionadded:: 25.4.0</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.InstanceMatcher.__doc__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__doc__</span> <span class="o">=</span> <span class="s1">&#39;Matcher for comparing and matching instances.</span><span class="se">\n\n</span><span class="s1">Attributes:</span><span class="se">\n</span><span class="s1">    method: The matching method to use. Can be an InstanceMatchMethod enum value</span><span class="se">\n</span><span class="s1">        or a string that will be converted to the enum. Default is SPATIAL.</span><span class="se">\n</span><span class="s1">    threshold: The threshold value used for matching. For SPATIAL method, this is</span><span class="se">\n</span><span class="s1">        the maximum pixel distance. For IOU method, this is the minimum IoU value.</span><span class="se">\n</span><span class="s1">        Not used for IDENTITY method. Default is 5.0.</span><span class="se">\n</span><span class="s1">&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.InstanceMatcher.__doc__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to 'utf-8'.
errors defaults to 'strict'.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.InstanceMatcher.__firstlineno__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__firstlineno__</span> <span class="o">=</span> <span class="mi">687</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.InstanceMatcher.__firstlineno__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>int([x]) -&gt; integer
int(x, base=10) -&gt; integer</p>
<p>Convert a number or string to an integer, or return 0 if no arguments
are given.  If x is a number, return x.<strong>int</strong>().  For floating-point
numbers, this truncates towards zero.</p>
<p>If x is not a number or if base is given, then x must be a string,
bytes, or bytearray instance representing an integer literal in the
given base.  The literal can be preceded by '+' or '-' and be surrounded
by whitespace.  The base defaults to 10.  Valid bases are 0 and 2-36.
Base 0 means to interpret the base from the string as an integer literal.</p>
<blockquote>
<blockquote>
<blockquote>
<p>int('0b100', base=0)
4</p>
</blockquote>
</blockquote>
</blockquote>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.InstanceMatcher.__match_args__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__match_args__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="s1">&#39;threshold&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.InstanceMatcher.__match_args__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Built-in immutable sequence.</p>
<p>If no argument is given, the constructor returns an empty tuple.
If iterable is specified the tuple is initialized from iterable's items.</p>
<p>If the argument is a tuple, the return value is the same object.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.InstanceMatcher.__module__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__module__</span> <span class="o">=</span> <span class="s1">&#39;sleap_io.model.matching&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.InstanceMatcher.__module__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to 'utf-8'.
errors defaults to 'strict'.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.InstanceMatcher.__slots__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="s1">&#39;threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;__weakref__&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.InstanceMatcher.__slots__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Built-in immutable sequence.</p>
<p>If no argument is given, the constructor returns an empty tuple.
If iterable is specified the tuple is initialized from iterable's items.</p>
<p>If the argument is a tuple, the return value is the same object.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.InstanceMatcher.__static_attributes__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__static_attributes__</span> <span class="o">=</span> <span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.InstanceMatcher.__static_attributes__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Built-in immutable sequence.</p>
<p>If no argument is given, the constructor returns an empty tuple.
If iterable is specified the tuple is initialized from iterable's items.</p>
<p>If the argument is a tuple, the return value is the same object.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.InstanceMatcher.__weakref__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__weakref__</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#sleap_io.model.matching.InstanceMatcher.__weakref__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>list of weak references to the object</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.InstanceMatcher.__eq__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.InstanceMatcher.__eq__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class InstanceMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-16" name="__codelineno-0-16"></a><a href="#__codelineno-0-16"><span class="linenos" data-linenos="16 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><a href="#__codelineno-0-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><a href="#__codelineno-0-18"><span class="linenos" data-linenos="18 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><a href="#__codelineno-0-19"><span class="linenos" data-linenos="19 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">Any</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><a href="#__codelineno-0-20"><span class="linenos" data-linenos="20 "></span></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><a href="#__codelineno-0-21"><span class="linenos" data-linenos="21 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">attrs</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.InstanceMatcher.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">method</span><span class="o">=&lt;</span><span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">SPATIAL</span><span class="p">:</span> <span class="s1">&#39;spatial&#39;</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.InstanceMatcher.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class InstanceMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-23" name="__codelineno-0-23"></a><a href="#__codelineno-0-23"><span class="linenos" data-linenos="23 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><a href="#__codelineno-0-24"><span class="linenos" data-linenos="24 "></span></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><a href="#__codelineno-0-25"><span class="linenos" data-linenos="25 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.instance</span><span class="w"> </span><span class="kn">import</span> <span class="n">Instance</span><span class="p">,</span> <span class="n">Track</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><a href="#__codelineno-0-26"><span class="linenos" data-linenos="26 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.labeled_frame</span><span class="w"> </span><span class="kn">import</span> <span class="n">LabeledFrame</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.InstanceMatcher.__replace__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__replace__</span><span class="p">(</span><span class="o">**</span><span class="n">changes</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.InstanceMatcher.__replace__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class InstanceMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><a href="#__codelineno-0-1100"><span class="linenos" data-linenos="1100 "></span></a><span class="n">Only</span> <span class="n">used</span> <span class="n">when</span> <span class="n">compare_images</span><span class="o">=</span><span class="kc">True</span><span class="o">.</span> <span class="n">Expensive</span> <span class="n">operation</span><span class="o">.</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.InstanceMatcher.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#sleap_io.model.matching.InstanceMatcher.__repr__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class InstanceMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="sd">&quot;&quot;&quot;Unified matcher system for comparing and matching data structures during merging.</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="sd">This module provides configurable matchers for comparing skeletons, instances, tracks,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="sd">and videos during merge operations. The matchers use various strategies to determine</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="sd">when data structures should be considered equivalent during merging.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="sd">Key features:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="sd">- Skeleton matching: exact, structure-based, overlap, and subset matching</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="sd">- Instance matching: spatial proximity, track identity, and bounding box IoU</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><a href="#__codelineno-0-10"><span class="linenos" data-linenos="10 "></span></a><span class="sd">- Track matching: by name or object identity</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><a href="#__codelineno-0-11"><span class="linenos" data-linenos="11 "></span></a><span class="sd">- Video matching: path, basename, content, and auto matching</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><a href="#__codelineno-0-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><a href="#__codelineno-0-13"><span class="linenos" data-linenos="13 "></span></a><span class="sd">Video matching supports path-based, filename-based, content-based, and</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><a href="#__codelineno-0-14"><span class="linenos" data-linenos="14 "></span></a><span class="sd">automatic strategies.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><a href="#__codelineno-0-15"><span class="linenos" data-linenos="15 "></span></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.InstanceMatcher.__setattr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.InstanceMatcher.__setattr__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class InstanceMatcher.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1176" name="__codelineno-0-1176"></a><a href="#__codelineno-0-1176"><span class="linenos" data-linenos="1176 "></span></a>        <span class="n">details</span><span class="p">:</span> <span class="n">Dictionary</span> <span class="n">containing</span> <span class="n">additional</span> <span class="n">error</span> <span class="n">details</span> <span class="ow">and</span> <span class="n">context</span><span class="o">.</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a><a href="#__codelineno-0-1177"><span class="linenos" data-linenos="1177 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a><a href="#__codelineno-0-1178"><span class="linenos" data-linenos="1178 "></span></a>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a><a href="#__codelineno-0-1179"><span class="linenos" data-linenos="1179 "></span></a><span class="sd">    message: str</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a><a href="#__codelineno-0-1180"><span class="linenos" data-linenos="1180 "></span></a><span class="sd">    details: dict = attrs.field(factory=dict)</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a><a href="#__codelineno-0-1181"><span class="linenos" data-linenos="1181 "></span></a>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a><a href="#__codelineno-0-1182"><span class="linenos" data-linenos="1182 "></span></a>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a><a href="#__codelineno-0-1183"><span class="linenos" data-linenos="1183 "></span></a><span class="sd">class SkeletonMismatchError(MergeError):</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a><a href="#__codelineno-0-1184"><span class="linenos" data-linenos="1184 "></span></a><span class="sd">    &quot;&quot;&quot;</span><span class="n">Raised</span> <span class="n">when</span> <span class="n">skeletons</span> <span class="n">don</span><span class="s1">&#39;t match during merge.&quot;&quot;&quot;</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.InstanceMatcher.find_matches" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_matches</span><span class="p">(</span><span class="n">instances1</span><span class="p">,</span> <span class="n">instances2</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.InstanceMatcher.find_matches" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Find all matching instances between two lists.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of (idx1, idx2, score) tuples for matching instances.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-716" name="__codelineno-0-716"></a><a href="#__codelineno-0-716"><span class="linenos" data-linenos="716 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">find_matches</span><span class="p">(</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a><a href="#__codelineno-0-717"><span class="linenos" data-linenos="717 "></span></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">instances1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Instance</span><span class="p">],</span> <span class="n">instances2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Instance</span><span class="p">]</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a><a href="#__codelineno-0-718"><span class="linenos" data-linenos="718 "></span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a><a href="#__codelineno-0-719"><span class="linenos" data-linenos="719 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Find all matching instances between two lists.</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a><a href="#__codelineno-0-720"><span class="linenos" data-linenos="720 "></span></a>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a><a href="#__codelineno-0-721"><span class="linenos" data-linenos="721 "></span></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a><a href="#__codelineno-0-722"><span class="linenos" data-linenos="722 "></span></a><span class="sd">        List of (idx1, idx2, score) tuples for matching instances.</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a><a href="#__codelineno-0-723"><span class="linenos" data-linenos="723 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a><a href="#__codelineno-0-724"><span class="linenos" data-linenos="724 "></span></a>    <span class="n">matches</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a><a href="#__codelineno-0-725"><span class="linenos" data-linenos="725 "></span></a>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a><a href="#__codelineno-0-726"><span class="linenos" data-linenos="726 "></span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">inst1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">instances1</span><span class="p">):</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><a href="#__codelineno-0-727"><span class="linenos" data-linenos="727 "></span></a>        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">inst2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">instances2</span><span class="p">):</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><a href="#__codelineno-0-728"><span class="linenos" data-linenos="728 "></span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">inst1</span><span class="p">,</span> <span class="n">inst2</span><span class="p">):</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><a href="#__codelineno-0-729"><span class="linenos" data-linenos="729 "></span></a>                <span class="c1"># Calculate match score based on method</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><a href="#__codelineno-0-730"><span class="linenos" data-linenos="730 "></span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">SPATIAL</span><span class="p">:</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a><a href="#__codelineno-0-731"><span class="linenos" data-linenos="731 "></span></a>                    <span class="c1"># Use inverse distance as score</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a><a href="#__codelineno-0-732"><span class="linenos" data-linenos="732 "></span></a>                    <span class="n">pts1</span> <span class="o">=</span> <span class="n">inst1</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a><a href="#__codelineno-0-733"><span class="linenos" data-linenos="733 "></span></a>                    <span class="n">pts2</span> <span class="o">=</span> <span class="n">inst2</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a><a href="#__codelineno-0-734"><span class="linenos" data-linenos="734 "></span></a>                    <span class="n">valid</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pts1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pts2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a><a href="#__codelineno-0-735"><span class="linenos" data-linenos="735 "></span></a>                    <span class="k">if</span> <span class="n">valid</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a><a href="#__codelineno-0-736"><span class="linenos" data-linenos="736 "></span></a>                        <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a><a href="#__codelineno-0-737"><span class="linenos" data-linenos="737 "></span></a>                            <span class="n">pts1</span><span class="p">[</span><span class="n">valid</span><span class="p">]</span> <span class="o">-</span> <span class="n">pts2</span><span class="p">[</span><span class="n">valid</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a><a href="#__codelineno-0-738"><span class="linenos" data-linenos="738 "></span></a>                        <span class="p">)</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><a href="#__codelineno-0-739"><span class="linenos" data-linenos="739 "></span></a>                        <span class="n">score</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">distances</span><span class="p">))</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><a href="#__codelineno-0-740"><span class="linenos" data-linenos="740 "></span></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a><a href="#__codelineno-0-741"><span class="linenos" data-linenos="741 "></span></a>                        <span class="n">score</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a><a href="#__codelineno-0-742"><span class="linenos" data-linenos="742 "></span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">IOU</span><span class="p">:</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a><a href="#__codelineno-0-743"><span class="linenos" data-linenos="743 "></span></a>                    <span class="c1"># Calculate actual IoU as score</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a><a href="#__codelineno-0-744"><span class="linenos" data-linenos="744 "></span></a>                    <span class="n">bbox1</span> <span class="o">=</span> <span class="n">inst1</span><span class="o">.</span><span class="n">bounding_box</span><span class="p">()</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a><a href="#__codelineno-0-745"><span class="linenos" data-linenos="745 "></span></a>                    <span class="n">bbox2</span> <span class="o">=</span> <span class="n">inst2</span><span class="o">.</span><span class="n">bounding_box</span><span class="p">()</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a><a href="#__codelineno-0-746"><span class="linenos" data-linenos="746 "></span></a>                    <span class="k">if</span> <span class="n">bbox1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">bbox2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a><a href="#__codelineno-0-747"><span class="linenos" data-linenos="747 "></span></a>                        <span class="c1"># Calculate IoU</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><a href="#__codelineno-0-748"><span class="linenos" data-linenos="748 "></span></a>                        <span class="n">intersection_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">bbox1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a><a href="#__codelineno-0-749"><span class="linenos" data-linenos="749 "></span></a>                        <span class="n">intersection_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">bbox1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bbox2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a><a href="#__codelineno-0-750"><span class="linenos" data-linenos="750 "></span></a>                        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">intersection_min</span> <span class="o">&lt;</span> <span class="n">intersection_max</span><span class="p">):</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a><a href="#__codelineno-0-751"><span class="linenos" data-linenos="751 "></span></a>                            <span class="n">intersection_area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a><a href="#__codelineno-0-752"><span class="linenos" data-linenos="752 "></span></a>                                <span class="n">intersection_max</span> <span class="o">-</span> <span class="n">intersection_min</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a><a href="#__codelineno-0-753"><span class="linenos" data-linenos="753 "></span></a>                            <span class="p">)</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a><a href="#__codelineno-0-754"><span class="linenos" data-linenos="754 "></span></a>                            <span class="n">area1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">bbox1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a><a href="#__codelineno-0-755"><span class="linenos" data-linenos="755 "></span></a>                            <span class="n">area2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">bbox2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a><a href="#__codelineno-0-756"><span class="linenos" data-linenos="756 "></span></a>                            <span class="n">union_area</span> <span class="o">=</span> <span class="n">area1</span> <span class="o">+</span> <span class="n">area2</span> <span class="o">-</span> <span class="n">intersection_area</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a><a href="#__codelineno-0-757"><span class="linenos" data-linenos="757 "></span></a>                            <span class="n">score</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a><a href="#__codelineno-0-758"><span class="linenos" data-linenos="758 "></span></a>                                <span class="n">intersection_area</span> <span class="o">/</span> <span class="n">union_area</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a><a href="#__codelineno-0-759"><span class="linenos" data-linenos="759 "></span></a>                                <span class="k">if</span> <span class="n">union_area</span> <span class="o">&gt;</span> <span class="mi">0</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a><a href="#__codelineno-0-760"><span class="linenos" data-linenos="760 "></span></a>                                <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a><a href="#__codelineno-0-761"><span class="linenos" data-linenos="761 "></span></a>                            <span class="p">)</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a><a href="#__codelineno-0-762"><span class="linenos" data-linenos="762 "></span></a>                        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a><a href="#__codelineno-0-763"><span class="linenos" data-linenos="763 "></span></a>                            <span class="n">score</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a><a href="#__codelineno-0-764"><span class="linenos" data-linenos="764 "></span></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a><a href="#__codelineno-0-765"><span class="linenos" data-linenos="765 "></span></a>                        <span class="n">score</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a><a href="#__codelineno-0-766"><span class="linenos" data-linenos="766 "></span></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><a href="#__codelineno-0-767"><span class="linenos" data-linenos="767 "></span></a>                    <span class="n">score</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Binary match for identity</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a><a href="#__codelineno-0-768"><span class="linenos" data-linenos="768 "></span></a>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a><a href="#__codelineno-0-769"><span class="linenos" data-linenos="769 "></span></a>                <span class="n">matches</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">score</span><span class="p">))</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a><a href="#__codelineno-0-770"><span class="linenos" data-linenos="770 "></span></a>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a><a href="#__codelineno-0-771"><span class="linenos" data-linenos="771 "></span></a>    <span class="k">return</span> <span class="n">matches</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.InstanceMatcher.match" class="doc doc-heading">
            <code class="highlight language-python"><span class="k">match</span><span class="p">(</span><span class="n">instance1</span><span class="p">,</span> <span class="n">instance2</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.InstanceMatcher.match" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Check if two instances match according to the configured method.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-705" name="__codelineno-0-705"></a><a href="#__codelineno-0-705"><span class="linenos" data-linenos="705 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance1</span><span class="p">:</span> <span class="n">Instance</span><span class="p">,</span> <span class="n">instance2</span><span class="p">:</span> <span class="n">Instance</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><a href="#__codelineno-0-706"><span class="linenos" data-linenos="706 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if two instances match according to the configured method.&quot;&quot;&quot;</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a><a href="#__codelineno-0-707"><span class="linenos" data-linenos="707 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">SPATIAL</span><span class="p">:</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a><a href="#__codelineno-0-708"><span class="linenos" data-linenos="708 "></span></a>        <span class="k">return</span> <span class="n">instance1</span><span class="o">.</span><span class="n">same_pose_as</span><span class="p">(</span><span class="n">instance2</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a><a href="#__codelineno-0-709"><span class="linenos" data-linenos="709 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">IDENTITY</span><span class="p">:</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a><a href="#__codelineno-0-710"><span class="linenos" data-linenos="710 "></span></a>        <span class="k">return</span> <span class="n">instance1</span><span class="o">.</span><span class="n">same_identity_as</span><span class="p">(</span><span class="n">instance2</span><span class="p">)</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><a href="#__codelineno-0-711"><span class="linenos" data-linenos="711 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">IOU</span><span class="p">:</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a><a href="#__codelineno-0-712"><span class="linenos" data-linenos="712 "></span></a>        <span class="k">return</span> <span class="n">instance1</span><span class="o">.</span><span class="n">overlaps_with</span><span class="p">(</span><span class="n">instance2</span><span class="p">,</span> <span class="n">iou_threshold</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a><a href="#__codelineno-0-713"><span class="linenos" data-linenos="713 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a><a href="#__codelineno-0-714"><span class="linenos" data-linenos="714 "></span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown instance match method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="mergeresult">MergeResult<a class="headerlink" href="#mergeresult" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.MergeResult" class="doc doc-heading">
            <code>sleap_io.model.matching.MergeResult</code>


<a href="#sleap_io.model.matching.MergeResult" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">



        <p>Result of a merge operation.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.successful">successful</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the merge completed successfully.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.frames_merged">frames_merged</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of frames that were merged.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.instances_added">instances_added</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of new instances added.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.instances_updated">instances_updated</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of existing instances that were updated.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.instances_skipped">instances_skipped</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of instances that were skipped.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.conflicts">conflicts</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of conflicts that were resolved during merging.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.errors">errors</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of errors encountered during merging.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>












<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__eq__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.MergeResult.__eq__&lt;/code&gt;)" href="#sleap_io.model.matching.MergeResult.__eq__">__eq__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class MergeResult.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;successful&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frames_merged&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instances_added&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instances_updated&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instances_skipped&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;conflicts&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NOTHING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;errors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NOTHING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.MergeResult.__init__&lt;/code&gt;)" href="#sleap_io.model.matching.MergeResult.__init__">__init__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class MergeResult.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;__replace__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;changes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.MergeResult.__replace__&lt;/code&gt;)" href="#sleap_io.model.matching.MergeResult.__replace__">__replace__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class MergeResult.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__repr__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.MergeResult.__repr__&lt;/code&gt;)" href="#sleap_io.model.matching.MergeResult.__repr__">__repr__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method generated by attrs for class MergeResult.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.MergeResult.summary&lt;/code&gt;)" href="#sleap_io.model.matching.MergeResult.summary">summary</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generate a human-readable summary of the merge result.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



              <details class="mkdocstrings-source">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1189" name="__codelineno-0-1189"></a><a href="#__codelineno-0-1189"><span class="linenos" data-linenos="1189 "></span></a><span class="nd">@attrs</span><span class="o">.</span><span class="n">define</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a><a href="#__codelineno-0-1190"><span class="linenos" data-linenos="1190 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">MergeResult</span><span class="p">:</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a><a href="#__codelineno-0-1191"><span class="linenos" data-linenos="1191 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Result of a merge operation.</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><a href="#__codelineno-0-1192"><span class="linenos" data-linenos="1192 "></span></a>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a><a href="#__codelineno-0-1193"><span class="linenos" data-linenos="1193 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a><a href="#__codelineno-0-1194"><span class="linenos" data-linenos="1194 "></span></a><span class="sd">        successful: Whether the merge completed successfully.</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a><a href="#__codelineno-0-1195"><span class="linenos" data-linenos="1195 "></span></a><span class="sd">        frames_merged: Number of frames that were merged.</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a><a href="#__codelineno-0-1196"><span class="linenos" data-linenos="1196 "></span></a><span class="sd">        instances_added: Number of new instances added.</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a><a href="#__codelineno-0-1197"><span class="linenos" data-linenos="1197 "></span></a><span class="sd">        instances_updated: Number of existing instances that were updated.</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a><a href="#__codelineno-0-1198"><span class="linenos" data-linenos="1198 "></span></a><span class="sd">        instances_skipped: Number of instances that were skipped.</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><a href="#__codelineno-0-1199"><span class="linenos" data-linenos="1199 "></span></a><span class="sd">        conflicts: List of conflicts that were resolved during merging.</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a><a href="#__codelineno-0-1200"><span class="linenos" data-linenos="1200 "></span></a><span class="sd">        errors: List of errors encountered during merging.</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a><a href="#__codelineno-0-1201"><span class="linenos" data-linenos="1201 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a><a href="#__codelineno-0-1202"><span class="linenos" data-linenos="1202 "></span></a>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a><a href="#__codelineno-0-1203"><span class="linenos" data-linenos="1203 "></span></a>    <span class="n">successful</span><span class="p">:</span> <span class="nb">bool</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a><a href="#__codelineno-0-1204"><span class="linenos" data-linenos="1204 "></span></a>    <span class="n">frames_merged</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a><a href="#__codelineno-0-1205"><span class="linenos" data-linenos="1205 "></span></a>    <span class="n">instances_added</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a><a href="#__codelineno-0-1206"><span class="linenos" data-linenos="1206 "></span></a>    <span class="n">instances_updated</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a><a href="#__codelineno-0-1207"><span class="linenos" data-linenos="1207 "></span></a>    <span class="n">instances_skipped</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a><a href="#__codelineno-0-1208"><span class="linenos" data-linenos="1208 "></span></a>    <span class="n">conflicts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ConflictResolution</span><span class="p">]</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a><a href="#__codelineno-0-1209"><span class="linenos" data-linenos="1209 "></span></a>    <span class="n">errors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MergeError</span><span class="p">]</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a><a href="#__codelineno-0-1210"><span class="linenos" data-linenos="1210 "></span></a>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a><a href="#__codelineno-0-1211"><span class="linenos" data-linenos="1211 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a><a href="#__codelineno-0-1212"><span class="linenos" data-linenos="1212 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a human-readable summary of the merge result.&quot;&quot;&quot;</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a><a href="#__codelineno-0-1213"><span class="linenos" data-linenos="1213 "></span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a><a href="#__codelineno-0-1214"><span class="linenos" data-linenos="1214 "></span></a>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><a href="#__codelineno-0-1215"><span class="linenos" data-linenos="1215 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">successful</span><span class="p">:</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><a href="#__codelineno-0-1216"><span class="linenos" data-linenos="1216 "></span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;✓ Merge completed successfully&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><a href="#__codelineno-0-1217"><span class="linenos" data-linenos="1217 "></span></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a><a href="#__codelineno-0-1218"><span class="linenos" data-linenos="1218 "></span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;✗ Merge completed with errors&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a><a href="#__codelineno-0-1219"><span class="linenos" data-linenos="1219 "></span></a>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a><a href="#__codelineno-0-1220"><span class="linenos" data-linenos="1220 "></span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Frames merged: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">frames_merged</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a><a href="#__codelineno-0-1221"><span class="linenos" data-linenos="1221 "></span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Instances added: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">instances_added</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a><a href="#__codelineno-0-1222"><span class="linenos" data-linenos="1222 "></span></a>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a><a href="#__codelineno-0-1223"><span class="linenos" data-linenos="1223 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances_updated</span><span class="p">:</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a><a href="#__codelineno-0-1224"><span class="linenos" data-linenos="1224 "></span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Instances updated: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">instances_updated</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a><a href="#__codelineno-0-1225"><span class="linenos" data-linenos="1225 "></span></a>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a><a href="#__codelineno-0-1226"><span class="linenos" data-linenos="1226 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances_skipped</span><span class="p">:</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a><a href="#__codelineno-0-1227"><span class="linenos" data-linenos="1227 "></span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Instances skipped: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">instances_skipped</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a><a href="#__codelineno-0-1228"><span class="linenos" data-linenos="1228 "></span></a>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a><a href="#__codelineno-0-1229"><span class="linenos" data-linenos="1229 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conflicts</span><span class="p">:</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a><a href="#__codelineno-0-1230"><span class="linenos" data-linenos="1230 "></span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Conflicts resolved: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conflicts</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a><a href="#__codelineno-0-1231"><span class="linenos" data-linenos="1231 "></span></a>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a><a href="#__codelineno-0-1232"><span class="linenos" data-linenos="1232 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a><a href="#__codelineno-0-1233"><span class="linenos" data-linenos="1233 "></span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Errors encountered: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a><a href="#__codelineno-0-1234"><span class="linenos" data-linenos="1234 "></span></a>            <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>  <span class="c1"># Show first 5 errors</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a><a href="#__codelineno-0-1235"><span class="linenos" data-linenos="1235 "></span></a>                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    - </span><span class="si">{</span><span class="n">error</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><a href="#__codelineno-0-1236"><span class="linenos" data-linenos="1236 "></span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a><a href="#__codelineno-0-1237"><span class="linenos" data-linenos="1237 "></span></a>                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    ... and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">5</span><span class="si">}</span><span class="s2"> more&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a><a href="#__codelineno-0-1238"><span class="linenos" data-linenos="1238 "></span></a>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><a href="#__codelineno-0-1239"><span class="linenos" data-linenos="1239 "></span></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.MergeResult.__annotations__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__annotations__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;successful&#39;</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span><span class="p">,</span> <span class="s1">&#39;frames_merged&#39;</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;instances_added&#39;</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;instances_updated&#39;</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;instances_skipped&#39;</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;conflicts&#39;</span><span class="p">:</span> <span class="s1">&#39;list[ConflictResolution]&#39;</span><span class="p">,</span> <span class="s1">&#39;errors&#39;</span><span class="p">:</span> <span class="s1">&#39;list[MergeError]&#39;</span><span class="p">}</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.MergeResult.__annotations__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>dict() -&gt; new empty dictionary
dict(mapping) -&gt; new dictionary initialized from a mapping object's
    (key, value) pairs
dict(iterable) -&gt; new dictionary initialized as if via:
    d = {}
    for k, v in iterable:
        d[k] = v
dict(**kwargs) -&gt; new dictionary initialized with the name=value pairs
    in the keyword argument list.  For example:  dict(one=1, two=2)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.MergeResult.__attrs_own_setattr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__attrs_own_setattr__</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.MergeResult.__attrs_own_setattr__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Returns True when the argument is true, False otherwise.
The builtins True and False are the only two instances of the class bool.
The class bool is a subclass of the class int, and cannot be subclassed.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.MergeResult.__attrs_props__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__attrs_props__</span> <span class="o">=</span> <span class="n">ClassProps</span><span class="p">(</span><span class="n">is_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_slotted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_weakref_slot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_frozen</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=&lt;</span><span class="n">KeywordOnly</span><span class="o">.</span><span class="n">NO</span><span class="p">:</span> <span class="s1">&#39;no&#39;</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">collected_fields_by_mro</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_init</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_repr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_eq</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_ordering</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hashability</span><span class="o">=&lt;</span><span class="n">Hashability</span><span class="o">.</span><span class="n">UNHASHABLE</span><span class="p">:</span> <span class="s1">&#39;unhashable&#39;</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">added_match_args</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">added_str</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">added_pickling</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">on_setattr_hook</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">pipe</span><span class="o">.&lt;</span><span class="nb">locals</span><span class="o">&gt;.</span><span class="n">wrapped_pipe</span> <span class="n">at</span> <span class="mh">0x7f45c0a9aca0</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">field_transformer</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.MergeResult.__attrs_props__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Effective class properties as derived from parameters to <code>attr.s()</code> or
<code>define()</code> decorators.</p>
<p>This is the same data structure that <em>attrs</em> uses internally to decide how
to construct the final class.</p>
<p>Warning:</p>
<div class="highlight"><pre><span></span><code>This feature is currently **experimental** and is not covered by our
strict backwards-compatibility guarantees.
</code></pre></div>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.__attrs_props__.is_exception">is_exception</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class is treated as an exception class.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.__attrs_props__.is_slotted">is_slotted</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class is <code>slotted &lt;slotted classes&gt;</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.__attrs_props__.has_weakref_slot">has_weakref_slot</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has a slot for weak references.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.__attrs_props__.is_frozen">is_frozen</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class is frozen.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.__attrs_props__.kw_only">kw_only</span></code></td>
            <td>
                  <code><span title="KeywordOnly">KeywordOnly</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether / how the class enforces keyword-only arguments on the
<code>__init__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.__attrs_props__.collected_fields_by_mro">collected_fields_by_mro</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class fields were collected by method resolution order.
That is, correctly but unlike <code>dataclasses</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.__attrs_props__.added_init">added_init</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has an <em>attrs</em>-generated <code>__init__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.__attrs_props__.added_repr">added_repr</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has an <em>attrs</em>-generated <code>__repr__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.__attrs_props__.added_eq">added_eq</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has <em>attrs</em>-generated equality methods.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.__attrs_props__.added_ordering">added_ordering</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has <em>attrs</em>-generated ordering methods.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.__attrs_props__.hashability">hashability</span></code></td>
            <td>
                  <code><span title="Hashability">Hashability</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How <code>hashable &lt;hashing&gt;</code> the class is.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.__attrs_props__.added_match_args">added_match_args</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class supports positional <code>match &lt;match&gt;</code> over its
fields.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.__attrs_props__.added_str">added_str</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has an <em>attrs</em>-generated <code>__str__</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.__attrs_props__.added_pickling">added_pickling</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the class has <em>attrs</em>-generated <code>__getstate__</code> and
<code>__setstate__</code> methods for <code>pickle</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.__attrs_props__.on_setattr_hook">on_setattr_hook</span></code></td>
            <td>
                  <code><span title="Callable">Callable</span>[[<span title="typing.Any">Any</span>, <span title="Attribute">Attribute</span>[<span title="typing.Any">Any</span>], <span title="typing.Any">Any</span>], <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The class's <code>__setattr__</code> hook.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.__attrs_props__.field_transformer">field_transformer</span></code></td>
            <td>
                  <code><span title="Callable">Callable</span>[[<span title="Attribute">Attribute</span>[<span title="typing.Any">Any</span>]], <span title="Attribute">Attribute</span>[<span title="typing.Any">Any</span>]] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The class's <code>field transformers &lt;transform-fields&gt;</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>.. versionadded:: 25.4.0</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.MergeResult.__doc__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__doc__</span> <span class="o">=</span> <span class="s1">&#39;Result of a merge operation.</span><span class="se">\n\n</span><span class="s1">Attributes:</span><span class="se">\n</span><span class="s1">    successful: Whether the merge completed successfully.</span><span class="se">\n</span><span class="s1">    frames_merged: Number of frames that were merged.</span><span class="se">\n</span><span class="s1">    instances_added: Number of new instances added.</span><span class="se">\n</span><span class="s1">    instances_updated: Number of existing instances that were updated.</span><span class="se">\n</span><span class="s1">    instances_skipped: Number of instances that were skipped.</span><span class="se">\n</span><span class="s1">    conflicts: List of conflicts that were resolved during merging.</span><span class="se">\n</span><span class="s1">    errors: List of errors encountered during merging.</span><span class="se">\n</span><span class="s1">&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.MergeResult.__doc__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to 'utf-8'.
errors defaults to 'strict'.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.MergeResult.__firstlineno__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__firstlineno__</span> <span class="o">=</span> <span class="mi">1189</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.MergeResult.__firstlineno__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>int([x]) -&gt; integer
int(x, base=10) -&gt; integer</p>
<p>Convert a number or string to an integer, or return 0 if no arguments
are given.  If x is a number, return x.<strong>int</strong>().  For floating-point
numbers, this truncates towards zero.</p>
<p>If x is not a number or if base is given, then x must be a string,
bytes, or bytearray instance representing an integer literal in the
given base.  The literal can be preceded by '+' or '-' and be surrounded
by whitespace.  The base defaults to 10.  Valid bases are 0 and 2-36.
Base 0 means to interpret the base from the string as an integer literal.</p>
<blockquote>
<blockquote>
<blockquote>
<p>int('0b100', base=0)
4</p>
</blockquote>
</blockquote>
</blockquote>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.MergeResult.__match_args__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__match_args__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;successful&#39;</span><span class="p">,</span> <span class="s1">&#39;frames_merged&#39;</span><span class="p">,</span> <span class="s1">&#39;instances_added&#39;</span><span class="p">,</span> <span class="s1">&#39;instances_updated&#39;</span><span class="p">,</span> <span class="s1">&#39;instances_skipped&#39;</span><span class="p">,</span> <span class="s1">&#39;conflicts&#39;</span><span class="p">,</span> <span class="s1">&#39;errors&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.MergeResult.__match_args__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Built-in immutable sequence.</p>
<p>If no argument is given, the constructor returns an empty tuple.
If iterable is specified the tuple is initialized from iterable's items.</p>
<p>If the argument is a tuple, the return value is the same object.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.MergeResult.__module__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__module__</span> <span class="o">=</span> <span class="s1">&#39;sleap_io.model.matching&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.MergeResult.__module__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to 'utf-8'.
errors defaults to 'strict'.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.MergeResult.__slots__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;successful&#39;</span><span class="p">,</span> <span class="s1">&#39;frames_merged&#39;</span><span class="p">,</span> <span class="s1">&#39;instances_added&#39;</span><span class="p">,</span> <span class="s1">&#39;instances_updated&#39;</span><span class="p">,</span> <span class="s1">&#39;instances_skipped&#39;</span><span class="p">,</span> <span class="s1">&#39;conflicts&#39;</span><span class="p">,</span> <span class="s1">&#39;errors&#39;</span><span class="p">,</span> <span class="s1">&#39;__weakref__&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.MergeResult.__slots__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Built-in immutable sequence.</p>
<p>If no argument is given, the constructor returns an empty tuple.
If iterable is specified the tuple is initialized from iterable's items.</p>
<p>If the argument is a tuple, the return value is the same object.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.MergeResult.__static_attributes__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__static_attributes__</span> <span class="o">=</span> <span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.MergeResult.__static_attributes__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Built-in immutable sequence.</p>
<p>If no argument is given, the constructor returns an empty tuple.
If iterable is specified the tuple is initialized from iterable's items.</p>
<p>If the argument is a tuple, the return value is the same object.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="sleap_io.model.matching.MergeResult.__weakref__" class="doc doc-heading">
            <code class="highlight language-python"><span class="vm">__weakref__</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#sleap_io.model.matching.MergeResult.__weakref__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>list of weak references to the object</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.MergeResult.__eq__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.MergeResult.__eq__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class MergeResult.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-16" name="__codelineno-0-16"></a><a href="#__codelineno-0-16"><span class="linenos" data-linenos="16 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><a href="#__codelineno-0-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><a href="#__codelineno-0-18"><span class="linenos" data-linenos="18 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><a href="#__codelineno-0-19"><span class="linenos" data-linenos="19 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">Any</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><a href="#__codelineno-0-20"><span class="linenos" data-linenos="20 "></span></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><a href="#__codelineno-0-21"><span class="linenos" data-linenos="21 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">attrs</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><a href="#__codelineno-0-22"><span class="linenos" data-linenos="22 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><a href="#__codelineno-0-23"><span class="linenos" data-linenos="23 "></span></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><a href="#__codelineno-0-24"><span class="linenos" data-linenos="24 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.instance</span><span class="w"> </span><span class="kn">import</span> <span class="n">Instance</span><span class="p">,</span> <span class="n">Track</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><a href="#__codelineno-0-25"><span class="linenos" data-linenos="25 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.labeled_frame</span><span class="w"> </span><span class="kn">import</span> <span class="n">LabeledFrame</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><a href="#__codelineno-0-26"><span class="linenos" data-linenos="26 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.skeleton</span><span class="w"> </span><span class="kn">import</span> <span class="n">Skeleton</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.MergeResult.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">successful</span><span class="p">,</span> <span class="n">frames_merged</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">instances_added</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">instances_updated</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">instances_skipped</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">conflicts</span><span class="o">=</span><span class="n">NOTHING</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">NOTHING</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.MergeResult.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class MergeResult.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-28" name="__codelineno-0-28"></a><a href="#__codelineno-0-28"><span class="linenos" data-linenos="28 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.video</span><span class="w"> </span><span class="kn">import</span> <span class="n">Video</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><a href="#__codelineno-0-29"><span class="linenos" data-linenos="29 "></span></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><a href="#__codelineno-0-30"><span class="linenos" data-linenos="30 "></span></a><span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><a href="#__codelineno-0-31"><span class="linenos" data-linenos="31 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.labels</span><span class="w"> </span><span class="kn">import</span> <span class="n">Labels</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><a href="#__codelineno-0-32"><span class="linenos" data-linenos="32 "></span></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><a href="#__codelineno-0-33"><span class="linenos" data-linenos="33 "></span></a>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><a href="#__codelineno-0-34"><span class="linenos" data-linenos="34 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">SkeletonMatchMethod</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><a href="#__codelineno-0-35"><span class="linenos" data-linenos="35 "></span></a>    <span class="s2">&quot;&quot;&quot;Methods for matching skeletons.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><a href="#__codelineno-0-36"><span class="linenos" data-linenos="36 "></span></a>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><a href="#__codelineno-0-37"><span class="linenos" data-linenos="37 "></span></a><span class="s2">    Attributes:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><a href="#__codelineno-0-38"><span class="linenos" data-linenos="38 "></span></a><span class="s2">        EXACT: Exact match requiring same nodes in the same order.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><a href="#__codelineno-0-39"><span class="linenos" data-linenos="39 "></span></a><span class="s2">        STRUCTURE: Match requiring same nodes and edges, but order doesn&#39;t matter.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><a href="#__codelineno-0-40"><span class="linenos" data-linenos="40 "></span></a><span class="s2">        OVERLAP: Partial match based on overlapping nodes (uses Jaccard similarity).</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><a href="#__codelineno-0-41"><span class="linenos" data-linenos="41 "></span></a><span class="s2">        SUBSET: Match if one skeleton&#39;s nodes are a subset of another&#39;s.</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.MergeResult.__replace__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__replace__</span><span class="p">(</span><span class="o">**</span><span class="n">changes</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.MergeResult.__replace__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class MergeResult.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><a href="#__codelineno-0-1100"><span class="linenos" data-linenos="1100 "></span></a><span class="n">Only</span> <span class="n">used</span> <span class="n">when</span> <span class="n">compare_images</span><span class="o">=</span><span class="kc">True</span><span class="o">.</span> <span class="n">Expensive</span> <span class="n">operation</span><span class="o">.</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.MergeResult.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#sleap_io.model.matching.MergeResult.__repr__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Method generated by attrs for class MergeResult.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="sd">&quot;&quot;&quot;Unified matcher system for comparing and matching data structures during merging.</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="sd">This module provides configurable matchers for comparing skeletons, instances, tracks,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="sd">and videos during merge operations. The matchers use various strategies to determine</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="sd">when data structures should be considered equivalent during merging.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="sd">Key features:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="sd">- Skeleton matching: exact, structure-based, overlap, and subset matching</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="sd">- Instance matching: spatial proximity, track identity, and bounding box IoU</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><a href="#__codelineno-0-10"><span class="linenos" data-linenos="10 "></span></a><span class="sd">- Track matching: by name or object identity</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><a href="#__codelineno-0-11"><span class="linenos" data-linenos="11 "></span></a><span class="sd">- Video matching: path, basename, content, and auto matching</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><a href="#__codelineno-0-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><a href="#__codelineno-0-13"><span class="linenos" data-linenos="13 "></span></a><span class="sd">Video matching supports path-based, filename-based, content-based, and</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><a href="#__codelineno-0-14"><span class="linenos" data-linenos="14 "></span></a><span class="sd">automatic strategies.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><a href="#__codelineno-0-15"><span class="linenos" data-linenos="15 "></span></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.MergeResult.summary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">summary</span><span class="p">()</span></code>

<a href="#sleap_io.model.matching.MergeResult.summary" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Generate a human-readable summary of the merge result.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1211" name="__codelineno-0-1211"></a><a href="#__codelineno-0-1211"><span class="linenos" data-linenos="1211 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a><a href="#__codelineno-0-1212"><span class="linenos" data-linenos="1212 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a human-readable summary of the merge result.&quot;&quot;&quot;</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a><a href="#__codelineno-0-1213"><span class="linenos" data-linenos="1213 "></span></a>    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a><a href="#__codelineno-0-1214"><span class="linenos" data-linenos="1214 "></span></a>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><a href="#__codelineno-0-1215"><span class="linenos" data-linenos="1215 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">successful</span><span class="p">:</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><a href="#__codelineno-0-1216"><span class="linenos" data-linenos="1216 "></span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;✓ Merge completed successfully&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><a href="#__codelineno-0-1217"><span class="linenos" data-linenos="1217 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a><a href="#__codelineno-0-1218"><span class="linenos" data-linenos="1218 "></span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;✗ Merge completed with errors&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a><a href="#__codelineno-0-1219"><span class="linenos" data-linenos="1219 "></span></a>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a><a href="#__codelineno-0-1220"><span class="linenos" data-linenos="1220 "></span></a>    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Frames merged: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">frames_merged</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a><a href="#__codelineno-0-1221"><span class="linenos" data-linenos="1221 "></span></a>    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Instances added: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">instances_added</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a><a href="#__codelineno-0-1222"><span class="linenos" data-linenos="1222 "></span></a>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a><a href="#__codelineno-0-1223"><span class="linenos" data-linenos="1223 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances_updated</span><span class="p">:</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a><a href="#__codelineno-0-1224"><span class="linenos" data-linenos="1224 "></span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Instances updated: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">instances_updated</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a><a href="#__codelineno-0-1225"><span class="linenos" data-linenos="1225 "></span></a>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a><a href="#__codelineno-0-1226"><span class="linenos" data-linenos="1226 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances_skipped</span><span class="p">:</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a><a href="#__codelineno-0-1227"><span class="linenos" data-linenos="1227 "></span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Instances skipped: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">instances_skipped</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a><a href="#__codelineno-0-1228"><span class="linenos" data-linenos="1228 "></span></a>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a><a href="#__codelineno-0-1229"><span class="linenos" data-linenos="1229 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conflicts</span><span class="p">:</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a><a href="#__codelineno-0-1230"><span class="linenos" data-linenos="1230 "></span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Conflicts resolved: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conflicts</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a><a href="#__codelineno-0-1231"><span class="linenos" data-linenos="1231 "></span></a>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a><a href="#__codelineno-0-1232"><span class="linenos" data-linenos="1232 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a><a href="#__codelineno-0-1233"><span class="linenos" data-linenos="1233 "></span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Errors encountered: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a><a href="#__codelineno-0-1234"><span class="linenos" data-linenos="1234 "></span></a>        <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>  <span class="c1"># Show first 5 errors</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a><a href="#__codelineno-0-1235"><span class="linenos" data-linenos="1235 "></span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    - </span><span class="si">{</span><span class="n">error</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><a href="#__codelineno-0-1236"><span class="linenos" data-linenos="1236 "></span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a><a href="#__codelineno-0-1237"><span class="linenos" data-linenos="1237 "></span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    ... and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">5</span><span class="si">}</span><span class="s2"> more&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a><a href="#__codelineno-0-1238"><span class="linenos" data-linenos="1238 "></span></a>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><a href="#__codelineno-0-1239"><span class="linenos" data-linenos="1239 "></span></a>    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 - 2026 Talmo Lab

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/talmolab" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/talmop" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.tracking", "toc.follow", "navigation.sections", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate", "content.tooltips", "content.code.select", "content.footnote.tooltips"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../js/toc-code-style.js"></script>
      
    
  </body>
</html>