
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://io.sleap.ai/dev/merging/">
      
      
        <link rel="prev" href="../examples/">
      
      
        <link rel="next" href="../model/">
      
      
      <link rel="icon" href="../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Merging - sleap-io documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#merging-annotations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="sleap-io documentation" class="md-header__button md-logo" aria-label="sleap-io documentation" data-md-component="logo">
      
  <img src="../assets/sleap-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            sleap-io documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Merging
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-orange" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/talmolab/sleap-io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="sleap-io documentation" class="md-nav__button md-logo" aria-label="sleap-io documentation" data-md-component="logo">
      
  <img src="../assets/sleap-logo.png" alt="logo">

    </a>
    sleap-io documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/talmolab/sleap-io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/talmolab/sleap-io/releases" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Releases
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Merging
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Merging
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      Quick start
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-merging-works" class="md-nav__link">
    <span class="md-ellipsis">
      How merging works
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#merging-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      Merging strategies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matching-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Matching configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-workflows" class="md-nav__link">
    <span class="md-ellipsis">
      Common workflows
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-topics" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced topics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-reference" class="md-nav__link">
    <span class="md-ellipsis">
      API reference
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../formats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Formats
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Full API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Full API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/sleap_io/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    sleap_io
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_3_1" id="__nav_5_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3_1">
            <span class="md-nav__icon md-icon"></span>
            sleap_io
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3_1_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/sleap_io/io/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    io
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_3_1_1" id="__nav_5_3_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            io
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/alphatracker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    alphatracker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cli
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/coco/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    coco
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/dlc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dlc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/jabs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    jabs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/labelstudio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    labelstudio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/leap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    leap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    main
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/nwb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nwb
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/nwb_annotations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nwb_annotations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/nwb_predictions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nwb_predictions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/skeleton/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    skeleton
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/slp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    slp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/ultralytics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ultralytics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/video_reading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    video_reading
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/io/video_writing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    video_writing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3_1_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/sleap_io/model/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    model
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_3_1_2" id="__nav_5_3_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            model
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/model/camera/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    camera
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/model/instance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    instance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/model/labeled_frame/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    labeled_frame
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/model/labels/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    labels
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/model/labels_set/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    labels_set
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/model/matching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    matching
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/model/skeleton/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    skeleton
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/model/suggestions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    suggestions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/model/video/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    video
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sleap_io/version/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    version
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      Quick start
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-merging-works" class="md-nav__link">
    <span class="md-ellipsis">
      How merging works
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#merging-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      Merging strategies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matching-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Matching configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-workflows" class="md-nav__link">
    <span class="md-ellipsis">
      Common workflows
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-topics" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced topics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-reference" class="md-nav__link">
    <span class="md-ellipsis">
      API reference
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="merging-annotations">Merging annotations<a class="headerlink" href="#merging-annotations" title="Permanent link">&para;</a></h1>
<p>The merging system in sleap-io provides powerful tools for combining multiple annotation files while intelligently handling conflicts, duplicates, and different data sources. This is essential for collaborative annotation, human-in-the-loop workflows, and consolidating predictions from multiple models.</p>
<div class="admonition info">
<p class="admonition-title">Key concepts</p>
<ul>
<li><strong>Merging</strong>: Combining annotations from multiple sources into a single dataset</li>
<li><strong>Matching</strong>: Determining which objects (skeletons, videos, tracks, instances) correspond between datasets</li>
<li><strong>Conflict resolution</strong>: Handling overlapping or contradicting annotations using configurable strategies</li>
<li><strong>Provenance tracking</strong>: Automatic recording of merge history and data sources</li>
</ul>
</div>
<h2 id="quick-start">Quick start<a class="headerlink" href="#quick-start" title="Permanent link">&para;</a></h2>
<p>The simplest and most common use case is merging predictions back into a manually annotated project:</p>
<div class="highlight"><span class="filename">Basic merge example</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">sleap_io</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sio</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="c1"># Load your manual annotations and new predictions</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="n">base_labels</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;manual_annotations.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="n">predictions</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;model_predictions.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="c1"># Merge predictions into base project</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="c1"># Default &#39;smart&#39; strategy preserves manual labels</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="n">result</span> <span class="o">=</span> <span class="n">base_labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><a href="#__codelineno-0-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><a href="#__codelineno-0-11"><span class="linenos" data-linenos="11 "></span></a><span class="c1"># Check what happened</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><a href="#__codelineno-0-12"><span class="linenos" data-linenos="12 "></span></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Frames merged: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">frames_merged</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><a href="#__codelineno-0-13"><span class="linenos" data-linenos="13 "></span></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Instances added: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">instances_added</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><a href="#__codelineno-0-14"><span class="linenos" data-linenos="14 "></span></a>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><a href="#__codelineno-0-15"><span class="linenos" data-linenos="15 "></span></a><span class="c1"># Save the merged project</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><a href="#__codelineno-0-16"><span class="linenos" data-linenos="16 "></span></a><span class="n">base_labels</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;merged_project.slp&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The default <code>smart</code> strategy automatically preserves your manual annotations while adding new predictions, making it ideal for human-in-the-loop workflows.</p>
</div>
<h2 id="how-merging-works">How merging works<a class="headerlink" href="#how-merging-works" title="Permanent link">&para;</a></h2>
<p>The merge process follows a systematic approach to combine data structures while maintaining consistency:</p>
<pre class="mermaid"><code>graph TD
    A[Start Merge] --&gt; B[Match Skeletons]
    B --&gt; C[Match Videos]
    C --&gt; D[Match Tracks]
    D --&gt; E[For Each Frame]
    E --&gt; F{Frame Exists?}
    F --&gt;|No| G[Add New Frame]
    F --&gt;|Yes| H[Match Instances]
    H --&gt; I[Apply Strategy]
    I --&gt; J[Resolve Conflicts]
    G --&gt; K[Next Frame]
    J --&gt; K
    K --&gt; E
    K --&gt; L[Return MergeResult]</code></pre>
<h3 id="step-by-step-process">Step-by-step process<a class="headerlink" href="#step-by-step-process" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Skeleton matching</strong>: Identifies corresponding skeletons between datasets based on node names and structure</li>
<li><strong>Video matching</strong>: Determines which videos represent the same source data (handles different paths, formats)</li>
<li><strong>Track matching</strong>: Maps tracks (instance identities) between datasets</li>
<li><strong>Frame merging</strong>: For each frame, applies the chosen strategy to combine instances</li>
<li><strong>Conflict resolution</strong>: Handles overlapping instances according to the selected strategy</li>
</ol>
<h2 id="merging-strategies">Merging strategies<a class="headerlink" href="#merging-strategies" title="Permanent link">&para;</a></h2>
<p>The merge strategy determines how instances are combined when frames overlap. Each strategy is designed for specific workflows and requirements.</p>
<h3 id="smart-strategy-default">Smart strategy (default)<a class="headerlink" href="#smart-strategy-default" title="Permanent link">&para;</a></h3>
<p>Intelligently preserves manual annotations while updating predictions. This is the recommended strategy for most use cases.</p>
<details class="abstract">
<summary>Algorithm details</summary>
<div class="highlight"><span class="filename">Smart merge logic (simplified)</span><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><a href="#__codelineno-1-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">smart_merge</span><span class="p">(</span><span class="n">base_frame</span><span class="p">,</span> <span class="n">new_frame</span><span class="p">):</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><a href="#__codelineno-1-2"><span class="linenos" data-linenos=" 2 "></span></a>    <span class="n">merged</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><a href="#__codelineno-1-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><a href="#__codelineno-1-4"><span class="linenos" data-linenos=" 4 "></span></a>    <span class="c1"># Step 1: Always keep user labels from base</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><a href="#__codelineno-1-5"><span class="linenos" data-linenos=" 5 "></span></a>    <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">base_frame</span><span class="p">:</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><a href="#__codelineno-1-6"><span class="linenos" data-linenos=" 6 "></span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">Instance</span><span class="p">):</span>  <span class="c1"># User label</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><a href="#__codelineno-1-7"><span class="linenos" data-linenos=" 7 "></span></a>            <span class="n">merged</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a><a href="#__codelineno-1-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a><a href="#__codelineno-1-9"><span class="linenos" data-linenos=" 9 "></span></a>    <span class="c1"># Step 2: Find spatial matches between frames</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a><a href="#__codelineno-1-10"><span class="linenos" data-linenos="10 "></span></a>    <span class="n">matches</span> <span class="o">=</span> <span class="n">find_spatial_matches</span><span class="p">(</span><span class="n">base_frame</span><span class="p">,</span> <span class="n">new_frame</span><span class="p">)</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a><a href="#__codelineno-1-11"><span class="linenos" data-linenos="11 "></span></a>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a><a href="#__codelineno-1-12"><span class="linenos" data-linenos="12 "></span></a>    <span class="c1"># Step 3: Process each match</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a><a href="#__codelineno-1-13"><span class="linenos" data-linenos="13 "></span></a>    <span class="k">for</span> <span class="n">base_inst</span><span class="p">,</span> <span class="n">new_inst</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a><a href="#__codelineno-1-14"><span class="linenos" data-linenos="14 "></span></a>        <span class="k">if</span> <span class="n">both_are_user_labels</span><span class="p">:</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a><a href="#__codelineno-1-15"><span class="linenos" data-linenos="15 "></span></a>            <span class="n">keep</span><span class="p">(</span><span class="n">base_inst</span><span class="p">)</span>  <span class="c1"># Preserve original</span>
<a id="__codelineno-1-16" name="__codelineno-1-16"></a><a href="#__codelineno-1-16"><span class="linenos" data-linenos="16 "></span></a>        <span class="k">elif</span> <span class="n">base_is_user_label</span><span class="p">:</span>
<a id="__codelineno-1-17" name="__codelineno-1-17"></a><a href="#__codelineno-1-17"><span class="linenos" data-linenos="17 "></span></a>            <span class="n">keep</span><span class="p">(</span><span class="n">base_inst</span><span class="p">)</span>  <span class="c1"># User labels always win</span>
<a id="__codelineno-1-18" name="__codelineno-1-18"></a><a href="#__codelineno-1-18"><span class="linenos" data-linenos="18 "></span></a>        <span class="k">elif</span> <span class="n">new_is_user_label</span><span class="p">:</span>
<a id="__codelineno-1-19" name="__codelineno-1-19"></a><a href="#__codelineno-1-19"><span class="linenos" data-linenos="19 "></span></a>            <span class="n">keep</span><span class="p">(</span><span class="n">new_inst</span><span class="p">)</span>   <span class="c1"># New user label replaces prediction</span>
<a id="__codelineno-1-20" name="__codelineno-1-20"></a><a href="#__codelineno-1-20"><span class="linenos" data-linenos="20 "></span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Both are predictions</span>
<a id="__codelineno-1-21" name="__codelineno-1-21"></a><a href="#__codelineno-1-21"><span class="linenos" data-linenos="21 "></span></a>            <span class="n">keep</span><span class="p">(</span><span class="n">higher_score_instance</span><span class="p">)</span>
<a id="__codelineno-1-22" name="__codelineno-1-22"></a><a href="#__codelineno-1-22"><span class="linenos" data-linenos="22 "></span></a>
<a id="__codelineno-1-23" name="__codelineno-1-23"></a><a href="#__codelineno-1-23"><span class="linenos" data-linenos="23 "></span></a>    <span class="c1"># Step 4: Add unmatched instances from new frame</span>
<a id="__codelineno-1-24" name="__codelineno-1-24"></a><a href="#__codelineno-1-24"><span class="linenos" data-linenos="24 "></span></a>    <span class="n">merged</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">unmatched_new_instances</span><span class="p">)</span>
<a id="__codelineno-1-25" name="__codelineno-1-25"></a><a href="#__codelineno-1-25"><span class="linenos" data-linenos="25 "></span></a>
<a id="__codelineno-1-26" name="__codelineno-1-26"></a><a href="#__codelineno-1-26"><span class="linenos" data-linenos="26 "></span></a>    <span class="k">return</span> <span class="n">merged</span>
</code></pre></div>
</details>
<div class="admonition example">
<p class="admonition-title">When to use</p>
<ul>
<li>Merging model predictions into manually annotated projects</li>
<li>Updating predictions while preserving validated annotations</li>
<li>Human-in-the-loop training workflows</li>
</ul>
</div>
<div class="highlight"><span class="filename">Using smart strategy</span><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">result</span> <span class="o">=</span> <span class="n">base_labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">new_labels</span><span class="p">,</span> <span class="n">frame_strategy</span><span class="o">=</span><span class="s2">&quot;smart&quot;</span><span class="p">)</span>
</code></pre></div>
<p><strong>Behavior matrix:</strong></p>
<table>
<thead>
<tr>
<th>Base frame</th>
<th>New frame</th>
<th>Result</th>
<th>Reasoning</th>
</tr>
</thead>
<tbody>
<tr>
<td>User label</td>
<td>Prediction</td>
<td>User label</td>
<td>Manual annotations are preserved</td>
</tr>
<tr>
<td>User label</td>
<td>User label</td>
<td>Base user label</td>
<td>Avoid duplicates, keep original</td>
</tr>
<tr>
<td>Prediction</td>
<td>User label</td>
<td>User label</td>
<td>Manual corrections override predictions</td>
</tr>
<tr>
<td>Prediction (score: 0.8)</td>
<td>Prediction (score: 0.9)</td>
<td>Prediction (0.9)</td>
<td>Higher confidence wins</td>
</tr>
<tr>
<td>Empty</td>
<td>Any</td>
<td>New instance</td>
<td>Add missing annotations</td>
</tr>
</tbody>
</table>
<h3 id="keep-original-strategy">Keep original strategy<a class="headerlink" href="#keep-original-strategy" title="Permanent link">&para;</a></h3>
<p>Preserves all instances from the base dataset, ignoring new instances at matching positions.</p>
<div class="admonition example">
<p class="admonition-title">When to use</p>
<ul>
<li>Protecting validated datasets from modification</li>
<li>Reviewing changes without applying them</li>
<li>Maintaining data integrity for published datasets</li>
</ul>
</div>
<div class="highlight"><span class="filename">Using keep original strategy</span><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">result</span> <span class="o">=</span> <span class="n">base_labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">new_labels</span><span class="p">,</span> <span class="n">frame_strategy</span><span class="o">=</span><span class="s2">&quot;keep_original&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="keep-new-strategy">Keep new strategy<a class="headerlink" href="#keep-new-strategy" title="Permanent link">&para;</a></h3>
<p>Replaces matched instances with new ones, effectively updating the base dataset.</p>
<div class="admonition example">
<p class="admonition-title">When to use</p>
<ul>
<li>Completely replacing old predictions with new ones</li>
<li>Applying corrections from a revised annotation pass</li>
<li>Updating with higher quality annotations</li>
</ul>
</div>
<div class="highlight"><span class="filename">Using keep new strategy</span><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">result</span> <span class="o">=</span> <span class="n">base_labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">new_labels</span><span class="p">,</span> <span class="n">frame_strategy</span><span class="o">=</span><span class="s2">&quot;keep_new&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="keep-both-strategy">Keep both strategy<a class="headerlink" href="#keep-both-strategy" title="Permanent link">&para;</a></h3>
<p>Retains all instances from both datasets without filtering duplicates.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This strategy can create overlapping instances at the same locations. Use with caution and consider post-processing to remove duplicates.</p>
</div>
<div class="admonition example">
<p class="admonition-title">When to use</p>
<ul>
<li>Combining annotations from multiple annotators</li>
<li>Preserving all data for later review</li>
<li>Creating training data with augmented annotations</li>
</ul>
</div>
<div class="highlight"><span class="filename">Using keep both strategy</span><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">result</span> <span class="o">=</span> <span class="n">base_labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">new_labels</span><span class="p">,</span> <span class="n">frame_strategy</span><span class="o">=</span><span class="s2">&quot;keep_both&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="update-tracks-strategy">Update tracks strategy<a class="headerlink" href="#update-tracks-strategy" title="Permanent link">&para;</a></h3>
<p>Updates the track assignments and tracking scores of existing instances based on spatial matches with new instances, while preserving the original pose annotations.</p>
<p>This strategy preserves the original pose data and <strong>does not</strong> add new or remove existing instances!</p>
<div class="admonition example">
<p class="admonition-title">When to use</p>
<ul>
<li>Updating track identities after running a tracking algorithm</li>
<li>Merging tracking information from different tracking runs</li>
</ul>
</div>
<div class="highlight"><span class="filename">Using update tracks strategy</span><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">result</span> <span class="o">=</span> <span class="n">base_labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">new_labels</span><span class="p">,</span> <span class="n">frame_strategy</span><span class="o">=</span><span class="s2">&quot;update_tracks&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="matching-configuration">Matching configuration<a class="headerlink" href="#matching-configuration" title="Permanent link">&para;</a></h2>
<p>Matching determines which objects correspond between datasets. Different matchers handle various scenarios and data inconsistencies.</p>
<h3 id="video-matching">Video matching<a class="headerlink" href="#video-matching" title="Permanent link">&para;</a></h3>
<p>Controls how videos are matched between projects, essential for cross-platform workflows and different file organizations.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:5"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><input id="__tabbed_1_4" name="__tabbed_1" type="radio" /><input id="__tabbed_1_5" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">AUTO (default)</label><label for="__tabbed_1_2">PATH</label><label for="__tabbed_1_3">BASENAME</label><label for="__tabbed_1_4">CONTENT</label><label for="__tabbed_1_5">IMAGE_DEDUP</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Tries multiple strategies in sequence until a match is found:</p>
<pre class="mermaid"><code>graph LR
    A[Try PATH match] --&gt;|Fail| B[Try BASENAME match]
    B --&gt;|Fail| C[Try CONTENT match]
    C --&gt;|Fail| D[No match]
    A --&gt;|Success| E[Match found]
    B --&gt;|Success| E
    C --&gt;|Success| E</code></pre>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="n">VideoMatcher</span><span class="p">,</span> <span class="n">VideoMatchMethod</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="n">matcher</span> <span class="o">=</span> <span class="n">VideoMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">AUTO</span><span class="p">)</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="n">result</span> <span class="o">=</span> <span class="n">base_labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">new_labels</span><span class="p">,</span> <span class="n">video_matcher</span><span class="o">=</span><span class="n">matcher</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Exact path matching with optional strict mode:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># Strict: paths must be identical</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">strict_matcher</span> <span class="o">=</span> <span class="n">VideoMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">PATH</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="c1"># Lenient: normalizes paths before comparison</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="n">lenient_matcher</span> <span class="o">=</span> <span class="n">VideoMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">PATH</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Matches by filename only, ignoring directories:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="n">BASENAME_VIDEO_MATCHER</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="c1"># Matches &quot;video.mp4&quot; regardless of path</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="n">result</span> <span class="o">=</span> <span class="n">base_labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">new_labels</span><span class="p">,</span> <span class="n">video_matcher</span><span class="o">=</span><span class="n">BASENAME_VIDEO_MATCHER</span><span class="p">)</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Perfect for cross-platform collaboration where the same files exist in different locations.</p>
</div>
</div>
<div class="tabbed-block">
<p>Matches videos by shape and backend type:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># Useful when files are renamed but content is identical</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">content_matcher</span> <span class="o">=</span> <span class="n">VideoMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">CONTENT</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>For image sequences, removes duplicate images:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="n">IMAGE_DEDUP_VIDEO_MATCHER</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="c1"># Automatically deduplicates overlapping images</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="n">result</span> <span class="o">=</span> <span class="n">labels1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">labels2</span><span class="p">,</span> <span class="n">video_matcher</span><span class="o">=</span><span class="n">IMAGE_DEDUP_VIDEO_MATCHER</span><span class="p">)</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only works with <code>ImageVideo</code> backends (image sequences from COCO/CVAT exports).</p>
</div>
</div>
</div>
</div>
<h3 id="instance-matching">Instance matching<a class="headerlink" href="#instance-matching" title="Permanent link">&para;</a></h3>
<p>Determines when two instances represent the same annotation.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:3"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Spatial (default)</label><label for="__tabbed_2_2">Identity</label><label for="__tabbed_2_3">IoU</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Matches instances by Euclidean distance between corresponding points:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="n">InstanceMatcher</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="c1"># Threshold is maximum pixel distance</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="n">matcher</span> <span class="o">=</span> <span class="n">InstanceMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;spatial&quot;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">How it works</p>
<p>Computes average distance between visible points. Instances match if distance &lt; threshold.</p>
</div>
</div>
<div class="tabbed-block">
<p>Matches instances by track identity:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># Only matches if instances belong to the same track</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">matcher</span> <span class="o">=</span> <span class="n">InstanceMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;identity&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Matches by bounding box overlap:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># Threshold is minimum Intersection over Union</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="n">matcher</span> <span class="o">=</span> <span class="n">InstanceMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;iou&quot;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="skeleton-matching">Skeleton matching<a class="headerlink" href="#skeleton-matching" title="Permanent link">&para;</a></h3>
<p>Controls how skeletons are matched and mapped between datasets.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:4"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><input id="__tabbed_3_3" name="__tabbed_3" type="radio" /><input id="__tabbed_3_4" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Structure (default)</label><label for="__tabbed_3_2">Exact</label><label for="__tabbed_3_3">Overlap</label><label for="__tabbed_3_4">Subset</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Same nodes and edges, order doesn't matter:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="n">STRUCTURE_SKELETON_MATCHER</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="n">result</span> <span class="o">=</span> <span class="n">base_labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">new_labels</span><span class="p">,</span> <span class="n">skeleton_matcher</span><span class="o">=</span><span class="n">STRUCTURE_SKELETON_MATCHER</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Nodes must be identical and in the same order:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">matcher</span> <span class="o">=</span> <span class="n">SkeletonMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;exact&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Partial match based on Jaccard similarity:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1"># Requires 70% node overlap</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="n">matcher</span> <span class="o">=</span> <span class="n">SkeletonMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;overlap&quot;</span><span class="p">,</span> <span class="n">min_overlap</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>One skeleton's nodes must be a subset of the other:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="n">SUBSET_SKELETON_MATCHER</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="c1"># Useful for adding nodes to existing skeletons</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="n">result</span> <span class="o">=</span> <span class="n">base_labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">new_labels</span><span class="p">,</span> <span class="n">skeleton_matcher</span><span class="o">=</span><span class="n">SUBSET_SKELETON_MATCHER</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="common-workflows">Common workflows<a class="headerlink" href="#common-workflows" title="Permanent link">&para;</a></h2>
<h3 id="human-in-the-loop-hitl-training">Human-in-the-loop (HITL) training<a class="headerlink" href="#human-in-the-loop-hitl-training" title="Permanent link">&para;</a></h3>
<p>The most common workflow: merging model predictions back into your training data.</p>
<div class="highlight"><span class="filename">HITL workflow</span><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><a href="#__codelineno-19-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">sleap_io</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sio</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a><a href="#__codelineno-19-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><a href="#__codelineno-19-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="c1"># Load manual annotations and predictions</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a><a href="#__codelineno-19-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="n">manual_labels</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;manual_annotations.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a><a href="#__codelineno-19-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="n">predictions</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;predictions.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-19-6" name="__codelineno-19-6"></a><a href="#__codelineno-19-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="hll"><a href="#__codelineno-19-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="c1"># Merge with smart strategy (default)</span>
</span><a id="__codelineno-19-8" name="__codelineno-19-8"></a><span class="hll"><a href="#__codelineno-19-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="c1"># This preserves all manual labels while adding predictions</span>
</span><a id="__codelineno-19-9" name="__codelineno-19-9"></a><span class="hll"><a href="#__codelineno-19-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="n">result</span> <span class="o">=</span> <span class="n">manual_labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><a id="__codelineno-19-10" name="__codelineno-19-10"></a><span class="hll"><a href="#__codelineno-19-10"><span class="linenos" data-linenos="10 "></span></a>
</span><a id="__codelineno-19-11" name="__codelineno-19-11"></a><a href="#__codelineno-19-11"><span class="linenos" data-linenos="11 "></span></a><span class="c1"># Review what was merged</span>
<a id="__codelineno-19-12" name="__codelineno-19-12"></a><a href="#__codelineno-19-12"><span class="linenos" data-linenos="12 "></span></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Frames merged: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">frames_merged</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-19-13" name="__codelineno-19-13"></a><a href="#__codelineno-19-13"><span class="linenos" data-linenos="13 "></span></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New instances: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">instances_added</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-19-14" name="__codelineno-19-14"></a><a href="#__codelineno-19-14"><span class="linenos" data-linenos="14 "></span></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Conflicts resolved: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">conflicts</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-19-15" name="__codelineno-19-15"></a><a href="#__codelineno-19-15"><span class="linenos" data-linenos="15 "></span></a>
<a id="__codelineno-19-16" name="__codelineno-19-16"></a><a href="#__codelineno-19-16"><span class="linenos" data-linenos="16 "></span></a><span class="c1"># Check for any errors</span>
<a id="__codelineno-19-17" name="__codelineno-19-17"></a><a href="#__codelineno-19-17"><span class="linenos" data-linenos="17 "></span></a><span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
<a id="__codelineno-19-18" name="__codelineno-19-18"></a><a href="#__codelineno-19-18"><span class="linenos" data-linenos="18 "></span></a>    <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
<a id="__codelineno-19-19" name="__codelineno-19-19"></a><a href="#__codelineno-19-19"><span class="linenos" data-linenos="19 "></span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">error</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-19-20" name="__codelineno-19-20"></a><a href="#__codelineno-19-20"><span class="linenos" data-linenos="20 "></span></a>
<a id="__codelineno-19-21" name="__codelineno-19-21"></a><a href="#__codelineno-19-21"><span class="linenos" data-linenos="21 "></span></a><span class="c1"># Save the updated project</span>
<a id="__codelineno-19-22" name="__codelineno-19-22"></a><a href="#__codelineno-19-22"><span class="linenos" data-linenos="22 "></span></a><span class="n">manual_labels</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;updated_project.slp&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="cross-platform-collaboration">Cross-platform collaboration<a class="headerlink" href="#cross-platform-collaboration" title="Permanent link">&para;</a></h3>
<p>When working across different operating systems or file structures:</p>
<div class="admonition example">
<p class="admonition-title">Scenario: Windows and Linux collaboration</p>
<p>Your team uses different operating systems with different file paths:</p>
<ul>
<li>Windows: <code>C:\research\videos\session_001.mp4</code></li>
<li>Linux: <code>/home/lab/data/videos/session_001.mp4</code></li>
</ul>
</div>
<div class="highlight"><span class="filename">Cross-platform merging</span><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><a href="#__codelineno-20-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="n">BASENAME_VIDEO_MATCHER</span>
<a id="__codelineno-20-2" name="__codelineno-20-2"></a><a href="#__codelineno-20-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-20-3" name="__codelineno-20-3"></a><a href="#__codelineno-20-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="c1"># Load annotations from different systems</span>
<a id="__codelineno-20-4" name="__codelineno-20-4"></a><a href="#__codelineno-20-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="n">windows_annotations</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;windows_annotations.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-20-5" name="__codelineno-20-5"></a><a href="#__codelineno-20-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="n">linux_predictions</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;linux_predictions.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-20-6" name="__codelineno-20-6"></a><a href="#__codelineno-20-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-20-7" name="__codelineno-20-7"></a><a href="#__codelineno-20-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="c1"># Use basename matching to ignore path differences</span>
<a id="__codelineno-20-8" name="__codelineno-20-8"></a><a href="#__codelineno-20-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="n">result</span> <span class="o">=</span> <span class="n">windows_annotations</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
<a id="__codelineno-20-9" name="__codelineno-20-9"></a><a href="#__codelineno-20-9"><span class="linenos" data-linenos=" 9 "></span></a>    <span class="n">linux_predictions</span><span class="p">,</span>
<a id="__codelineno-20-10" name="__codelineno-20-10"></a><a href="#__codelineno-20-10"><span class="linenos" data-linenos="10 "></span></a>    <span class="n">video_matcher</span><span class="o">=</span><span class="n">BASENAME_VIDEO_MATCHER</span>  <span class="c1"># Matches by filename only</span>
<a id="__codelineno-20-11" name="__codelineno-20-11"></a><a href="#__codelineno-20-11"><span class="linenos" data-linenos="11 "></span></a><span class="p">)</span>
<a id="__codelineno-20-12" name="__codelineno-20-12"></a><a href="#__codelineno-20-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-20-13" name="__codelineno-20-13"></a><a href="#__codelineno-20-13"><span class="linenos" data-linenos="13 "></span></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully matched </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">videos_merged</span><span class="p">)</span><span class="si">}</span><span class="s2"> videos across platforms&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="combining-multiple-annotators">Combining multiple annotators<a class="headerlink" href="#combining-multiple-annotators" title="Permanent link">&para;</a></h3>
<p>Merge annotations from different team members:</p>
<div class="highlight"><span class="filename">Multi-annotator workflow</span><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><a href="#__codelineno-21-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="c1"># Load annotations from multiple sources</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a><a href="#__codelineno-21-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="n">annotator1</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;annotator1.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-21-3" name="__codelineno-21-3"></a><a href="#__codelineno-21-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="n">annotator2</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;annotator2.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-21-4" name="__codelineno-21-4"></a><a href="#__codelineno-21-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="n">annotator3</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;annotator3.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-21-5" name="__codelineno-21-5"></a><a href="#__codelineno-21-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-21-6" name="__codelineno-21-6"></a><a href="#__codelineno-21-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="c1"># Start with first annotator</span>
<a id="__codelineno-21-7" name="__codelineno-21-7"></a><a href="#__codelineno-21-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="n">merged</span> <span class="o">=</span> <span class="n">annotator1</span>
<a id="__codelineno-21-8" name="__codelineno-21-8"></a><a href="#__codelineno-21-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-21-9" name="__codelineno-21-9"></a><a href="#__codelineno-21-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="c1"># Merge others, keeping all annotations for review</span>
<a id="__codelineno-21-10" name="__codelineno-21-10"></a><span class="hll"><a href="#__codelineno-21-10"><span class="linenos" data-linenos="10 "></span></a><span class="k">for</span> <span class="n">labels</span> <span class="ow">in</span> <span class="p">[</span><span class="n">annotator2</span><span class="p">,</span> <span class="n">annotator3</span><span class="p">]:</span>
</span><a id="__codelineno-21-11" name="__codelineno-21-11"></a><span class="hll"><a href="#__codelineno-21-11"><span class="linenos" data-linenos="11 "></span></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">frame_strategy</span><span class="o">=</span><span class="s2">&quot;keep_both&quot;</span><span class="p">)</span>
</span><a id="__codelineno-21-12" name="__codelineno-21-12"></a><a href="#__codelineno-21-12"><span class="linenos" data-linenos="12 "></span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">instances_added</span><span class="si">}</span><span class="s2"> instances from </span><span class="si">{</span><span class="n">labels</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-21-13" name="__codelineno-21-13"></a><a href="#__codelineno-21-13"><span class="linenos" data-linenos="13 "></span></a>
<a id="__codelineno-21-14" name="__codelineno-21-14"></a><a href="#__codelineno-21-14"><span class="linenos" data-linenos="14 "></span></a><span class="c1"># Review overlapping annotations</span>
<a id="__codelineno-21-15" name="__codelineno-21-15"></a><a href="#__codelineno-21-15"><span class="linenos" data-linenos="15 "></span></a><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">merged</span><span class="p">:</span>
<a id="__codelineno-21-16" name="__codelineno-21-16"></a><a href="#__codelineno-21-16"><span class="linenos" data-linenos="16 "></span></a>    <span class="n">instances</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">instances</span>
<a id="__codelineno-21-17" name="__codelineno-21-17"></a><a href="#__codelineno-21-17"><span class="linenos" data-linenos="17 "></span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">expected_count</span><span class="p">:</span>
<a id="__codelineno-21-18" name="__codelineno-21-18"></a><a href="#__codelineno-21-18"><span class="linenos" data-linenos="18 "></span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Frame </span><span class="si">{</span><span class="n">frame</span><span class="o">.</span><span class="n">frame_idx</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span><span class="si">}</span><span class="s2"> instances (review needed)&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="updating-predictions">Updating predictions<a class="headerlink" href="#updating-predictions" title="Permanent link">&para;</a></h3>
<p>Replace old predictions with improved ones:</p>
<div class="highlight"><span class="filename">Updating predictions</span><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><a href="#__codelineno-22-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="c1"># Load existing project</span>
<a id="__codelineno-22-2" name="__codelineno-22-2"></a><a href="#__codelineno-22-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="n">project</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;project_with_old_predictions.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-22-3" name="__codelineno-22-3"></a><a href="#__codelineno-22-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-22-4" name="__codelineno-22-4"></a><a href="#__codelineno-22-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="c1"># Load new predictions from improved model</span>
<a id="__codelineno-22-5" name="__codelineno-22-5"></a><a href="#__codelineno-22-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="n">new_predictions</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;better_model_predictions.slp&quot;</span><span class="p">)</span>
<a id="__codelineno-22-6" name="__codelineno-22-6"></a><a href="#__codelineno-22-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-22-7" name="__codelineno-22-7"></a><a href="#__codelineno-22-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="c1"># Configure matching to be more lenient for predictions</span>
<a id="__codelineno-22-8" name="__codelineno-22-8"></a><a href="#__codelineno-22-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="n">InstanceMatcher</span>
<a id="__codelineno-22-9" name="__codelineno-22-9"></a><a href="#__codelineno-22-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-22-10" name="__codelineno-22-10"></a><a href="#__codelineno-22-10"><span class="linenos" data-linenos="10 "></span></a><span class="n">instance_matcher</span> <span class="o">=</span> <span class="n">InstanceMatcher</span><span class="p">(</span>
<a id="__codelineno-22-11" name="__codelineno-22-11"></a><a href="#__codelineno-22-11"><span class="linenos" data-linenos="11 "></span></a>    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;spatial&quot;</span><span class="p">,</span>
<a id="__codelineno-22-12" name="__codelineno-22-12"></a><span class="hll"><a href="#__codelineno-22-12"><span class="linenos" data-linenos="12 "></span></a>    <span class="n">threshold</span><span class="o">=</span><span class="mf">10.0</span>  <span class="c1"># More lenient for predictions</span>
</span><a id="__codelineno-22-13" name="__codelineno-22-13"></a><span class="hll"><a href="#__codelineno-22-13"><span class="linenos" data-linenos="13 "></span></a><span class="p">)</span>
</span><a id="__codelineno-22-14" name="__codelineno-22-14"></a><a href="#__codelineno-22-14"><span class="linenos" data-linenos="14 "></span></a>
<a id="__codelineno-22-15" name="__codelineno-22-15"></a><a href="#__codelineno-22-15"><span class="linenos" data-linenos="15 "></span></a><span class="c1"># Merge with smart strategy to preserve manual labels</span>
<a id="__codelineno-22-16" name="__codelineno-22-16"></a><a href="#__codelineno-22-16"><span class="linenos" data-linenos="16 "></span></a><span class="n">result</span> <span class="o">=</span> <span class="n">project</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
<a id="__codelineno-22-17" name="__codelineno-22-17"></a><a href="#__codelineno-22-17"><span class="linenos" data-linenos="17 "></span></a>    <span class="n">new_predictions</span><span class="p">,</span>
<a id="__codelineno-22-18" name="__codelineno-22-18"></a><a href="#__codelineno-22-18"><span class="linenos" data-linenos="18 "></span></a>    <span class="n">frame_strategy</span><span class="o">=</span><span class="s2">&quot;smart&quot;</span><span class="p">,</span>
<a id="__codelineno-22-19" name="__codelineno-22-19"></a><a href="#__codelineno-22-19"><span class="linenos" data-linenos="19 "></span></a>    <span class="n">instance_matcher</span><span class="o">=</span><span class="n">instance_matcher</span>
<a id="__codelineno-22-20" name="__codelineno-22-20"></a><a href="#__codelineno-22-20"><span class="linenos" data-linenos="20 "></span></a><span class="p">)</span>
<a id="__codelineno-22-21" name="__codelineno-22-21"></a><a href="#__codelineno-22-21"><span class="linenos" data-linenos="21 "></span></a>
<a id="__codelineno-22-22" name="__codelineno-22-22"></a><a href="#__codelineno-22-22"><span class="linenos" data-linenos="22 "></span></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updated </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">frames_merged</span><span class="si">}</span><span class="s2"> frames with new predictions&quot;</span><span class="p">)</span>
<a id="__codelineno-22-23" name="__codelineno-22-23"></a><a href="#__codelineno-22-23"><span class="linenos" data-linenos="23 "></span></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Preserved </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">project</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="n">instances</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;Instance&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> manual labels&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="advanced-topics">Advanced topics<a class="headerlink" href="#advanced-topics" title="Permanent link">&para;</a></h2>
<h3 id="image-sequence-deduplication">Image sequence deduplication<a class="headerlink" href="#image-sequence-deduplication" title="Permanent link">&para;</a></h3>
<p>When working with COCO or CVAT exports that contain overlapping images:</p>
<details class="info">
<summary>Background</summary>
<p>CVAT and COCO exports often use image sequences (ImageVideo) rather than video files. When merging multiple exports, you may have duplicate images that need to be handled intelligently.</p>
</details>
<div class="highlight"><span class="filename">Deduplicating image sequences</span><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><a href="#__codelineno-23-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="n">IMAGE_DEDUP_VIDEO_MATCHER</span><span class="p">,</span> <span class="n">SHAPE_VIDEO_MATCHER</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a><a href="#__codelineno-23-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-23-3" name="__codelineno-23-3"></a><a href="#__codelineno-23-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="c1"># Load CVAT exports with potential overlaps</span>
<a id="__codelineno-23-4" name="__codelineno-23-4"></a><a href="#__codelineno-23-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="n">batch1</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;cvat_batch1.json&quot;</span><span class="p">)</span>  <span class="c1"># 1000 images</span>
<a id="__codelineno-23-5" name="__codelineno-23-5"></a><a href="#__codelineno-23-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="n">batch2</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;cvat_batch2.json&quot;</span><span class="p">)</span>  <span class="c1"># 1000 images, 22 overlapping</span>
<a id="__codelineno-23-6" name="__codelineno-23-6"></a><a href="#__codelineno-23-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-23-7" name="__codelineno-23-7"></a><a href="#__codelineno-23-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="c1"># Option 1: Remove duplicates, keep videos separate</span>
<a id="__codelineno-23-8" name="__codelineno-23-8"></a><a href="#__codelineno-23-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="n">result</span> <span class="o">=</span> <span class="n">batch1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">batch2</span><span class="p">,</span> <span class="n">video_matcher</span><span class="o">=</span><span class="n">IMAGE_DEDUP_VIDEO_MATCHER</span><span class="p">)</span>
<a id="__codelineno-23-9" name="__codelineno-23-9"></a><a href="#__codelineno-23-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Result: </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">batch1</span><span class="o">.</span><span class="n">videos</span><span class="p">)</span><span class="si">}</span><span class="s2"> unique images&quot;</span><span class="p">)</span>
<a id="__codelineno-23-10" name="__codelineno-23-10"></a><a href="#__codelineno-23-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-23-11" name="__codelineno-23-11"></a><a href="#__codelineno-23-11"><span class="linenos" data-linenos="11 "></span></a><span class="c1"># Option 2: Merge same-shaped videos into one</span>
<a id="__codelineno-23-12" name="__codelineno-23-12"></a><a href="#__codelineno-23-12"><span class="linenos" data-linenos="12 "></span></a><span class="n">result</span> <span class="o">=</span> <span class="n">batch1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">batch2</span><span class="p">,</span> <span class="n">video_matcher</span><span class="o">=</span><span class="n">SHAPE_VIDEO_MATCHER</span><span class="p">)</span>
<a id="__codelineno-23-13" name="__codelineno-23-13"></a><a href="#__codelineno-23-13"><span class="linenos" data-linenos="13 "></span></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Result: Single video with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">batch1</span><span class="o">.</span><span class="n">videos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span><span class="si">}</span><span class="s2"> images&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="frame-level-merging">Frame-level merging<a class="headerlink" href="#frame-level-merging" title="Permanent link">&para;</a></h3>
<p>For fine-grained control over individual frames:</p>
<div class="highlight"><span class="filename">Frame-level merge control</span><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><a href="#__codelineno-24-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="n">InstanceMatcher</span>
<a id="__codelineno-24-2" name="__codelineno-24-2"></a><a href="#__codelineno-24-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a><a href="#__codelineno-24-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="c1"># Get specific frames</span>
<a id="__codelineno-24-4" name="__codelineno-24-4"></a><a href="#__codelineno-24-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="n">frame1</span> <span class="o">=</span> <span class="n">base_labels</span><span class="o">.</span><span class="n">labeled_frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-24-5" name="__codelineno-24-5"></a><a href="#__codelineno-24-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="n">frame2</span> <span class="o">=</span> <span class="n">new_labels</span><span class="o">.</span><span class="n">labeled_frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-24-6" name="__codelineno-24-6"></a><a href="#__codelineno-24-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-24-7" name="__codelineno-24-7"></a><a href="#__codelineno-24-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="c1"># Configure matching</span>
<a id="__codelineno-24-8" name="__codelineno-24-8"></a><a href="#__codelineno-24-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="n">matcher</span> <span class="o">=</span> <span class="n">InstanceMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;spatial&quot;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<a id="__codelineno-24-9" name="__codelineno-24-9"></a><a href="#__codelineno-24-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-24-10" name="__codelineno-24-10"></a><a href="#__codelineno-24-10"><span class="linenos" data-linenos="10 "></span></a><span class="c1"># Merge at frame level</span>
<a id="__codelineno-24-11" name="__codelineno-24-11"></a><a href="#__codelineno-24-11"><span class="linenos" data-linenos="11 "></span></a><span class="n">merged_instances</span><span class="p">,</span> <span class="n">conflicts</span> <span class="o">=</span> <span class="n">frame1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
<a id="__codelineno-24-12" name="__codelineno-24-12"></a><a href="#__codelineno-24-12"><span class="linenos" data-linenos="12 "></span></a>    <span class="n">frame2</span><span class="p">,</span>
<a id="__codelineno-24-13" name="__codelineno-24-13"></a><a href="#__codelineno-24-13"><span class="linenos" data-linenos="13 "></span></a>    <span class="n">instance_matcher</span><span class="o">=</span><span class="n">matcher</span><span class="p">,</span>
<a id="__codelineno-24-14" name="__codelineno-24-14"></a><a href="#__codelineno-24-14"><span class="linenos" data-linenos="14 "></span></a>    <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;smart&quot;</span>
<a id="__codelineno-24-15" name="__codelineno-24-15"></a><a href="#__codelineno-24-15"><span class="linenos" data-linenos="15 "></span></a><span class="p">)</span>
<a id="__codelineno-24-16" name="__codelineno-24-16"></a><a href="#__codelineno-24-16"><span class="linenos" data-linenos="16 "></span></a>
<a id="__codelineno-24-17" name="__codelineno-24-17"></a><a href="#__codelineno-24-17"><span class="linenos" data-linenos="17 "></span></a><span class="c1"># Apply merged instances</span>
<a id="__codelineno-24-18" name="__codelineno-24-18"></a><a href="#__codelineno-24-18"><span class="linenos" data-linenos="18 "></span></a><span class="n">frame1</span><span class="o">.</span><span class="n">instances</span> <span class="o">=</span> <span class="n">merged_instances</span>
<a id="__codelineno-24-19" name="__codelineno-24-19"></a><a href="#__codelineno-24-19"><span class="linenos" data-linenos="19 "></span></a>
<a id="__codelineno-24-20" name="__codelineno-24-20"></a><a href="#__codelineno-24-20"><span class="linenos" data-linenos="20 "></span></a><span class="c1"># Review conflicts</span>
<a id="__codelineno-24-21" name="__codelineno-24-21"></a><a href="#__codelineno-24-21"><span class="linenos" data-linenos="21 "></span></a><span class="k">for</span> <span class="n">original</span><span class="p">,</span> <span class="n">new</span><span class="p">,</span> <span class="n">resolution</span> <span class="ow">in</span> <span class="n">conflicts</span><span class="p">:</span>
<a id="__codelineno-24-22" name="__codelineno-24-22"></a><a href="#__codelineno-24-22"><span class="linenos" data-linenos="22 "></span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Conflict resolved: </span><span class="si">{</span><span class="n">resolution</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="error-handling">Error handling<a class="headerlink" href="#error-handling" title="Permanent link">&para;</a></h3>
<p>Configure how merge errors are handled:</p>
<div class="highlight"><span class="filename">Error handling strategies</span><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><a href="#__codelineno-25-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="c1"># Strict mode: Stop on first error</span>
<a id="__codelineno-25-2" name="__codelineno-25-2"></a><a href="#__codelineno-25-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-25-3" name="__codelineno-25-3"></a><a href="#__codelineno-25-3"><span class="linenos" data-linenos=" 3 "></span></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">error_mode</span><span class="o">=</span><span class="s2">&quot;strict&quot;</span><span class="p">)</span>
<a id="__codelineno-25-4" name="__codelineno-25-4"></a><a href="#__codelineno-25-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-25-5" name="__codelineno-25-5"></a><a href="#__codelineno-25-5"><span class="linenos" data-linenos=" 5 "></span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Merge failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-25-6" name="__codelineno-25-6"></a><a href="#__codelineno-25-6"><span class="linenos" data-linenos=" 6 "></span></a>    <span class="c1"># Handle error...</span>
<a id="__codelineno-25-7" name="__codelineno-25-7"></a><a href="#__codelineno-25-7"><span class="linenos" data-linenos=" 7 "></span></a>
<a id="__codelineno-25-8" name="__codelineno-25-8"></a><a href="#__codelineno-25-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="c1"># Continue mode: Collect errors but continue (default)</span>
<a id="__codelineno-25-9" name="__codelineno-25-9"></a><a href="#__codelineno-25-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="n">result</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">error_mode</span><span class="o">=</span><span class="s2">&quot;continue&quot;</span><span class="p">)</span>
<a id="__codelineno-25-10" name="__codelineno-25-10"></a><a href="#__codelineno-25-10"><span class="linenos" data-linenos="10 "></span></a><span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
<a id="__codelineno-25-11" name="__codelineno-25-11"></a><a href="#__codelineno-25-11"><span class="linenos" data-linenos="11 "></span></a>    <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
<a id="__codelineno-25-12" name="__codelineno-25-12"></a><a href="#__codelineno-25-12"><span class="linenos" data-linenos="12 "></span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">error</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-25-13" name="__codelineno-25-13"></a><a href="#__codelineno-25-13"><span class="linenos" data-linenos="13 "></span></a>
<a id="__codelineno-25-14" name="__codelineno-25-14"></a><a href="#__codelineno-25-14"><span class="linenos" data-linenos="14 "></span></a><span class="c1"># Warning mode: Print warnings but continue</span>
<a id="__codelineno-25-15" name="__codelineno-25-15"></a><a href="#__codelineno-25-15"><span class="linenos" data-linenos="15 "></span></a><span class="n">result</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">error_mode</span><span class="o">=</span><span class="s2">&quot;warn&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="provenance-tracking">Provenance tracking<a class="headerlink" href="#provenance-tracking" title="Permanent link">&para;</a></h3>
<p>All merge operations are automatically tracked:</p>
<div class="highlight"><span class="filename">Accessing merge history</span><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><a href="#__codelineno-26-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="c1"># After merging</span>
<a id="__codelineno-26-2" name="__codelineno-26-2"></a><a href="#__codelineno-26-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="n">result</span> <span class="o">=</span> <span class="n">base_labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">new_labels</span><span class="p">)</span>
<a id="__codelineno-26-3" name="__codelineno-26-3"></a><a href="#__codelineno-26-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-26-4" name="__codelineno-26-4"></a><a href="#__codelineno-26-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="c1"># Check merge history</span>
<a id="__codelineno-26-5" name="__codelineno-26-5"></a><a href="#__codelineno-26-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="n">merge_history</span> <span class="o">=</span> <span class="n">base_labels</span><span class="o">.</span><span class="n">provenance</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;merge_history&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-26-6" name="__codelineno-26-6"></a><a href="#__codelineno-26-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-26-7" name="__codelineno-26-7"></a><a href="#__codelineno-26-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="k">for</span> <span class="n">merge</span> <span class="ow">in</span> <span class="n">merge_history</span><span class="p">:</span>
<a id="__codelineno-26-8" name="__codelineno-26-8"></a><a href="#__codelineno-26-8"><span class="linenos" data-linenos=" 8 "></span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Merged at: </span><span class="si">{</span><span class="n">merge</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-26-9" name="__codelineno-26-9"></a><a href="#__codelineno-26-9"><span class="linenos" data-linenos=" 9 "></span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Source: </span><span class="si">{</span><span class="n">merge</span><span class="p">[</span><span class="s1">&#39;source_labels&#39;</span><span class="p">][</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-26-10" name="__codelineno-26-10"></a><a href="#__codelineno-26-10"><span class="linenos" data-linenos="10 "></span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Frames merged: </span><span class="si">{</span><span class="n">merge</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">][</span><span class="s1">&#39;frames_merged&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-26-11" name="__codelineno-26-11"></a><a href="#__codelineno-26-11"><span class="linenos" data-linenos="11 "></span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Instances added: </span><span class="si">{</span><span class="n">merge</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">][</span><span class="s1">&#39;instances_added&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h2>
<p>Common issues and solutions when merging datasets.</p>
<details class="failure">
<summary>No frames merged</summary>
<p><strong>Symptom:</strong> <code>result.frames_merged == 0</code></p>
<p><strong>Possible causes and solutions:</strong></p>
<ol>
<li>
<p><strong>Videos don't match</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c1"># Try different video matching strategies</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="n">result</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">video_matcher</span><span class="o">=</span><span class="n">BASENAME_VIDEO_MATCHER</span><span class="p">)</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="c1"># or</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="n">result</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">video_matcher</span><span class="o">=</span><span class="n">AUTO_VIDEO_MATCHER</span><span class="p">)</span>
</code></pre></div></p>
</li>
<li>
<p><strong>Frame indices don't align</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c1"># Check frame indices</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Base frames: </span><span class="si">{</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">frame_idx</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">base_labels</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New frames: </span><span class="si">{</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">frame_idx</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">new_labels</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></p>
</li>
<li>
<p><strong>Skeleton mismatch</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="c1"># Validate and use lenient matching</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="n">result</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>    <span class="n">other</span><span class="p">,</span>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>    <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>    <span class="n">skeleton_matcher</span><span class="o">=</span><span class="n">OVERLAP_SKELETON_MATCHER</span>
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="p">)</span>
</code></pre></div></p>
</li>
</ol>
</details>
<details class="failure">
<summary>Manual annotations lost</summary>
<p><strong>Symptom:</strong> User labels disappear after merging</p>
<p><strong>Solution:</strong> Ensure you're using the <code>smart</code> strategy (default):
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c1"># Explicitly set smart strategy</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="n">result</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">frame_strategy</span><span class="o">=</span><span class="s2">&quot;smart&quot;</span><span class="p">)</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="c1"># Verify manual labels are preserved</span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="n">manual_count_before</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">labels</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">instances</span> 
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>                         <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;Instance&#39;</span><span class="p">)</span>
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="n">result</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="n">manual_count_after</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">labels</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">instances</span> 
<a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>                        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;Instance&#39;</span><span class="p">)</span>
<a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="k">assert</span> <span class="n">manual_count_after</span> <span class="o">&gt;=</span> <span class="n">manual_count_before</span>
</code></pre></div></p>
</details>
<details class="failure">
<summary>Duplicate instances</summary>
<p><strong>Symptom:</strong> Multiple instances at the same location</p>
<p><strong>Solutions:</strong></p>
<ol>
<li>
<p><strong>Tighten spatial matching</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="n">matcher</span> <span class="o">=</span> <span class="n">InstanceMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;spatial&quot;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>  <span class="c1"># Stricter</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="n">result</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">instance_matcher</span><span class="o">=</span><span class="n">matcher</span><span class="p">)</span>
</code></pre></div></p>
</li>
<li>
<p><strong>Use identity matching for tracked data</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="n">matcher</span> <span class="o">=</span> <span class="n">InstanceMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;identity&quot;</span><span class="p">)</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="n">result</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">instance_matcher</span><span class="o">=</span><span class="n">matcher</span><span class="p">)</span>
</code></pre></div></p>
</li>
<li>
<p><strong>Post-process to remove duplicates</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.instance</span><span class="w"> </span><span class="kn">import</span> <span class="n">PredictedInstance</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>    <span class="c1"># Remove duplicate predictions within threshold</span>
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>    <span class="n">cleaned</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>    <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">instances</span><span class="p">:</span>
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>        <span class="n">is_duplicate</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>        <span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="n">cleaned</span><span class="p">:</span>
<a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>            <span class="k">if</span> <span class="n">inst</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
<a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a>                <span class="n">is_duplicate</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a>                <span class="k">break</span>
<a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_duplicate</span><span class="p">:</span>
<a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a>            <span class="n">cleaned</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>
<a id="__codelineno-33-14" name="__codelineno-33-14" href="#__codelineno-33-14"></a>    <span class="n">frame</span><span class="o">.</span><span class="n">instances</span> <span class="o">=</span> <span class="n">cleaned</span>
</code></pre></div></p>
</li>
</ol>
</details>
<details class="failure">
<summary>Memory issues with large datasets</summary>
<p><strong>Symptom:</strong> Out of memory errors during merge</p>
<p><strong>Solutions:</strong></p>
<ol>
<li>
<p><strong>Process in batches</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="c1"># Split by video</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="k">for</span> <span class="n">video</span> <span class="ow">in</span> <span class="n">new_labels</span><span class="o">.</span><span class="n">videos</span><span class="p">:</span>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>    <span class="n">video_labels</span> <span class="o">=</span> <span class="n">new_labels</span><span class="o">.</span><span class="n">extract_video</span><span class="p">(</span><span class="n">video</span><span class="p">)</span>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">base_labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">video_labels</span><span class="p">)</span>
</code></pre></div></p>
</li>
<li>
<p><strong>Use progress callback to monitor</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">progress</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">current</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>    <span class="c1"># Add memory monitoring here if needed</span>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="n">result</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">progress_callback</span><span class="o">=</span><span class="n">progress</span><span class="p">)</span>
</code></pre></div></p>
</li>
</ol>
</details>
<h2 id="api-reference">API reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h2>
<h3 id="labels-merge-method">Labels merge method<a class="headerlink" href="#labels-merge-method" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">


<h4 id="sleap_io.model.labels.Labels.merge" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sleap_io</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">Labels</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">instance_matcher</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">skeleton_matcher</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">video_matcher</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">track_matcher</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frame_strategy</span><span class="o">=</span><span class="s1">&#39;smart&#39;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">error_mode</span><span class="o">=</span><span class="s1">&#39;continue&#39;</span><span class="p">)</span></code>

<a href="#sleap_io.model.labels.Labels.merge" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">

        <p>Merge another Labels object into this one.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code>&#39;Labels&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Another Labels object to merge into this one.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>instance_matcher</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[&#39;InstanceMatcher&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matcher for comparing instances. If None, uses default
spatial matching with 5px tolerance.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>skeleton_matcher</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[&#39;SkeletonMatcher&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matcher for comparing skeletons. If None, uses structure
matching.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>video_matcher</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[&#39;VideoMatcher&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matcher for comparing videos. If None, uses auto matching.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>track_matcher</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[&#39;TrackMatcher&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matcher for comparing tracks. If None, uses name matching.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>frame_strategy</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Strategy for merging frames:
- "smart": Keep user labels, update predictions
- "keep_original": Keep original frames
- "keep_new": Replace with new frames
- "keep_both": Keep all frames
- "update_tracks": Update track and score of the original instances
    from the new instances.</p>
              </div>
            </td>
            <td>
                  <code>&#39;smart&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>validate</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, validate for conflicts before merging.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>progress_callback</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional callback for progress updates.
Should accept (current, total, message) arguments.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>error_mode</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How to handle errors:
- "continue": Log errors but continue
- "strict": Raise exception on first error
- "warn": Print warnings but continue</p>
              </div>
            </td>
            <td>
                  <code>&#39;continue&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>&#39;MergeResult&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>MergeResult object with statistics and any errors/conflicts.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>This method modifies the Labels object in place. The merge is designed to
handle common workflows like merging predictions back into a project.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>sleap_io/model/labels.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1670" name="__codelineno-0-1670"></a><a href="#__codelineno-0-1670"><span class="linenos" data-linenos="1670 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span>
<a id="__codelineno-0-1671" name="__codelineno-0-1671"></a><a href="#__codelineno-0-1671"><span class="linenos" data-linenos="1671 "></span></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1672" name="__codelineno-0-1672"></a><a href="#__codelineno-0-1672"><span class="linenos" data-linenos="1672 "></span></a>    <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Labels&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1673" name="__codelineno-0-1673"></a><a href="#__codelineno-0-1673"><span class="linenos" data-linenos="1673 "></span></a>    <span class="n">instance_matcher</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;InstanceMatcher&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1674" name="__codelineno-0-1674"></a><a href="#__codelineno-0-1674"><span class="linenos" data-linenos="1674 "></span></a>    <span class="n">skeleton_matcher</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;SkeletonMatcher&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1675" name="__codelineno-0-1675"></a><a href="#__codelineno-0-1675"><span class="linenos" data-linenos="1675 "></span></a>    <span class="n">video_matcher</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;VideoMatcher&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1676" name="__codelineno-0-1676"></a><a href="#__codelineno-0-1676"><span class="linenos" data-linenos="1676 "></span></a>    <span class="n">track_matcher</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;TrackMatcher&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1677" name="__codelineno-0-1677"></a><a href="#__codelineno-0-1677"><span class="linenos" data-linenos="1677 "></span></a>    <span class="n">frame_strategy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;smart&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1678" name="__codelineno-0-1678"></a><a href="#__codelineno-0-1678"><span class="linenos" data-linenos="1678 "></span></a>    <span class="n">validate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1679" name="__codelineno-0-1679"></a><a href="#__codelineno-0-1679"><span class="linenos" data-linenos="1679 "></span></a>    <span class="n">progress_callback</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1680" name="__codelineno-0-1680"></a><a href="#__codelineno-0-1680"><span class="linenos" data-linenos="1680 "></span></a>    <span class="n">error_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;continue&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1681" name="__codelineno-0-1681"></a><a href="#__codelineno-0-1681"><span class="linenos" data-linenos="1681 "></span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MergeResult&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1682" name="__codelineno-0-1682"></a><a href="#__codelineno-0-1682"><span class="linenos" data-linenos="1682 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge another Labels object into this one.</span>
<a id="__codelineno-0-1683" name="__codelineno-0-1683"></a><a href="#__codelineno-0-1683"><span class="linenos" data-linenos="1683 "></span></a>
<a id="__codelineno-0-1684" name="__codelineno-0-1684"></a><a href="#__codelineno-0-1684"><span class="linenos" data-linenos="1684 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1685" name="__codelineno-0-1685"></a><a href="#__codelineno-0-1685"><span class="linenos" data-linenos="1685 "></span></a><span class="sd">        other: Another Labels object to merge into this one.</span>
<a id="__codelineno-0-1686" name="__codelineno-0-1686"></a><a href="#__codelineno-0-1686"><span class="linenos" data-linenos="1686 "></span></a><span class="sd">        instance_matcher: Matcher for comparing instances. If None, uses default</span>
<a id="__codelineno-0-1687" name="__codelineno-0-1687"></a><a href="#__codelineno-0-1687"><span class="linenos" data-linenos="1687 "></span></a><span class="sd">            spatial matching with 5px tolerance.</span>
<a id="__codelineno-0-1688" name="__codelineno-0-1688"></a><a href="#__codelineno-0-1688"><span class="linenos" data-linenos="1688 "></span></a><span class="sd">        skeleton_matcher: Matcher for comparing skeletons. If None, uses structure</span>
<a id="__codelineno-0-1689" name="__codelineno-0-1689"></a><a href="#__codelineno-0-1689"><span class="linenos" data-linenos="1689 "></span></a><span class="sd">            matching.</span>
<a id="__codelineno-0-1690" name="__codelineno-0-1690"></a><a href="#__codelineno-0-1690"><span class="linenos" data-linenos="1690 "></span></a><span class="sd">        video_matcher: Matcher for comparing videos. If None, uses auto matching.</span>
<a id="__codelineno-0-1691" name="__codelineno-0-1691"></a><a href="#__codelineno-0-1691"><span class="linenos" data-linenos="1691 "></span></a><span class="sd">        track_matcher: Matcher for comparing tracks. If None, uses name matching.</span>
<a id="__codelineno-0-1692" name="__codelineno-0-1692"></a><a href="#__codelineno-0-1692"><span class="linenos" data-linenos="1692 "></span></a><span class="sd">        frame_strategy: Strategy for merging frames:</span>
<a id="__codelineno-0-1693" name="__codelineno-0-1693"></a><a href="#__codelineno-0-1693"><span class="linenos" data-linenos="1693 "></span></a><span class="sd">            - &quot;smart&quot;: Keep user labels, update predictions</span>
<a id="__codelineno-0-1694" name="__codelineno-0-1694"></a><a href="#__codelineno-0-1694"><span class="linenos" data-linenos="1694 "></span></a><span class="sd">            - &quot;keep_original&quot;: Keep original frames</span>
<a id="__codelineno-0-1695" name="__codelineno-0-1695"></a><a href="#__codelineno-0-1695"><span class="linenos" data-linenos="1695 "></span></a><span class="sd">            - &quot;keep_new&quot;: Replace with new frames</span>
<a id="__codelineno-0-1696" name="__codelineno-0-1696"></a><a href="#__codelineno-0-1696"><span class="linenos" data-linenos="1696 "></span></a><span class="sd">            - &quot;keep_both&quot;: Keep all frames</span>
<a id="__codelineno-0-1697" name="__codelineno-0-1697"></a><a href="#__codelineno-0-1697"><span class="linenos" data-linenos="1697 "></span></a><span class="sd">            - &quot;update_tracks&quot;: Update track and score of the original instances</span>
<a id="__codelineno-0-1698" name="__codelineno-0-1698"></a><a href="#__codelineno-0-1698"><span class="linenos" data-linenos="1698 "></span></a><span class="sd">                from the new instances.</span>
<a id="__codelineno-0-1699" name="__codelineno-0-1699"></a><a href="#__codelineno-0-1699"><span class="linenos" data-linenos="1699 "></span></a><span class="sd">        validate: If True, validate for conflicts before merging.</span>
<a id="__codelineno-0-1700" name="__codelineno-0-1700"></a><a href="#__codelineno-0-1700"><span class="linenos" data-linenos="1700 "></span></a><span class="sd">        progress_callback: Optional callback for progress updates.</span>
<a id="__codelineno-0-1701" name="__codelineno-0-1701"></a><a href="#__codelineno-0-1701"><span class="linenos" data-linenos="1701 "></span></a><span class="sd">            Should accept (current, total, message) arguments.</span>
<a id="__codelineno-0-1702" name="__codelineno-0-1702"></a><a href="#__codelineno-0-1702"><span class="linenos" data-linenos="1702 "></span></a><span class="sd">        error_mode: How to handle errors:</span>
<a id="__codelineno-0-1703" name="__codelineno-0-1703"></a><a href="#__codelineno-0-1703"><span class="linenos" data-linenos="1703 "></span></a><span class="sd">            - &quot;continue&quot;: Log errors but continue</span>
<a id="__codelineno-0-1704" name="__codelineno-0-1704"></a><a href="#__codelineno-0-1704"><span class="linenos" data-linenos="1704 "></span></a><span class="sd">            - &quot;strict&quot;: Raise exception on first error</span>
<a id="__codelineno-0-1705" name="__codelineno-0-1705"></a><a href="#__codelineno-0-1705"><span class="linenos" data-linenos="1705 "></span></a><span class="sd">            - &quot;warn&quot;: Print warnings but continue</span>
<a id="__codelineno-0-1706" name="__codelineno-0-1706"></a><a href="#__codelineno-0-1706"><span class="linenos" data-linenos="1706 "></span></a>
<a id="__codelineno-0-1707" name="__codelineno-0-1707"></a><a href="#__codelineno-0-1707"><span class="linenos" data-linenos="1707 "></span></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1708" name="__codelineno-0-1708"></a><a href="#__codelineno-0-1708"><span class="linenos" data-linenos="1708 "></span></a><span class="sd">        MergeResult object with statistics and any errors/conflicts.</span>
<a id="__codelineno-0-1709" name="__codelineno-0-1709"></a><a href="#__codelineno-0-1709"><span class="linenos" data-linenos="1709 "></span></a>
<a id="__codelineno-0-1710" name="__codelineno-0-1710"></a><a href="#__codelineno-0-1710"><span class="linenos" data-linenos="1710 "></span></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-1711" name="__codelineno-0-1711"></a><a href="#__codelineno-0-1711"><span class="linenos" data-linenos="1711 "></span></a><span class="sd">        This method modifies the Labels object in place. The merge is designed to</span>
<a id="__codelineno-0-1712" name="__codelineno-0-1712"></a><a href="#__codelineno-0-1712"><span class="linenos" data-linenos="1712 "></span></a><span class="sd">        handle common workflows like merging predictions back into a project.</span>
<a id="__codelineno-0-1713" name="__codelineno-0-1713"></a><a href="#__codelineno-0-1713"><span class="linenos" data-linenos="1713 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1714" name="__codelineno-0-1714"></a><a href="#__codelineno-0-1714"><span class="linenos" data-linenos="1714 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<a id="__codelineno-0-1715" name="__codelineno-0-1715"></a><a href="#__codelineno-0-1715"><span class="linenos" data-linenos="1715 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-1716" name="__codelineno-0-1716"></a><a href="#__codelineno-0-1716"><span class="linenos" data-linenos="1716 "></span></a>
<a id="__codelineno-0-1717" name="__codelineno-0-1717"></a><a href="#__codelineno-0-1717"><span class="linenos" data-linenos="1717 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">sleap_io.model.matching</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-0-1718" name="__codelineno-0-1718"></a><a href="#__codelineno-0-1718"><span class="linenos" data-linenos="1718 "></span></a>        <span class="n">ConflictResolution</span><span class="p">,</span>
<a id="__codelineno-0-1719" name="__codelineno-0-1719"></a><a href="#__codelineno-0-1719"><span class="linenos" data-linenos="1719 "></span></a>        <span class="n">ErrorMode</span><span class="p">,</span>
<a id="__codelineno-0-1720" name="__codelineno-0-1720"></a><a href="#__codelineno-0-1720"><span class="linenos" data-linenos="1720 "></span></a>        <span class="n">InstanceMatcher</span><span class="p">,</span>
<a id="__codelineno-0-1721" name="__codelineno-0-1721"></a><a href="#__codelineno-0-1721"><span class="linenos" data-linenos="1721 "></span></a>        <span class="n">MergeError</span><span class="p">,</span>
<a id="__codelineno-0-1722" name="__codelineno-0-1722"></a><a href="#__codelineno-0-1722"><span class="linenos" data-linenos="1722 "></span></a>        <span class="n">MergeResult</span><span class="p">,</span>
<a id="__codelineno-0-1723" name="__codelineno-0-1723"></a><a href="#__codelineno-0-1723"><span class="linenos" data-linenos="1723 "></span></a>        <span class="n">SkeletonMatcher</span><span class="p">,</span>
<a id="__codelineno-0-1724" name="__codelineno-0-1724"></a><a href="#__codelineno-0-1724"><span class="linenos" data-linenos="1724 "></span></a>        <span class="n">SkeletonMatchMethod</span><span class="p">,</span>
<a id="__codelineno-0-1725" name="__codelineno-0-1725"></a><a href="#__codelineno-0-1725"><span class="linenos" data-linenos="1725 "></span></a>        <span class="n">SkeletonMismatchError</span><span class="p">,</span>
<a id="__codelineno-0-1726" name="__codelineno-0-1726"></a><a href="#__codelineno-0-1726"><span class="linenos" data-linenos="1726 "></span></a>        <span class="n">TrackMatcher</span><span class="p">,</span>
<a id="__codelineno-0-1727" name="__codelineno-0-1727"></a><a href="#__codelineno-0-1727"><span class="linenos" data-linenos="1727 "></span></a>        <span class="n">VideoMatcher</span><span class="p">,</span>
<a id="__codelineno-0-1728" name="__codelineno-0-1728"></a><a href="#__codelineno-0-1728"><span class="linenos" data-linenos="1728 "></span></a>        <span class="n">VideoMatchMethod</span><span class="p">,</span>
<a id="__codelineno-0-1729" name="__codelineno-0-1729"></a><a href="#__codelineno-0-1729"><span class="linenos" data-linenos="1729 "></span></a>    <span class="p">)</span>
<a id="__codelineno-0-1730" name="__codelineno-0-1730"></a><a href="#__codelineno-0-1730"><span class="linenos" data-linenos="1730 "></span></a>
<a id="__codelineno-0-1731" name="__codelineno-0-1731"></a><a href="#__codelineno-0-1731"><span class="linenos" data-linenos="1731 "></span></a>    <span class="c1"># Initialize matchers with defaults if not provided</span>
<a id="__codelineno-0-1732" name="__codelineno-0-1732"></a><a href="#__codelineno-0-1732"><span class="linenos" data-linenos="1732 "></span></a>    <span class="k">if</span> <span class="n">instance_matcher</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1733" name="__codelineno-0-1733"></a><a href="#__codelineno-0-1733"><span class="linenos" data-linenos="1733 "></span></a>        <span class="n">instance_matcher</span> <span class="o">=</span> <span class="n">InstanceMatcher</span><span class="p">()</span>
<a id="__codelineno-0-1734" name="__codelineno-0-1734"></a><a href="#__codelineno-0-1734"><span class="linenos" data-linenos="1734 "></span></a>    <span class="k">if</span> <span class="n">skeleton_matcher</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1735" name="__codelineno-0-1735"></a><a href="#__codelineno-0-1735"><span class="linenos" data-linenos="1735 "></span></a>        <span class="n">skeleton_matcher</span> <span class="o">=</span> <span class="n">SkeletonMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">STRUCTURE</span><span class="p">)</span>
<a id="__codelineno-0-1736" name="__codelineno-0-1736"></a><a href="#__codelineno-0-1736"><span class="linenos" data-linenos="1736 "></span></a>    <span class="k">if</span> <span class="n">video_matcher</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1737" name="__codelineno-0-1737"></a><a href="#__codelineno-0-1737"><span class="linenos" data-linenos="1737 "></span></a>        <span class="n">video_matcher</span> <span class="o">=</span> <span class="n">VideoMatcher</span><span class="p">()</span>
<a id="__codelineno-0-1738" name="__codelineno-0-1738"></a><a href="#__codelineno-0-1738"><span class="linenos" data-linenos="1738 "></span></a>    <span class="k">if</span> <span class="n">track_matcher</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1739" name="__codelineno-0-1739"></a><a href="#__codelineno-0-1739"><span class="linenos" data-linenos="1739 "></span></a>        <span class="n">track_matcher</span> <span class="o">=</span> <span class="n">TrackMatcher</span><span class="p">()</span>
<a id="__codelineno-0-1740" name="__codelineno-0-1740"></a><a href="#__codelineno-0-1740"><span class="linenos" data-linenos="1740 "></span></a>
<a id="__codelineno-0-1741" name="__codelineno-0-1741"></a><a href="#__codelineno-0-1741"><span class="linenos" data-linenos="1741 "></span></a>    <span class="c1"># Parse error mode</span>
<a id="__codelineno-0-1742" name="__codelineno-0-1742"></a><a href="#__codelineno-0-1742"><span class="linenos" data-linenos="1742 "></span></a>    <span class="n">error_mode_enum</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="p">(</span><span class="n">error_mode</span><span class="p">)</span>
<a id="__codelineno-0-1743" name="__codelineno-0-1743"></a><a href="#__codelineno-0-1743"><span class="linenos" data-linenos="1743 "></span></a>
<a id="__codelineno-0-1744" name="__codelineno-0-1744"></a><a href="#__codelineno-0-1744"><span class="linenos" data-linenos="1744 "></span></a>    <span class="c1"># Initialize result</span>
<a id="__codelineno-0-1745" name="__codelineno-0-1745"></a><a href="#__codelineno-0-1745"><span class="linenos" data-linenos="1745 "></span></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">MergeResult</span><span class="p">(</span><span class="n">successful</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-1746" name="__codelineno-0-1746"></a><a href="#__codelineno-0-1746"><span class="linenos" data-linenos="1746 "></span></a>
<a id="__codelineno-0-1747" name="__codelineno-0-1747"></a><a href="#__codelineno-0-1747"><span class="linenos" data-linenos="1747 "></span></a>    <span class="c1"># Track merge history in provenance</span>
<a id="__codelineno-0-1748" name="__codelineno-0-1748"></a><a href="#__codelineno-0-1748"><span class="linenos" data-linenos="1748 "></span></a>    <span class="k">if</span> <span class="s2">&quot;merge_history&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">provenance</span><span class="p">:</span>
<a id="__codelineno-0-1749" name="__codelineno-0-1749"></a><a href="#__codelineno-0-1749"><span class="linenos" data-linenos="1749 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">provenance</span><span class="p">[</span><span class="s2">&quot;merge_history&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1750" name="__codelineno-0-1750"></a><a href="#__codelineno-0-1750"><span class="linenos" data-linenos="1750 "></span></a>
<a id="__codelineno-0-1751" name="__codelineno-0-1751"></a><a href="#__codelineno-0-1751"><span class="linenos" data-linenos="1751 "></span></a>    <span class="n">merge_record</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-1752" name="__codelineno-0-1752"></a><a href="#__codelineno-0-1752"><span class="linenos" data-linenos="1752 "></span></a>        <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
<a id="__codelineno-0-1753" name="__codelineno-0-1753"></a><a href="#__codelineno-0-1753"><span class="linenos" data-linenos="1753 "></span></a>        <span class="s2">&quot;source_labels&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-1754" name="__codelineno-0-1754"></a><a href="#__codelineno-0-1754"><span class="linenos" data-linenos="1754 "></span></a>            <span class="s2">&quot;n_frames&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">labeled_frames</span><span class="p">),</span>
<a id="__codelineno-0-1755" name="__codelineno-0-1755"></a><a href="#__codelineno-0-1755"><span class="linenos" data-linenos="1755 "></span></a>            <span class="s2">&quot;n_videos&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">videos</span><span class="p">),</span>
<a id="__codelineno-0-1756" name="__codelineno-0-1756"></a><a href="#__codelineno-0-1756"><span class="linenos" data-linenos="1756 "></span></a>            <span class="s2">&quot;n_skeletons&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">skeletons</span><span class="p">),</span>
<a id="__codelineno-0-1757" name="__codelineno-0-1757"></a><a href="#__codelineno-0-1757"><span class="linenos" data-linenos="1757 "></span></a>            <span class="s2">&quot;n_tracks&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">tracks</span><span class="p">),</span>
<a id="__codelineno-0-1758" name="__codelineno-0-1758"></a><a href="#__codelineno-0-1758"><span class="linenos" data-linenos="1758 "></span></a>        <span class="p">},</span>
<a id="__codelineno-0-1759" name="__codelineno-0-1759"></a><a href="#__codelineno-0-1759"><span class="linenos" data-linenos="1759 "></span></a>        <span class="s2">&quot;strategy&quot;</span><span class="p">:</span> <span class="n">frame_strategy</span><span class="p">,</span>
<a id="__codelineno-0-1760" name="__codelineno-0-1760"></a><a href="#__codelineno-0-1760"><span class="linenos" data-linenos="1760 "></span></a>    <span class="p">}</span>
<a id="__codelineno-0-1761" name="__codelineno-0-1761"></a><a href="#__codelineno-0-1761"><span class="linenos" data-linenos="1761 "></span></a>
<a id="__codelineno-0-1762" name="__codelineno-0-1762"></a><a href="#__codelineno-0-1762"><span class="linenos" data-linenos="1762 "></span></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1763" name="__codelineno-0-1763"></a><a href="#__codelineno-0-1763"><span class="linenos" data-linenos="1763 "></span></a>        <span class="c1"># Step 1: Match and merge skeletons</span>
<a id="__codelineno-0-1764" name="__codelineno-0-1764"></a><a href="#__codelineno-0-1764"><span class="linenos" data-linenos="1764 "></span></a>        <span class="n">skeleton_map</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1765" name="__codelineno-0-1765"></a><a href="#__codelineno-0-1765"><span class="linenos" data-linenos="1765 "></span></a>        <span class="k">for</span> <span class="n">other_skel</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">skeletons</span><span class="p">:</span>
<a id="__codelineno-0-1766" name="__codelineno-0-1766"></a><a href="#__codelineno-0-1766"><span class="linenos" data-linenos="1766 "></span></a>            <span class="n">matched</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1767" name="__codelineno-0-1767"></a><a href="#__codelineno-0-1767"><span class="linenos" data-linenos="1767 "></span></a>            <span class="k">for</span> <span class="n">self_skel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeletons</span><span class="p">:</span>
<a id="__codelineno-0-1768" name="__codelineno-0-1768"></a><a href="#__codelineno-0-1768"><span class="linenos" data-linenos="1768 "></span></a>                <span class="k">if</span> <span class="n">skeleton_matcher</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">self_skel</span><span class="p">,</span> <span class="n">other_skel</span><span class="p">):</span>
<a id="__codelineno-0-1769" name="__codelineno-0-1769"></a><a href="#__codelineno-0-1769"><span class="linenos" data-linenos="1769 "></span></a>                    <span class="n">skeleton_map</span><span class="p">[</span><span class="n">other_skel</span><span class="p">]</span> <span class="o">=</span> <span class="n">self_skel</span>
<a id="__codelineno-0-1770" name="__codelineno-0-1770"></a><a href="#__codelineno-0-1770"><span class="linenos" data-linenos="1770 "></span></a>                    <span class="n">matched</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1771" name="__codelineno-0-1771"></a><a href="#__codelineno-0-1771"><span class="linenos" data-linenos="1771 "></span></a>                    <span class="k">break</span>
<a id="__codelineno-0-1772" name="__codelineno-0-1772"></a><a href="#__codelineno-0-1772"><span class="linenos" data-linenos="1772 "></span></a>
<a id="__codelineno-0-1773" name="__codelineno-0-1773"></a><a href="#__codelineno-0-1773"><span class="linenos" data-linenos="1773 "></span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">matched</span><span class="p">:</span>
<a id="__codelineno-0-1774" name="__codelineno-0-1774"></a><a href="#__codelineno-0-1774"><span class="linenos" data-linenos="1774 "></span></a>                <span class="k">if</span> <span class="n">validate</span> <span class="ow">and</span> <span class="n">error_mode_enum</span> <span class="o">==</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">STRICT</span><span class="p">:</span>
<a id="__codelineno-0-1775" name="__codelineno-0-1775"></a><a href="#__codelineno-0-1775"><span class="linenos" data-linenos="1775 "></span></a>                    <span class="k">raise</span> <span class="n">SkeletonMismatchError</span><span class="p">(</span>
<a id="__codelineno-0-1776" name="__codelineno-0-1776"></a><a href="#__codelineno-0-1776"><span class="linenos" data-linenos="1776 "></span></a>                        <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;No matching skeleton found for </span><span class="si">{</span><span class="n">other_skel</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1777" name="__codelineno-0-1777"></a><a href="#__codelineno-0-1777"><span class="linenos" data-linenos="1777 "></span></a>                        <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;skeleton&quot;</span><span class="p">:</span> <span class="n">other_skel</span><span class="p">},</span>
<a id="__codelineno-0-1778" name="__codelineno-0-1778"></a><a href="#__codelineno-0-1778"><span class="linenos" data-linenos="1778 "></span></a>                    <span class="p">)</span>
<a id="__codelineno-0-1779" name="__codelineno-0-1779"></a><a href="#__codelineno-0-1779"><span class="linenos" data-linenos="1779 "></span></a>                <span class="k">elif</span> <span class="n">error_mode_enum</span> <span class="o">==</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">WARN</span><span class="p">:</span>
<a id="__codelineno-0-1780" name="__codelineno-0-1780"></a><a href="#__codelineno-0-1780"><span class="linenos" data-linenos="1780 "></span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: No matching skeleton for </span><span class="si">{</span><span class="n">other_skel</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1781" name="__codelineno-0-1781"></a><a href="#__codelineno-0-1781"><span class="linenos" data-linenos="1781 "></span></a>
<a id="__codelineno-0-1782" name="__codelineno-0-1782"></a><a href="#__codelineno-0-1782"><span class="linenos" data-linenos="1782 "></span></a>                <span class="c1"># Add new skeleton if no match</span>
<a id="__codelineno-0-1783" name="__codelineno-0-1783"></a><a href="#__codelineno-0-1783"><span class="linenos" data-linenos="1783 "></span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">skeletons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">other_skel</span><span class="p">)</span>
<a id="__codelineno-0-1784" name="__codelineno-0-1784"></a><a href="#__codelineno-0-1784"><span class="linenos" data-linenos="1784 "></span></a>                <span class="n">skeleton_map</span><span class="p">[</span><span class="n">other_skel</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_skel</span>
<a id="__codelineno-0-1785" name="__codelineno-0-1785"></a><a href="#__codelineno-0-1785"><span class="linenos" data-linenos="1785 "></span></a>
<a id="__codelineno-0-1786" name="__codelineno-0-1786"></a><a href="#__codelineno-0-1786"><span class="linenos" data-linenos="1786 "></span></a>        <span class="c1"># Step 2: Match and merge videos</span>
<a id="__codelineno-0-1787" name="__codelineno-0-1787"></a><a href="#__codelineno-0-1787"><span class="linenos" data-linenos="1787 "></span></a>        <span class="n">video_map</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1788" name="__codelineno-0-1788"></a><a href="#__codelineno-0-1788"><span class="linenos" data-linenos="1788 "></span></a>        <span class="n">frame_idx_map</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Maps (old_video, old_idx) -&gt; (new_video, new_idx)</span>
<a id="__codelineno-0-1789" name="__codelineno-0-1789"></a><a href="#__codelineno-0-1789"><span class="linenos" data-linenos="1789 "></span></a>
<a id="__codelineno-0-1790" name="__codelineno-0-1790"></a><a href="#__codelineno-0-1790"><span class="linenos" data-linenos="1790 "></span></a>        <span class="k">for</span> <span class="n">other_video</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">videos</span><span class="p">:</span>
<a id="__codelineno-0-1791" name="__codelineno-0-1791"></a><a href="#__codelineno-0-1791"><span class="linenos" data-linenos="1791 "></span></a>            <span class="n">matched</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1792" name="__codelineno-0-1792"></a><a href="#__codelineno-0-1792"><span class="linenos" data-linenos="1792 "></span></a>            <span class="n">matched_video</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1793" name="__codelineno-0-1793"></a><a href="#__codelineno-0-1793"><span class="linenos" data-linenos="1793 "></span></a>
<a id="__codelineno-0-1794" name="__codelineno-0-1794"></a><a href="#__codelineno-0-1794"><span class="linenos" data-linenos="1794 "></span></a>            <span class="c1"># Special handling for AUTO method to prefer basename over content matches</span>
<a id="__codelineno-0-1795" name="__codelineno-0-1795"></a><a href="#__codelineno-0-1795"><span class="linenos" data-linenos="1795 "></span></a>            <span class="k">if</span> <span class="n">video_matcher</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">AUTO</span><span class="p">:</span>
<a id="__codelineno-0-1796" name="__codelineno-0-1796"></a><a href="#__codelineno-0-1796"><span class="linenos" data-linenos="1796 "></span></a>                <span class="c1"># Collect all matches and categorize by match quality</span>
<a id="__codelineno-0-1797" name="__codelineno-0-1797"></a><a href="#__codelineno-0-1797"><span class="linenos" data-linenos="1797 "></span></a>                <span class="n">basename_matches</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1798" name="__codelineno-0-1798"></a><a href="#__codelineno-0-1798"><span class="linenos" data-linenos="1798 "></span></a>                <span class="n">content_only_matches</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1799" name="__codelineno-0-1799"></a><a href="#__codelineno-0-1799"><span class="linenos" data-linenos="1799 "></span></a>
<a id="__codelineno-0-1800" name="__codelineno-0-1800"></a><a href="#__codelineno-0-1800"><span class="linenos" data-linenos="1800 "></span></a>                <span class="k">for</span> <span class="n">self_video</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="p">:</span>
<a id="__codelineno-0-1801" name="__codelineno-0-1801"></a><a href="#__codelineno-0-1801"><span class="linenos" data-linenos="1801 "></span></a>                    <span class="c1"># Check strict path match</span>
<a id="__codelineno-0-1802" name="__codelineno-0-1802"></a><a href="#__codelineno-0-1802"><span class="linenos" data-linenos="1802 "></span></a>                    <span class="k">if</span> <span class="n">self_video</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">other_video</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-1803" name="__codelineno-0-1803"></a><a href="#__codelineno-0-1803"><span class="linenos" data-linenos="1803 "></span></a>                        <span class="c1"># Exact path match - use immediately</span>
<a id="__codelineno-0-1804" name="__codelineno-0-1804"></a><a href="#__codelineno-0-1804"><span class="linenos" data-linenos="1804 "></span></a>                        <span class="n">matched_video</span> <span class="o">=</span> <span class="n">self_video</span>
<a id="__codelineno-0-1805" name="__codelineno-0-1805"></a><a href="#__codelineno-0-1805"><span class="linenos" data-linenos="1805 "></span></a>                        <span class="k">break</span>
<a id="__codelineno-0-1806" name="__codelineno-0-1806"></a><a href="#__codelineno-0-1806"><span class="linenos" data-linenos="1806 "></span></a>                    <span class="c1"># Check basename match</span>
<a id="__codelineno-0-1807" name="__codelineno-0-1807"></a><a href="#__codelineno-0-1807"><span class="linenos" data-linenos="1807 "></span></a>                    <span class="k">if</span> <span class="n">self_video</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">other_video</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-1808" name="__codelineno-0-1808"></a><a href="#__codelineno-0-1808"><span class="linenos" data-linenos="1808 "></span></a>                        <span class="n">basename_matches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">self_video</span><span class="p">)</span>
<a id="__codelineno-0-1809" name="__codelineno-0-1809"></a><a href="#__codelineno-0-1809"><span class="linenos" data-linenos="1809 "></span></a>                    <span class="c1"># Check content-only match (no path match)</span>
<a id="__codelineno-0-1810" name="__codelineno-0-1810"></a><a href="#__codelineno-0-1810"><span class="linenos" data-linenos="1810 "></span></a>                    <span class="k">elif</span> <span class="n">self_video</span><span class="o">.</span><span class="n">matches_content</span><span class="p">(</span><span class="n">other_video</span><span class="p">):</span>
<a id="__codelineno-0-1811" name="__codelineno-0-1811"></a><a href="#__codelineno-0-1811"><span class="linenos" data-linenos="1811 "></span></a>                        <span class="n">content_only_matches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">self_video</span><span class="p">)</span>
<a id="__codelineno-0-1812" name="__codelineno-0-1812"></a><a href="#__codelineno-0-1812"><span class="linenos" data-linenos="1812 "></span></a>
<a id="__codelineno-0-1813" name="__codelineno-0-1813"></a><a href="#__codelineno-0-1813"><span class="linenos" data-linenos="1813 "></span></a>                <span class="c1"># Pick best match: prefer basename over content-only</span>
<a id="__codelineno-0-1814" name="__codelineno-0-1814"></a><a href="#__codelineno-0-1814"><span class="linenos" data-linenos="1814 "></span></a>                <span class="k">if</span> <span class="n">matched_video</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1815" name="__codelineno-0-1815"></a><a href="#__codelineno-0-1815"><span class="linenos" data-linenos="1815 "></span></a>                    <span class="k">if</span> <span class="n">basename_matches</span><span class="p">:</span>
<a id="__codelineno-0-1816" name="__codelineno-0-1816"></a><a href="#__codelineno-0-1816"><span class="linenos" data-linenos="1816 "></span></a>                        <span class="n">matched_video</span> <span class="o">=</span> <span class="n">basename_matches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1817" name="__codelineno-0-1817"></a><a href="#__codelineno-0-1817"><span class="linenos" data-linenos="1817 "></span></a>                    <span class="k">elif</span> <span class="n">content_only_matches</span><span class="p">:</span>
<a id="__codelineno-0-1818" name="__codelineno-0-1818"></a><a href="#__codelineno-0-1818"><span class="linenos" data-linenos="1818 "></span></a>                        <span class="n">matched_video</span> <span class="o">=</span> <span class="n">content_only_matches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1819" name="__codelineno-0-1819"></a><a href="#__codelineno-0-1819"><span class="linenos" data-linenos="1819 "></span></a>
<a id="__codelineno-0-1820" name="__codelineno-0-1820"></a><a href="#__codelineno-0-1820"><span class="linenos" data-linenos="1820 "></span></a>                <span class="k">if</span> <span class="n">matched_video</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1821" name="__codelineno-0-1821"></a><a href="#__codelineno-0-1821"><span class="linenos" data-linenos="1821 "></span></a>                    <span class="n">video_map</span><span class="p">[</span><span class="n">other_video</span><span class="p">]</span> <span class="o">=</span> <span class="n">matched_video</span>
<a id="__codelineno-0-1822" name="__codelineno-0-1822"></a><a href="#__codelineno-0-1822"><span class="linenos" data-linenos="1822 "></span></a>                    <span class="n">matched</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1823" name="__codelineno-0-1823"></a><a href="#__codelineno-0-1823"><span class="linenos" data-linenos="1823 "></span></a>
<a id="__codelineno-0-1824" name="__codelineno-0-1824"></a><a href="#__codelineno-0-1824"><span class="linenos" data-linenos="1824 "></span></a>            <span class="c1"># For non-AUTO methods, use original first-match logic</span>
<a id="__codelineno-0-1825" name="__codelineno-0-1825"></a><a href="#__codelineno-0-1825"><span class="linenos" data-linenos="1825 "></span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">matched</span><span class="p">:</span>
<a id="__codelineno-0-1826" name="__codelineno-0-1826"></a><a href="#__codelineno-0-1826"><span class="linenos" data-linenos="1826 "></span></a>                <span class="k">for</span> <span class="n">self_video</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="p">:</span>
<a id="__codelineno-0-1827" name="__codelineno-0-1827"></a><a href="#__codelineno-0-1827"><span class="linenos" data-linenos="1827 "></span></a>                    <span class="k">if</span> <span class="n">video_matcher</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">self_video</span><span class="p">,</span> <span class="n">other_video</span><span class="p">):</span>
<a id="__codelineno-0-1828" name="__codelineno-0-1828"></a><a href="#__codelineno-0-1828"><span class="linenos" data-linenos="1828 "></span></a>                        <span class="n">matched_video</span> <span class="o">=</span> <span class="n">self_video</span>
<a id="__codelineno-0-1829" name="__codelineno-0-1829"></a><a href="#__codelineno-0-1829"><span class="linenos" data-linenos="1829 "></span></a>                        <span class="c1"># Special handling for different match methods</span>
<a id="__codelineno-0-1830" name="__codelineno-0-1830"></a><a href="#__codelineno-0-1830"><span class="linenos" data-linenos="1830 "></span></a>                        <span class="k">if</span> <span class="n">video_matcher</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">IMAGE_DEDUP</span><span class="p">:</span>
<a id="__codelineno-0-1831" name="__codelineno-0-1831"></a><a href="#__codelineno-0-1831"><span class="linenos" data-linenos="1831 "></span></a>                            <span class="c1"># Deduplicate images from other_video</span>
<a id="__codelineno-0-1832" name="__codelineno-0-1832"></a><a href="#__codelineno-0-1832"><span class="linenos" data-linenos="1832 "></span></a>                            <span class="n">deduped_video</span> <span class="o">=</span> <span class="n">other_video</span><span class="o">.</span><span class="n">deduplicate_with</span><span class="p">(</span><span class="n">self_video</span><span class="p">)</span>
<a id="__codelineno-0-1833" name="__codelineno-0-1833"></a><a href="#__codelineno-0-1833"><span class="linenos" data-linenos="1833 "></span></a>                            <span class="k">if</span> <span class="n">deduped_video</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1834" name="__codelineno-0-1834"></a><a href="#__codelineno-0-1834"><span class="linenos" data-linenos="1834 "></span></a>                                <span class="c1"># All images were duplicates, map to existing video</span>
<a id="__codelineno-0-1835" name="__codelineno-0-1835"></a><a href="#__codelineno-0-1835"><span class="linenos" data-linenos="1835 "></span></a>                                <span class="n">video_map</span><span class="p">[</span><span class="n">other_video</span><span class="p">]</span> <span class="o">=</span> <span class="n">self_video</span>
<a id="__codelineno-0-1836" name="__codelineno-0-1836"></a><a href="#__codelineno-0-1836"><span class="linenos" data-linenos="1836 "></span></a>                                <span class="c1"># Build frame index mapping for deduplicated frames</span>
<a id="__codelineno-0-1837" name="__codelineno-0-1837"></a><a href="#__codelineno-0-1837"><span class="linenos" data-linenos="1837 "></span></a>                                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-1838" name="__codelineno-0-1838"></a><a href="#__codelineno-0-1838"><span class="linenos" data-linenos="1838 "></span></a>                                    <span class="n">other_video</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="nb">list</span>
<a id="__codelineno-0-1839" name="__codelineno-0-1839"></a><a href="#__codelineno-0-1839"><span class="linenos" data-linenos="1839 "></span></a>                                <span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">self_video</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-1840" name="__codelineno-0-1840"></a><a href="#__codelineno-0-1840"><span class="linenos" data-linenos="1840 "></span></a>                                    <span class="n">other_basenames</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1841" name="__codelineno-0-1841"></a><a href="#__codelineno-0-1841"><span class="linenos" data-linenos="1841 "></span></a>                                        <span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">other_video</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-1842" name="__codelineno-0-1842"></a><a href="#__codelineno-0-1842"><span class="linenos" data-linenos="1842 "></span></a>                                    <span class="p">]</span>
<a id="__codelineno-0-1843" name="__codelineno-0-1843"></a><a href="#__codelineno-0-1843"><span class="linenos" data-linenos="1843 "></span></a>                                    <span class="n">self_basenames</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1844" name="__codelineno-0-1844"></a><a href="#__codelineno-0-1844"><span class="linenos" data-linenos="1844 "></span></a>                                        <span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">self_video</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-1845" name="__codelineno-0-1845"></a><a href="#__codelineno-0-1845"><span class="linenos" data-linenos="1845 "></span></a>                                    <span class="p">]</span>
<a id="__codelineno-0-1846" name="__codelineno-0-1846"></a><a href="#__codelineno-0-1846"><span class="linenos" data-linenos="1846 "></span></a>                                    <span class="k">for</span> <span class="n">old_idx</span><span class="p">,</span> <span class="n">basename</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">other_basenames</span><span class="p">):</span>
<a id="__codelineno-0-1847" name="__codelineno-0-1847"></a><a href="#__codelineno-0-1847"><span class="linenos" data-linenos="1847 "></span></a>                                        <span class="k">if</span> <span class="n">basename</span> <span class="ow">in</span> <span class="n">self_basenames</span><span class="p">:</span>
<a id="__codelineno-0-1848" name="__codelineno-0-1848"></a><a href="#__codelineno-0-1848"><span class="linenos" data-linenos="1848 "></span></a>                                            <span class="n">new_idx</span> <span class="o">=</span> <span class="n">self_basenames</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">basename</span><span class="p">)</span>
<a id="__codelineno-0-1849" name="__codelineno-0-1849"></a><a href="#__codelineno-0-1849"><span class="linenos" data-linenos="1849 "></span></a>                                            <span class="n">frame_idx_map</span><span class="p">[(</span><span class="n">other_video</span><span class="p">,</span> <span class="n">old_idx</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1850" name="__codelineno-0-1850"></a><a href="#__codelineno-0-1850"><span class="linenos" data-linenos="1850 "></span></a>                                                <span class="n">self_video</span><span class="p">,</span>
<a id="__codelineno-0-1851" name="__codelineno-0-1851"></a><a href="#__codelineno-0-1851"><span class="linenos" data-linenos="1851 "></span></a>                                                <span class="n">new_idx</span><span class="p">,</span>
<a id="__codelineno-0-1852" name="__codelineno-0-1852"></a><a href="#__codelineno-0-1852"><span class="linenos" data-linenos="1852 "></span></a>                                            <span class="p">)</span>
<a id="__codelineno-0-1853" name="__codelineno-0-1853"></a><a href="#__codelineno-0-1853"><span class="linenos" data-linenos="1853 "></span></a>                            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1854" name="__codelineno-0-1854"></a><a href="#__codelineno-0-1854"><span class="linenos" data-linenos="1854 "></span></a>                                <span class="c1"># Add deduplicated video as new</span>
<a id="__codelineno-0-1855" name="__codelineno-0-1855"></a><a href="#__codelineno-0-1855"><span class="linenos" data-linenos="1855 "></span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deduped_video</span><span class="p">)</span>
<a id="__codelineno-0-1856" name="__codelineno-0-1856"></a><a href="#__codelineno-0-1856"><span class="linenos" data-linenos="1856 "></span></a>                                <span class="n">video_map</span><span class="p">[</span><span class="n">other_video</span><span class="p">]</span> <span class="o">=</span> <span class="n">deduped_video</span>
<a id="__codelineno-0-1857" name="__codelineno-0-1857"></a><a href="#__codelineno-0-1857"><span class="linenos" data-linenos="1857 "></span></a>                                <span class="c1"># Build frame index mapping for remaining frames</span>
<a id="__codelineno-0-1858" name="__codelineno-0-1858"></a><a href="#__codelineno-0-1858"><span class="linenos" data-linenos="1858 "></span></a>                                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-1859" name="__codelineno-0-1859"></a><a href="#__codelineno-0-1859"><span class="linenos" data-linenos="1859 "></span></a>                                    <span class="n">other_video</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="nb">list</span>
<a id="__codelineno-0-1860" name="__codelineno-0-1860"></a><a href="#__codelineno-0-1860"><span class="linenos" data-linenos="1860 "></span></a>                                <span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">deduped_video</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-1861" name="__codelineno-0-1861"></a><a href="#__codelineno-0-1861"><span class="linenos" data-linenos="1861 "></span></a>                                    <span class="n">other_basenames</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1862" name="__codelineno-0-1862"></a><a href="#__codelineno-0-1862"><span class="linenos" data-linenos="1862 "></span></a>                                        <span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">other_video</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-1863" name="__codelineno-0-1863"></a><a href="#__codelineno-0-1863"><span class="linenos" data-linenos="1863 "></span></a>                                    <span class="p">]</span>
<a id="__codelineno-0-1864" name="__codelineno-0-1864"></a><a href="#__codelineno-0-1864"><span class="linenos" data-linenos="1864 "></span></a>                                    <span class="n">deduped_basenames</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1865" name="__codelineno-0-1865"></a><a href="#__codelineno-0-1865"><span class="linenos" data-linenos="1865 "></span></a>                                        <span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">deduped_video</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-1866" name="__codelineno-0-1866"></a><a href="#__codelineno-0-1866"><span class="linenos" data-linenos="1866 "></span></a>                                    <span class="p">]</span>
<a id="__codelineno-0-1867" name="__codelineno-0-1867"></a><a href="#__codelineno-0-1867"><span class="linenos" data-linenos="1867 "></span></a>                                    <span class="n">self_basenames</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1868" name="__codelineno-0-1868"></a><a href="#__codelineno-0-1868"><span class="linenos" data-linenos="1868 "></span></a>                                        <span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">self_video</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-1869" name="__codelineno-0-1869"></a><a href="#__codelineno-0-1869"><span class="linenos" data-linenos="1869 "></span></a>                                    <span class="p">]</span>
<a id="__codelineno-0-1870" name="__codelineno-0-1870"></a><a href="#__codelineno-0-1870"><span class="linenos" data-linenos="1870 "></span></a>                                    <span class="k">for</span> <span class="n">old_idx</span><span class="p">,</span> <span class="n">basename</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">other_basenames</span><span class="p">):</span>
<a id="__codelineno-0-1871" name="__codelineno-0-1871"></a><a href="#__codelineno-0-1871"><span class="linenos" data-linenos="1871 "></span></a>                                        <span class="k">if</span> <span class="n">basename</span> <span class="ow">in</span> <span class="n">deduped_basenames</span><span class="p">:</span>
<a id="__codelineno-0-1872" name="__codelineno-0-1872"></a><a href="#__codelineno-0-1872"><span class="linenos" data-linenos="1872 "></span></a>                                            <span class="n">new_idx</span> <span class="o">=</span> <span class="n">deduped_basenames</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">basename</span><span class="p">)</span>
<a id="__codelineno-0-1873" name="__codelineno-0-1873"></a><a href="#__codelineno-0-1873"><span class="linenos" data-linenos="1873 "></span></a>                                            <span class="n">frame_idx_map</span><span class="p">[(</span><span class="n">other_video</span><span class="p">,</span> <span class="n">old_idx</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1874" name="__codelineno-0-1874"></a><a href="#__codelineno-0-1874"><span class="linenos" data-linenos="1874 "></span></a>                                                <span class="n">deduped_video</span><span class="p">,</span>
<a id="__codelineno-0-1875" name="__codelineno-0-1875"></a><a href="#__codelineno-0-1875"><span class="linenos" data-linenos="1875 "></span></a>                                                <span class="n">new_idx</span><span class="p">,</span>
<a id="__codelineno-0-1876" name="__codelineno-0-1876"></a><a href="#__codelineno-0-1876"><span class="linenos" data-linenos="1876 "></span></a>                                            <span class="p">)</span>
<a id="__codelineno-0-1877" name="__codelineno-0-1877"></a><a href="#__codelineno-0-1877"><span class="linenos" data-linenos="1877 "></span></a>                                        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1878" name="__codelineno-0-1878"></a><a href="#__codelineno-0-1878"><span class="linenos" data-linenos="1878 "></span></a>                                            <span class="c1"># Cases where the image was a duplicate,</span>
<a id="__codelineno-0-1879" name="__codelineno-0-1879"></a><a href="#__codelineno-0-1879"><span class="linenos" data-linenos="1879 "></span></a>                                            <span class="c1"># present in both self and other labels</span>
<a id="__codelineno-0-1880" name="__codelineno-0-1880"></a><a href="#__codelineno-0-1880"><span class="linenos" data-linenos="1880 "></span></a>                                            <span class="c1"># See Issue #239.</span>
<a id="__codelineno-0-1881" name="__codelineno-0-1881"></a><a href="#__codelineno-0-1881"><span class="linenos" data-linenos="1881 "></span></a>                                            <span class="k">assert</span> <span class="n">basename</span> <span class="ow">in</span> <span class="n">self_basenames</span><span class="p">,</span> <span class="p">(</span>
<a id="__codelineno-0-1882" name="__codelineno-0-1882"></a><a href="#__codelineno-0-1882"><span class="linenos" data-linenos="1882 "></span></a>                                                <span class="s2">&quot;Unexpected basename mismatch, </span><span class="se">\</span>
<a id="__codelineno-0-1883" name="__codelineno-0-1883"></a><a href="#__codelineno-0-1883"><span class="linenos" data-linenos="1883 "></span></a><span class="s2">                                                    possible file corruption.&quot;</span>
<a id="__codelineno-0-1884" name="__codelineno-0-1884"></a><a href="#__codelineno-0-1884"><span class="linenos" data-linenos="1884 "></span></a>                                            <span class="p">)</span>
<a id="__codelineno-0-1885" name="__codelineno-0-1885"></a><a href="#__codelineno-0-1885"><span class="linenos" data-linenos="1885 "></span></a>                                            <span class="n">new_idx</span> <span class="o">=</span> <span class="n">self_basenames</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">basename</span><span class="p">)</span>
<a id="__codelineno-0-1886" name="__codelineno-0-1886"></a><a href="#__codelineno-0-1886"><span class="linenos" data-linenos="1886 "></span></a>                                            <span class="n">frame_idx_map</span><span class="p">[(</span><span class="n">other_video</span><span class="p">,</span> <span class="n">old_idx</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1887" name="__codelineno-0-1887"></a><a href="#__codelineno-0-1887"><span class="linenos" data-linenos="1887 "></span></a>                                                <span class="n">self_video</span><span class="p">,</span>
<a id="__codelineno-0-1888" name="__codelineno-0-1888"></a><a href="#__codelineno-0-1888"><span class="linenos" data-linenos="1888 "></span></a>                                                <span class="n">new_idx</span><span class="p">,</span>
<a id="__codelineno-0-1889" name="__codelineno-0-1889"></a><a href="#__codelineno-0-1889"><span class="linenos" data-linenos="1889 "></span></a>                                            <span class="p">)</span>
<a id="__codelineno-0-1890" name="__codelineno-0-1890"></a><a href="#__codelineno-0-1890"><span class="linenos" data-linenos="1890 "></span></a>                        <span class="k">elif</span> <span class="n">video_matcher</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">SHAPE</span><span class="p">:</span>
<a id="__codelineno-0-1891" name="__codelineno-0-1891"></a><a href="#__codelineno-0-1891"><span class="linenos" data-linenos="1891 "></span></a>                            <span class="c1"># Merge videos with same shape</span>
<a id="__codelineno-0-1892" name="__codelineno-0-1892"></a><a href="#__codelineno-0-1892"><span class="linenos" data-linenos="1892 "></span></a>                            <span class="n">merged_video</span> <span class="o">=</span> <span class="n">self_video</span><span class="o">.</span><span class="n">merge_with</span><span class="p">(</span><span class="n">other_video</span><span class="p">)</span>
<a id="__codelineno-0-1893" name="__codelineno-0-1893"></a><a href="#__codelineno-0-1893"><span class="linenos" data-linenos="1893 "></span></a>                            <span class="c1"># Replace self_video with merged version</span>
<a id="__codelineno-0-1894" name="__codelineno-0-1894"></a><a href="#__codelineno-0-1894"><span class="linenos" data-linenos="1894 "></span></a>                            <span class="n">self_video_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">self_video</span><span class="p">)</span>
<a id="__codelineno-0-1895" name="__codelineno-0-1895"></a><a href="#__codelineno-0-1895"><span class="linenos" data-linenos="1895 "></span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="p">[</span><span class="n">self_video_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_video</span>
<a id="__codelineno-0-1896" name="__codelineno-0-1896"></a><a href="#__codelineno-0-1896"><span class="linenos" data-linenos="1896 "></span></a>                            <span class="n">video_map</span><span class="p">[</span><span class="n">other_video</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_video</span>
<a id="__codelineno-0-1897" name="__codelineno-0-1897"></a><a href="#__codelineno-0-1897"><span class="linenos" data-linenos="1897 "></span></a>                            <span class="n">video_map</span><span class="p">[</span><span class="n">self_video</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1898" name="__codelineno-0-1898"></a><a href="#__codelineno-0-1898"><span class="linenos" data-linenos="1898 "></span></a>                                <span class="n">merged_video</span>  <span class="c1"># Update mapping for self too</span>
<a id="__codelineno-0-1899" name="__codelineno-0-1899"></a><a href="#__codelineno-0-1899"><span class="linenos" data-linenos="1899 "></span></a>                            <span class="p">)</span>
<a id="__codelineno-0-1900" name="__codelineno-0-1900"></a><a href="#__codelineno-0-1900"><span class="linenos" data-linenos="1900 "></span></a>                            <span class="c1"># Build frame index mapping</span>
<a id="__codelineno-0-1901" name="__codelineno-0-1901"></a><a href="#__codelineno-0-1901"><span class="linenos" data-linenos="1901 "></span></a>                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other_video</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-1902" name="__codelineno-0-1902"></a><a href="#__codelineno-0-1902"><span class="linenos" data-linenos="1902 "></span></a>                                <span class="n">merged_video</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="nb">list</span>
<a id="__codelineno-0-1903" name="__codelineno-0-1903"></a><a href="#__codelineno-0-1903"><span class="linenos" data-linenos="1903 "></span></a>                            <span class="p">):</span>
<a id="__codelineno-0-1904" name="__codelineno-0-1904"></a><a href="#__codelineno-0-1904"><span class="linenos" data-linenos="1904 "></span></a>                                <span class="n">other_basenames</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1905" name="__codelineno-0-1905"></a><a href="#__codelineno-0-1905"><span class="linenos" data-linenos="1905 "></span></a>                                    <span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">other_video</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-1906" name="__codelineno-0-1906"></a><a href="#__codelineno-0-1906"><span class="linenos" data-linenos="1906 "></span></a>                                <span class="p">]</span>
<a id="__codelineno-0-1907" name="__codelineno-0-1907"></a><a href="#__codelineno-0-1907"><span class="linenos" data-linenos="1907 "></span></a>                                <span class="n">merged_basenames</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1908" name="__codelineno-0-1908"></a><a href="#__codelineno-0-1908"><span class="linenos" data-linenos="1908 "></span></a>                                    <span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">merged_video</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-1909" name="__codelineno-0-1909"></a><a href="#__codelineno-0-1909"><span class="linenos" data-linenos="1909 "></span></a>                                <span class="p">]</span>
<a id="__codelineno-0-1910" name="__codelineno-0-1910"></a><a href="#__codelineno-0-1910"><span class="linenos" data-linenos="1910 "></span></a>                                <span class="k">for</span> <span class="n">old_idx</span><span class="p">,</span> <span class="n">basename</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">other_basenames</span><span class="p">):</span>
<a id="__codelineno-0-1911" name="__codelineno-0-1911"></a><a href="#__codelineno-0-1911"><span class="linenos" data-linenos="1911 "></span></a>                                    <span class="k">if</span> <span class="n">basename</span> <span class="ow">in</span> <span class="n">merged_basenames</span><span class="p">:</span>
<a id="__codelineno-0-1912" name="__codelineno-0-1912"></a><a href="#__codelineno-0-1912"><span class="linenos" data-linenos="1912 "></span></a>                                        <span class="n">new_idx</span> <span class="o">=</span> <span class="n">merged_basenames</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">basename</span><span class="p">)</span>
<a id="__codelineno-0-1913" name="__codelineno-0-1913"></a><a href="#__codelineno-0-1913"><span class="linenos" data-linenos="1913 "></span></a>                                        <span class="n">frame_idx_map</span><span class="p">[(</span><span class="n">other_video</span><span class="p">,</span> <span class="n">old_idx</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1914" name="__codelineno-0-1914"></a><a href="#__codelineno-0-1914"><span class="linenos" data-linenos="1914 "></span></a>                                            <span class="n">merged_video</span><span class="p">,</span>
<a id="__codelineno-0-1915" name="__codelineno-0-1915"></a><a href="#__codelineno-0-1915"><span class="linenos" data-linenos="1915 "></span></a>                                            <span class="n">new_idx</span><span class="p">,</span>
<a id="__codelineno-0-1916" name="__codelineno-0-1916"></a><a href="#__codelineno-0-1916"><span class="linenos" data-linenos="1916 "></span></a>                                        <span class="p">)</span>
<a id="__codelineno-0-1917" name="__codelineno-0-1917"></a><a href="#__codelineno-0-1917"><span class="linenos" data-linenos="1917 "></span></a>                        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1918" name="__codelineno-0-1918"></a><a href="#__codelineno-0-1918"><span class="linenos" data-linenos="1918 "></span></a>                            <span class="c1"># Regular matching, no special handling</span>
<a id="__codelineno-0-1919" name="__codelineno-0-1919"></a><a href="#__codelineno-0-1919"><span class="linenos" data-linenos="1919 "></span></a>                            <span class="n">video_map</span><span class="p">[</span><span class="n">other_video</span><span class="p">]</span> <span class="o">=</span> <span class="n">self_video</span>
<a id="__codelineno-0-1920" name="__codelineno-0-1920"></a><a href="#__codelineno-0-1920"><span class="linenos" data-linenos="1920 "></span></a>                        <span class="n">matched</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1921" name="__codelineno-0-1921"></a><a href="#__codelineno-0-1921"><span class="linenos" data-linenos="1921 "></span></a>                        <span class="k">break</span>
<a id="__codelineno-0-1922" name="__codelineno-0-1922"></a><a href="#__codelineno-0-1922"><span class="linenos" data-linenos="1922 "></span></a>
<a id="__codelineno-0-1923" name="__codelineno-0-1923"></a><a href="#__codelineno-0-1923"><span class="linenos" data-linenos="1923 "></span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">matched</span><span class="p">:</span>
<a id="__codelineno-0-1924" name="__codelineno-0-1924"></a><a href="#__codelineno-0-1924"><span class="linenos" data-linenos="1924 "></span></a>                <span class="c1"># Add new video if no match</span>
<a id="__codelineno-0-1925" name="__codelineno-0-1925"></a><a href="#__codelineno-0-1925"><span class="linenos" data-linenos="1925 "></span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">videos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">other_video</span><span class="p">)</span>
<a id="__codelineno-0-1926" name="__codelineno-0-1926"></a><a href="#__codelineno-0-1926"><span class="linenos" data-linenos="1926 "></span></a>                <span class="n">video_map</span><span class="p">[</span><span class="n">other_video</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_video</span>
<a id="__codelineno-0-1927" name="__codelineno-0-1927"></a><a href="#__codelineno-0-1927"><span class="linenos" data-linenos="1927 "></span></a>
<a id="__codelineno-0-1928" name="__codelineno-0-1928"></a><a href="#__codelineno-0-1928"><span class="linenos" data-linenos="1928 "></span></a>        <span class="c1"># Step 3: Match and merge tracks</span>
<a id="__codelineno-0-1929" name="__codelineno-0-1929"></a><a href="#__codelineno-0-1929"><span class="linenos" data-linenos="1929 "></span></a>        <span class="n">track_map</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1930" name="__codelineno-0-1930"></a><a href="#__codelineno-0-1930"><span class="linenos" data-linenos="1930 "></span></a>        <span class="k">for</span> <span class="n">other_track</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">tracks</span><span class="p">:</span>
<a id="__codelineno-0-1931" name="__codelineno-0-1931"></a><a href="#__codelineno-0-1931"><span class="linenos" data-linenos="1931 "></span></a>            <span class="n">matched</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1932" name="__codelineno-0-1932"></a><a href="#__codelineno-0-1932"><span class="linenos" data-linenos="1932 "></span></a>            <span class="k">for</span> <span class="n">self_track</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tracks</span><span class="p">:</span>
<a id="__codelineno-0-1933" name="__codelineno-0-1933"></a><a href="#__codelineno-0-1933"><span class="linenos" data-linenos="1933 "></span></a>                <span class="k">if</span> <span class="n">track_matcher</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">self_track</span><span class="p">,</span> <span class="n">other_track</span><span class="p">):</span>
<a id="__codelineno-0-1934" name="__codelineno-0-1934"></a><a href="#__codelineno-0-1934"><span class="linenos" data-linenos="1934 "></span></a>                    <span class="n">track_map</span><span class="p">[</span><span class="n">other_track</span><span class="p">]</span> <span class="o">=</span> <span class="n">self_track</span>
<a id="__codelineno-0-1935" name="__codelineno-0-1935"></a><a href="#__codelineno-0-1935"><span class="linenos" data-linenos="1935 "></span></a>                    <span class="n">matched</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1936" name="__codelineno-0-1936"></a><a href="#__codelineno-0-1936"><span class="linenos" data-linenos="1936 "></span></a>                    <span class="k">break</span>
<a id="__codelineno-0-1937" name="__codelineno-0-1937"></a><a href="#__codelineno-0-1937"><span class="linenos" data-linenos="1937 "></span></a>
<a id="__codelineno-0-1938" name="__codelineno-0-1938"></a><a href="#__codelineno-0-1938"><span class="linenos" data-linenos="1938 "></span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">matched</span><span class="p">:</span>
<a id="__codelineno-0-1939" name="__codelineno-0-1939"></a><a href="#__codelineno-0-1939"><span class="linenos" data-linenos="1939 "></span></a>                <span class="c1"># Add new track if no match</span>
<a id="__codelineno-0-1940" name="__codelineno-0-1940"></a><a href="#__codelineno-0-1940"><span class="linenos" data-linenos="1940 "></span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">tracks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">other_track</span><span class="p">)</span>
<a id="__codelineno-0-1941" name="__codelineno-0-1941"></a><a href="#__codelineno-0-1941"><span class="linenos" data-linenos="1941 "></span></a>                <span class="n">track_map</span><span class="p">[</span><span class="n">other_track</span><span class="p">]</span> <span class="o">=</span> <span class="n">other_track</span>
<a id="__codelineno-0-1942" name="__codelineno-0-1942"></a><a href="#__codelineno-0-1942"><span class="linenos" data-linenos="1942 "></span></a>
<a id="__codelineno-0-1943" name="__codelineno-0-1943"></a><a href="#__codelineno-0-1943"><span class="linenos" data-linenos="1943 "></span></a>        <span class="c1"># Step 4: Merge frames</span>
<a id="__codelineno-0-1944" name="__codelineno-0-1944"></a><a href="#__codelineno-0-1944"><span class="linenos" data-linenos="1944 "></span></a>        <span class="n">total_frames</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">labeled_frames</span><span class="p">)</span>
<a id="__codelineno-0-1945" name="__codelineno-0-1945"></a><a href="#__codelineno-0-1945"><span class="linenos" data-linenos="1945 "></span></a>
<a id="__codelineno-0-1946" name="__codelineno-0-1946"></a><a href="#__codelineno-0-1946"><span class="linenos" data-linenos="1946 "></span></a>        <span class="k">for</span> <span class="n">frame_idx</span><span class="p">,</span> <span class="n">other_frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">labeled_frames</span><span class="p">):</span>
<a id="__codelineno-0-1947" name="__codelineno-0-1947"></a><a href="#__codelineno-0-1947"><span class="linenos" data-linenos="1947 "></span></a>            <span class="k">if</span> <span class="n">progress_callback</span><span class="p">:</span>
<a id="__codelineno-0-1948" name="__codelineno-0-1948"></a><a href="#__codelineno-0-1948"><span class="linenos" data-linenos="1948 "></span></a>                <span class="n">progress_callback</span><span class="p">(</span>
<a id="__codelineno-0-1949" name="__codelineno-0-1949"></a><a href="#__codelineno-0-1949"><span class="linenos" data-linenos="1949 "></span></a>                    <span class="n">frame_idx</span><span class="p">,</span>
<a id="__codelineno-0-1950" name="__codelineno-0-1950"></a><a href="#__codelineno-0-1950"><span class="linenos" data-linenos="1950 "></span></a>                    <span class="n">total_frames</span><span class="p">,</span>
<a id="__codelineno-0-1951" name="__codelineno-0-1951"></a><a href="#__codelineno-0-1951"><span class="linenos" data-linenos="1951 "></span></a>                    <span class="sa">f</span><span class="s2">&quot;Merging frame </span><span class="si">{</span><span class="n">frame_idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">total_frames</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1952" name="__codelineno-0-1952"></a><a href="#__codelineno-0-1952"><span class="linenos" data-linenos="1952 "></span></a>                <span class="p">)</span>
<a id="__codelineno-0-1953" name="__codelineno-0-1953"></a><a href="#__codelineno-0-1953"><span class="linenos" data-linenos="1953 "></span></a>
<a id="__codelineno-0-1954" name="__codelineno-0-1954"></a><a href="#__codelineno-0-1954"><span class="linenos" data-linenos="1954 "></span></a>            <span class="c1"># Check if frame index needs remapping (for deduplicated/merged videos)</span>
<a id="__codelineno-0-1955" name="__codelineno-0-1955"></a><a href="#__codelineno-0-1955"><span class="linenos" data-linenos="1955 "></span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">other_frame</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">other_frame</span><span class="o">.</span><span class="n">frame_idx</span><span class="p">)</span> <span class="ow">in</span> <span class="n">frame_idx_map</span><span class="p">:</span>
<a id="__codelineno-0-1956" name="__codelineno-0-1956"></a><a href="#__codelineno-0-1956"><span class="linenos" data-linenos="1956 "></span></a>                <span class="n">mapped_video</span><span class="p">,</span> <span class="n">mapped_frame_idx</span> <span class="o">=</span> <span class="n">frame_idx_map</span><span class="p">[</span>
<a id="__codelineno-0-1957" name="__codelineno-0-1957"></a><a href="#__codelineno-0-1957"><span class="linenos" data-linenos="1957 "></span></a>                    <span class="p">(</span><span class="n">other_frame</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">other_frame</span><span class="o">.</span><span class="n">frame_idx</span><span class="p">)</span>
<a id="__codelineno-0-1958" name="__codelineno-0-1958"></a><a href="#__codelineno-0-1958"><span class="linenos" data-linenos="1958 "></span></a>                <span class="p">]</span>
<a id="__codelineno-0-1959" name="__codelineno-0-1959"></a><a href="#__codelineno-0-1959"><span class="linenos" data-linenos="1959 "></span></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1960" name="__codelineno-0-1960"></a><a href="#__codelineno-0-1960"><span class="linenos" data-linenos="1960 "></span></a>                <span class="c1"># Map video to self</span>
<a id="__codelineno-0-1961" name="__codelineno-0-1961"></a><a href="#__codelineno-0-1961"><span class="linenos" data-linenos="1961 "></span></a>                <span class="n">mapped_video</span> <span class="o">=</span> <span class="n">video_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">other_frame</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">other_frame</span><span class="o">.</span><span class="n">video</span><span class="p">)</span>
<a id="__codelineno-0-1962" name="__codelineno-0-1962"></a><a href="#__codelineno-0-1962"><span class="linenos" data-linenos="1962 "></span></a>                <span class="n">mapped_frame_idx</span> <span class="o">=</span> <span class="n">other_frame</span><span class="o">.</span><span class="n">frame_idx</span>
<a id="__codelineno-0-1963" name="__codelineno-0-1963"></a><a href="#__codelineno-0-1963"><span class="linenos" data-linenos="1963 "></span></a>
<a id="__codelineno-0-1964" name="__codelineno-0-1964"></a><a href="#__codelineno-0-1964"><span class="linenos" data-linenos="1964 "></span></a>            <span class="c1"># Find matching frame in self</span>
<a id="__codelineno-0-1965" name="__codelineno-0-1965"></a><a href="#__codelineno-0-1965"><span class="linenos" data-linenos="1965 "></span></a>            <span class="n">matching_frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">mapped_video</span><span class="p">,</span> <span class="n">mapped_frame_idx</span><span class="p">)</span>
<a id="__codelineno-0-1966" name="__codelineno-0-1966"></a><a href="#__codelineno-0-1966"><span class="linenos" data-linenos="1966 "></span></a>
<a id="__codelineno-0-1967" name="__codelineno-0-1967"></a><a href="#__codelineno-0-1967"><span class="linenos" data-linenos="1967 "></span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matching_frames</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1968" name="__codelineno-0-1968"></a><a href="#__codelineno-0-1968"><span class="linenos" data-linenos="1968 "></span></a>                <span class="c1"># No matching frame, create new one</span>
<a id="__codelineno-0-1969" name="__codelineno-0-1969"></a><a href="#__codelineno-0-1969"><span class="linenos" data-linenos="1969 "></span></a>                <span class="n">new_frame</span> <span class="o">=</span> <span class="n">LabeledFrame</span><span class="p">(</span>
<a id="__codelineno-0-1970" name="__codelineno-0-1970"></a><a href="#__codelineno-0-1970"><span class="linenos" data-linenos="1970 "></span></a>                    <span class="n">video</span><span class="o">=</span><span class="n">mapped_video</span><span class="p">,</span>
<a id="__codelineno-0-1971" name="__codelineno-0-1971"></a><a href="#__codelineno-0-1971"><span class="linenos" data-linenos="1971 "></span></a>                    <span class="n">frame_idx</span><span class="o">=</span><span class="n">mapped_frame_idx</span><span class="p">,</span>
<a id="__codelineno-0-1972" name="__codelineno-0-1972"></a><a href="#__codelineno-0-1972"><span class="linenos" data-linenos="1972 "></span></a>                    <span class="n">instances</span><span class="o">=</span><span class="p">[],</span>
<a id="__codelineno-0-1973" name="__codelineno-0-1973"></a><a href="#__codelineno-0-1973"><span class="linenos" data-linenos="1973 "></span></a>                <span class="p">)</span>
<a id="__codelineno-0-1974" name="__codelineno-0-1974"></a><a href="#__codelineno-0-1974"><span class="linenos" data-linenos="1974 "></span></a>
<a id="__codelineno-0-1975" name="__codelineno-0-1975"></a><a href="#__codelineno-0-1975"><span class="linenos" data-linenos="1975 "></span></a>                <span class="c1"># Map instances to new skeleton/track</span>
<a id="__codelineno-0-1976" name="__codelineno-0-1976"></a><a href="#__codelineno-0-1976"><span class="linenos" data-linenos="1976 "></span></a>                <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">other_frame</span><span class="o">.</span><span class="n">instances</span><span class="p">:</span>
<a id="__codelineno-0-1977" name="__codelineno-0-1977"></a><a href="#__codelineno-0-1977"><span class="linenos" data-linenos="1977 "></span></a>                    <span class="n">new_inst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map_instance</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">skeleton_map</span><span class="p">,</span> <span class="n">track_map</span><span class="p">)</span>
<a id="__codelineno-0-1978" name="__codelineno-0-1978"></a><a href="#__codelineno-0-1978"><span class="linenos" data-linenos="1978 "></span></a>                    <span class="n">new_frame</span><span class="o">.</span><span class="n">instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_inst</span><span class="p">)</span>
<a id="__codelineno-0-1979" name="__codelineno-0-1979"></a><a href="#__codelineno-0-1979"><span class="linenos" data-linenos="1979 "></span></a>                    <span class="n">result</span><span class="o">.</span><span class="n">instances_added</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-1980" name="__codelineno-0-1980"></a><a href="#__codelineno-0-1980"><span class="linenos" data-linenos="1980 "></span></a>
<a id="__codelineno-0-1981" name="__codelineno-0-1981"></a><a href="#__codelineno-0-1981"><span class="linenos" data-linenos="1981 "></span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_frame</span><span class="p">)</span>
<a id="__codelineno-0-1982" name="__codelineno-0-1982"></a><a href="#__codelineno-0-1982"><span class="linenos" data-linenos="1982 "></span></a>                <span class="n">result</span><span class="o">.</span><span class="n">frames_merged</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-1983" name="__codelineno-0-1983"></a><a href="#__codelineno-0-1983"><span class="linenos" data-linenos="1983 "></span></a>
<a id="__codelineno-0-1984" name="__codelineno-0-1984"></a><a href="#__codelineno-0-1984"><span class="linenos" data-linenos="1984 "></span></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1985" name="__codelineno-0-1985"></a><a href="#__codelineno-0-1985"><span class="linenos" data-linenos="1985 "></span></a>                <span class="c1"># Merge into existing frame</span>
<a id="__codelineno-0-1986" name="__codelineno-0-1986"></a><a href="#__codelineno-0-1986"><span class="linenos" data-linenos="1986 "></span></a>                <span class="n">self_frame</span> <span class="o">=</span> <span class="n">matching_frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1987" name="__codelineno-0-1987"></a><a href="#__codelineno-0-1987"><span class="linenos" data-linenos="1987 "></span></a>
<a id="__codelineno-0-1988" name="__codelineno-0-1988"></a><a href="#__codelineno-0-1988"><span class="linenos" data-linenos="1988 "></span></a>                <span class="c1"># Merge instances using frame-level merge</span>
<a id="__codelineno-0-1989" name="__codelineno-0-1989"></a><a href="#__codelineno-0-1989"><span class="linenos" data-linenos="1989 "></span></a>                <span class="n">merged_instances</span><span class="p">,</span> <span class="n">conflicts</span> <span class="o">=</span> <span class="n">self_frame</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
<a id="__codelineno-0-1990" name="__codelineno-0-1990"></a><a href="#__codelineno-0-1990"><span class="linenos" data-linenos="1990 "></span></a>                    <span class="n">other_frame</span><span class="p">,</span>
<a id="__codelineno-0-1991" name="__codelineno-0-1991"></a><a href="#__codelineno-0-1991"><span class="linenos" data-linenos="1991 "></span></a>                    <span class="n">instance_matcher</span><span class="o">=</span><span class="n">instance_matcher</span><span class="p">,</span>
<a id="__codelineno-0-1992" name="__codelineno-0-1992"></a><a href="#__codelineno-0-1992"><span class="linenos" data-linenos="1992 "></span></a>                    <span class="n">strategy</span><span class="o">=</span><span class="n">frame_strategy</span><span class="p">,</span>
<a id="__codelineno-0-1993" name="__codelineno-0-1993"></a><a href="#__codelineno-0-1993"><span class="linenos" data-linenos="1993 "></span></a>                <span class="p">)</span>
<a id="__codelineno-0-1994" name="__codelineno-0-1994"></a><a href="#__codelineno-0-1994"><span class="linenos" data-linenos="1994 "></span></a>
<a id="__codelineno-0-1995" name="__codelineno-0-1995"></a><a href="#__codelineno-0-1995"><span class="linenos" data-linenos="1995 "></span></a>                <span class="c1"># Remap skeleton and track references for instances from other frame</span>
<a id="__codelineno-0-1996" name="__codelineno-0-1996"></a><a href="#__codelineno-0-1996"><span class="linenos" data-linenos="1996 "></span></a>                <span class="n">remapped_instances</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1997" name="__codelineno-0-1997"></a><a href="#__codelineno-0-1997"><span class="linenos" data-linenos="1997 "></span></a>                <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">merged_instances</span><span class="p">:</span>
<a id="__codelineno-0-1998" name="__codelineno-0-1998"></a><a href="#__codelineno-0-1998"><span class="linenos" data-linenos="1998 "></span></a>                    <span class="c1"># Check if instance needs remapping (from other_frame)</span>
<a id="__codelineno-0-1999" name="__codelineno-0-1999"></a><a href="#__codelineno-0-1999"><span class="linenos" data-linenos="1999 "></span></a>                    <span class="k">if</span> <span class="n">inst</span><span class="o">.</span><span class="n">skeleton</span> <span class="ow">in</span> <span class="n">skeleton_map</span><span class="p">:</span>
<a id="__codelineno-0-2000" name="__codelineno-0-2000"></a><a href="#__codelineno-0-2000"><span class="linenos" data-linenos="2000 "></span></a>                        <span class="c1"># Instance needs remapping</span>
<a id="__codelineno-0-2001" name="__codelineno-0-2001"></a><a href="#__codelineno-0-2001"><span class="linenos" data-linenos="2001 "></span></a>                        <span class="n">remapped_inst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map_instance</span><span class="p">(</span>
<a id="__codelineno-0-2002" name="__codelineno-0-2002"></a><a href="#__codelineno-0-2002"><span class="linenos" data-linenos="2002 "></span></a>                            <span class="n">inst</span><span class="p">,</span> <span class="n">skeleton_map</span><span class="p">,</span> <span class="n">track_map</span>
<a id="__codelineno-0-2003" name="__codelineno-0-2003"></a><a href="#__codelineno-0-2003"><span class="linenos" data-linenos="2003 "></span></a>                        <span class="p">)</span>
<a id="__codelineno-0-2004" name="__codelineno-0-2004"></a><a href="#__codelineno-0-2004"><span class="linenos" data-linenos="2004 "></span></a>                        <span class="n">remapped_instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">remapped_inst</span><span class="p">)</span>
<a id="__codelineno-0-2005" name="__codelineno-0-2005"></a><a href="#__codelineno-0-2005"><span class="linenos" data-linenos="2005 "></span></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2006" name="__codelineno-0-2006"></a><a href="#__codelineno-0-2006"><span class="linenos" data-linenos="2006 "></span></a>                        <span class="c1"># Instance already has correct skeleton (from self_frame)</span>
<a id="__codelineno-0-2007" name="__codelineno-0-2007"></a><a href="#__codelineno-0-2007"><span class="linenos" data-linenos="2007 "></span></a>                        <span class="n">remapped_instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>
<a id="__codelineno-0-2008" name="__codelineno-0-2008"></a><a href="#__codelineno-0-2008"><span class="linenos" data-linenos="2008 "></span></a>                <span class="n">merged_instances</span> <span class="o">=</span> <span class="n">remapped_instances</span>
<a id="__codelineno-0-2009" name="__codelineno-0-2009"></a><a href="#__codelineno-0-2009"><span class="linenos" data-linenos="2009 "></span></a>
<a id="__codelineno-0-2010" name="__codelineno-0-2010"></a><a href="#__codelineno-0-2010"><span class="linenos" data-linenos="2010 "></span></a>                <span class="c1"># Count changes</span>
<a id="__codelineno-0-2011" name="__codelineno-0-2011"></a><a href="#__codelineno-0-2011"><span class="linenos" data-linenos="2011 "></span></a>                <span class="n">n_before</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">self_frame</span><span class="o">.</span><span class="n">instances</span><span class="p">)</span>
<a id="__codelineno-0-2012" name="__codelineno-0-2012"></a><a href="#__codelineno-0-2012"><span class="linenos" data-linenos="2012 "></span></a>                <span class="n">n_after</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">merged_instances</span><span class="p">)</span>
<a id="__codelineno-0-2013" name="__codelineno-0-2013"></a><a href="#__codelineno-0-2013"><span class="linenos" data-linenos="2013 "></span></a>                <span class="n">result</span><span class="o">.</span><span class="n">instances_added</span> <span class="o">+=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_after</span> <span class="o">-</span> <span class="n">n_before</span><span class="p">)</span>
<a id="__codelineno-0-2014" name="__codelineno-0-2014"></a><a href="#__codelineno-0-2014"><span class="linenos" data-linenos="2014 "></span></a>
<a id="__codelineno-0-2015" name="__codelineno-0-2015"></a><a href="#__codelineno-0-2015"><span class="linenos" data-linenos="2015 "></span></a>                <span class="c1"># Record conflicts</span>
<a id="__codelineno-0-2016" name="__codelineno-0-2016"></a><a href="#__codelineno-0-2016"><span class="linenos" data-linenos="2016 "></span></a>                <span class="k">for</span> <span class="n">orig</span><span class="p">,</span> <span class="n">new</span><span class="p">,</span> <span class="n">resolution</span> <span class="ow">in</span> <span class="n">conflicts</span><span class="p">:</span>
<a id="__codelineno-0-2017" name="__codelineno-0-2017"></a><a href="#__codelineno-0-2017"><span class="linenos" data-linenos="2017 "></span></a>                    <span class="n">result</span><span class="o">.</span><span class="n">conflicts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-2018" name="__codelineno-0-2018"></a><a href="#__codelineno-0-2018"><span class="linenos" data-linenos="2018 "></span></a>                        <span class="n">ConflictResolution</span><span class="p">(</span>
<a id="__codelineno-0-2019" name="__codelineno-0-2019"></a><a href="#__codelineno-0-2019"><span class="linenos" data-linenos="2019 "></span></a>                            <span class="n">frame</span><span class="o">=</span><span class="n">self_frame</span><span class="p">,</span>
<a id="__codelineno-0-2020" name="__codelineno-0-2020"></a><a href="#__codelineno-0-2020"><span class="linenos" data-linenos="2020 "></span></a>                            <span class="n">conflict_type</span><span class="o">=</span><span class="s2">&quot;instance_conflict&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2021" name="__codelineno-0-2021"></a><a href="#__codelineno-0-2021"><span class="linenos" data-linenos="2021 "></span></a>                            <span class="n">original_data</span><span class="o">=</span><span class="n">orig</span><span class="p">,</span>
<a id="__codelineno-0-2022" name="__codelineno-0-2022"></a><a href="#__codelineno-0-2022"><span class="linenos" data-linenos="2022 "></span></a>                            <span class="n">new_data</span><span class="o">=</span><span class="n">new</span><span class="p">,</span>
<a id="__codelineno-0-2023" name="__codelineno-0-2023"></a><a href="#__codelineno-0-2023"><span class="linenos" data-linenos="2023 "></span></a>                            <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">,</span>
<a id="__codelineno-0-2024" name="__codelineno-0-2024"></a><a href="#__codelineno-0-2024"><span class="linenos" data-linenos="2024 "></span></a>                        <span class="p">)</span>
<a id="__codelineno-0-2025" name="__codelineno-0-2025"></a><a href="#__codelineno-0-2025"><span class="linenos" data-linenos="2025 "></span></a>                    <span class="p">)</span>
<a id="__codelineno-0-2026" name="__codelineno-0-2026"></a><a href="#__codelineno-0-2026"><span class="linenos" data-linenos="2026 "></span></a>
<a id="__codelineno-0-2027" name="__codelineno-0-2027"></a><a href="#__codelineno-0-2027"><span class="linenos" data-linenos="2027 "></span></a>                <span class="c1"># Update frame instances</span>
<a id="__codelineno-0-2028" name="__codelineno-0-2028"></a><a href="#__codelineno-0-2028"><span class="linenos" data-linenos="2028 "></span></a>                <span class="n">self_frame</span><span class="o">.</span><span class="n">instances</span> <span class="o">=</span> <span class="n">merged_instances</span>
<a id="__codelineno-0-2029" name="__codelineno-0-2029"></a><a href="#__codelineno-0-2029"><span class="linenos" data-linenos="2029 "></span></a>                <span class="n">result</span><span class="o">.</span><span class="n">frames_merged</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-2030" name="__codelineno-0-2030"></a><a href="#__codelineno-0-2030"><span class="linenos" data-linenos="2030 "></span></a>
<a id="__codelineno-0-2031" name="__codelineno-0-2031"></a><a href="#__codelineno-0-2031"><span class="linenos" data-linenos="2031 "></span></a>        <span class="c1"># Step 5: Merge suggestions</span>
<a id="__codelineno-0-2032" name="__codelineno-0-2032"></a><a href="#__codelineno-0-2032"><span class="linenos" data-linenos="2032 "></span></a>        <span class="k">for</span> <span class="n">other_suggestion</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">suggestions</span><span class="p">:</span>
<a id="__codelineno-0-2033" name="__codelineno-0-2033"></a><a href="#__codelineno-0-2033"><span class="linenos" data-linenos="2033 "></span></a>            <span class="n">mapped_video</span> <span class="o">=</span> <span class="n">video_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<a id="__codelineno-0-2034" name="__codelineno-0-2034"></a><a href="#__codelineno-0-2034"><span class="linenos" data-linenos="2034 "></span></a>                <span class="n">other_suggestion</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">other_suggestion</span><span class="o">.</span><span class="n">video</span>
<a id="__codelineno-0-2035" name="__codelineno-0-2035"></a><a href="#__codelineno-0-2035"><span class="linenos" data-linenos="2035 "></span></a>            <span class="p">)</span>
<a id="__codelineno-0-2036" name="__codelineno-0-2036"></a><a href="#__codelineno-0-2036"><span class="linenos" data-linenos="2036 "></span></a>            <span class="c1"># Check if suggestion already exists</span>
<a id="__codelineno-0-2037" name="__codelineno-0-2037"></a><a href="#__codelineno-0-2037"><span class="linenos" data-linenos="2037 "></span></a>            <span class="n">exists</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-2038" name="__codelineno-0-2038"></a><a href="#__codelineno-0-2038"><span class="linenos" data-linenos="2038 "></span></a>            <span class="k">for</span> <span class="n">self_suggestion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">suggestions</span><span class="p">:</span>
<a id="__codelineno-0-2039" name="__codelineno-0-2039"></a><a href="#__codelineno-0-2039"><span class="linenos" data-linenos="2039 "></span></a>                <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-2040" name="__codelineno-0-2040"></a><a href="#__codelineno-0-2040"><span class="linenos" data-linenos="2040 "></span></a>                    <span class="n">self_suggestion</span><span class="o">.</span><span class="n">video</span> <span class="o">==</span> <span class="n">mapped_video</span>
<a id="__codelineno-0-2041" name="__codelineno-0-2041"></a><a href="#__codelineno-0-2041"><span class="linenos" data-linenos="2041 "></span></a>                    <span class="ow">and</span> <span class="n">self_suggestion</span><span class="o">.</span><span class="n">frame_idx</span> <span class="o">==</span> <span class="n">other_suggestion</span><span class="o">.</span><span class="n">frame_idx</span>
<a id="__codelineno-0-2042" name="__codelineno-0-2042"></a><a href="#__codelineno-0-2042"><span class="linenos" data-linenos="2042 "></span></a>                <span class="p">):</span>
<a id="__codelineno-0-2043" name="__codelineno-0-2043"></a><a href="#__codelineno-0-2043"><span class="linenos" data-linenos="2043 "></span></a>                    <span class="n">exists</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-2044" name="__codelineno-0-2044"></a><a href="#__codelineno-0-2044"><span class="linenos" data-linenos="2044 "></span></a>                    <span class="k">break</span>
<a id="__codelineno-0-2045" name="__codelineno-0-2045"></a><a href="#__codelineno-0-2045"><span class="linenos" data-linenos="2045 "></span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">:</span>
<a id="__codelineno-0-2046" name="__codelineno-0-2046"></a><a href="#__codelineno-0-2046"><span class="linenos" data-linenos="2046 "></span></a>                <span class="c1"># Create new suggestion with mapped video</span>
<a id="__codelineno-0-2047" name="__codelineno-0-2047"></a><a href="#__codelineno-0-2047"><span class="linenos" data-linenos="2047 "></span></a>                <span class="n">new_suggestion</span> <span class="o">=</span> <span class="n">SuggestionFrame</span><span class="p">(</span>
<a id="__codelineno-0-2048" name="__codelineno-0-2048"></a><a href="#__codelineno-0-2048"><span class="linenos" data-linenos="2048 "></span></a>                    <span class="n">video</span><span class="o">=</span><span class="n">mapped_video</span><span class="p">,</span> <span class="n">frame_idx</span><span class="o">=</span><span class="n">other_suggestion</span><span class="o">.</span><span class="n">frame_idx</span>
<a id="__codelineno-0-2049" name="__codelineno-0-2049"></a><a href="#__codelineno-0-2049"><span class="linenos" data-linenos="2049 "></span></a>                <span class="p">)</span>
<a id="__codelineno-0-2050" name="__codelineno-0-2050"></a><a href="#__codelineno-0-2050"><span class="linenos" data-linenos="2050 "></span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">suggestions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_suggestion</span><span class="p">)</span>
<a id="__codelineno-0-2051" name="__codelineno-0-2051"></a><a href="#__codelineno-0-2051"><span class="linenos" data-linenos="2051 "></span></a>
<a id="__codelineno-0-2052" name="__codelineno-0-2052"></a><a href="#__codelineno-0-2052"><span class="linenos" data-linenos="2052 "></span></a>        <span class="c1"># Update merge record</span>
<a id="__codelineno-0-2053" name="__codelineno-0-2053"></a><a href="#__codelineno-0-2053"><span class="linenos" data-linenos="2053 "></span></a>        <span class="n">merge_record</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-2054" name="__codelineno-0-2054"></a><a href="#__codelineno-0-2054"><span class="linenos" data-linenos="2054 "></span></a>            <span class="s2">&quot;frames_merged&quot;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">frames_merged</span><span class="p">,</span>
<a id="__codelineno-0-2055" name="__codelineno-0-2055"></a><a href="#__codelineno-0-2055"><span class="linenos" data-linenos="2055 "></span></a>            <span class="s2">&quot;instances_added&quot;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">instances_added</span><span class="p">,</span>
<a id="__codelineno-0-2056" name="__codelineno-0-2056"></a><a href="#__codelineno-0-2056"><span class="linenos" data-linenos="2056 "></span></a>            <span class="s2">&quot;conflicts&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">conflicts</span><span class="p">),</span>
<a id="__codelineno-0-2057" name="__codelineno-0-2057"></a><a href="#__codelineno-0-2057"><span class="linenos" data-linenos="2057 "></span></a>        <span class="p">}</span>
<a id="__codelineno-0-2058" name="__codelineno-0-2058"></a><a href="#__codelineno-0-2058"><span class="linenos" data-linenos="2058 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">provenance</span><span class="p">[</span><span class="s2">&quot;merge_history&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">merge_record</span><span class="p">)</span>
<a id="__codelineno-0-2059" name="__codelineno-0-2059"></a><a href="#__codelineno-0-2059"><span class="linenos" data-linenos="2059 "></span></a>
<a id="__codelineno-0-2060" name="__codelineno-0-2060"></a><a href="#__codelineno-0-2060"><span class="linenos" data-linenos="2060 "></span></a>    <span class="k">except</span> <span class="n">MergeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-2061" name="__codelineno-0-2061"></a><a href="#__codelineno-0-2061"><span class="linenos" data-linenos="2061 "></span></a>        <span class="n">result</span><span class="o">.</span><span class="n">successful</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-2062" name="__codelineno-0-2062"></a><a href="#__codelineno-0-2062"><span class="linenos" data-linenos="2062 "></span></a>        <span class="n">result</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-2063" name="__codelineno-0-2063"></a><a href="#__codelineno-0-2063"><span class="linenos" data-linenos="2063 "></span></a>        <span class="k">if</span> <span class="n">error_mode_enum</span> <span class="o">==</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">STRICT</span><span class="p">:</span>
<a id="__codelineno-0-2064" name="__codelineno-0-2064"></a><a href="#__codelineno-0-2064"><span class="linenos" data-linenos="2064 "></span></a>            <span class="k">raise</span>
<a id="__codelineno-0-2065" name="__codelineno-0-2065"></a><a href="#__codelineno-0-2065"><span class="linenos" data-linenos="2065 "></span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-2066" name="__codelineno-0-2066"></a><a href="#__codelineno-0-2066"><span class="linenos" data-linenos="2066 "></span></a>        <span class="n">result</span><span class="o">.</span><span class="n">successful</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-2067" name="__codelineno-0-2067"></a><a href="#__codelineno-0-2067"><span class="linenos" data-linenos="2067 "></span></a>        <span class="n">result</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-2068" name="__codelineno-0-2068"></a><a href="#__codelineno-0-2068"><span class="linenos" data-linenos="2068 "></span></a>            <span class="n">MergeError</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;exception&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">})</span>
<a id="__codelineno-0-2069" name="__codelineno-0-2069"></a><a href="#__codelineno-0-2069"><span class="linenos" data-linenos="2069 "></span></a>        <span class="p">)</span>
<a id="__codelineno-0-2070" name="__codelineno-0-2070"></a><a href="#__codelineno-0-2070"><span class="linenos" data-linenos="2070 "></span></a>        <span class="k">if</span> <span class="n">error_mode_enum</span> <span class="o">==</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">STRICT</span><span class="p">:</span>
<a id="__codelineno-0-2071" name="__codelineno-0-2071"></a><a href="#__codelineno-0-2071"><span class="linenos" data-linenos="2071 "></span></a>            <span class="k">raise</span>
<a id="__codelineno-0-2072" name="__codelineno-0-2072"></a><a href="#__codelineno-0-2072"><span class="linenos" data-linenos="2072 "></span></a>
<a id="__codelineno-0-2073" name="__codelineno-0-2073"></a><a href="#__codelineno-0-2073"><span class="linenos" data-linenos="2073 "></span></a>    <span class="k">if</span> <span class="n">progress_callback</span><span class="p">:</span>
<a id="__codelineno-0-2074" name="__codelineno-0-2074"></a><a href="#__codelineno-0-2074"><span class="linenos" data-linenos="2074 "></span></a>        <span class="n">progress_callback</span><span class="p">(</span><span class="n">total_frames</span><span class="p">,</span> <span class="n">total_frames</span><span class="p">,</span> <span class="s2">&quot;Merge complete&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2075" name="__codelineno-0-2075"></a><a href="#__codelineno-0-2075"><span class="linenos" data-linenos="2075 "></span></a>
<a id="__codelineno-0-2076" name="__codelineno-0-2076"></a><a href="#__codelineno-0-2076"><span class="linenos" data-linenos="2076 "></span></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
            </details>
    </div>

</div><h3 id="enums">Enums<a class="headerlink" href="#enums" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.SkeletonMatchMethod" class="doc doc-heading">
            <code>sleap_io.model.matching.SkeletonMatchMethod</code>


<a href="#sleap_io.model.matching.SkeletonMatchMethod" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="str">str</span></code>, <code><span title="enum.Enum">Enum</span></code></p>


        <p>Methods for matching skeletons.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatchMethod.EXACT">EXACT</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exact match requiring same nodes in the same order.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatchMethod.STRUCTURE">STRUCTURE</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Match requiring same nodes and edges, but order doesn't matter.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatchMethod.OVERLAP">OVERLAP</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Partial match based on overlapping nodes (uses Jaccard similarity).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatchMethod.SUBSET">SUBSET</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Match if one skeleton's nodes are a subset of another's.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>













              <details class="quote">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-32" name="__codelineno-0-32"></a><a href="#__codelineno-0-32"><span class="linenos" data-linenos="32 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">SkeletonMatchMethod</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><a href="#__codelineno-0-33"><span class="linenos" data-linenos="33 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Methods for matching skeletons.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><a href="#__codelineno-0-34"><span class="linenos" data-linenos="34 "></span></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><a href="#__codelineno-0-35"><span class="linenos" data-linenos="35 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><a href="#__codelineno-0-36"><span class="linenos" data-linenos="36 "></span></a><span class="sd">        EXACT: Exact match requiring same nodes in the same order.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><a href="#__codelineno-0-37"><span class="linenos" data-linenos="37 "></span></a><span class="sd">        STRUCTURE: Match requiring same nodes and edges, but order doesn&#39;t matter.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><a href="#__codelineno-0-38"><span class="linenos" data-linenos="38 "></span></a><span class="sd">        OVERLAP: Partial match based on overlapping nodes (uses Jaccard similarity).</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><a href="#__codelineno-0-39"><span class="linenos" data-linenos="39 "></span></a><span class="sd">        SUBSET: Match if one skeleton&#39;s nodes are a subset of another&#39;s.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><a href="#__codelineno-0-40"><span class="linenos" data-linenos="40 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><a href="#__codelineno-0-41"><span class="linenos" data-linenos="41 "></span></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><a href="#__codelineno-0-42"><span class="linenos" data-linenos="42 "></span></a>    <span class="n">EXACT</span> <span class="o">=</span> <span class="s2">&quot;exact&quot;</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><a href="#__codelineno-0-43"><span class="linenos" data-linenos="43 "></span></a>    <span class="n">STRUCTURE</span> <span class="o">=</span> <span class="s2">&quot;structure&quot;</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><a href="#__codelineno-0-44"><span class="linenos" data-linenos="44 "></span></a>    <span class="n">OVERLAP</span> <span class="o">=</span> <span class="s2">&quot;overlap&quot;</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><a href="#__codelineno-0-45"><span class="linenos" data-linenos="45 "></span></a>    <span class="n">SUBSET</span> <span class="o">=</span> <span class="s2">&quot;subset&quot;</span>
</code></pre></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.InstanceMatchMethod" class="doc doc-heading">
            <code>sleap_io.model.matching.InstanceMatchMethod</code>


<a href="#sleap_io.model.matching.InstanceMatchMethod" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="str">str</span></code>, <code><span title="enum.Enum">Enum</span></code></p>


        <p>Methods for matching instances.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatchMethod.SPATIAL">SPATIAL</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Match instances by spatial proximity using Euclidean distance.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatchMethod.IDENTITY">IDENTITY</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Match instances by track identity (same track object).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatchMethod.IOU">IOU</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Match instances by bounding box Intersection over Union.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>













              <details class="quote">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-48" name="__codelineno-0-48"></a><a href="#__codelineno-0-48"><span class="linenos" data-linenos="48 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">InstanceMatchMethod</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><a href="#__codelineno-0-49"><span class="linenos" data-linenos="49 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Methods for matching instances.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><a href="#__codelineno-0-50"><span class="linenos" data-linenos="50 "></span></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><a href="#__codelineno-0-51"><span class="linenos" data-linenos="51 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><a href="#__codelineno-0-52"><span class="linenos" data-linenos="52 "></span></a><span class="sd">        SPATIAL: Match instances by spatial proximity using Euclidean distance.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><a href="#__codelineno-0-53"><span class="linenos" data-linenos="53 "></span></a><span class="sd">        IDENTITY: Match instances by track identity (same track object).</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><a href="#__codelineno-0-54"><span class="linenos" data-linenos="54 "></span></a><span class="sd">        IOU: Match instances by bounding box Intersection over Union.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><a href="#__codelineno-0-55"><span class="linenos" data-linenos="55 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><a href="#__codelineno-0-56"><span class="linenos" data-linenos="56 "></span></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><a href="#__codelineno-0-57"><span class="linenos" data-linenos="57 "></span></a>    <span class="n">SPATIAL</span> <span class="o">=</span> <span class="s2">&quot;spatial&quot;</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><a href="#__codelineno-0-58"><span class="linenos" data-linenos="58 "></span></a>    <span class="n">IDENTITY</span> <span class="o">=</span> <span class="s2">&quot;identity&quot;</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><a href="#__codelineno-0-59"><span class="linenos" data-linenos="59 "></span></a>    <span class="n">IOU</span> <span class="o">=</span> <span class="s2">&quot;iou&quot;</span>
</code></pre></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.TrackMatchMethod" class="doc doc-heading">
            <code>sleap_io.model.matching.TrackMatchMethod</code>


<a href="#sleap_io.model.matching.TrackMatchMethod" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="str">str</span></code>, <code><span title="enum.Enum">Enum</span></code></p>


        <p>Methods for matching tracks.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatchMethod.NAME">NAME</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Match tracks by their name attribute.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatchMethod.IDENTITY">IDENTITY</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Match tracks by object identity (same Python object).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>













              <details class="quote">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-62" name="__codelineno-0-62"></a><a href="#__codelineno-0-62"><span class="linenos" data-linenos="62 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">TrackMatchMethod</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><a href="#__codelineno-0-63"><span class="linenos" data-linenos="63 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Methods for matching tracks.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><a href="#__codelineno-0-64"><span class="linenos" data-linenos="64 "></span></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><a href="#__codelineno-0-65"><span class="linenos" data-linenos="65 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><a href="#__codelineno-0-66"><span class="linenos" data-linenos="66 "></span></a><span class="sd">        NAME: Match tracks by their name attribute.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><a href="#__codelineno-0-67"><span class="linenos" data-linenos="67 "></span></a><span class="sd">        IDENTITY: Match tracks by object identity (same Python object).</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><a href="#__codelineno-0-68"><span class="linenos" data-linenos="68 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><a href="#__codelineno-0-69"><span class="linenos" data-linenos="69 "></span></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><a href="#__codelineno-0-70"><span class="linenos" data-linenos="70 "></span></a>    <span class="n">NAME</span> <span class="o">=</span> <span class="s2">&quot;name&quot;</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><a href="#__codelineno-0-71"><span class="linenos" data-linenos="71 "></span></a>    <span class="n">IDENTITY</span> <span class="o">=</span> <span class="s2">&quot;identity&quot;</span>
</code></pre></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.VideoMatchMethod" class="doc doc-heading">
            <code>sleap_io.model.matching.VideoMatchMethod</code>


<a href="#sleap_io.model.matching.VideoMatchMethod" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="str">str</span></code>, <code><span title="enum.Enum">Enum</span></code></p>


        <p>Methods for matching videos.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatchMethod.PATH">PATH</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Match by exact file path (strict or lenient based on
VideoMatcher.strict setting).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatchMethod.BASENAME">BASENAME</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Match by filename only, ignoring directory paths.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatchMethod.CONTENT">CONTENT</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Match by video shape (frames, height, width, channels) and
backend type.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatchMethod.AUTO">AUTO</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Automatic matching - tries BASENAME first, then falls back to CONTENT.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatchMethod.IMAGE_DEDUP">IMAGE_DEDUP</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(ImageVideo only) Match ImageVideo instances with overlapping
image files. Used to deduplicate individual images when merging datasets
where videos are image sequences.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatchMethod.SHAPE">SHAPE</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Match videos by shape only (height, width, channels), ignoring
filenames and frame count. Commonly used with ImageVideo to merge
same-shaped image sequences.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>













              <details class="quote">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-74" name="__codelineno-0-74"></a><a href="#__codelineno-0-74"><span class="linenos" data-linenos="74 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">VideoMatchMethod</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><a href="#__codelineno-0-75"><span class="linenos" data-linenos="75 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Methods for matching videos.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><a href="#__codelineno-0-76"><span class="linenos" data-linenos="76 "></span></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><a href="#__codelineno-0-77"><span class="linenos" data-linenos="77 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><a href="#__codelineno-0-78"><span class="linenos" data-linenos="78 "></span></a><span class="sd">        PATH: Match by exact file path (strict or lenient based on</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><a href="#__codelineno-0-79"><span class="linenos" data-linenos="79 "></span></a><span class="sd">            VideoMatcher.strict setting).</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><a href="#__codelineno-0-80"><span class="linenos" data-linenos="80 "></span></a><span class="sd">        BASENAME: Match by filename only, ignoring directory paths.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><a href="#__codelineno-0-81"><span class="linenos" data-linenos="81 "></span></a><span class="sd">        CONTENT: Match by video shape (frames, height, width, channels) and</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><a href="#__codelineno-0-82"><span class="linenos" data-linenos="82 "></span></a><span class="sd">            backend type.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><a href="#__codelineno-0-83"><span class="linenos" data-linenos="83 "></span></a><span class="sd">        AUTO: Automatic matching - tries BASENAME first, then falls back to CONTENT.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><a href="#__codelineno-0-84"><span class="linenos" data-linenos="84 "></span></a><span class="sd">        IMAGE_DEDUP: (ImageVideo only) Match ImageVideo instances with overlapping</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><a href="#__codelineno-0-85"><span class="linenos" data-linenos="85 "></span></a><span class="sd">            image files. Used to deduplicate individual images when merging datasets</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><a href="#__codelineno-0-86"><span class="linenos" data-linenos="86 "></span></a><span class="sd">            where videos are image sequences.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><a href="#__codelineno-0-87"><span class="linenos" data-linenos="87 "></span></a><span class="sd">        SHAPE: Match videos by shape only (height, width, channels), ignoring</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><a href="#__codelineno-0-88"><span class="linenos" data-linenos="88 "></span></a><span class="sd">            filenames and frame count. Commonly used with ImageVideo to merge</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><a href="#__codelineno-0-89"><span class="linenos" data-linenos="89 "></span></a><span class="sd">            same-shaped image sequences.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><a href="#__codelineno-0-90"><span class="linenos" data-linenos="90 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><a href="#__codelineno-0-91"><span class="linenos" data-linenos="91 "></span></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><a href="#__codelineno-0-92"><span class="linenos" data-linenos="92 "></span></a>    <span class="n">PATH</span> <span class="o">=</span> <span class="s2">&quot;path&quot;</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><a href="#__codelineno-0-93"><span class="linenos" data-linenos="93 "></span></a>    <span class="n">BASENAME</span> <span class="o">=</span> <span class="s2">&quot;basename&quot;</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><a href="#__codelineno-0-94"><span class="linenos" data-linenos="94 "></span></a>    <span class="n">CONTENT</span> <span class="o">=</span> <span class="s2">&quot;content&quot;</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><a href="#__codelineno-0-95"><span class="linenos" data-linenos="95 "></span></a>    <span class="n">AUTO</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><a href="#__codelineno-0-96"><span class="linenos" data-linenos="96 "></span></a>    <span class="n">IMAGE_DEDUP</span> <span class="o">=</span> <span class="s2">&quot;image_dedup&quot;</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><a href="#__codelineno-0-97"><span class="linenos" data-linenos="97 "></span></a>    <span class="n">SHAPE</span> <span class="o">=</span> <span class="s2">&quot;shape&quot;</span>
</code></pre></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.FrameStrategy" class="doc doc-heading">
            <code>sleap_io.model.matching.FrameStrategy</code>


<a href="#sleap_io.model.matching.FrameStrategy" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="str">str</span></code>, <code><span title="enum.Enum">Enum</span></code></p>


        <p>Strategies for handling frame merging.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.SMART">SMART</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Smart merging that preserves user labels over predictions when
they overlap.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_ORIGINAL">KEEP_ORIGINAL</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always keep instances from the original (base) frame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_NEW">KEEP_NEW</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always keep instances from the new (incoming) frame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameStrategy.KEEP_BOTH">KEEP_BOTH</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keep all instances from both frames without filtering.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>













              <details class="quote">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-100" name="__codelineno-0-100"></a><a href="#__codelineno-0-100"><span class="linenos" data-linenos="100 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">FrameStrategy</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><a href="#__codelineno-0-101"><span class="linenos" data-linenos="101 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Strategies for handling frame merging.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><a href="#__codelineno-0-102"><span class="linenos" data-linenos="102 "></span></a>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><a href="#__codelineno-0-103"><span class="linenos" data-linenos="103 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><a href="#__codelineno-0-104"><span class="linenos" data-linenos="104 "></span></a><span class="sd">        SMART: Smart merging that preserves user labels over predictions when</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><a href="#__codelineno-0-105"><span class="linenos" data-linenos="105 "></span></a><span class="sd">            they overlap.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><a href="#__codelineno-0-106"><span class="linenos" data-linenos="106 "></span></a><span class="sd">        KEEP_ORIGINAL: Always keep instances from the original (base) frame.</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><a href="#__codelineno-0-107"><span class="linenos" data-linenos="107 "></span></a><span class="sd">        KEEP_NEW: Always keep instances from the new (incoming) frame.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><a href="#__codelineno-0-108"><span class="linenos" data-linenos="108 "></span></a><span class="sd">        KEEP_BOTH: Keep all instances from both frames without filtering.</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><a href="#__codelineno-0-109"><span class="linenos" data-linenos="109 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><a href="#__codelineno-0-110"><span class="linenos" data-linenos="110 "></span></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><a href="#__codelineno-0-111"><span class="linenos" data-linenos="111 "></span></a>    <span class="n">SMART</span> <span class="o">=</span> <span class="s2">&quot;smart&quot;</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><a href="#__codelineno-0-112"><span class="linenos" data-linenos="112 "></span></a>    <span class="n">KEEP_ORIGINAL</span> <span class="o">=</span> <span class="s2">&quot;keep_original&quot;</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><a href="#__codelineno-0-113"><span class="linenos" data-linenos="113 "></span></a>    <span class="n">KEEP_NEW</span> <span class="o">=</span> <span class="s2">&quot;keep_new&quot;</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><a href="#__codelineno-0-114"><span class="linenos" data-linenos="114 "></span></a>    <span class="n">KEEP_BOTH</span> <span class="o">=</span> <span class="s2">&quot;keep_both&quot;</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><a href="#__codelineno-0-115"><span class="linenos" data-linenos="115 "></span></a>    <span class="n">UPDATE_TRACKS</span> <span class="o">=</span> <span class="s2">&quot;update_tracks&quot;</span>
</code></pre></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.ErrorMode" class="doc doc-heading">
            <code>sleap_io.model.matching.ErrorMode</code>


<a href="#sleap_io.model.matching.ErrorMode" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="str">str</span></code>, <code><span title="enum.Enum">Enum</span></code></p>


        <p>Error handling modes for merge operations.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.ErrorMode.CONTINUE">CONTINUE</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Continue merging on errors, collecting them in the result.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.ErrorMode.STRICT">STRICT</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raise an exception on the first error encountered.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.ErrorMode.WARN">WARN</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Issue warnings about errors but continue merging.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>













              <details class="quote">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-118" name="__codelineno-0-118"></a><a href="#__codelineno-0-118"><span class="linenos" data-linenos="118 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">ErrorMode</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><a href="#__codelineno-0-119"><span class="linenos" data-linenos="119 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Error handling modes for merge operations.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><a href="#__codelineno-0-120"><span class="linenos" data-linenos="120 "></span></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><a href="#__codelineno-0-121"><span class="linenos" data-linenos="121 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><a href="#__codelineno-0-122"><span class="linenos" data-linenos="122 "></span></a><span class="sd">        CONTINUE: Continue merging on errors, collecting them in the result.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><a href="#__codelineno-0-123"><span class="linenos" data-linenos="123 "></span></a><span class="sd">        STRICT: Raise an exception on the first error encountered.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><a href="#__codelineno-0-124"><span class="linenos" data-linenos="124 "></span></a><span class="sd">        WARN: Issue warnings about errors but continue merging.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><a href="#__codelineno-0-125"><span class="linenos" data-linenos="125 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><a href="#__codelineno-0-126"><span class="linenos" data-linenos="126 "></span></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><a href="#__codelineno-0-127"><span class="linenos" data-linenos="127 "></span></a>    <span class="n">CONTINUE</span> <span class="o">=</span> <span class="s2">&quot;continue&quot;</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><a href="#__codelineno-0-128"><span class="linenos" data-linenos="128 "></span></a>    <span class="n">STRICT</span> <span class="o">=</span> <span class="s2">&quot;strict&quot;</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><a href="#__codelineno-0-129"><span class="linenos" data-linenos="129 "></span></a>    <span class="n">WARN</span> <span class="o">=</span> <span class="s2">&quot;warn&quot;</span>
</code></pre></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div><h3 id="matcher-classes">Matcher classes<a class="headerlink" href="#matcher-classes" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.SkeletonMatcher" class="doc doc-heading">
            <code>sleap_io.model.matching.SkeletonMatcher</code>


<a href="#sleap_io.model.matching.SkeletonMatcher" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">


        <p>Matcher for comparing and matching skeletons.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.method">method</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;sleap_io.model.matching.SkeletonMatchMethod&lt;/code&gt;" href="#sleap_io.model.matching.SkeletonMatchMethod">SkeletonMatchMethod</a>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matching method to use. Can be a SkeletonMatchMethod enum value
or a string that will be converted to the enum. Default is STRUCTURE.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.require_same_order">require_same_order</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to require nodes in the same order for STRUCTURE
matching. Only used when method is STRUCTURE. Default is False.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.SkeletonMatcher.min_overlap">min_overlap</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum Jaccard similarity required for OVERLAP matching.
Only used when method is OVERLAP. Default is 0.5.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>












<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;k&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skeleton1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;skeleton2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.SkeletonMatcher.match&lt;/code&gt;)" href="#sleap_io.model.matching.SkeletonMatcher.match">match</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Check if two skeletons match according to the configured method.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



              <details class="quote">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-132" name="__codelineno-0-132"></a><a href="#__codelineno-0-132"><span class="linenos" data-linenos="132 "></span></a><span class="nd">@attrs</span><span class="o">.</span><span class="n">define</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><a href="#__codelineno-0-133"><span class="linenos" data-linenos="133 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">SkeletonMatcher</span><span class="p">:</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><a href="#__codelineno-0-134"><span class="linenos" data-linenos="134 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Matcher for comparing and matching skeletons.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><a href="#__codelineno-0-135"><span class="linenos" data-linenos="135 "></span></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><a href="#__codelineno-0-136"><span class="linenos" data-linenos="136 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><a href="#__codelineno-0-137"><span class="linenos" data-linenos="137 "></span></a><span class="sd">        method: The matching method to use. Can be a SkeletonMatchMethod enum value</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><a href="#__codelineno-0-138"><span class="linenos" data-linenos="138 "></span></a><span class="sd">            or a string that will be converted to the enum. Default is STRUCTURE.</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><a href="#__codelineno-0-139"><span class="linenos" data-linenos="139 "></span></a><span class="sd">        require_same_order: Whether to require nodes in the same order for STRUCTURE</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><a href="#__codelineno-0-140"><span class="linenos" data-linenos="140 "></span></a><span class="sd">            matching. Only used when method is STRUCTURE. Default is False.</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><a href="#__codelineno-0-141"><span class="linenos" data-linenos="141 "></span></a><span class="sd">        min_overlap: Minimum Jaccard similarity required for OVERLAP matching.</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><a href="#__codelineno-0-142"><span class="linenos" data-linenos="142 "></span></a><span class="sd">            Only used when method is OVERLAP. Default is 0.5.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><a href="#__codelineno-0-143"><span class="linenos" data-linenos="143 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><a href="#__codelineno-0-144"><span class="linenos" data-linenos="144 "></span></a>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><a href="#__codelineno-0-145"><span class="linenos" data-linenos="145 "></span></a>    <span class="n">method</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SkeletonMatchMethod</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">field</span><span class="p">(</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><a href="#__codelineno-0-146"><span class="linenos" data-linenos="146 "></span></a>        <span class="n">default</span><span class="o">=</span><span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">STRUCTURE</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><a href="#__codelineno-0-147"><span class="linenos" data-linenos="147 "></span></a>        <span class="n">converter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">SkeletonMatchMethod</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><a href="#__codelineno-0-148"><span class="linenos" data-linenos="148 "></span></a>    <span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><a href="#__codelineno-0-149"><span class="linenos" data-linenos="149 "></span></a>    <span class="n">require_same_order</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><a href="#__codelineno-0-150"><span class="linenos" data-linenos="150 "></span></a>    <span class="n">min_overlap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><a href="#__codelineno-0-151"><span class="linenos" data-linenos="151 "></span></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><a href="#__codelineno-0-152"><span class="linenos" data-linenos="152 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skeleton1</span><span class="p">:</span> <span class="n">Skeleton</span><span class="p">,</span> <span class="n">skeleton2</span><span class="p">:</span> <span class="n">Skeleton</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><a href="#__codelineno-0-153"><span class="linenos" data-linenos="153 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two skeletons match according to the configured method.&quot;&quot;&quot;</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><a href="#__codelineno-0-154"><span class="linenos" data-linenos="154 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">EXACT</span><span class="p">:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><a href="#__codelineno-0-155"><span class="linenos" data-linenos="155 "></span></a>            <span class="k">return</span> <span class="n">skeleton1</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">skeleton2</span><span class="p">,</span> <span class="n">require_same_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><a href="#__codelineno-0-156"><span class="linenos" data-linenos="156 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">STRUCTURE</span><span class="p">:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><a href="#__codelineno-0-157"><span class="linenos" data-linenos="157 "></span></a>            <span class="k">return</span> <span class="n">skeleton1</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><a href="#__codelineno-0-158"><span class="linenos" data-linenos="158 "></span></a>                <span class="n">skeleton2</span><span class="p">,</span> <span class="n">require_same_order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">require_same_order</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><a href="#__codelineno-0-159"><span class="linenos" data-linenos="159 "></span></a>            <span class="p">)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><a href="#__codelineno-0-160"><span class="linenos" data-linenos="160 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">OVERLAP</span><span class="p">:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><a href="#__codelineno-0-161"><span class="linenos" data-linenos="161 "></span></a>            <span class="n">metrics</span> <span class="o">=</span> <span class="n">skeleton1</span><span class="o">.</span><span class="n">node_similarities</span><span class="p">(</span><span class="n">skeleton2</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><a href="#__codelineno-0-162"><span class="linenos" data-linenos="162 "></span></a>            <span class="k">return</span> <span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;jaccard&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_overlap</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><a href="#__codelineno-0-163"><span class="linenos" data-linenos="163 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">SUBSET</span><span class="p">:</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><a href="#__codelineno-0-164"><span class="linenos" data-linenos="164 "></span></a>            <span class="c1"># Check if skeleton1 nodes are subset of skeleton2</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><a href="#__codelineno-0-165"><span class="linenos" data-linenos="165 "></span></a>            <span class="n">nodes1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">skeleton1</span><span class="o">.</span><span class="n">node_names</span><span class="p">)</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><a href="#__codelineno-0-166"><span class="linenos" data-linenos="166 "></span></a>            <span class="n">nodes2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">skeleton2</span><span class="o">.</span><span class="n">node_names</span><span class="p">)</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><a href="#__codelineno-0-167"><span class="linenos" data-linenos="167 "></span></a>            <span class="k">return</span> <span class="n">nodes1</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">nodes2</span><span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><a href="#__codelineno-0-168"><span class="linenos" data-linenos="168 "></span></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><a href="#__codelineno-0-169"><span class="linenos" data-linenos="169 "></span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown skeleton match method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.SkeletonMatcher.match" class="doc doc-heading">
            <code class="highlight language-python"><span class="k">match</span><span class="p">(</span><span class="n">skeleton1</span><span class="p">,</span> <span class="n">skeleton2</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.SkeletonMatcher.match" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Check if two skeletons match according to the configured method.</p>


            <details class="quote">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-152" name="__codelineno-0-152"></a><a href="#__codelineno-0-152"><span class="linenos" data-linenos="152 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skeleton1</span><span class="p">:</span> <span class="n">Skeleton</span><span class="p">,</span> <span class="n">skeleton2</span><span class="p">:</span> <span class="n">Skeleton</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><a href="#__codelineno-0-153"><span class="linenos" data-linenos="153 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if two skeletons match according to the configured method.&quot;&quot;&quot;</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><a href="#__codelineno-0-154"><span class="linenos" data-linenos="154 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">EXACT</span><span class="p">:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><a href="#__codelineno-0-155"><span class="linenos" data-linenos="155 "></span></a>        <span class="k">return</span> <span class="n">skeleton1</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">skeleton2</span><span class="p">,</span> <span class="n">require_same_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><a href="#__codelineno-0-156"><span class="linenos" data-linenos="156 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">STRUCTURE</span><span class="p">:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><a href="#__codelineno-0-157"><span class="linenos" data-linenos="157 "></span></a>        <span class="k">return</span> <span class="n">skeleton1</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><a href="#__codelineno-0-158"><span class="linenos" data-linenos="158 "></span></a>            <span class="n">skeleton2</span><span class="p">,</span> <span class="n">require_same_order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">require_same_order</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><a href="#__codelineno-0-159"><span class="linenos" data-linenos="159 "></span></a>        <span class="p">)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><a href="#__codelineno-0-160"><span class="linenos" data-linenos="160 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">OVERLAP</span><span class="p">:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><a href="#__codelineno-0-161"><span class="linenos" data-linenos="161 "></span></a>        <span class="n">metrics</span> <span class="o">=</span> <span class="n">skeleton1</span><span class="o">.</span><span class="n">node_similarities</span><span class="p">(</span><span class="n">skeleton2</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><a href="#__codelineno-0-162"><span class="linenos" data-linenos="162 "></span></a>        <span class="k">return</span> <span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;jaccard&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_overlap</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><a href="#__codelineno-0-163"><span class="linenos" data-linenos="163 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">SUBSET</span><span class="p">:</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><a href="#__codelineno-0-164"><span class="linenos" data-linenos="164 "></span></a>        <span class="c1"># Check if skeleton1 nodes are subset of skeleton2</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><a href="#__codelineno-0-165"><span class="linenos" data-linenos="165 "></span></a>        <span class="n">nodes1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">skeleton1</span><span class="o">.</span><span class="n">node_names</span><span class="p">)</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><a href="#__codelineno-0-166"><span class="linenos" data-linenos="166 "></span></a>        <span class="n">nodes2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">skeleton2</span><span class="o">.</span><span class="n">node_names</span><span class="p">)</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><a href="#__codelineno-0-167"><span class="linenos" data-linenos="167 "></span></a>        <span class="k">return</span> <span class="n">nodes1</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">nodes2</span><span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><a href="#__codelineno-0-168"><span class="linenos" data-linenos="168 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><a href="#__codelineno-0-169"><span class="linenos" data-linenos="169 "></span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown skeleton match method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.InstanceMatcher" class="doc doc-heading">
            <code>sleap_io.model.matching.InstanceMatcher</code>


<a href="#sleap_io.model.matching.InstanceMatcher" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">


        <p>Matcher for comparing and matching instances.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.method">method</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;sleap_io.model.matching.InstanceMatchMethod&lt;/code&gt;" href="#sleap_io.model.matching.InstanceMatchMethod">InstanceMatchMethod</a>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matching method to use. Can be an InstanceMatchMethod enum value
or a string that will be converted to the enum. Default is SPATIAL.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.InstanceMatcher.threshold">threshold</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The threshold value used for matching. For SPATIAL method, this is
the maximum pixel distance. For IOU method, this is the minimum IoU value.
Not used for IDENTITY method. Default is 5.0.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>












<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;find_matches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instances1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instances2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.InstanceMatcher.find_matches&lt;/code&gt;)" href="#sleap_io.model.matching.InstanceMatcher.find_matches">find_matches</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Find all matching instances between two lists.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;k&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instance1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instance2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.InstanceMatcher.match&lt;/code&gt;)" href="#sleap_io.model.matching.InstanceMatcher.match">match</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Check if two instances match according to the configured method.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



              <details class="quote">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-172" name="__codelineno-0-172"></a><a href="#__codelineno-0-172"><span class="linenos" data-linenos="172 "></span></a><span class="nd">@attrs</span><span class="o">.</span><span class="n">define</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><a href="#__codelineno-0-173"><span class="linenos" data-linenos="173 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">InstanceMatcher</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><a href="#__codelineno-0-174"><span class="linenos" data-linenos="174 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Matcher for comparing and matching instances.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><a href="#__codelineno-0-175"><span class="linenos" data-linenos="175 "></span></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><a href="#__codelineno-0-176"><span class="linenos" data-linenos="176 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><a href="#__codelineno-0-177"><span class="linenos" data-linenos="177 "></span></a><span class="sd">        method: The matching method to use. Can be an InstanceMatchMethod enum value</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><a href="#__codelineno-0-178"><span class="linenos" data-linenos="178 "></span></a><span class="sd">            or a string that will be converted to the enum. Default is SPATIAL.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><a href="#__codelineno-0-179"><span class="linenos" data-linenos="179 "></span></a><span class="sd">        threshold: The threshold value used for matching. For SPATIAL method, this is</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><a href="#__codelineno-0-180"><span class="linenos" data-linenos="180 "></span></a><span class="sd">            the maximum pixel distance. For IOU method, this is the minimum IoU value.</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><a href="#__codelineno-0-181"><span class="linenos" data-linenos="181 "></span></a><span class="sd">            Not used for IDENTITY method. Default is 5.0.</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><a href="#__codelineno-0-182"><span class="linenos" data-linenos="182 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><a href="#__codelineno-0-183"><span class="linenos" data-linenos="183 "></span></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><a href="#__codelineno-0-184"><span class="linenos" data-linenos="184 "></span></a>    <span class="n">method</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">InstanceMatchMethod</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">field</span><span class="p">(</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><a href="#__codelineno-0-185"><span class="linenos" data-linenos="185 "></span></a>        <span class="n">default</span><span class="o">=</span><span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">SPATIAL</span><span class="p">,</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><a href="#__codelineno-0-186"><span class="linenos" data-linenos="186 "></span></a>        <span class="n">converter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">InstanceMatchMethod</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><a href="#__codelineno-0-187"><span class="linenos" data-linenos="187 "></span></a>    <span class="p">)</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><a href="#__codelineno-0-188"><span class="linenos" data-linenos="188 "></span></a>    <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><a href="#__codelineno-0-189"><span class="linenos" data-linenos="189 "></span></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><a href="#__codelineno-0-190"><span class="linenos" data-linenos="190 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance1</span><span class="p">:</span> <span class="n">Instance</span><span class="p">,</span> <span class="n">instance2</span><span class="p">:</span> <span class="n">Instance</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><a href="#__codelineno-0-191"><span class="linenos" data-linenos="191 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two instances match according to the configured method.&quot;&quot;&quot;</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><a href="#__codelineno-0-192"><span class="linenos" data-linenos="192 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">SPATIAL</span><span class="p">:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><a href="#__codelineno-0-193"><span class="linenos" data-linenos="193 "></span></a>            <span class="k">return</span> <span class="n">instance1</span><span class="o">.</span><span class="n">same_pose_as</span><span class="p">(</span><span class="n">instance2</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><a href="#__codelineno-0-194"><span class="linenos" data-linenos="194 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">IDENTITY</span><span class="p">:</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><a href="#__codelineno-0-195"><span class="linenos" data-linenos="195 "></span></a>            <span class="k">return</span> <span class="n">instance1</span><span class="o">.</span><span class="n">same_identity_as</span><span class="p">(</span><span class="n">instance2</span><span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><a href="#__codelineno-0-196"><span class="linenos" data-linenos="196 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">IOU</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><a href="#__codelineno-0-197"><span class="linenos" data-linenos="197 "></span></a>            <span class="k">return</span> <span class="n">instance1</span><span class="o">.</span><span class="n">overlaps_with</span><span class="p">(</span><span class="n">instance2</span><span class="p">,</span> <span class="n">iou_threshold</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><a href="#__codelineno-0-198"><span class="linenos" data-linenos="198 "></span></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><a href="#__codelineno-0-199"><span class="linenos" data-linenos="199 "></span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown instance match method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><a href="#__codelineno-0-200"><span class="linenos" data-linenos="200 "></span></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><a href="#__codelineno-0-201"><span class="linenos" data-linenos="201 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">find_matches</span><span class="p">(</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><a href="#__codelineno-0-202"><span class="linenos" data-linenos="202 "></span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">instances1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Instance</span><span class="p">],</span> <span class="n">instances2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Instance</span><span class="p">]</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><a href="#__codelineno-0-203"><span class="linenos" data-linenos="203 "></span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><a href="#__codelineno-0-204"><span class="linenos" data-linenos="204 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Find all matching instances between two lists.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><a href="#__codelineno-0-205"><span class="linenos" data-linenos="205 "></span></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><a href="#__codelineno-0-206"><span class="linenos" data-linenos="206 "></span></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><a href="#__codelineno-0-207"><span class="linenos" data-linenos="207 "></span></a><span class="sd">            List of (idx1, idx2, score) tuples for matching instances.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><a href="#__codelineno-0-208"><span class="linenos" data-linenos="208 "></span></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><a href="#__codelineno-0-209"><span class="linenos" data-linenos="209 "></span></a>        <span class="n">matches</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><a href="#__codelineno-0-210"><span class="linenos" data-linenos="210 "></span></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><a href="#__codelineno-0-211"><span class="linenos" data-linenos="211 "></span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">inst1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">instances1</span><span class="p">):</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><a href="#__codelineno-0-212"><span class="linenos" data-linenos="212 "></span></a>            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">inst2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">instances2</span><span class="p">):</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><a href="#__codelineno-0-213"><span class="linenos" data-linenos="213 "></span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">inst1</span><span class="p">,</span> <span class="n">inst2</span><span class="p">):</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><a href="#__codelineno-0-214"><span class="linenos" data-linenos="214 "></span></a>                    <span class="c1"># Calculate match score based on method</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><a href="#__codelineno-0-215"><span class="linenos" data-linenos="215 "></span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">SPATIAL</span><span class="p">:</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><a href="#__codelineno-0-216"><span class="linenos" data-linenos="216 "></span></a>                        <span class="c1"># Use inverse distance as score</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><a href="#__codelineno-0-217"><span class="linenos" data-linenos="217 "></span></a>                        <span class="n">pts1</span> <span class="o">=</span> <span class="n">inst1</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><a href="#__codelineno-0-218"><span class="linenos" data-linenos="218 "></span></a>                        <span class="n">pts2</span> <span class="o">=</span> <span class="n">inst2</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><a href="#__codelineno-0-219"><span class="linenos" data-linenos="219 "></span></a>                        <span class="n">valid</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pts1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pts2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><a href="#__codelineno-0-220"><span class="linenos" data-linenos="220 "></span></a>                        <span class="k">if</span> <span class="n">valid</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><a href="#__codelineno-0-221"><span class="linenos" data-linenos="221 "></span></a>                            <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><a href="#__codelineno-0-222"><span class="linenos" data-linenos="222 "></span></a>                                <span class="n">pts1</span><span class="p">[</span><span class="n">valid</span><span class="p">]</span> <span class="o">-</span> <span class="n">pts2</span><span class="p">[</span><span class="n">valid</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><a href="#__codelineno-0-223"><span class="linenos" data-linenos="223 "></span></a>                            <span class="p">)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><a href="#__codelineno-0-224"><span class="linenos" data-linenos="224 "></span></a>                            <span class="n">score</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">distances</span><span class="p">))</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><a href="#__codelineno-0-225"><span class="linenos" data-linenos="225 "></span></a>                        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><a href="#__codelineno-0-226"><span class="linenos" data-linenos="226 "></span></a>                            <span class="n">score</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><a href="#__codelineno-0-227"><span class="linenos" data-linenos="227 "></span></a>                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">IOU</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><a href="#__codelineno-0-228"><span class="linenos" data-linenos="228 "></span></a>                        <span class="c1"># Calculate actual IoU as score</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><a href="#__codelineno-0-229"><span class="linenos" data-linenos="229 "></span></a>                        <span class="n">bbox1</span> <span class="o">=</span> <span class="n">inst1</span><span class="o">.</span><span class="n">bounding_box</span><span class="p">()</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><a href="#__codelineno-0-230"><span class="linenos" data-linenos="230 "></span></a>                        <span class="n">bbox2</span> <span class="o">=</span> <span class="n">inst2</span><span class="o">.</span><span class="n">bounding_box</span><span class="p">()</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><a href="#__codelineno-0-231"><span class="linenos" data-linenos="231 "></span></a>                        <span class="k">if</span> <span class="n">bbox1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">bbox2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><a href="#__codelineno-0-232"><span class="linenos" data-linenos="232 "></span></a>                            <span class="c1"># Calculate IoU</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><a href="#__codelineno-0-233"><span class="linenos" data-linenos="233 "></span></a>                            <span class="n">intersection_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">bbox1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><a href="#__codelineno-0-234"><span class="linenos" data-linenos="234 "></span></a>                            <span class="n">intersection_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">bbox1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bbox2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><a href="#__codelineno-0-235"><span class="linenos" data-linenos="235 "></span></a>                            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">intersection_min</span> <span class="o">&lt;</span> <span class="n">intersection_max</span><span class="p">):</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><a href="#__codelineno-0-236"><span class="linenos" data-linenos="236 "></span></a>                                <span class="n">intersection_area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><a href="#__codelineno-0-237"><span class="linenos" data-linenos="237 "></span></a>                                    <span class="n">intersection_max</span> <span class="o">-</span> <span class="n">intersection_min</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><a href="#__codelineno-0-238"><span class="linenos" data-linenos="238 "></span></a>                                <span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><a href="#__codelineno-0-239"><span class="linenos" data-linenos="239 "></span></a>                                <span class="n">area1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">bbox1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><a href="#__codelineno-0-240"><span class="linenos" data-linenos="240 "></span></a>                                <span class="n">area2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">bbox2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><a href="#__codelineno-0-241"><span class="linenos" data-linenos="241 "></span></a>                                <span class="n">union_area</span> <span class="o">=</span> <span class="n">area1</span> <span class="o">+</span> <span class="n">area2</span> <span class="o">-</span> <span class="n">intersection_area</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><a href="#__codelineno-0-242"><span class="linenos" data-linenos="242 "></span></a>                                <span class="n">score</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><a href="#__codelineno-0-243"><span class="linenos" data-linenos="243 "></span></a>                                    <span class="n">intersection_area</span> <span class="o">/</span> <span class="n">union_area</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><a href="#__codelineno-0-244"><span class="linenos" data-linenos="244 "></span></a>                                    <span class="k">if</span> <span class="n">union_area</span> <span class="o">&gt;</span> <span class="mi">0</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><a href="#__codelineno-0-245"><span class="linenos" data-linenos="245 "></span></a>                                    <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><a href="#__codelineno-0-246"><span class="linenos" data-linenos="246 "></span></a>                                <span class="p">)</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><a href="#__codelineno-0-247"><span class="linenos" data-linenos="247 "></span></a>                            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><a href="#__codelineno-0-248"><span class="linenos" data-linenos="248 "></span></a>                                <span class="n">score</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><a href="#__codelineno-0-249"><span class="linenos" data-linenos="249 "></span></a>                        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><a href="#__codelineno-0-250"><span class="linenos" data-linenos="250 "></span></a>                            <span class="n">score</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><a href="#__codelineno-0-251"><span class="linenos" data-linenos="251 "></span></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><a href="#__codelineno-0-252"><span class="linenos" data-linenos="252 "></span></a>                        <span class="n">score</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Binary match for identity</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><a href="#__codelineno-0-253"><span class="linenos" data-linenos="253 "></span></a>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><a href="#__codelineno-0-254"><span class="linenos" data-linenos="254 "></span></a>                    <span class="n">matches</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">score</span><span class="p">))</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><a href="#__codelineno-0-255"><span class="linenos" data-linenos="255 "></span></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><a href="#__codelineno-0-256"><span class="linenos" data-linenos="256 "></span></a>        <span class="k">return</span> <span class="n">matches</span>
</code></pre></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.InstanceMatcher.find_matches" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_matches</span><span class="p">(</span><span class="n">instances1</span><span class="p">,</span> <span class="n">instances2</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.InstanceMatcher.find_matches" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Find all matching instances between two lists.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of (idx1, idx2, score) tuples for matching instances.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-201" name="__codelineno-0-201"></a><a href="#__codelineno-0-201"><span class="linenos" data-linenos="201 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">find_matches</span><span class="p">(</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><a href="#__codelineno-0-202"><span class="linenos" data-linenos="202 "></span></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">instances1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Instance</span><span class="p">],</span> <span class="n">instances2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Instance</span><span class="p">]</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><a href="#__codelineno-0-203"><span class="linenos" data-linenos="203 "></span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><a href="#__codelineno-0-204"><span class="linenos" data-linenos="204 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Find all matching instances between two lists.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><a href="#__codelineno-0-205"><span class="linenos" data-linenos="205 "></span></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><a href="#__codelineno-0-206"><span class="linenos" data-linenos="206 "></span></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><a href="#__codelineno-0-207"><span class="linenos" data-linenos="207 "></span></a><span class="sd">        List of (idx1, idx2, score) tuples for matching instances.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><a href="#__codelineno-0-208"><span class="linenos" data-linenos="208 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><a href="#__codelineno-0-209"><span class="linenos" data-linenos="209 "></span></a>    <span class="n">matches</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><a href="#__codelineno-0-210"><span class="linenos" data-linenos="210 "></span></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><a href="#__codelineno-0-211"><span class="linenos" data-linenos="211 "></span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">inst1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">instances1</span><span class="p">):</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><a href="#__codelineno-0-212"><span class="linenos" data-linenos="212 "></span></a>        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">inst2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">instances2</span><span class="p">):</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><a href="#__codelineno-0-213"><span class="linenos" data-linenos="213 "></span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">inst1</span><span class="p">,</span> <span class="n">inst2</span><span class="p">):</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><a href="#__codelineno-0-214"><span class="linenos" data-linenos="214 "></span></a>                <span class="c1"># Calculate match score based on method</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><a href="#__codelineno-0-215"><span class="linenos" data-linenos="215 "></span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">SPATIAL</span><span class="p">:</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><a href="#__codelineno-0-216"><span class="linenos" data-linenos="216 "></span></a>                    <span class="c1"># Use inverse distance as score</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><a href="#__codelineno-0-217"><span class="linenos" data-linenos="217 "></span></a>                    <span class="n">pts1</span> <span class="o">=</span> <span class="n">inst1</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><a href="#__codelineno-0-218"><span class="linenos" data-linenos="218 "></span></a>                    <span class="n">pts2</span> <span class="o">=</span> <span class="n">inst2</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><a href="#__codelineno-0-219"><span class="linenos" data-linenos="219 "></span></a>                    <span class="n">valid</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pts1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pts2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><a href="#__codelineno-0-220"><span class="linenos" data-linenos="220 "></span></a>                    <span class="k">if</span> <span class="n">valid</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><a href="#__codelineno-0-221"><span class="linenos" data-linenos="221 "></span></a>                        <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><a href="#__codelineno-0-222"><span class="linenos" data-linenos="222 "></span></a>                            <span class="n">pts1</span><span class="p">[</span><span class="n">valid</span><span class="p">]</span> <span class="o">-</span> <span class="n">pts2</span><span class="p">[</span><span class="n">valid</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><a href="#__codelineno-0-223"><span class="linenos" data-linenos="223 "></span></a>                        <span class="p">)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><a href="#__codelineno-0-224"><span class="linenos" data-linenos="224 "></span></a>                        <span class="n">score</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">distances</span><span class="p">))</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><a href="#__codelineno-0-225"><span class="linenos" data-linenos="225 "></span></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><a href="#__codelineno-0-226"><span class="linenos" data-linenos="226 "></span></a>                        <span class="n">score</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><a href="#__codelineno-0-227"><span class="linenos" data-linenos="227 "></span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">IOU</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><a href="#__codelineno-0-228"><span class="linenos" data-linenos="228 "></span></a>                    <span class="c1"># Calculate actual IoU as score</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><a href="#__codelineno-0-229"><span class="linenos" data-linenos="229 "></span></a>                    <span class="n">bbox1</span> <span class="o">=</span> <span class="n">inst1</span><span class="o">.</span><span class="n">bounding_box</span><span class="p">()</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><a href="#__codelineno-0-230"><span class="linenos" data-linenos="230 "></span></a>                    <span class="n">bbox2</span> <span class="o">=</span> <span class="n">inst2</span><span class="o">.</span><span class="n">bounding_box</span><span class="p">()</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><a href="#__codelineno-0-231"><span class="linenos" data-linenos="231 "></span></a>                    <span class="k">if</span> <span class="n">bbox1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">bbox2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><a href="#__codelineno-0-232"><span class="linenos" data-linenos="232 "></span></a>                        <span class="c1"># Calculate IoU</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><a href="#__codelineno-0-233"><span class="linenos" data-linenos="233 "></span></a>                        <span class="n">intersection_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">bbox1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><a href="#__codelineno-0-234"><span class="linenos" data-linenos="234 "></span></a>                        <span class="n">intersection_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">bbox1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bbox2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><a href="#__codelineno-0-235"><span class="linenos" data-linenos="235 "></span></a>                        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">intersection_min</span> <span class="o">&lt;</span> <span class="n">intersection_max</span><span class="p">):</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><a href="#__codelineno-0-236"><span class="linenos" data-linenos="236 "></span></a>                            <span class="n">intersection_area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><a href="#__codelineno-0-237"><span class="linenos" data-linenos="237 "></span></a>                                <span class="n">intersection_max</span> <span class="o">-</span> <span class="n">intersection_min</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><a href="#__codelineno-0-238"><span class="linenos" data-linenos="238 "></span></a>                            <span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><a href="#__codelineno-0-239"><span class="linenos" data-linenos="239 "></span></a>                            <span class="n">area1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">bbox1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><a href="#__codelineno-0-240"><span class="linenos" data-linenos="240 "></span></a>                            <span class="n">area2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">bbox2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><a href="#__codelineno-0-241"><span class="linenos" data-linenos="241 "></span></a>                            <span class="n">union_area</span> <span class="o">=</span> <span class="n">area1</span> <span class="o">+</span> <span class="n">area2</span> <span class="o">-</span> <span class="n">intersection_area</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><a href="#__codelineno-0-242"><span class="linenos" data-linenos="242 "></span></a>                            <span class="n">score</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><a href="#__codelineno-0-243"><span class="linenos" data-linenos="243 "></span></a>                                <span class="n">intersection_area</span> <span class="o">/</span> <span class="n">union_area</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><a href="#__codelineno-0-244"><span class="linenos" data-linenos="244 "></span></a>                                <span class="k">if</span> <span class="n">union_area</span> <span class="o">&gt;</span> <span class="mi">0</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><a href="#__codelineno-0-245"><span class="linenos" data-linenos="245 "></span></a>                                <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><a href="#__codelineno-0-246"><span class="linenos" data-linenos="246 "></span></a>                            <span class="p">)</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><a href="#__codelineno-0-247"><span class="linenos" data-linenos="247 "></span></a>                        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><a href="#__codelineno-0-248"><span class="linenos" data-linenos="248 "></span></a>                            <span class="n">score</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><a href="#__codelineno-0-249"><span class="linenos" data-linenos="249 "></span></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><a href="#__codelineno-0-250"><span class="linenos" data-linenos="250 "></span></a>                        <span class="n">score</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><a href="#__codelineno-0-251"><span class="linenos" data-linenos="251 "></span></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><a href="#__codelineno-0-252"><span class="linenos" data-linenos="252 "></span></a>                    <span class="n">score</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Binary match for identity</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><a href="#__codelineno-0-253"><span class="linenos" data-linenos="253 "></span></a>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><a href="#__codelineno-0-254"><span class="linenos" data-linenos="254 "></span></a>                <span class="n">matches</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">score</span><span class="p">))</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><a href="#__codelineno-0-255"><span class="linenos" data-linenos="255 "></span></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><a href="#__codelineno-0-256"><span class="linenos" data-linenos="256 "></span></a>    <span class="k">return</span> <span class="n">matches</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.InstanceMatcher.match" class="doc doc-heading">
            <code class="highlight language-python"><span class="k">match</span><span class="p">(</span><span class="n">instance1</span><span class="p">,</span> <span class="n">instance2</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.InstanceMatcher.match" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Check if two instances match according to the configured method.</p>


            <details class="quote">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-190" name="__codelineno-0-190"></a><a href="#__codelineno-0-190"><span class="linenos" data-linenos="190 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance1</span><span class="p">:</span> <span class="n">Instance</span><span class="p">,</span> <span class="n">instance2</span><span class="p">:</span> <span class="n">Instance</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><a href="#__codelineno-0-191"><span class="linenos" data-linenos="191 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if two instances match according to the configured method.&quot;&quot;&quot;</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><a href="#__codelineno-0-192"><span class="linenos" data-linenos="192 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">SPATIAL</span><span class="p">:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><a href="#__codelineno-0-193"><span class="linenos" data-linenos="193 "></span></a>        <span class="k">return</span> <span class="n">instance1</span><span class="o">.</span><span class="n">same_pose_as</span><span class="p">(</span><span class="n">instance2</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><a href="#__codelineno-0-194"><span class="linenos" data-linenos="194 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">IDENTITY</span><span class="p">:</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><a href="#__codelineno-0-195"><span class="linenos" data-linenos="195 "></span></a>        <span class="k">return</span> <span class="n">instance1</span><span class="o">.</span><span class="n">same_identity_as</span><span class="p">(</span><span class="n">instance2</span><span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><a href="#__codelineno-0-196"><span class="linenos" data-linenos="196 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">IOU</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><a href="#__codelineno-0-197"><span class="linenos" data-linenos="197 "></span></a>        <span class="k">return</span> <span class="n">instance1</span><span class="o">.</span><span class="n">overlaps_with</span><span class="p">(</span><span class="n">instance2</span><span class="p">,</span> <span class="n">iou_threshold</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><a href="#__codelineno-0-198"><span class="linenos" data-linenos="198 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><a href="#__codelineno-0-199"><span class="linenos" data-linenos="199 "></span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown instance match method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.TrackMatcher" class="doc doc-heading">
            <code>sleap_io.model.matching.TrackMatcher</code>


<a href="#sleap_io.model.matching.TrackMatcher" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">


        <p>Matcher for comparing and matching tracks.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.TrackMatcher.method">method</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;sleap_io.model.matching.TrackMatchMethod&lt;/code&gt;" href="#sleap_io.model.matching.TrackMatchMethod">TrackMatchMethod</a>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matching method to use. Can be a TrackMatchMethod enum value
or a string that will be converted to the enum. Default is NAME.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>












<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;k&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;track1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;track2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.TrackMatcher.match&lt;/code&gt;)" href="#sleap_io.model.matching.TrackMatcher.match">match</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Check if two tracks match according to the configured method.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



              <details class="quote">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-259" name="__codelineno-0-259"></a><a href="#__codelineno-0-259"><span class="linenos" data-linenos="259 "></span></a><span class="nd">@attrs</span><span class="o">.</span><span class="n">define</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><a href="#__codelineno-0-260"><span class="linenos" data-linenos="260 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">TrackMatcher</span><span class="p">:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><a href="#__codelineno-0-261"><span class="linenos" data-linenos="261 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Matcher for comparing and matching tracks.</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><a href="#__codelineno-0-262"><span class="linenos" data-linenos="262 "></span></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><a href="#__codelineno-0-263"><span class="linenos" data-linenos="263 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><a href="#__codelineno-0-264"><span class="linenos" data-linenos="264 "></span></a><span class="sd">        method: The matching method to use. Can be a TrackMatchMethod enum value</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><a href="#__codelineno-0-265"><span class="linenos" data-linenos="265 "></span></a><span class="sd">            or a string that will be converted to the enum. Default is NAME.</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><a href="#__codelineno-0-266"><span class="linenos" data-linenos="266 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><a href="#__codelineno-0-267"><span class="linenos" data-linenos="267 "></span></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><a href="#__codelineno-0-268"><span class="linenos" data-linenos="268 "></span></a>    <span class="n">method</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TrackMatchMethod</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">field</span><span class="p">(</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><a href="#__codelineno-0-269"><span class="linenos" data-linenos="269 "></span></a>        <span class="n">default</span><span class="o">=</span><span class="n">TrackMatchMethod</span><span class="o">.</span><span class="n">NAME</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><a href="#__codelineno-0-270"><span class="linenos" data-linenos="270 "></span></a>        <span class="n">converter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">TrackMatchMethod</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><a href="#__codelineno-0-271"><span class="linenos" data-linenos="271 "></span></a>    <span class="p">)</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><a href="#__codelineno-0-272"><span class="linenos" data-linenos="272 "></span></a>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><a href="#__codelineno-0-273"><span class="linenos" data-linenos="273 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track1</span><span class="p">:</span> <span class="n">Track</span><span class="p">,</span> <span class="n">track2</span><span class="p">:</span> <span class="n">Track</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><a href="#__codelineno-0-274"><span class="linenos" data-linenos="274 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two tracks match according to the configured method.&quot;&quot;&quot;</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><a href="#__codelineno-0-275"><span class="linenos" data-linenos="275 "></span></a>        <span class="k">return</span> <span class="n">track1</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">track2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</code></pre></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.TrackMatcher.match" class="doc doc-heading">
            <code class="highlight language-python"><span class="k">match</span><span class="p">(</span><span class="n">track1</span><span class="p">,</span> <span class="n">track2</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.TrackMatcher.match" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Check if two tracks match according to the configured method.</p>


            <details class="quote">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-273" name="__codelineno-0-273"></a><a href="#__codelineno-0-273"><span class="linenos" data-linenos="273 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track1</span><span class="p">:</span> <span class="n">Track</span><span class="p">,</span> <span class="n">track2</span><span class="p">:</span> <span class="n">Track</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><a href="#__codelineno-0-274"><span class="linenos" data-linenos="274 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if two tracks match according to the configured method.&quot;&quot;&quot;</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><a href="#__codelineno-0-275"><span class="linenos" data-linenos="275 "></span></a>    <span class="k">return</span> <span class="n">track1</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">track2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</code></pre></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.VideoMatcher" class="doc doc-heading">
            <code>sleap_io.model.matching.VideoMatcher</code>


<a href="#sleap_io.model.matching.VideoMatcher" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">


        <p>Matcher for comparing and matching videos.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.method">method</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;sleap_io.model.matching.VideoMatchMethod&lt;/code&gt;" href="#sleap_io.model.matching.VideoMatchMethod">VideoMatchMethod</a>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matching method to use. Can be a VideoMatchMethod enum value
or a string that will be converted to the enum. Default is AUTO.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.VideoMatcher.strict">strict</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use strict path matching for the PATH method.
When True, paths must be exactly identical. When False, paths
are normalized before comparison. Only used when method is PATH.
Default is False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>












<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;k&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;video1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;video2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.VideoMatcher.match&lt;/code&gt;)" href="#sleap_io.model.matching.VideoMatcher.match">match</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Check if two videos match according to the configured method.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



              <details class="quote">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-278" name="__codelineno-0-278"></a><a href="#__codelineno-0-278"><span class="linenos" data-linenos="278 "></span></a><span class="nd">@attrs</span><span class="o">.</span><span class="n">define</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><a href="#__codelineno-0-279"><span class="linenos" data-linenos="279 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">VideoMatcher</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><a href="#__codelineno-0-280"><span class="linenos" data-linenos="280 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Matcher for comparing and matching videos.</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><a href="#__codelineno-0-281"><span class="linenos" data-linenos="281 "></span></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><a href="#__codelineno-0-282"><span class="linenos" data-linenos="282 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><a href="#__codelineno-0-283"><span class="linenos" data-linenos="283 "></span></a><span class="sd">        method: The matching method to use. Can be a VideoMatchMethod enum value</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><a href="#__codelineno-0-284"><span class="linenos" data-linenos="284 "></span></a><span class="sd">            or a string that will be converted to the enum. Default is AUTO.</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><a href="#__codelineno-0-285"><span class="linenos" data-linenos="285 "></span></a><span class="sd">        strict: Whether to use strict path matching for the PATH method.</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><a href="#__codelineno-0-286"><span class="linenos" data-linenos="286 "></span></a><span class="sd">            When True, paths must be exactly identical. When False, paths</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><a href="#__codelineno-0-287"><span class="linenos" data-linenos="287 "></span></a><span class="sd">            are normalized before comparison. Only used when method is PATH.</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><a href="#__codelineno-0-288"><span class="linenos" data-linenos="288 "></span></a><span class="sd">            Default is False.</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><a href="#__codelineno-0-289"><span class="linenos" data-linenos="289 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><a href="#__codelineno-0-290"><span class="linenos" data-linenos="290 "></span></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><a href="#__codelineno-0-291"><span class="linenos" data-linenos="291 "></span></a>    <span class="n">method</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">VideoMatchMethod</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">field</span><span class="p">(</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><a href="#__codelineno-0-292"><span class="linenos" data-linenos="292 "></span></a>        <span class="n">default</span><span class="o">=</span><span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">AUTO</span><span class="p">,</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><a href="#__codelineno-0-293"><span class="linenos" data-linenos="293 "></span></a>        <span class="n">converter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">VideoMatchMethod</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><a href="#__codelineno-0-294"><span class="linenos" data-linenos="294 "></span></a>    <span class="p">)</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><a href="#__codelineno-0-295"><span class="linenos" data-linenos="295 "></span></a>    <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><a href="#__codelineno-0-296"><span class="linenos" data-linenos="296 "></span></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><a href="#__codelineno-0-297"><span class="linenos" data-linenos="297 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">video1</span><span class="p">:</span> <span class="n">Video</span><span class="p">,</span> <span class="n">video2</span><span class="p">:</span> <span class="n">Video</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><a href="#__codelineno-0-298"><span class="linenos" data-linenos="298 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two videos match according to the configured method.&quot;&quot;&quot;</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><a href="#__codelineno-0-299"><span class="linenos" data-linenos="299 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">AUTO</span><span class="p">:</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><a href="#__codelineno-0-300"><span class="linenos" data-linenos="300 "></span></a>            <span class="c1"># Try different methods in order of specificity (most to least specific).</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><a href="#__codelineno-0-301"><span class="linenos" data-linenos="301 "></span></a>            <span class="c1"># This prioritizes exact path matches, then basename matches, and only</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><a href="#__codelineno-0-302"><span class="linenos" data-linenos="302 "></span></a>            <span class="c1"># falls back to content matching (shape + backend) as a last resort.</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><a href="#__codelineno-0-303"><span class="linenos" data-linenos="303 "></span></a>            <span class="k">if</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">video2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><a href="#__codelineno-0-304"><span class="linenos" data-linenos="304 "></span></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><a href="#__codelineno-0-305"><span class="linenos" data-linenos="305 "></span></a>            <span class="k">if</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">video2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><a href="#__codelineno-0-306"><span class="linenos" data-linenos="306 "></span></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><a href="#__codelineno-0-307"><span class="linenos" data-linenos="307 "></span></a>            <span class="k">if</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_content</span><span class="p">(</span><span class="n">video2</span><span class="p">):</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><a href="#__codelineno-0-308"><span class="linenos" data-linenos="308 "></span></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><a href="#__codelineno-0-309"><span class="linenos" data-linenos="309 "></span></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><a href="#__codelineno-0-310"><span class="linenos" data-linenos="310 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">PATH</span><span class="p">:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><a href="#__codelineno-0-311"><span class="linenos" data-linenos="311 "></span></a>            <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">video2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">)</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><a href="#__codelineno-0-312"><span class="linenos" data-linenos="312 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">BASENAME</span><span class="p">:</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><a href="#__codelineno-0-313"><span class="linenos" data-linenos="313 "></span></a>            <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">video2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><a href="#__codelineno-0-314"><span class="linenos" data-linenos="314 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">CONTENT</span><span class="p">:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><a href="#__codelineno-0-315"><span class="linenos" data-linenos="315 "></span></a>            <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_content</span><span class="p">(</span><span class="n">video2</span><span class="p">)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><a href="#__codelineno-0-316"><span class="linenos" data-linenos="316 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">IMAGE_DEDUP</span><span class="p">:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><a href="#__codelineno-0-317"><span class="linenos" data-linenos="317 "></span></a>            <span class="c1"># Match ImageVideo instances with overlapping images (ImageVideo only)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><a href="#__codelineno-0-318"><span class="linenos" data-linenos="318 "></span></a>            <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">has_overlapping_images</span><span class="p">(</span><span class="n">video2</span><span class="p">)</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><a href="#__codelineno-0-319"><span class="linenos" data-linenos="319 "></span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">SHAPE</span><span class="p">:</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><a href="#__codelineno-0-320"><span class="linenos" data-linenos="320 "></span></a>            <span class="c1"># Match videos by shape only (height, width, channels)</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><a href="#__codelineno-0-321"><span class="linenos" data-linenos="321 "></span></a>            <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_shape</span><span class="p">(</span><span class="n">video2</span><span class="p">)</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><a href="#__codelineno-0-322"><span class="linenos" data-linenos="322 "></span></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><a href="#__codelineno-0-323"><span class="linenos" data-linenos="323 "></span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown video match method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.VideoMatcher.match" class="doc doc-heading">
            <code class="highlight language-python"><span class="k">match</span><span class="p">(</span><span class="n">video1</span><span class="p">,</span> <span class="n">video2</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.VideoMatcher.match" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Check if two videos match according to the configured method.</p>


            <details class="quote">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-297" name="__codelineno-0-297"></a><a href="#__codelineno-0-297"><span class="linenos" data-linenos="297 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">video1</span><span class="p">:</span> <span class="n">Video</span><span class="p">,</span> <span class="n">video2</span><span class="p">:</span> <span class="n">Video</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><a href="#__codelineno-0-298"><span class="linenos" data-linenos="298 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if two videos match according to the configured method.&quot;&quot;&quot;</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><a href="#__codelineno-0-299"><span class="linenos" data-linenos="299 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">AUTO</span><span class="p">:</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><a href="#__codelineno-0-300"><span class="linenos" data-linenos="300 "></span></a>        <span class="c1"># Try different methods in order of specificity (most to least specific).</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><a href="#__codelineno-0-301"><span class="linenos" data-linenos="301 "></span></a>        <span class="c1"># This prioritizes exact path matches, then basename matches, and only</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><a href="#__codelineno-0-302"><span class="linenos" data-linenos="302 "></span></a>        <span class="c1"># falls back to content matching (shape + backend) as a last resort.</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><a href="#__codelineno-0-303"><span class="linenos" data-linenos="303 "></span></a>        <span class="k">if</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">video2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><a href="#__codelineno-0-304"><span class="linenos" data-linenos="304 "></span></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><a href="#__codelineno-0-305"><span class="linenos" data-linenos="305 "></span></a>        <span class="k">if</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">video2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><a href="#__codelineno-0-306"><span class="linenos" data-linenos="306 "></span></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><a href="#__codelineno-0-307"><span class="linenos" data-linenos="307 "></span></a>        <span class="k">if</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_content</span><span class="p">(</span><span class="n">video2</span><span class="p">):</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><a href="#__codelineno-0-308"><span class="linenos" data-linenos="308 "></span></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><a href="#__codelineno-0-309"><span class="linenos" data-linenos="309 "></span></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><a href="#__codelineno-0-310"><span class="linenos" data-linenos="310 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">PATH</span><span class="p">:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><a href="#__codelineno-0-311"><span class="linenos" data-linenos="311 "></span></a>        <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">video2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">)</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><a href="#__codelineno-0-312"><span class="linenos" data-linenos="312 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">BASENAME</span><span class="p">:</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><a href="#__codelineno-0-313"><span class="linenos" data-linenos="313 "></span></a>        <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_path</span><span class="p">(</span><span class="n">video2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><a href="#__codelineno-0-314"><span class="linenos" data-linenos="314 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">CONTENT</span><span class="p">:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><a href="#__codelineno-0-315"><span class="linenos" data-linenos="315 "></span></a>        <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_content</span><span class="p">(</span><span class="n">video2</span><span class="p">)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><a href="#__codelineno-0-316"><span class="linenos" data-linenos="316 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">IMAGE_DEDUP</span><span class="p">:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><a href="#__codelineno-0-317"><span class="linenos" data-linenos="317 "></span></a>        <span class="c1"># Match ImageVideo instances with overlapping images (ImageVideo only)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><a href="#__codelineno-0-318"><span class="linenos" data-linenos="318 "></span></a>        <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">has_overlapping_images</span><span class="p">(</span><span class="n">video2</span><span class="p">)</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><a href="#__codelineno-0-319"><span class="linenos" data-linenos="319 "></span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">SHAPE</span><span class="p">:</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><a href="#__codelineno-0-320"><span class="linenos" data-linenos="320 "></span></a>        <span class="c1"># Match videos by shape only (height, width, channels)</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><a href="#__codelineno-0-321"><span class="linenos" data-linenos="321 "></span></a>        <span class="k">return</span> <span class="n">video1</span><span class="o">.</span><span class="n">matches_shape</span><span class="p">(</span><span class="n">video2</span><span class="p">)</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><a href="#__codelineno-0-322"><span class="linenos" data-linenos="322 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><a href="#__codelineno-0-323"><span class="linenos" data-linenos="323 "></span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown video match method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.FrameMatcher" class="doc doc-heading">
            <code>sleap_io.model.matching.FrameMatcher</code>


<a href="#sleap_io.model.matching.FrameMatcher" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">


        <p>Matcher for comparing and matching labeled frames.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.FrameMatcher.video_must_match">video_must_match</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether frames must belong to the same video to be
considered a match. Default is True.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>












<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;k&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frame1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frame2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.FrameMatcher.match&lt;/code&gt;)" href="#sleap_io.model.matching.FrameMatcher.match">match</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Check if two frames match.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



              <details class="quote">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-326" name="__codelineno-0-326"></a><a href="#__codelineno-0-326"><span class="linenos" data-linenos="326 "></span></a><span class="nd">@attrs</span><span class="o">.</span><span class="n">define</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><a href="#__codelineno-0-327"><span class="linenos" data-linenos="327 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">FrameMatcher</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><a href="#__codelineno-0-328"><span class="linenos" data-linenos="328 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Matcher for comparing and matching labeled frames.</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><a href="#__codelineno-0-329"><span class="linenos" data-linenos="329 "></span></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><a href="#__codelineno-0-330"><span class="linenos" data-linenos="330 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><a href="#__codelineno-0-331"><span class="linenos" data-linenos="331 "></span></a><span class="sd">        video_must_match: Whether frames must belong to the same video to be</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><a href="#__codelineno-0-332"><span class="linenos" data-linenos="332 "></span></a><span class="sd">            considered a match. Default is True.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><a href="#__codelineno-0-333"><span class="linenos" data-linenos="333 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><a href="#__codelineno-0-334"><span class="linenos" data-linenos="334 "></span></a>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><a href="#__codelineno-0-335"><span class="linenos" data-linenos="335 "></span></a>    <span class="n">video_must_match</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><a href="#__codelineno-0-336"><span class="linenos" data-linenos="336 "></span></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><a href="#__codelineno-0-337"><span class="linenos" data-linenos="337 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame1</span><span class="p">:</span> <span class="n">LabeledFrame</span><span class="p">,</span> <span class="n">frame2</span><span class="p">:</span> <span class="n">LabeledFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><a href="#__codelineno-0-338"><span class="linenos" data-linenos="338 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two frames match.&quot;&quot;&quot;</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><a href="#__codelineno-0-339"><span class="linenos" data-linenos="339 "></span></a>        <span class="k">return</span> <span class="n">frame1</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">frame2</span><span class="p">,</span> <span class="n">video_must_match</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">video_must_match</span><span class="p">)</span>
</code></pre></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.FrameMatcher.match" class="doc doc-heading">
            <code class="highlight language-python"><span class="k">match</span><span class="p">(</span><span class="n">frame1</span><span class="p">,</span> <span class="n">frame2</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.FrameMatcher.match" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Check if two frames match.</p>


            <details class="quote">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-337" name="__codelineno-0-337"></a><a href="#__codelineno-0-337"><span class="linenos" data-linenos="337 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame1</span><span class="p">:</span> <span class="n">LabeledFrame</span><span class="p">,</span> <span class="n">frame2</span><span class="p">:</span> <span class="n">LabeledFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><a href="#__codelineno-0-338"><span class="linenos" data-linenos="338 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if two frames match.&quot;&quot;&quot;</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><a href="#__codelineno-0-339"><span class="linenos" data-linenos="339 "></span></a>    <span class="k">return</span> <span class="n">frame1</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">frame2</span><span class="p">,</span> <span class="n">video_must_match</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">video_must_match</span><span class="p">)</span>
</code></pre></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="pre-configured-matchers">Pre-configured matchers<a class="headerlink" href="#pre-configured-matchers" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-attribute">



<h4 id="sleap_io.model.matching.STRUCTURE_SKELETON_MATCHER" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sleap_io</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">matching</span><span class="o">.</span><span class="n">STRUCTURE_SKELETON_MATCHER</span> <span class="o">=</span> <span class="n">SkeletonMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="p">(</span><span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">STRUCTURE</span><span class="p">))</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.STRUCTURE_SKELETON_MATCHER" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="sleap_io.model.matching.SUBSET_SKELETON_MATCHER" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sleap_io</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">matching</span><span class="o">.</span><span class="n">SUBSET_SKELETON_MATCHER</span> <span class="o">=</span> <span class="n">SkeletonMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="p">(</span><span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">SUBSET</span><span class="p">))</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.SUBSET_SKELETON_MATCHER" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="sleap_io.model.matching.OVERLAP_SKELETON_MATCHER" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sleap_io</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">matching</span><span class="o">.</span><span class="n">OVERLAP_SKELETON_MATCHER</span> <span class="o">=</span> <span class="n">SkeletonMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="p">(</span><span class="n">SkeletonMatchMethod</span><span class="o">.</span><span class="n">OVERLAP</span><span class="p">),</span> <span class="n">min_overlap</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.OVERLAP_SKELETON_MATCHER" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="sleap_io.model.matching.DUPLICATE_MATCHER" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sleap_io</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">matching</span><span class="o">.</span><span class="n">DUPLICATE_MATCHER</span> <span class="o">=</span> <span class="n">InstanceMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="p">(</span><span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">SPATIAL</span><span class="p">),</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.DUPLICATE_MATCHER" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="sleap_io.model.matching.IOU_MATCHER" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sleap_io</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">matching</span><span class="o">.</span><span class="n">IOU_MATCHER</span> <span class="o">=</span> <span class="n">InstanceMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="p">(</span><span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">IOU</span><span class="p">),</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.IOU_MATCHER" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="sleap_io.model.matching.IDENTITY_INSTANCE_MATCHER" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sleap_io</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">matching</span><span class="o">.</span><span class="n">IDENTITY_INSTANCE_MATCHER</span> <span class="o">=</span> <span class="n">InstanceMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="p">(</span><span class="n">InstanceMatchMethod</span><span class="o">.</span><span class="n">IDENTITY</span><span class="p">))</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.IDENTITY_INSTANCE_MATCHER" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="sleap_io.model.matching.NAME_TRACK_MATCHER" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sleap_io</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">matching</span><span class="o">.</span><span class="n">NAME_TRACK_MATCHER</span> <span class="o">=</span> <span class="n">TrackMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="p">(</span><span class="n">TrackMatchMethod</span><span class="o">.</span><span class="n">NAME</span><span class="p">))</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.NAME_TRACK_MATCHER" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="sleap_io.model.matching.IDENTITY_TRACK_MATCHER" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sleap_io</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">matching</span><span class="o">.</span><span class="n">IDENTITY_TRACK_MATCHER</span> <span class="o">=</span> <span class="n">TrackMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="p">(</span><span class="n">TrackMatchMethod</span><span class="o">.</span><span class="n">IDENTITY</span><span class="p">))</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.IDENTITY_TRACK_MATCHER" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="sleap_io.model.matching.AUTO_VIDEO_MATCHER" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sleap_io</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">matching</span><span class="o">.</span><span class="n">AUTO_VIDEO_MATCHER</span> <span class="o">=</span> <span class="n">VideoMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="p">(</span><span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">AUTO</span><span class="p">))</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.AUTO_VIDEO_MATCHER" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="sleap_io.model.matching.SOURCE_VIDEO_MATCHER" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sleap_io</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">matching</span><span class="o">.</span><span class="n">SOURCE_VIDEO_MATCHER</span> <span class="o">=</span> <span class="n">VideoMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="p">(</span><span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">BASENAME</span><span class="p">))</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.SOURCE_VIDEO_MATCHER" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="sleap_io.model.matching.PATH_VIDEO_MATCHER" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sleap_io</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">matching</span><span class="o">.</span><span class="n">PATH_VIDEO_MATCHER</span> <span class="o">=</span> <span class="n">VideoMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="p">(</span><span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">PATH</span><span class="p">),</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.PATH_VIDEO_MATCHER" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="sleap_io.model.matching.BASENAME_VIDEO_MATCHER" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sleap_io</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">matching</span><span class="o">.</span><span class="n">BASENAME_VIDEO_MATCHER</span> <span class="o">=</span> <span class="n">VideoMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="p">(</span><span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">BASENAME</span><span class="p">))</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.BASENAME_VIDEO_MATCHER" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="sleap_io.model.matching.IMAGE_DEDUP_VIDEO_MATCHER" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sleap_io</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">matching</span><span class="o">.</span><span class="n">IMAGE_DEDUP_VIDEO_MATCHER</span> <span class="o">=</span> <span class="n">VideoMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="p">(</span><span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">IMAGE_DEDUP</span><span class="p">))</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.IMAGE_DEDUP_VIDEO_MATCHER" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="sleap_io.model.matching.SHAPE_VIDEO_MATCHER" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sleap_io</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">matching</span><span class="o">.</span><span class="n">SHAPE_VIDEO_MATCHER</span> <span class="o">=</span> <span class="n">VideoMatcher</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="p">(</span><span class="n">VideoMatchMethod</span><span class="o">.</span><span class="n">SHAPE</span><span class="p">))</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#sleap_io.model.matching.SHAPE_VIDEO_MATCHER" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">

    </div>

</div><h3 id="result-classes">Result classes<a class="headerlink" href="#result-classes" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.MergeResult" class="doc doc-heading">
            <code>sleap_io.model.matching.MergeResult</code>


<a href="#sleap_io.model.matching.MergeResult" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">


        <p>Result of a merge operation.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.successful">successful</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the merge completed successfully.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.frames_merged">frames_merged</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of frames that were merged.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.instances_added">instances_added</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of new instances added.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.instances_updated">instances_updated</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of existing instances that were updated.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.instances_skipped">instances_skipped</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of instances that were skipped.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.conflicts">conflicts</span></code></td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;sleap_io.model.matching.ConflictResolution&lt;/code&gt;" href="#sleap_io.model.matching.ConflictResolution">ConflictResolution</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of conflicts that were resolved during merging.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeResult.errors">errors</span></code></td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;sleap_io.model.matching.MergeError&lt;/code&gt;" href="#sleap_io.model.matching.MergeError">MergeError</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of errors encountered during merging.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>












<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.MergeResult.summary&lt;/code&gt;)" href="#sleap_io.model.matching.MergeResult.summary">summary</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generate a human-readable summary of the merge result.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



              <details class="quote">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-409" name="__codelineno-0-409"></a><a href="#__codelineno-0-409"><span class="linenos" data-linenos="409 "></span></a><span class="nd">@attrs</span><span class="o">.</span><span class="n">define</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><a href="#__codelineno-0-410"><span class="linenos" data-linenos="410 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">MergeResult</span><span class="p">:</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><a href="#__codelineno-0-411"><span class="linenos" data-linenos="411 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Result of a merge operation.</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><a href="#__codelineno-0-412"><span class="linenos" data-linenos="412 "></span></a>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><a href="#__codelineno-0-413"><span class="linenos" data-linenos="413 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><a href="#__codelineno-0-414"><span class="linenos" data-linenos="414 "></span></a><span class="sd">        successful: Whether the merge completed successfully.</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><a href="#__codelineno-0-415"><span class="linenos" data-linenos="415 "></span></a><span class="sd">        frames_merged: Number of frames that were merged.</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><a href="#__codelineno-0-416"><span class="linenos" data-linenos="416 "></span></a><span class="sd">        instances_added: Number of new instances added.</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><a href="#__codelineno-0-417"><span class="linenos" data-linenos="417 "></span></a><span class="sd">        instances_updated: Number of existing instances that were updated.</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><a href="#__codelineno-0-418"><span class="linenos" data-linenos="418 "></span></a><span class="sd">        instances_skipped: Number of instances that were skipped.</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><a href="#__codelineno-0-419"><span class="linenos" data-linenos="419 "></span></a><span class="sd">        conflicts: List of conflicts that were resolved during merging.</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><a href="#__codelineno-0-420"><span class="linenos" data-linenos="420 "></span></a><span class="sd">        errors: List of errors encountered during merging.</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><a href="#__codelineno-0-421"><span class="linenos" data-linenos="421 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><a href="#__codelineno-0-422"><span class="linenos" data-linenos="422 "></span></a>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><a href="#__codelineno-0-423"><span class="linenos" data-linenos="423 "></span></a>    <span class="n">successful</span><span class="p">:</span> <span class="nb">bool</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><a href="#__codelineno-0-424"><span class="linenos" data-linenos="424 "></span></a>    <span class="n">frames_merged</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><a href="#__codelineno-0-425"><span class="linenos" data-linenos="425 "></span></a>    <span class="n">instances_added</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><a href="#__codelineno-0-426"><span class="linenos" data-linenos="426 "></span></a>    <span class="n">instances_updated</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><a href="#__codelineno-0-427"><span class="linenos" data-linenos="427 "></span></a>    <span class="n">instances_skipped</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><a href="#__codelineno-0-428"><span class="linenos" data-linenos="428 "></span></a>    <span class="n">conflicts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ConflictResolution</span><span class="p">]</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><a href="#__codelineno-0-429"><span class="linenos" data-linenos="429 "></span></a>    <span class="n">errors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MergeError</span><span class="p">]</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><a href="#__codelineno-0-430"><span class="linenos" data-linenos="430 "></span></a>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><a href="#__codelineno-0-431"><span class="linenos" data-linenos="431 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><a href="#__codelineno-0-432"><span class="linenos" data-linenos="432 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a human-readable summary of the merge result.&quot;&quot;&quot;</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><a href="#__codelineno-0-433"><span class="linenos" data-linenos="433 "></span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><a href="#__codelineno-0-434"><span class="linenos" data-linenos="434 "></span></a>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><a href="#__codelineno-0-435"><span class="linenos" data-linenos="435 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">successful</span><span class="p">:</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><a href="#__codelineno-0-436"><span class="linenos" data-linenos="436 "></span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;✓ Merge completed successfully&quot;</span><span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><a href="#__codelineno-0-437"><span class="linenos" data-linenos="437 "></span></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><a href="#__codelineno-0-438"><span class="linenos" data-linenos="438 "></span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;✗ Merge completed with errors&quot;</span><span class="p">)</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><a href="#__codelineno-0-439"><span class="linenos" data-linenos="439 "></span></a>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><a href="#__codelineno-0-440"><span class="linenos" data-linenos="440 "></span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Frames merged: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">frames_merged</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><a href="#__codelineno-0-441"><span class="linenos" data-linenos="441 "></span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Instances added: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">instances_added</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><a href="#__codelineno-0-442"><span class="linenos" data-linenos="442 "></span></a>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><a href="#__codelineno-0-443"><span class="linenos" data-linenos="443 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances_updated</span><span class="p">:</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><a href="#__codelineno-0-444"><span class="linenos" data-linenos="444 "></span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Instances updated: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">instances_updated</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><a href="#__codelineno-0-445"><span class="linenos" data-linenos="445 "></span></a>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><a href="#__codelineno-0-446"><span class="linenos" data-linenos="446 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances_skipped</span><span class="p">:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><a href="#__codelineno-0-447"><span class="linenos" data-linenos="447 "></span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Instances skipped: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">instances_skipped</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><a href="#__codelineno-0-448"><span class="linenos" data-linenos="448 "></span></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><a href="#__codelineno-0-449"><span class="linenos" data-linenos="449 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conflicts</span><span class="p">:</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><a href="#__codelineno-0-450"><span class="linenos" data-linenos="450 "></span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Conflicts resolved: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conflicts</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><a href="#__codelineno-0-451"><span class="linenos" data-linenos="451 "></span></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><a href="#__codelineno-0-452"><span class="linenos" data-linenos="452 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><a href="#__codelineno-0-453"><span class="linenos" data-linenos="453 "></span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Errors encountered: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><a href="#__codelineno-0-454"><span class="linenos" data-linenos="454 "></span></a>            <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>  <span class="c1"># Show first 5 errors</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><a href="#__codelineno-0-455"><span class="linenos" data-linenos="455 "></span></a>                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    - </span><span class="si">{</span><span class="n">error</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><a href="#__codelineno-0-456"><span class="linenos" data-linenos="456 "></span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><a href="#__codelineno-0-457"><span class="linenos" data-linenos="457 "></span></a>                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    ... and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">5</span><span class="si">}</span><span class="s2"> more&quot;</span><span class="p">)</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><a href="#__codelineno-0-458"><span class="linenos" data-linenos="458 "></span></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><a href="#__codelineno-0-459"><span class="linenos" data-linenos="459 "></span></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.MergeResult.summary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">summary</span><span class="p">()</span></code>

<a href="#sleap_io.model.matching.MergeResult.summary" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Generate a human-readable summary of the merge result.</p>


            <details class="quote">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-431" name="__codelineno-0-431"></a><a href="#__codelineno-0-431"><span class="linenos" data-linenos="431 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><a href="#__codelineno-0-432"><span class="linenos" data-linenos="432 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a human-readable summary of the merge result.&quot;&quot;&quot;</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><a href="#__codelineno-0-433"><span class="linenos" data-linenos="433 "></span></a>    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><a href="#__codelineno-0-434"><span class="linenos" data-linenos="434 "></span></a>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><a href="#__codelineno-0-435"><span class="linenos" data-linenos="435 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">successful</span><span class="p">:</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><a href="#__codelineno-0-436"><span class="linenos" data-linenos="436 "></span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;✓ Merge completed successfully&quot;</span><span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><a href="#__codelineno-0-437"><span class="linenos" data-linenos="437 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><a href="#__codelineno-0-438"><span class="linenos" data-linenos="438 "></span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;✗ Merge completed with errors&quot;</span><span class="p">)</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><a href="#__codelineno-0-439"><span class="linenos" data-linenos="439 "></span></a>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><a href="#__codelineno-0-440"><span class="linenos" data-linenos="440 "></span></a>    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Frames merged: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">frames_merged</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><a href="#__codelineno-0-441"><span class="linenos" data-linenos="441 "></span></a>    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Instances added: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">instances_added</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><a href="#__codelineno-0-442"><span class="linenos" data-linenos="442 "></span></a>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><a href="#__codelineno-0-443"><span class="linenos" data-linenos="443 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances_updated</span><span class="p">:</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><a href="#__codelineno-0-444"><span class="linenos" data-linenos="444 "></span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Instances updated: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">instances_updated</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><a href="#__codelineno-0-445"><span class="linenos" data-linenos="445 "></span></a>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><a href="#__codelineno-0-446"><span class="linenos" data-linenos="446 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances_skipped</span><span class="p">:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><a href="#__codelineno-0-447"><span class="linenos" data-linenos="447 "></span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Instances skipped: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">instances_skipped</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><a href="#__codelineno-0-448"><span class="linenos" data-linenos="448 "></span></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><a href="#__codelineno-0-449"><span class="linenos" data-linenos="449 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conflicts</span><span class="p">:</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><a href="#__codelineno-0-450"><span class="linenos" data-linenos="450 "></span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Conflicts resolved: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conflicts</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><a href="#__codelineno-0-451"><span class="linenos" data-linenos="451 "></span></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><a href="#__codelineno-0-452"><span class="linenos" data-linenos="452 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><a href="#__codelineno-0-453"><span class="linenos" data-linenos="453 "></span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Errors encountered: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><a href="#__codelineno-0-454"><span class="linenos" data-linenos="454 "></span></a>        <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>  <span class="c1"># Show first 5 errors</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><a href="#__codelineno-0-455"><span class="linenos" data-linenos="455 "></span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    - </span><span class="si">{</span><span class="n">error</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><a href="#__codelineno-0-456"><span class="linenos" data-linenos="456 "></span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><a href="#__codelineno-0-457"><span class="linenos" data-linenos="457 "></span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    ... and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">5</span><span class="si">}</span><span class="s2"> more&quot;</span><span class="p">)</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><a href="#__codelineno-0-458"><span class="linenos" data-linenos="458 "></span></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><a href="#__codelineno-0-459"><span class="linenos" data-linenos="459 "></span></a>    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.ConflictResolution" class="doc doc-heading">
            <code>sleap_io.model.matching.ConflictResolution</code>


<a href="#sleap_io.model.matching.ConflictResolution" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">


        <p>Information about a conflict that was resolved during merging.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.ConflictResolution.frame">frame</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;LabeledFrame&lt;/code&gt; (&lt;code&gt;sleap_io.model.labeled_frame.LabeledFrame&lt;/code&gt;)" href="../reference/sleap_io/model/labeled_frame/#sleap_io.model.labeled_frame.LabeledFrame">LabeledFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The labeled frame where the conflict occurred.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.ConflictResolution.conflict_type">conflict_type</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of conflict (e.g., "duplicate_instance",
"skeleton_mismatch").</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.ConflictResolution.original_data">original_data</span></code></td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The original data before resolution.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.ConflictResolution.new_data">new_data</span></code></td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The new/incoming data that caused the conflict.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.ConflictResolution.resolution">resolution</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description of how the conflict was resolved.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>













              <details class="quote">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-364" name="__codelineno-0-364"></a><a href="#__codelineno-0-364"><span class="linenos" data-linenos="364 "></span></a><span class="nd">@attrs</span><span class="o">.</span><span class="n">define</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><a href="#__codelineno-0-365"><span class="linenos" data-linenos="365 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">ConflictResolution</span><span class="p">:</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><a href="#__codelineno-0-366"><span class="linenos" data-linenos="366 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Information about a conflict that was resolved during merging.</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><a href="#__codelineno-0-367"><span class="linenos" data-linenos="367 "></span></a>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><a href="#__codelineno-0-368"><span class="linenos" data-linenos="368 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><a href="#__codelineno-0-369"><span class="linenos" data-linenos="369 "></span></a><span class="sd">        frame: The labeled frame where the conflict occurred.</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><a href="#__codelineno-0-370"><span class="linenos" data-linenos="370 "></span></a><span class="sd">        conflict_type: Type of conflict (e.g., &quot;duplicate_instance&quot;,</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><a href="#__codelineno-0-371"><span class="linenos" data-linenos="371 "></span></a><span class="sd">            &quot;skeleton_mismatch&quot;).</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><a href="#__codelineno-0-372"><span class="linenos" data-linenos="372 "></span></a><span class="sd">        original_data: The original data before resolution.</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><a href="#__codelineno-0-373"><span class="linenos" data-linenos="373 "></span></a><span class="sd">        new_data: The new/incoming data that caused the conflict.</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><a href="#__codelineno-0-374"><span class="linenos" data-linenos="374 "></span></a><span class="sd">        resolution: Description of how the conflict was resolved.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><a href="#__codelineno-0-375"><span class="linenos" data-linenos="375 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><a href="#__codelineno-0-376"><span class="linenos" data-linenos="376 "></span></a>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><a href="#__codelineno-0-377"><span class="linenos" data-linenos="377 "></span></a>    <span class="n">frame</span><span class="p">:</span> <span class="n">LabeledFrame</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><a href="#__codelineno-0-378"><span class="linenos" data-linenos="378 "></span></a>    <span class="n">conflict_type</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><a href="#__codelineno-0-379"><span class="linenos" data-linenos="379 "></span></a>    <span class="n">original_data</span><span class="p">:</span> <span class="n">Any</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><a href="#__codelineno-0-380"><span class="linenos" data-linenos="380 "></span></a>    <span class="n">new_data</span><span class="p">:</span> <span class="n">Any</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><a href="#__codelineno-0-381"><span class="linenos" data-linenos="381 "></span></a>    <span class="n">resolution</span><span class="p">:</span> <span class="nb">str</span>
</code></pre></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.MergeError" class="doc doc-heading">
            <code>sleap_io.model.matching.MergeError</code>


<a href="#sleap_io.model.matching.MergeError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Base exception for merge errors.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeError.message">message</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Human-readable error message.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="sleap_io.model.matching.MergeError.details">details</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing additional error details and context.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>













              <details class="quote">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-384" name="__codelineno-0-384"></a><a href="#__codelineno-0-384"><span class="linenos" data-linenos="384 "></span></a><span class="nd">@attrs</span><span class="o">.</span><span class="n">define</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><a href="#__codelineno-0-385"><span class="linenos" data-linenos="385 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">MergeError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><a href="#__codelineno-0-386"><span class="linenos" data-linenos="386 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Base exception for merge errors.</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><a href="#__codelineno-0-387"><span class="linenos" data-linenos="387 "></span></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><a href="#__codelineno-0-388"><span class="linenos" data-linenos="388 "></span></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><a href="#__codelineno-0-389"><span class="linenos" data-linenos="389 "></span></a><span class="sd">        message: Human-readable error message.</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><a href="#__codelineno-0-390"><span class="linenos" data-linenos="390 "></span></a><span class="sd">        details: Dictionary containing additional error details and context.</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><a href="#__codelineno-0-391"><span class="linenos" data-linenos="391 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><a href="#__codelineno-0-392"><span class="linenos" data-linenos="392 "></span></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><a href="#__codelineno-0-393"><span class="linenos" data-linenos="393 "></span></a>    <span class="n">message</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><a href="#__codelineno-0-394"><span class="linenos" data-linenos="394 "></span></a>    <span class="n">details</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</code></pre></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.SkeletonMismatchError" class="doc doc-heading">
            <code>sleap_io.model.matching.SkeletonMismatchError</code>


<a href="#sleap_io.model.matching.SkeletonMismatchError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code&gt;sleap_io.model.matching.MergeError&lt;/code&gt;" href="#sleap_io.model.matching.MergeError">MergeError</a></code></p>


        <p>Raised when skeletons don't match during merge.</p>













              <details class="quote">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-397" name="__codelineno-0-397"></a><a href="#__codelineno-0-397"><span class="linenos" data-linenos="397 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">SkeletonMismatchError</span><span class="p">(</span><span class="n">MergeError</span><span class="p">):</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><a href="#__codelineno-0-398"><span class="linenos" data-linenos="398 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when skeletons don&#39;t match during merge.&quot;&quot;&quot;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><a href="#__codelineno-0-399"><span class="linenos" data-linenos="399 "></span></a>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><a href="#__codelineno-0-400"><span class="linenos" data-linenos="400 "></span></a>    <span class="k">pass</span>
</code></pre></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.VideoNotFoundError" class="doc doc-heading">
            <code>sleap_io.model.matching.VideoNotFoundError</code>


<a href="#sleap_io.model.matching.VideoNotFoundError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code&gt;sleap_io.model.matching.MergeError&lt;/code&gt;" href="#sleap_io.model.matching.MergeError">MergeError</a></code></p>


        <p>Raised when a video file cannot be found during merge.</p>













              <details class="quote">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-403" name="__codelineno-0-403"></a><a href="#__codelineno-0-403"><span class="linenos" data-linenos="403 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">VideoNotFoundError</span><span class="p">(</span><span class="n">MergeError</span><span class="p">):</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><a href="#__codelineno-0-404"><span class="linenos" data-linenos="404 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when a video file cannot be found during merge.&quot;&quot;&quot;</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><a href="#__codelineno-0-405"><span class="linenos" data-linenos="405 "></span></a>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><a href="#__codelineno-0-406"><span class="linenos" data-linenos="406 "></span></a>    <span class="k">pass</span>
</code></pre></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div><h3 id="progress-tracking">Progress tracking<a class="headerlink" href="#progress-tracking" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<h4 id="sleap_io.model.matching.MergeProgressBar" class="doc doc-heading">
            <code>sleap_io.model.matching.MergeProgressBar</code>


<a href="#sleap_io.model.matching.MergeProgressBar" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">


        <p>Context manager for merge progress tracking using tqdm.</p>
<p>This provides a clean interface for tracking merge progress with visual feedback.</p>


<details class="example" open>
  <summary>Example</summary>
  <p>with MergeProgressBar("Merging predictions") as progress:
    result = labels.merge(predictions, progress_callback=progress.callback)</p>
</details>











<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__enter__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.MergeProgressBar.__enter__&lt;/code&gt;)" href="#sleap_io.model.matching.MergeProgressBar.__enter__">__enter__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Enter the context manager.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__exit__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exc_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exc_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exc_tb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.MergeProgressBar.__exit__&lt;/code&gt;)" href="#sleap_io.model.matching.MergeProgressBar.__exit__">__exit__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Exit the context manager and close the progress bar.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Merging&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;leave&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.MergeProgressBar.__init__&lt;/code&gt;)" href="#sleap_io.model.matching.MergeProgressBar.__init__">__init__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Initialize the progress bar.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt; (&lt;code&gt;sleap_io.model.matching.MergeProgressBar.callback&lt;/code&gt;)" href="#sleap_io.model.matching.MergeProgressBar.callback">callback</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Progress callback for merge operations.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



              <details class="quote">
                <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
                <div class="highlight"><pre><span></span><code><a id="__codelineno-0-462" name="__codelineno-0-462"></a><a href="#__codelineno-0-462"><span class="linenos" data-linenos="462 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">MergeProgressBar</span><span class="p">:</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><a href="#__codelineno-0-463"><span class="linenos" data-linenos="463 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Context manager for merge progress tracking using tqdm.</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><a href="#__codelineno-0-464"><span class="linenos" data-linenos="464 "></span></a>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><a href="#__codelineno-0-465"><span class="linenos" data-linenos="465 "></span></a><span class="sd">    This provides a clean interface for tracking merge progress with visual feedback.</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><a href="#__codelineno-0-466"><span class="linenos" data-linenos="466 "></span></a>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><a href="#__codelineno-0-467"><span class="linenos" data-linenos="467 "></span></a><span class="sd">    Example:</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><a href="#__codelineno-0-468"><span class="linenos" data-linenos="468 "></span></a><span class="sd">        with MergeProgressBar(&quot;Merging predictions&quot;) as progress:</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><a href="#__codelineno-0-469"><span class="linenos" data-linenos="469 "></span></a><span class="sd">            result = labels.merge(predictions, progress_callback=progress.callback)</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><a href="#__codelineno-0-470"><span class="linenos" data-linenos="470 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><a href="#__codelineno-0-471"><span class="linenos" data-linenos="471 "></span></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><a href="#__codelineno-0-472"><span class="linenos" data-linenos="472 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Merging&quot;</span><span class="p">,</span> <span class="n">leave</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><a href="#__codelineno-0-473"><span class="linenos" data-linenos="473 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the progress bar.</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><a href="#__codelineno-0-474"><span class="linenos" data-linenos="474 "></span></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><a href="#__codelineno-0-475"><span class="linenos" data-linenos="475 "></span></a><span class="sd">        Args:</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><a href="#__codelineno-0-476"><span class="linenos" data-linenos="476 "></span></a><span class="sd">            desc: Description to show in the progress bar.</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><a href="#__codelineno-0-477"><span class="linenos" data-linenos="477 "></span></a><span class="sd">            leave: Whether to leave the progress bar on screen after completion.</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><a href="#__codelineno-0-478"><span class="linenos" data-linenos="478 "></span></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><a href="#__codelineno-0-479"><span class="linenos" data-linenos="479 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">desc</span> <span class="o">=</span> <span class="n">desc</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><a href="#__codelineno-0-480"><span class="linenos" data-linenos="480 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">leave</span> <span class="o">=</span> <span class="n">leave</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><a href="#__codelineno-0-481"><span class="linenos" data-linenos="481 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><a href="#__codelineno-0-482"><span class="linenos" data-linenos="482 "></span></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><a href="#__codelineno-0-483"><span class="linenos" data-linenos="483 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><a href="#__codelineno-0-484"><span class="linenos" data-linenos="484 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Enter the context manager.&quot;&quot;&quot;</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><a href="#__codelineno-0-485"><span class="linenos" data-linenos="485 "></span></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><a href="#__codelineno-0-486"><span class="linenos" data-linenos="486 "></span></a>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><a href="#__codelineno-0-487"><span class="linenos" data-linenos="487 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><a href="#__codelineno-0-488"><span class="linenos" data-linenos="488 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Exit the context manager and close the progress bar.&quot;&quot;&quot;</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><a href="#__codelineno-0-489"><span class="linenos" data-linenos="489 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><a href="#__codelineno-0-490"><span class="linenos" data-linenos="490 "></span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><a href="#__codelineno-0-491"><span class="linenos" data-linenos="491 "></span></a>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><a href="#__codelineno-0-492"><span class="linenos" data-linenos="492 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><a href="#__codelineno-0-493"><span class="linenos" data-linenos="493 "></span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Progress callback for merge operations.</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><a href="#__codelineno-0-494"><span class="linenos" data-linenos="494 "></span></a>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><a href="#__codelineno-0-495"><span class="linenos" data-linenos="495 "></span></a><span class="sd">        Args:</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><a href="#__codelineno-0-496"><span class="linenos" data-linenos="496 "></span></a><span class="sd">            current: Current progress value.</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a><a href="#__codelineno-0-497"><span class="linenos" data-linenos="497 "></span></a><span class="sd">            total: Total items to process.</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><a href="#__codelineno-0-498"><span class="linenos" data-linenos="498 "></span></a><span class="sd">            message: Optional message to display.</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><a href="#__codelineno-0-499"><span class="linenos" data-linenos="499 "></span></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><a href="#__codelineno-0-500"><span class="linenos" data-linenos="500 "></span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><a href="#__codelineno-0-501"><span class="linenos" data-linenos="501 "></span></a>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><a href="#__codelineno-0-502"><span class="linenos" data-linenos="502 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">total</span><span class="p">:</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><a href="#__codelineno-0-503"><span class="linenos" data-linenos="503 "></span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">leave</span><span class="p">)</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><a href="#__codelineno-0-504"><span class="linenos" data-linenos="504 "></span></a>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><a href="#__codelineno-0-505"><span class="linenos" data-linenos="505 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span><span class="p">:</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><a href="#__codelineno-0-506"><span class="linenos" data-linenos="506 "></span></a>            <span class="k">if</span> <span class="n">message</span><span class="p">:</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><a href="#__codelineno-0-507"><span class="linenos" data-linenos="507 "></span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><a href="#__codelineno-0-508"><span class="linenos" data-linenos="508 "></span></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><a href="#__codelineno-0-509"><span class="linenos" data-linenos="509 "></span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="p">)</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><a href="#__codelineno-0-510"><span class="linenos" data-linenos="510 "></span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">current</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><a href="#__codelineno-0-511"><span class="linenos" data-linenos="511 "></span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</code></pre></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.MergeProgressBar.__enter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__enter__</span><span class="p">()</span></code>

<a href="#sleap_io.model.matching.MergeProgressBar.__enter__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Enter the context manager.</p>


            <details class="quote">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-483" name="__codelineno-0-483"></a><a href="#__codelineno-0-483"><span class="linenos" data-linenos="483 "></span></a><span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><a href="#__codelineno-0-484"><span class="linenos" data-linenos="484 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Enter the context manager.&quot;&quot;&quot;</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><a href="#__codelineno-0-485"><span class="linenos" data-linenos="485 "></span></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.MergeProgressBar.__exit__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__exit__</span><span class="p">(</span><span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.MergeProgressBar.__exit__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Exit the context manager and close the progress bar.</p>


            <details class="quote">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-487" name="__codelineno-0-487"></a><a href="#__codelineno-0-487"><span class="linenos" data-linenos="487 "></span></a><span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><a href="#__codelineno-0-488"><span class="linenos" data-linenos="488 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Exit the context manager and close the progress bar.&quot;&quot;&quot;</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><a href="#__codelineno-0-489"><span class="linenos" data-linenos="489 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><a href="#__codelineno-0-490"><span class="linenos" data-linenos="490 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.MergeProgressBar.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Merging&#39;</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.MergeProgressBar.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Initialize the progress bar.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>desc</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description to show in the progress bar.</p>
              </div>
            </td>
            <td>
                  <code>&#39;Merging&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>leave</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to leave the progress bar on screen after completion.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-472" name="__codelineno-0-472"></a><a href="#__codelineno-0-472"><span class="linenos" data-linenos="472 "></span></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Merging&quot;</span><span class="p">,</span> <span class="n">leave</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><a href="#__codelineno-0-473"><span class="linenos" data-linenos="473 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the progress bar.</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><a href="#__codelineno-0-474"><span class="linenos" data-linenos="474 "></span></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><a href="#__codelineno-0-475"><span class="linenos" data-linenos="475 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><a href="#__codelineno-0-476"><span class="linenos" data-linenos="476 "></span></a><span class="sd">        desc: Description to show in the progress bar.</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><a href="#__codelineno-0-477"><span class="linenos" data-linenos="477 "></span></a><span class="sd">        leave: Whether to leave the progress bar on screen after completion.</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><a href="#__codelineno-0-478"><span class="linenos" data-linenos="478 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><a href="#__codelineno-0-479"><span class="linenos" data-linenos="479 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">desc</span> <span class="o">=</span> <span class="n">desc</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><a href="#__codelineno-0-480"><span class="linenos" data-linenos="480 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">leave</span> <span class="o">=</span> <span class="n">leave</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><a href="#__codelineno-0-481"><span class="linenos" data-linenos="481 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="sleap_io.model.matching.MergeProgressBar.callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">callback</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

<a href="#sleap_io.model.matching.MergeProgressBar.callback" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Progress callback for merge operations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>current</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current progress value.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>total</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Total items to process.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional message to display.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>sleap_io/model/matching.py</code></summary>
              <div class="highlight"><pre><span></span><code><a id="__codelineno-0-492" name="__codelineno-0-492"></a><a href="#__codelineno-0-492"><span class="linenos" data-linenos="492 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><a href="#__codelineno-0-493"><span class="linenos" data-linenos="493 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Progress callback for merge operations.</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><a href="#__codelineno-0-494"><span class="linenos" data-linenos="494 "></span></a>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><a href="#__codelineno-0-495"><span class="linenos" data-linenos="495 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><a href="#__codelineno-0-496"><span class="linenos" data-linenos="496 "></span></a><span class="sd">        current: Current progress value.</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a><a href="#__codelineno-0-497"><span class="linenos" data-linenos="497 "></span></a><span class="sd">        total: Total items to process.</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><a href="#__codelineno-0-498"><span class="linenos" data-linenos="498 "></span></a><span class="sd">        message: Optional message to display.</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><a href="#__codelineno-0-499"><span class="linenos" data-linenos="499 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><a href="#__codelineno-0-500"><span class="linenos" data-linenos="500 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><a href="#__codelineno-0-501"><span class="linenos" data-linenos="501 "></span></a>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><a href="#__codelineno-0-502"><span class="linenos" data-linenos="502 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">total</span><span class="p">:</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><a href="#__codelineno-0-503"><span class="linenos" data-linenos="503 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">leave</span><span class="p">)</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><a href="#__codelineno-0-504"><span class="linenos" data-linenos="504 "></span></a>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><a href="#__codelineno-0-505"><span class="linenos" data-linenos="505 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span><span class="p">:</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><a href="#__codelineno-0-506"><span class="linenos" data-linenos="506 "></span></a>        <span class="k">if</span> <span class="n">message</span><span class="p">:</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><a href="#__codelineno-0-507"><span class="linenos" data-linenos="507 "></span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><a href="#__codelineno-0-508"><span class="linenos" data-linenos="508 "></span></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><a href="#__codelineno-0-509"><span class="linenos" data-linenos="509 "></span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">desc</span><span class="p">)</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><a href="#__codelineno-0-510"><span class="linenos" data-linenos="510 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">current</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><a href="#__codelineno-0-511"><span class="linenos" data-linenos="511 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pbar</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</code></pre></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 - 2025 Talmo Lab

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/talmolab" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/talmop" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tracking", "toc.follow", "navigation.sections", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate", "content.tooltips", "content.code.select", "content.footnote.tooltips"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>